var KR=Object.defineProperty;var $R=(t,e,n)=>e in t?KR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Gg=(t,e,n)=>($R(t,typeof e!="symbol"?e+"":e,n),n),qg=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var he=(t,e,n)=>(qg(t,e,"read from private field"),n?n.call(t):e.get(t)),gt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Qe=(t,e,n,r)=>(qg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var Af=(t,e,n,r)=>({set _(i){Qe(t,e,i,n)},get _(){return he(t,e,r)}}),xr=(t,e,n)=>(qg(t,e,"access private method"),n);function sI(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var rh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var aI={exports:{}},M1={},lI={exports:{}},lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kd=Symbol.for("react.element"),QR=Symbol.for("react.portal"),XR=Symbol.for("react.fragment"),YR=Symbol.for("react.strict_mode"),ZR=Symbol.for("react.profiler"),JR=Symbol.for("react.provider"),e3=Symbol.for("react.context"),t3=Symbol.for("react.forward_ref"),n3=Symbol.for("react.suspense"),r3=Symbol.for("react.memo"),i3=Symbol.for("react.lazy"),e_=Symbol.iterator;function s3(t){return t===null||typeof t!="object"?null:(t=e_&&t[e_]||t["@@iterator"],typeof t=="function"?t:null)}var cI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uI=Object.assign,hI={};function Tu(t,e,n){this.props=t,this.context=e,this.refs=hI,this.updater=n||cI}Tu.prototype.isReactComponent={};Tu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Tu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dI(){}dI.prototype=Tu.prototype;function by(t,e,n){this.props=t,this.context=e,this.refs=hI,this.updater=n||cI}var Ry=by.prototype=new dI;Ry.constructor=by;uI(Ry,Tu.prototype);Ry.isPureReactComponent=!0;var t_=Array.isArray,fI=Object.prototype.hasOwnProperty,Ny={current:null},gI={key:!0,ref:!0,__self:!0,__source:!0};function mI(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)fI.call(e,r)&&!gI.hasOwnProperty(r)&&(i[r]=e[r]);var h=arguments.length-2;if(h===1)i.children=n;else if(1<h){for(var f=Array(h),m=0;m<h;m++)f[m]=arguments[m+2];i.children=f}if(t&&t.defaultProps)for(r in h=t.defaultProps,h)i[r]===void 0&&(i[r]=h[r]);return{$$typeof:kd,type:t,key:s,ref:l,props:i,_owner:Ny.current}}function o3(t,e){return{$$typeof:kd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Py(t){return typeof t=="object"&&t!==null&&t.$$typeof===kd}function a3(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var n_=/\/+/g;function Hg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?a3(""+t.key):e.toString(36)}function n0(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case kd:case QR:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+Hg(l,0):r,t_(i)?(n="",t!=null&&(n=t.replace(n_,"$&/")+"/"),n0(i,e,n,"",function(m){return m})):i!=null&&(Py(i)&&(i=o3(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(n_,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",t_(t))for(var h=0;h<t.length;h++){s=t[h];var f=r+Hg(s,h);l+=n0(s,e,n,f,i)}else if(f=s3(t),typeof f=="function")for(t=f.call(t),h=0;!(s=t.next()).done;)s=s.value,f=r+Hg(s,h++),l+=n0(s,e,n,f,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function Tf(t,e,n){if(t==null)return t;var r=[],i=0;return n0(t,r,"","",function(s){return e.call(n,s,i++)}),r}function l3(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Vr={current:null},r0={transition:null},c3={ReactCurrentDispatcher:Vr,ReactCurrentBatchConfig:r0,ReactCurrentOwner:Ny};function pI(){throw Error("act(...) is not supported in production builds of React.")}lt.Children={map:Tf,forEach:function(t,e,n){Tf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Tf(t,function(){e++}),e},toArray:function(t){return Tf(t,function(e){return e})||[]},only:function(t){if(!Py(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};lt.Component=Tu;lt.Fragment=XR;lt.Profiler=ZR;lt.PureComponent=by;lt.StrictMode=YR;lt.Suspense=n3;lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=c3;lt.act=pI;lt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=uI({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=Ny.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var h=t.type.defaultProps;for(f in e)fI.call(e,f)&&!gI.hasOwnProperty(f)&&(r[f]=e[f]===void 0&&h!==void 0?h[f]:e[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){h=Array(f);for(var m=0;m<f;m++)h[m]=arguments[m+2];r.children=h}return{$$typeof:kd,type:t.type,key:i,ref:s,props:r,_owner:l}};lt.createContext=function(t){return t={$$typeof:e3,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:JR,_context:t},t.Consumer=t};lt.createElement=mI;lt.createFactory=function(t){var e=mI.bind(null,t);return e.type=t,e};lt.createRef=function(){return{current:null}};lt.forwardRef=function(t){return{$$typeof:t3,render:t}};lt.isValidElement=Py;lt.lazy=function(t){return{$$typeof:i3,_payload:{_status:-1,_result:t},_init:l3}};lt.memo=function(t,e){return{$$typeof:r3,type:t,compare:e===void 0?null:e}};lt.startTransition=function(t){var e=r0.transition;r0.transition={};try{t()}finally{r0.transition=e}};lt.unstable_act=pI;lt.useCallback=function(t,e){return Vr.current.useCallback(t,e)};lt.useContext=function(t){return Vr.current.useContext(t)};lt.useDebugValue=function(){};lt.useDeferredValue=function(t){return Vr.current.useDeferredValue(t)};lt.useEffect=function(t,e){return Vr.current.useEffect(t,e)};lt.useId=function(){return Vr.current.useId()};lt.useImperativeHandle=function(t,e,n){return Vr.current.useImperativeHandle(t,e,n)};lt.useInsertionEffect=function(t,e){return Vr.current.useInsertionEffect(t,e)};lt.useLayoutEffect=function(t,e){return Vr.current.useLayoutEffect(t,e)};lt.useMemo=function(t,e){return Vr.current.useMemo(t,e)};lt.useReducer=function(t,e,n){return Vr.current.useReducer(t,e,n)};lt.useRef=function(t){return Vr.current.useRef(t)};lt.useState=function(t){return Vr.current.useState(t)};lt.useSyncExternalStore=function(t,e,n){return Vr.current.useSyncExternalStore(t,e,n)};lt.useTransition=function(){return Vr.current.useTransition()};lt.version="18.3.1";lI.exports=lt;var ne=lI.exports;const Ar=oI(ne),u3=sI({__proto__:null,default:Ar},[ne]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h3=ne,d3=Symbol.for("react.element"),f3=Symbol.for("react.fragment"),g3=Object.prototype.hasOwnProperty,m3=h3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p3={key:!0,ref:!0,__self:!0,__source:!0};function yI(t,e,n){var r,i={},s=null,l=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)g3.call(e,r)&&!p3.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:d3,type:t,key:s,ref:l,props:i,_owner:m3.current}}M1.Fragment=f3;M1.jsx=yI;M1.jsxs=yI;aI.exports=M1;var _=aI.exports,Um={},xI={exports:{}},mi={},wI={exports:{}},_I={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ie,Me){var je=Ie.length;Ie.push(Me);e:for(;0<je;){var Rt=je-1>>>1,Xe=Ie[Rt];if(0<i(Xe,Me))Ie[Rt]=Me,Ie[je]=Xe,je=Rt;else break e}}function n(Ie){return Ie.length===0?null:Ie[0]}function r(Ie){if(Ie.length===0)return null;var Me=Ie[0],je=Ie.pop();if(je!==Me){Ie[0]=je;e:for(var Rt=0,Xe=Ie.length,Tt=Xe>>>1;Rt<Tt;){var Bt=2*(Rt+1)-1,mr=Ie[Bt],ke=Bt+1,Xn=Ie[ke];if(0>i(mr,je))ke<Xe&&0>i(Xn,mr)?(Ie[Rt]=Xn,Ie[ke]=je,Rt=ke):(Ie[Rt]=mr,Ie[Bt]=je,Rt=Bt);else if(ke<Xe&&0>i(Xn,je))Ie[Rt]=Xn,Ie[ke]=je,Rt=ke;else break e}}return Me}function i(Ie,Me){var je=Ie.sortIndex-Me.sortIndex;return je!==0?je:Ie.id-Me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,h=l.now();t.unstable_now=function(){return l.now()-h}}var f=[],m=[],x=1,E=null,A=3,N=!1,U=!1,D=!1,G=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(Ie){for(var Me=n(m);Me!==null;){if(Me.callback===null)r(m);else if(Me.startTime<=Ie)r(m),Me.sortIndex=Me.expirationTime,e(f,Me);else break;Me=n(m)}}function V(Ie){if(D=!1,P(Ie),!U)if(n(f)!==null)U=!0,rt($);else{var Me=n(m);Me!==null&&Oe(V,Me.startTime-Ie)}}function $(Ie,Me){U=!1,D&&(D=!1,M(L),L=-1),N=!0;var je=A;try{for(P(Me),E=n(f);E!==null&&(!(E.expirationTime>Me)||Ie&&!K());){var Rt=E.callback;if(typeof Rt=="function"){E.callback=null,A=E.priorityLevel;var Xe=Rt(E.expirationTime<=Me);Me=t.unstable_now(),typeof Xe=="function"?E.callback=Xe:E===n(f)&&r(f),P(Me)}else r(f);E=n(f)}if(E!==null)var Tt=!0;else{var Bt=n(m);Bt!==null&&Oe(V,Bt.startTime-Me),Tt=!1}return Tt}finally{E=null,A=je,N=!1}}var J=!1,k=null,L=-1,F=5,H=-1;function K(){return!(t.unstable_now()-H<F)}function W(){if(k!==null){var Ie=t.unstable_now();H=Ie;var Me=!0;try{Me=k(!0,Ie)}finally{Me?z():(J=!1,k=null)}}else J=!1}var z;if(typeof b=="function")z=function(){b(W)};else if(typeof MessageChannel<"u"){var Ge=new MessageChannel,se=Ge.port2;Ge.port1.onmessage=W,z=function(){se.postMessage(null)}}else z=function(){G(W,0)};function rt(Ie){k=Ie,J||(J=!0,z())}function Oe(Ie,Me){L=G(function(){Ie(t.unstable_now())},Me)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ie){Ie.callback=null},t.unstable_continueExecution=function(){U||N||(U=!0,rt($))},t.unstable_forceFrameRate=function(Ie){0>Ie||125<Ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<Ie?Math.floor(1e3/Ie):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(Ie){switch(A){case 1:case 2:case 3:var Me=3;break;default:Me=A}var je=A;A=Me;try{return Ie()}finally{A=je}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ie,Me){switch(Ie){case 1:case 2:case 3:case 4:case 5:break;default:Ie=3}var je=A;A=Ie;try{return Me()}finally{A=je}},t.unstable_scheduleCallback=function(Ie,Me,je){var Rt=t.unstable_now();switch(typeof je=="object"&&je!==null?(je=je.delay,je=typeof je=="number"&&0<je?Rt+je:Rt):je=Rt,Ie){case 1:var Xe=-1;break;case 2:Xe=250;break;case 5:Xe=1073741823;break;case 4:Xe=1e4;break;default:Xe=5e3}return Xe=je+Xe,Ie={id:x++,callback:Me,priorityLevel:Ie,startTime:je,expirationTime:Xe,sortIndex:-1},je>Rt?(Ie.sortIndex=je,e(m,Ie),n(f)===null&&Ie===n(m)&&(D?(M(L),L=-1):D=!0,Oe(V,je-Rt))):(Ie.sortIndex=Xe,e(f,Ie),U||N||(U=!0,rt($))),Ie},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(Ie){var Me=A;return function(){var je=A;A=Me;try{return Ie.apply(this,arguments)}finally{A=je}}}})(_I);wI.exports=_I;var y3=wI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x3=ne,fi=y3;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var EI=new Set,Kh={};function Vl(t,e){Yc(t,e),Yc(t+"Capture",e)}function Yc(t,e){for(Kh[t]=e,t=0;t<e.length;t++)EI.add(e[t])}var so=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jm=Object.prototype.hasOwnProperty,w3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r_={},i_={};function _3(t){return jm.call(i_,t)?!0:jm.call(r_,t)?!1:w3.test(t)?i_[t]=!0:(r_[t]=!0,!1)}function E3(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function v3(t,e,n,r){if(e===null||typeof e>"u"||E3(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Br(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){fr[t]=new Br(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];fr[e]=new Br(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){fr[t]=new Br(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){fr[t]=new Br(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){fr[t]=new Br(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){fr[t]=new Br(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){fr[t]=new Br(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){fr[t]=new Br(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){fr[t]=new Br(t,5,!1,t.toLowerCase(),null,!1,!1)});var Dy=/[\-:]([a-z])/g;function ky(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Dy,ky);fr[e]=new Br(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Dy,ky);fr[e]=new Br(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Dy,ky);fr[e]=new Br(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){fr[t]=new Br(t,1,!1,t.toLowerCase(),null,!1,!1)});fr.xlinkHref=new Br("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){fr[t]=new Br(t,1,!1,t.toLowerCase(),null,!0,!0)});function Oy(t,e,n,r){var i=fr.hasOwnProperty(e)?fr[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(v3(e,n,i,r)&&(n=null),r||i===null?_3(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var yo=x3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cf=Symbol.for("react.element"),yc=Symbol.for("react.portal"),xc=Symbol.for("react.fragment"),My=Symbol.for("react.strict_mode"),zm=Symbol.for("react.profiler"),vI=Symbol.for("react.provider"),II=Symbol.for("react.context"),Ly=Symbol.for("react.forward_ref"),Gm=Symbol.for("react.suspense"),qm=Symbol.for("react.suspense_list"),Fy=Symbol.for("react.memo"),Mo=Symbol.for("react.lazy"),AI=Symbol.for("react.offscreen"),s_=Symbol.iterator;function ih(t){return t===null||typeof t!="object"?null:(t=s_&&t[s_]||t["@@iterator"],typeof t=="function"?t:null)}var mn=Object.assign,Wg;function xh(t){if(Wg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wg=e&&e[1]||""}return`
`+Wg+t}var Kg=!1;function $g(t,e){if(!t||Kg)return"";Kg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var r=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){r=m}t.call(e.prototype)}else{try{throw Error()}catch(m){r=m}t()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var i=m.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,h=s.length-1;1<=l&&0<=h&&i[l]!==s[h];)h--;for(;1<=l&&0<=h;l--,h--)if(i[l]!==s[h]){if(l!==1||h!==1)do if(l--,h--,0>h||i[l]!==s[h]){var f=`
`+i[l].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=l&&0<=h);break}}}finally{Kg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?xh(t):""}function I3(t){switch(t.tag){case 5:return xh(t.type);case 16:return xh("Lazy");case 13:return xh("Suspense");case 19:return xh("SuspenseList");case 0:case 2:case 15:return t=$g(t.type,!1),t;case 11:return t=$g(t.type.render,!1),t;case 1:return t=$g(t.type,!0),t;default:return""}}function Hm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xc:return"Fragment";case yc:return"Portal";case zm:return"Profiler";case My:return"StrictMode";case Gm:return"Suspense";case qm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case II:return(t.displayName||"Context")+".Consumer";case vI:return(t._context.displayName||"Context")+".Provider";case Ly:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fy:return e=t.displayName||null,e!==null?e:Hm(t.type)||"Memo";case Mo:e=t._payload,t=t._init;try{return Hm(t(e))}catch{}}return null}function A3(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hm(e);case 8:return e===My?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function TI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function T3(t){var e=TI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Sf(t){t._valueTracker||(t._valueTracker=T3(t))}function CI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=TI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function b0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wm(t,e){var n=e.checked;return mn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function o_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=pa(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function SI(t,e){e=e.checked,e!=null&&Oy(t,"checked",e,!1)}function Km(t,e){SI(t,e);var n=pa(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$m(t,e.type,n):e.hasOwnProperty("defaultValue")&&$m(t,e.type,pa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function a_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $m(t,e,n){(e!=="number"||b0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var wh=Array.isArray;function Pc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+pa(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Qm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return mn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function l_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ye(92));if(wh(n)){if(1<n.length)throw Error(ye(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:pa(n)}}function bI(t,e){var n=pa(e.value),r=pa(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function c_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function RI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?RI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bf,NI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bf=bf||document.createElement("div"),bf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $h(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C3=["Webkit","ms","Moz","O"];Object.keys(bh).forEach(function(t){C3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bh[e]=bh[t]})});function PI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||bh.hasOwnProperty(t)&&bh[t]?(""+e).trim():e+"px"}function DI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=PI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var S3=mn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ym(t,e){if(e){if(S3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function Zm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jm=null;function Vy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ep=null,Dc=null,kc=null;function u_(t){if(t=Ld(t)){if(typeof ep!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=U1(e),ep(t.stateNode,t.type,e))}}function kI(t){Dc?kc?kc.push(t):kc=[t]:Dc=t}function OI(){if(Dc){var t=Dc,e=kc;if(kc=Dc=null,u_(t),e)for(t=0;t<e.length;t++)u_(e[t])}}function MI(t,e){return t(e)}function LI(){}var Qg=!1;function FI(t,e,n){if(Qg)return t(e,n);Qg=!0;try{return MI(t,e,n)}finally{Qg=!1,(Dc!==null||kc!==null)&&(LI(),OI())}}function Qh(t,e){var n=t.stateNode;if(n===null)return null;var r=U1(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ye(231,e,typeof n));return n}var tp=!1;if(so)try{var sh={};Object.defineProperty(sh,"passive",{get:function(){tp=!0}}),window.addEventListener("test",sh,sh),window.removeEventListener("test",sh,sh)}catch{tp=!1}function b3(t,e,n,r,i,s,l,h,f){var m=Array.prototype.slice.call(arguments,3);try{e.apply(n,m)}catch(x){this.onError(x)}}var Rh=!1,R0=null,N0=!1,np=null,R3={onError:function(t){Rh=!0,R0=t}};function N3(t,e,n,r,i,s,l,h,f){Rh=!1,R0=null,b3.apply(R3,arguments)}function P3(t,e,n,r,i,s,l,h,f){if(N3.apply(this,arguments),Rh){if(Rh){var m=R0;Rh=!1,R0=null}else throw Error(ye(198));N0||(N0=!0,np=m)}}function Bl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function VI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function h_(t){if(Bl(t)!==t)throw Error(ye(188))}function D3(t){var e=t.alternate;if(!e){if(e=Bl(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return h_(i),t;if(s===r)return h_(i),e;s=s.sibling}throw Error(ye(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,h=i.child;h;){if(h===n){l=!0,n=i,r=s;break}if(h===r){l=!0,r=i,n=s;break}h=h.sibling}if(!l){for(h=s.child;h;){if(h===n){l=!0,n=s,r=i;break}if(h===r){l=!0,r=s,n=i;break}h=h.sibling}if(!l)throw Error(ye(189))}}if(n.alternate!==r)throw Error(ye(190))}if(n.tag!==3)throw Error(ye(188));return n.stateNode.current===n?t:e}function BI(t){return t=D3(t),t!==null?UI(t):null}function UI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=UI(t);if(e!==null)return e;t=t.sibling}return null}var jI=fi.unstable_scheduleCallback,d_=fi.unstable_cancelCallback,k3=fi.unstable_shouldYield,O3=fi.unstable_requestPaint,Rn=fi.unstable_now,M3=fi.unstable_getCurrentPriorityLevel,By=fi.unstable_ImmediatePriority,zI=fi.unstable_UserBlockingPriority,P0=fi.unstable_NormalPriority,L3=fi.unstable_LowPriority,GI=fi.unstable_IdlePriority,L1=null,vs=null;function F3(t){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(L1,t,void 0,(t.current.flags&128)===128)}catch{}}var Yi=Math.clz32?Math.clz32:U3,V3=Math.log,B3=Math.LN2;function U3(t){return t>>>=0,t===0?32:31-(V3(t)/B3|0)|0}var Rf=64,Nf=4194304;function _h(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function D0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var h=l&~i;h!==0?r=_h(h):(s&=l,s!==0&&(r=_h(s)))}else l=n&~i,l!==0?r=_h(l):s!==0&&(r=_h(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yi(e),i=1<<n,r|=t[n],e&=~i;return r}function j3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z3(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-Yi(s),h=1<<l,f=i[l];f===-1?(!(h&n)||h&r)&&(i[l]=j3(h,e)):f<=e&&(t.expiredLanes|=h),s&=~h}}function rp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function qI(){var t=Rf;return Rf<<=1,!(Rf&4194240)&&(Rf=64),t}function Xg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Od(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yi(e),t[e]=n}function G3(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Yi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Uy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var kt=0;function HI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WI,jy,KI,$I,QI,ip=!1,Pf=[],sa=null,oa=null,aa=null,Xh=new Map,Yh=new Map,Fo=[],q3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function f_(t,e){switch(t){case"focusin":case"focusout":sa=null;break;case"dragenter":case"dragleave":oa=null;break;case"mouseover":case"mouseout":aa=null;break;case"pointerover":case"pointerout":Xh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yh.delete(e.pointerId)}}function oh(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ld(e),e!==null&&jy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function H3(t,e,n,r,i){switch(e){case"focusin":return sa=oh(sa,t,e,n,r,i),!0;case"dragenter":return oa=oh(oa,t,e,n,r,i),!0;case"mouseover":return aa=oh(aa,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Xh.set(s,oh(Xh.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Yh.set(s,oh(Yh.get(s)||null,t,e,n,r,i)),!0}return!1}function XI(t){var e=sl(t.target);if(e!==null){var n=Bl(e);if(n!==null){if(e=n.tag,e===13){if(e=VI(n),e!==null){t.blockedOn=e,QI(t.priority,function(){KI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function i0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Jm=r,n.target.dispatchEvent(r),Jm=null}else return e=Ld(n),e!==null&&jy(e),t.blockedOn=n,!1;e.shift()}return!0}function g_(t,e,n){i0(t)&&n.delete(e)}function W3(){ip=!1,sa!==null&&i0(sa)&&(sa=null),oa!==null&&i0(oa)&&(oa=null),aa!==null&&i0(aa)&&(aa=null),Xh.forEach(g_),Yh.forEach(g_)}function ah(t,e){t.blockedOn===e&&(t.blockedOn=null,ip||(ip=!0,fi.unstable_scheduleCallback(fi.unstable_NormalPriority,W3)))}function Zh(t){function e(i){return ah(i,t)}if(0<Pf.length){ah(Pf[0],t);for(var n=1;n<Pf.length;n++){var r=Pf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(sa!==null&&ah(sa,t),oa!==null&&ah(oa,t),aa!==null&&ah(aa,t),Xh.forEach(e),Yh.forEach(e),n=0;n<Fo.length;n++)r=Fo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Fo.length&&(n=Fo[0],n.blockedOn===null);)XI(n),n.blockedOn===null&&Fo.shift()}var Oc=yo.ReactCurrentBatchConfig,k0=!0;function K3(t,e,n,r){var i=kt,s=Oc.transition;Oc.transition=null;try{kt=1,zy(t,e,n,r)}finally{kt=i,Oc.transition=s}}function $3(t,e,n,r){var i=kt,s=Oc.transition;Oc.transition=null;try{kt=4,zy(t,e,n,r)}finally{kt=i,Oc.transition=s}}function zy(t,e,n,r){if(k0){var i=sp(t,e,n,r);if(i===null)om(t,e,r,O0,n),f_(t,r);else if(H3(i,t,e,n,r))r.stopPropagation();else if(f_(t,r),e&4&&-1<q3.indexOf(t)){for(;i!==null;){var s=Ld(i);if(s!==null&&WI(s),s=sp(t,e,n,r),s===null&&om(t,e,r,O0,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else om(t,e,r,null,n)}}var O0=null;function sp(t,e,n,r){if(O0=null,t=Vy(r),t=sl(t),t!==null)if(e=Bl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=VI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return O0=t,null}function YI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(M3()){case By:return 1;case zI:return 4;case P0:case L3:return 16;case GI:return 536870912;default:return 16}default:return 16}}var ea=null,Gy=null,s0=null;function ZI(){if(s0)return s0;var t,e=Gy,n=e.length,r,i="value"in ea?ea.value:ea.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return s0=i.slice(t,1<r?1-r:void 0)}function o0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Df(){return!0}function m_(){return!1}function pi(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var h in t)t.hasOwnProperty(h)&&(n=t[h],this[h]=n?n(s):s[h]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Df:m_,this.isPropagationStopped=m_,this}return mn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Df)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Df)},persist:function(){},isPersistent:Df}),e}var Cu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qy=pi(Cu),Md=mn({},Cu,{view:0,detail:0}),Q3=pi(Md),Yg,Zg,lh,F1=mn({},Md,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==lh&&(lh&&t.type==="mousemove"?(Yg=t.screenX-lh.screenX,Zg=t.screenY-lh.screenY):Zg=Yg=0,lh=t),Yg)},movementY:function(t){return"movementY"in t?t.movementY:Zg}}),p_=pi(F1),X3=mn({},F1,{dataTransfer:0}),Y3=pi(X3),Z3=mn({},Md,{relatedTarget:0}),Jg=pi(Z3),J3=mn({},Cu,{animationName:0,elapsedTime:0,pseudoElement:0}),eN=pi(J3),tN=mn({},Cu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nN=pi(tN),rN=mn({},Cu,{data:0}),y_=pi(rN),iN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oN[t])?!!e[t]:!1}function Hy(){return aN}var lN=mn({},Md,{key:function(t){if(t.key){var e=iN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=o0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?sN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hy,charCode:function(t){return t.type==="keypress"?o0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?o0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cN=pi(lN),uN=mn({},F1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x_=pi(uN),hN=mn({},Md,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hy}),dN=pi(hN),fN=mn({},Cu,{propertyName:0,elapsedTime:0,pseudoElement:0}),gN=pi(fN),mN=mn({},F1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),pN=pi(mN),yN=[9,13,27,32],Wy=so&&"CompositionEvent"in window,Nh=null;so&&"documentMode"in document&&(Nh=document.documentMode);var xN=so&&"TextEvent"in window&&!Nh,JI=so&&(!Wy||Nh&&8<Nh&&11>=Nh),w_=String.fromCharCode(32),__=!1;function eA(t,e){switch(t){case"keyup":return yN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var wc=!1;function wN(t,e){switch(t){case"compositionend":return tA(e);case"keypress":return e.which!==32?null:(__=!0,w_);case"textInput":return t=e.data,t===w_&&__?null:t;default:return null}}function _N(t,e){if(wc)return t==="compositionend"||!Wy&&eA(t,e)?(t=ZI(),s0=Gy=ea=null,wc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return JI&&e.locale!=="ko"?null:e.data;default:return null}}var EN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function E_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!EN[t.type]:e==="textarea"}function nA(t,e,n,r){kI(r),e=M0(e,"onChange"),0<e.length&&(n=new qy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ph=null,Jh=null;function vN(t){fA(t,0)}function V1(t){var e=vc(t);if(CI(e))return t}function IN(t,e){if(t==="change")return e}var rA=!1;if(so){var em;if(so){var tm="oninput"in document;if(!tm){var v_=document.createElement("div");v_.setAttribute("oninput","return;"),tm=typeof v_.oninput=="function"}em=tm}else em=!1;rA=em&&(!document.documentMode||9<document.documentMode)}function I_(){Ph&&(Ph.detachEvent("onpropertychange",iA),Jh=Ph=null)}function iA(t){if(t.propertyName==="value"&&V1(Jh)){var e=[];nA(e,Jh,t,Vy(t)),FI(vN,e)}}function AN(t,e,n){t==="focusin"?(I_(),Ph=e,Jh=n,Ph.attachEvent("onpropertychange",iA)):t==="focusout"&&I_()}function TN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return V1(Jh)}function CN(t,e){if(t==="click")return V1(e)}function SN(t,e){if(t==="input"||t==="change")return V1(e)}function bN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ji=typeof Object.is=="function"?Object.is:bN;function ed(t,e){if(Ji(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jm.call(e,i)||!Ji(t[i],e[i]))return!1}return!0}function A_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function T_(t,e){var n=A_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=A_(n)}}function sA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function oA(){for(var t=window,e=b0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=b0(t.document)}return e}function Ky(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function RN(t){var e=oA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&sA(n.ownerDocument.documentElement,n)){if(r!==null&&Ky(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=T_(n,s);var l=T_(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var NN=so&&"documentMode"in document&&11>=document.documentMode,_c=null,op=null,Dh=null,ap=!1;function C_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ap||_c==null||_c!==b0(r)||(r=_c,"selectionStart"in r&&Ky(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Dh&&ed(Dh,r)||(Dh=r,r=M0(op,"onSelect"),0<r.length&&(e=new qy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_c)))}function kf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ec={animationend:kf("Animation","AnimationEnd"),animationiteration:kf("Animation","AnimationIteration"),animationstart:kf("Animation","AnimationStart"),transitionend:kf("Transition","TransitionEnd")},nm={},aA={};so&&(aA=document.createElement("div").style,"AnimationEvent"in window||(delete Ec.animationend.animation,delete Ec.animationiteration.animation,delete Ec.animationstart.animation),"TransitionEvent"in window||delete Ec.transitionend.transition);function B1(t){if(nm[t])return nm[t];if(!Ec[t])return t;var e=Ec[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in aA)return nm[t]=e[n];return t}var lA=B1("animationend"),cA=B1("animationiteration"),uA=B1("animationstart"),hA=B1("transitionend"),dA=new Map,S_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sa(t,e){dA.set(t,e),Vl(e,[t])}for(var rm=0;rm<S_.length;rm++){var im=S_[rm],PN=im.toLowerCase(),DN=im[0].toUpperCase()+im.slice(1);Sa(PN,"on"+DN)}Sa(lA,"onAnimationEnd");Sa(cA,"onAnimationIteration");Sa(uA,"onAnimationStart");Sa("dblclick","onDoubleClick");Sa("focusin","onFocus");Sa("focusout","onBlur");Sa(hA,"onTransitionEnd");Yc("onMouseEnter",["mouseout","mouseover"]);Yc("onMouseLeave",["mouseout","mouseover"]);Yc("onPointerEnter",["pointerout","pointerover"]);Yc("onPointerLeave",["pointerout","pointerover"]);Vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Eh));function b_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,P3(r,e,void 0,t),t.currentTarget=null}function fA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var h=r[l],f=h.instance,m=h.currentTarget;if(h=h.listener,f!==s&&i.isPropagationStopped())break e;b_(i,h,m),s=f}else for(l=0;l<r.length;l++){if(h=r[l],f=h.instance,m=h.currentTarget,h=h.listener,f!==s&&i.isPropagationStopped())break e;b_(i,h,m),s=f}}}if(N0)throw t=np,N0=!1,np=null,t}function Yt(t,e){var n=e[dp];n===void 0&&(n=e[dp]=new Set);var r=t+"__bubble";n.has(r)||(gA(e,t,2,!1),n.add(r))}function sm(t,e,n){var r=0;e&&(r|=4),gA(n,t,r,e)}var Of="_reactListening"+Math.random().toString(36).slice(2);function td(t){if(!t[Of]){t[Of]=!0,EI.forEach(function(n){n!=="selectionchange"&&(kN.has(n)||sm(n,!1,t),sm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Of]||(e[Of]=!0,sm("selectionchange",!1,e))}}function gA(t,e,n,r){switch(YI(e)){case 1:var i=K3;break;case 4:i=$3;break;default:i=zy}n=i.bind(null,e,n,t),i=void 0,!tp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function om(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var h=r.stateNode.containerInfo;if(h===i||h.nodeType===8&&h.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var f=l.tag;if((f===3||f===4)&&(f=l.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;l=l.return}for(;h!==null;){if(l=sl(h),l===null)return;if(f=l.tag,f===5||f===6){r=s=l;continue e}h=h.parentNode}}r=r.return}FI(function(){var m=s,x=Vy(n),E=[];e:{var A=dA.get(t);if(A!==void 0){var N=qy,U=t;switch(t){case"keypress":if(o0(n)===0)break e;case"keydown":case"keyup":N=cN;break;case"focusin":U="focus",N=Jg;break;case"focusout":U="blur",N=Jg;break;case"beforeblur":case"afterblur":N=Jg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=p_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=Y3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=dN;break;case lA:case cA:case uA:N=eN;break;case hA:N=gN;break;case"scroll":N=Q3;break;case"wheel":N=pN;break;case"copy":case"cut":case"paste":N=nN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=x_}var D=(e&4)!==0,G=!D&&t==="scroll",M=D?A!==null?A+"Capture":null:A;D=[];for(var b=m,P;b!==null;){P=b;var V=P.stateNode;if(P.tag===5&&V!==null&&(P=V,M!==null&&(V=Qh(b,M),V!=null&&D.push(nd(b,V,P)))),G)break;b=b.return}0<D.length&&(A=new N(A,U,null,n,x),E.push({event:A,listeners:D}))}}if(!(e&7)){e:{if(A=t==="mouseover"||t==="pointerover",N=t==="mouseout"||t==="pointerout",A&&n!==Jm&&(U=n.relatedTarget||n.fromElement)&&(sl(U)||U[oo]))break e;if((N||A)&&(A=x.window===x?x:(A=x.ownerDocument)?A.defaultView||A.parentWindow:window,N?(U=n.relatedTarget||n.toElement,N=m,U=U?sl(U):null,U!==null&&(G=Bl(U),U!==G||U.tag!==5&&U.tag!==6)&&(U=null)):(N=null,U=m),N!==U)){if(D=p_,V="onMouseLeave",M="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(D=x_,V="onPointerLeave",M="onPointerEnter",b="pointer"),G=N==null?A:vc(N),P=U==null?A:vc(U),A=new D(V,b+"leave",N,n,x),A.target=G,A.relatedTarget=P,V=null,sl(x)===m&&(D=new D(M,b+"enter",U,n,x),D.target=P,D.relatedTarget=G,V=D),G=V,N&&U)t:{for(D=N,M=U,b=0,P=D;P;P=oc(P))b++;for(P=0,V=M;V;V=oc(V))P++;for(;0<b-P;)D=oc(D),b--;for(;0<P-b;)M=oc(M),P--;for(;b--;){if(D===M||M!==null&&D===M.alternate)break t;D=oc(D),M=oc(M)}D=null}else D=null;N!==null&&R_(E,A,N,D,!1),U!==null&&G!==null&&R_(E,G,U,D,!0)}}e:{if(A=m?vc(m):window,N=A.nodeName&&A.nodeName.toLowerCase(),N==="select"||N==="input"&&A.type==="file")var $=IN;else if(E_(A))if(rA)$=SN;else{$=TN;var J=AN}else(N=A.nodeName)&&N.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&($=CN);if($&&($=$(t,m))){nA(E,$,n,x);break e}J&&J(t,A,m),t==="focusout"&&(J=A._wrapperState)&&J.controlled&&A.type==="number"&&$m(A,"number",A.value)}switch(J=m?vc(m):window,t){case"focusin":(E_(J)||J.contentEditable==="true")&&(_c=J,op=m,Dh=null);break;case"focusout":Dh=op=_c=null;break;case"mousedown":ap=!0;break;case"contextmenu":case"mouseup":case"dragend":ap=!1,C_(E,n,x);break;case"selectionchange":if(NN)break;case"keydown":case"keyup":C_(E,n,x)}var k;if(Wy)e:{switch(t){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else wc?eA(t,n)&&(L="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(L="onCompositionStart");L&&(JI&&n.locale!=="ko"&&(wc||L!=="onCompositionStart"?L==="onCompositionEnd"&&wc&&(k=ZI()):(ea=x,Gy="value"in ea?ea.value:ea.textContent,wc=!0)),J=M0(m,L),0<J.length&&(L=new y_(L,t,null,n,x),E.push({event:L,listeners:J}),k?L.data=k:(k=tA(n),k!==null&&(L.data=k)))),(k=xN?wN(t,n):_N(t,n))&&(m=M0(m,"onBeforeInput"),0<m.length&&(x=new y_("onBeforeInput","beforeinput",null,n,x),E.push({event:x,listeners:m}),x.data=k))}fA(E,e)})}function nd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function M0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Qh(t,n),s!=null&&r.unshift(nd(t,s,i)),s=Qh(t,e),s!=null&&r.push(nd(t,s,i))),t=t.return}return r}function oc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function R_(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var h=n,f=h.alternate,m=h.stateNode;if(f!==null&&f===r)break;h.tag===5&&m!==null&&(h=m,i?(f=Qh(n,s),f!=null&&l.unshift(nd(n,f,h))):i||(f=Qh(n,s),f!=null&&l.push(nd(n,f,h)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var ON=/\r\n?/g,MN=/\u0000|\uFFFD/g;function N_(t){return(typeof t=="string"?t:""+t).replace(ON,`
`).replace(MN,"")}function Mf(t,e,n){if(e=N_(e),N_(t)!==e&&n)throw Error(ye(425))}function L0(){}var lp=null,cp=null;function up(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hp=typeof setTimeout=="function"?setTimeout:void 0,LN=typeof clearTimeout=="function"?clearTimeout:void 0,P_=typeof Promise=="function"?Promise:void 0,FN=typeof queueMicrotask=="function"?queueMicrotask:typeof P_<"u"?function(t){return P_.resolve(null).then(t).catch(VN)}:hp;function VN(t){setTimeout(function(){throw t})}function am(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Zh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Zh(e)}function la(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function D_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Su=Math.random().toString(36).slice(2),xs="__reactFiber$"+Su,rd="__reactProps$"+Su,oo="__reactContainer$"+Su,dp="__reactEvents$"+Su,BN="__reactListeners$"+Su,UN="__reactHandles$"+Su;function sl(t){var e=t[xs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[oo]||n[xs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=D_(t);t!==null;){if(n=t[xs])return n;t=D_(t)}return e}t=n,n=t.parentNode}return null}function Ld(t){return t=t[xs]||t[oo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function U1(t){return t[rd]||null}var fp=[],Ic=-1;function ba(t){return{current:t}}function en(t){0>Ic||(t.current=fp[Ic],fp[Ic]=null,Ic--)}function $t(t,e){Ic++,fp[Ic]=t.current,t.current=e}var ya={},Rr=ba(ya),Jr=ba(!1),_l=ya;function Zc(t,e){var n=t.type.contextTypes;if(!n)return ya;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ei(t){return t=t.childContextTypes,t!=null}function F0(){en(Jr),en(Rr)}function k_(t,e,n){if(Rr.current!==ya)throw Error(ye(168));$t(Rr,e),$t(Jr,n)}function mA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ye(108,A3(t)||"Unknown",i));return mn({},n,r)}function V0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ya,_l=Rr.current,$t(Rr,t),$t(Jr,Jr.current),!0}function O_(t,e,n){var r=t.stateNode;if(!r)throw Error(ye(169));n?(t=mA(t,e,_l),r.__reactInternalMemoizedMergedChildContext=t,en(Jr),en(Rr),$t(Rr,t)):en(Jr),$t(Jr,n)}var Xs=null,j1=!1,lm=!1;function pA(t){Xs===null?Xs=[t]:Xs.push(t)}function jN(t){j1=!0,pA(t)}function Ra(){if(!lm&&Xs!==null){lm=!0;var t=0,e=kt;try{var n=Xs;for(kt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Xs=null,j1=!1}catch(i){throw Xs!==null&&(Xs=Xs.slice(t+1)),jI(By,Ra),i}finally{kt=e,lm=!1}}return null}var Ac=[],Tc=0,B0=null,U0=0,Ei=[],vi=0,El=null,Zs=1,Js="";function Ya(t,e){Ac[Tc++]=U0,Ac[Tc++]=B0,B0=t,U0=e}function yA(t,e,n){Ei[vi++]=Zs,Ei[vi++]=Js,Ei[vi++]=El,El=t;var r=Zs;t=Js;var i=32-Yi(r)-1;r&=~(1<<i),n+=1;var s=32-Yi(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Zs=1<<32-Yi(e)+i|n<<i|r,Js=s+t}else Zs=1<<s|n<<i|r,Js=t}function $y(t){t.return!==null&&(Ya(t,1),yA(t,1,0))}function Qy(t){for(;t===B0;)B0=Ac[--Tc],Ac[Tc]=null,U0=Ac[--Tc],Ac[Tc]=null;for(;t===El;)El=Ei[--vi],Ei[vi]=null,Js=Ei[--vi],Ei[vi]=null,Zs=Ei[--vi],Ei[vi]=null}var di=null,hi=null,sn=!1,Wi=null;function xA(t,e){var n=Ii(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function M_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,di=t,hi=la(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,di=t,hi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=El!==null?{id:Zs,overflow:Js}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ii(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,di=t,hi=null,!0):!1;default:return!1}}function gp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mp(t){if(sn){var e=hi;if(e){var n=e;if(!M_(t,e)){if(gp(t))throw Error(ye(418));e=la(n.nextSibling);var r=di;e&&M_(t,e)?xA(r,n):(t.flags=t.flags&-4097|2,sn=!1,di=t)}}else{if(gp(t))throw Error(ye(418));t.flags=t.flags&-4097|2,sn=!1,di=t}}}function L_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;di=t}function Lf(t){if(t!==di)return!1;if(!sn)return L_(t),sn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!up(t.type,t.memoizedProps)),e&&(e=hi)){if(gp(t))throw wA(),Error(ye(418));for(;e;)xA(t,e),e=la(e.nextSibling)}if(L_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hi=la(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hi=null}}else hi=di?la(t.stateNode.nextSibling):null;return!0}function wA(){for(var t=hi;t;)t=la(t.nextSibling)}function Jc(){hi=di=null,sn=!1}function Xy(t){Wi===null?Wi=[t]:Wi.push(t)}var zN=yo.ReactCurrentBatchConfig;function ch(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ye(309));var r=n.stateNode}if(!r)throw Error(ye(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var h=i.refs;l===null?delete h[s]:h[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(ye(284));if(!n._owner)throw Error(ye(290,t))}return t}function Ff(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function F_(t){var e=t._init;return e(t._payload)}function _A(t){function e(M,b){if(t){var P=M.deletions;P===null?(M.deletions=[b],M.flags|=16):P.push(b)}}function n(M,b){if(!t)return null;for(;b!==null;)e(M,b),b=b.sibling;return null}function r(M,b){for(M=new Map;b!==null;)b.key!==null?M.set(b.key,b):M.set(b.index,b),b=b.sibling;return M}function i(M,b){return M=da(M,b),M.index=0,M.sibling=null,M}function s(M,b,P){return M.index=P,t?(P=M.alternate,P!==null?(P=P.index,P<b?(M.flags|=2,b):P):(M.flags|=2,b)):(M.flags|=1048576,b)}function l(M){return t&&M.alternate===null&&(M.flags|=2),M}function h(M,b,P,V){return b===null||b.tag!==6?(b=mm(P,M.mode,V),b.return=M,b):(b=i(b,P),b.return=M,b)}function f(M,b,P,V){var $=P.type;return $===xc?x(M,b,P.props.children,V,P.key):b!==null&&(b.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Mo&&F_($)===b.type)?(V=i(b,P.props),V.ref=ch(M,b,P),V.return=M,V):(V=f0(P.type,P.key,P.props,null,M.mode,V),V.ref=ch(M,b,P),V.return=M,V)}function m(M,b,P,V){return b===null||b.tag!==4||b.stateNode.containerInfo!==P.containerInfo||b.stateNode.implementation!==P.implementation?(b=pm(P,M.mode,V),b.return=M,b):(b=i(b,P.children||[]),b.return=M,b)}function x(M,b,P,V,$){return b===null||b.tag!==7?(b=yl(P,M.mode,V,$),b.return=M,b):(b=i(b,P),b.return=M,b)}function E(M,b,P){if(typeof b=="string"&&b!==""||typeof b=="number")return b=mm(""+b,M.mode,P),b.return=M,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Cf:return P=f0(b.type,b.key,b.props,null,M.mode,P),P.ref=ch(M,null,b),P.return=M,P;case yc:return b=pm(b,M.mode,P),b.return=M,b;case Mo:var V=b._init;return E(M,V(b._payload),P)}if(wh(b)||ih(b))return b=yl(b,M.mode,P,null),b.return=M,b;Ff(M,b)}return null}function A(M,b,P,V){var $=b!==null?b.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return $!==null?null:h(M,b,""+P,V);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Cf:return P.key===$?f(M,b,P,V):null;case yc:return P.key===$?m(M,b,P,V):null;case Mo:return $=P._init,A(M,b,$(P._payload),V)}if(wh(P)||ih(P))return $!==null?null:x(M,b,P,V,null);Ff(M,P)}return null}function N(M,b,P,V,$){if(typeof V=="string"&&V!==""||typeof V=="number")return M=M.get(P)||null,h(b,M,""+V,$);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Cf:return M=M.get(V.key===null?P:V.key)||null,f(b,M,V,$);case yc:return M=M.get(V.key===null?P:V.key)||null,m(b,M,V,$);case Mo:var J=V._init;return N(M,b,P,J(V._payload),$)}if(wh(V)||ih(V))return M=M.get(P)||null,x(b,M,V,$,null);Ff(b,V)}return null}function U(M,b,P,V){for(var $=null,J=null,k=b,L=b=0,F=null;k!==null&&L<P.length;L++){k.index>L?(F=k,k=null):F=k.sibling;var H=A(M,k,P[L],V);if(H===null){k===null&&(k=F);break}t&&k&&H.alternate===null&&e(M,k),b=s(H,b,L),J===null?$=H:J.sibling=H,J=H,k=F}if(L===P.length)return n(M,k),sn&&Ya(M,L),$;if(k===null){for(;L<P.length;L++)k=E(M,P[L],V),k!==null&&(b=s(k,b,L),J===null?$=k:J.sibling=k,J=k);return sn&&Ya(M,L),$}for(k=r(M,k);L<P.length;L++)F=N(k,M,L,P[L],V),F!==null&&(t&&F.alternate!==null&&k.delete(F.key===null?L:F.key),b=s(F,b,L),J===null?$=F:J.sibling=F,J=F);return t&&k.forEach(function(K){return e(M,K)}),sn&&Ya(M,L),$}function D(M,b,P,V){var $=ih(P);if(typeof $!="function")throw Error(ye(150));if(P=$.call(P),P==null)throw Error(ye(151));for(var J=$=null,k=b,L=b=0,F=null,H=P.next();k!==null&&!H.done;L++,H=P.next()){k.index>L?(F=k,k=null):F=k.sibling;var K=A(M,k,H.value,V);if(K===null){k===null&&(k=F);break}t&&k&&K.alternate===null&&e(M,k),b=s(K,b,L),J===null?$=K:J.sibling=K,J=K,k=F}if(H.done)return n(M,k),sn&&Ya(M,L),$;if(k===null){for(;!H.done;L++,H=P.next())H=E(M,H.value,V),H!==null&&(b=s(H,b,L),J===null?$=H:J.sibling=H,J=H);return sn&&Ya(M,L),$}for(k=r(M,k);!H.done;L++,H=P.next())H=N(k,M,L,H.value,V),H!==null&&(t&&H.alternate!==null&&k.delete(H.key===null?L:H.key),b=s(H,b,L),J===null?$=H:J.sibling=H,J=H);return t&&k.forEach(function(W){return e(M,W)}),sn&&Ya(M,L),$}function G(M,b,P,V){if(typeof P=="object"&&P!==null&&P.type===xc&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case Cf:e:{for(var $=P.key,J=b;J!==null;){if(J.key===$){if($=P.type,$===xc){if(J.tag===7){n(M,J.sibling),b=i(J,P.props.children),b.return=M,M=b;break e}}else if(J.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Mo&&F_($)===J.type){n(M,J.sibling),b=i(J,P.props),b.ref=ch(M,J,P),b.return=M,M=b;break e}n(M,J);break}else e(M,J);J=J.sibling}P.type===xc?(b=yl(P.props.children,M.mode,V,P.key),b.return=M,M=b):(V=f0(P.type,P.key,P.props,null,M.mode,V),V.ref=ch(M,b,P),V.return=M,M=V)}return l(M);case yc:e:{for(J=P.key;b!==null;){if(b.key===J)if(b.tag===4&&b.stateNode.containerInfo===P.containerInfo&&b.stateNode.implementation===P.implementation){n(M,b.sibling),b=i(b,P.children||[]),b.return=M,M=b;break e}else{n(M,b);break}else e(M,b);b=b.sibling}b=pm(P,M.mode,V),b.return=M,M=b}return l(M);case Mo:return J=P._init,G(M,b,J(P._payload),V)}if(wh(P))return U(M,b,P,V);if(ih(P))return D(M,b,P,V);Ff(M,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,b!==null&&b.tag===6?(n(M,b.sibling),b=i(b,P),b.return=M,M=b):(n(M,b),b=mm(P,M.mode,V),b.return=M,M=b),l(M)):n(M,b)}return G}var eu=_A(!0),EA=_A(!1),j0=ba(null),z0=null,Cc=null,Yy=null;function Zy(){Yy=Cc=z0=null}function Jy(t){var e=j0.current;en(j0),t._currentValue=e}function pp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Mc(t,e){z0=t,Yy=Cc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qr=!0),t.firstContext=null)}function Ci(t){var e=t._currentValue;if(Yy!==t)if(t={context:t,memoizedValue:e,next:null},Cc===null){if(z0===null)throw Error(ye(308));Cc=t,z0.dependencies={lanes:0,firstContext:t}}else Cc=Cc.next=t;return e}var ol=null;function ex(t){ol===null?ol=[t]:ol.push(t)}function vA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,ex(e)):(n.next=i.next,i.next=n),e.interleaved=n,ao(t,r)}function ao(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Lo=!1;function tx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function io(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ca(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,At&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ao(t,n)}return i=r.interleaved,i===null?(e.next=e,ex(r)):(e.next=i.next,i.next=e),r.interleaved=e,ao(t,n)}function a0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Uy(t,n)}}function V_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function G0(t,e,n,r){var i=t.updateQueue;Lo=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,h=i.shared.pending;if(h!==null){i.shared.pending=null;var f=h,m=f.next;f.next=null,l===null?s=m:l.next=m,l=f;var x=t.alternate;x!==null&&(x=x.updateQueue,h=x.lastBaseUpdate,h!==l&&(h===null?x.firstBaseUpdate=m:h.next=m,x.lastBaseUpdate=f))}if(s!==null){var E=i.baseState;l=0,x=m=f=null,h=s;do{var A=h.lane,N=h.eventTime;if((r&A)===A){x!==null&&(x=x.next={eventTime:N,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var U=t,D=h;switch(A=e,N=n,D.tag){case 1:if(U=D.payload,typeof U=="function"){E=U.call(N,E,A);break e}E=U;break e;case 3:U.flags=U.flags&-65537|128;case 0:if(U=D.payload,A=typeof U=="function"?U.call(N,E,A):U,A==null)break e;E=mn({},E,A);break e;case 2:Lo=!0}}h.callback!==null&&h.lane!==0&&(t.flags|=64,A=i.effects,A===null?i.effects=[h]:A.push(h))}else N={eventTime:N,lane:A,tag:h.tag,payload:h.payload,callback:h.callback,next:null},x===null?(m=x=N,f=E):x=x.next=N,l|=A;if(h=h.next,h===null){if(h=i.shared.pending,h===null)break;A=h,h=A.next,A.next=null,i.lastBaseUpdate=A,i.shared.pending=null}}while(1);if(x===null&&(f=E),i.baseState=f,i.firstBaseUpdate=m,i.lastBaseUpdate=x,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Il|=l,t.lanes=l,t.memoizedState=E}}function B_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ye(191,i));i.call(r)}}}var Fd={},Is=ba(Fd),id=ba(Fd),sd=ba(Fd);function al(t){if(t===Fd)throw Error(ye(174));return t}function nx(t,e){switch($t(sd,e),$t(id,t),$t(Is,Fd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xm(e,t)}en(Is),$t(Is,e)}function tu(){en(Is),en(id),en(sd)}function AA(t){al(sd.current);var e=al(Is.current),n=Xm(e,t.type);e!==n&&($t(id,t),$t(Is,n))}function rx(t){id.current===t&&(en(Is),en(id))}var hn=ba(0);function q0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cm=[];function ix(){for(var t=0;t<cm.length;t++)cm[t]._workInProgressVersionPrimary=null;cm.length=0}var l0=yo.ReactCurrentDispatcher,um=yo.ReactCurrentBatchConfig,vl=0,fn=null,Hn=null,er=null,H0=!1,kh=!1,od=0,GN=0;function wr(){throw Error(ye(321))}function sx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ji(t[n],e[n]))return!1;return!0}function ox(t,e,n,r,i,s){if(vl=s,fn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,l0.current=t===null||t.memoizedState===null?KN:$N,t=n(r,i),kh){s=0;do{if(kh=!1,od=0,25<=s)throw Error(ye(301));s+=1,er=Hn=null,e.updateQueue=null,l0.current=QN,t=n(r,i)}while(kh)}if(l0.current=W0,e=Hn!==null&&Hn.next!==null,vl=0,er=Hn=fn=null,H0=!1,e)throw Error(ye(300));return t}function ax(){var t=od!==0;return od=0,t}function fs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return er===null?fn.memoizedState=er=t:er=er.next=t,er}function Si(){if(Hn===null){var t=fn.alternate;t=t!==null?t.memoizedState:null}else t=Hn.next;var e=er===null?fn.memoizedState:er.next;if(e!==null)er=e,Hn=t;else{if(t===null)throw Error(ye(310));Hn=t,t={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},er===null?fn.memoizedState=er=t:er=er.next=t}return er}function ad(t,e){return typeof e=="function"?e(t):e}function hm(t){var e=Si(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=Hn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var h=l=null,f=null,m=s;do{var x=m.lane;if((vl&x)===x)f!==null&&(f=f.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:t(r,m.action);else{var E={lane:x,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};f===null?(h=f=E,l=r):f=f.next=E,fn.lanes|=x,Il|=x}m=m.next}while(m!==null&&m!==s);f===null?l=r:f.next=h,Ji(r,e.memoizedState)||(Qr=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=f,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,fn.lanes|=s,Il|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function dm(t){var e=Si(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);Ji(s,e.memoizedState)||(Qr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function TA(){}function CA(t,e){var n=fn,r=Si(),i=e(),s=!Ji(r.memoizedState,i);if(s&&(r.memoizedState=i,Qr=!0),r=r.queue,lx(RA.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||er!==null&&er.memoizedState.tag&1){if(n.flags|=2048,ld(9,bA.bind(null,n,r,i,e),void 0,null),nr===null)throw Error(ye(349));vl&30||SA(n,e,i)}return i}function SA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=fn.updateQueue,e===null?(e={lastEffect:null,stores:null},fn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bA(t,e,n,r){e.value=n,e.getSnapshot=r,NA(e)&&PA(t)}function RA(t,e,n){return n(function(){NA(e)&&PA(t)})}function NA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ji(t,n)}catch{return!0}}function PA(t){var e=ao(t,1);e!==null&&Zi(e,t,1,-1)}function U_(t){var e=fs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:t},e.queue=t,t=t.dispatch=WN.bind(null,fn,t),[e.memoizedState,t]}function ld(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=fn.updateQueue,e===null?(e={lastEffect:null,stores:null},fn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function DA(){return Si().memoizedState}function c0(t,e,n,r){var i=fs();fn.flags|=t,i.memoizedState=ld(1|e,n,void 0,r===void 0?null:r)}function z1(t,e,n,r){var i=Si();r=r===void 0?null:r;var s=void 0;if(Hn!==null){var l=Hn.memoizedState;if(s=l.destroy,r!==null&&sx(r,l.deps)){i.memoizedState=ld(e,n,s,r);return}}fn.flags|=t,i.memoizedState=ld(1|e,n,s,r)}function j_(t,e){return c0(8390656,8,t,e)}function lx(t,e){return z1(2048,8,t,e)}function kA(t,e){return z1(4,2,t,e)}function OA(t,e){return z1(4,4,t,e)}function MA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function LA(t,e,n){return n=n!=null?n.concat([t]):null,z1(4,4,MA.bind(null,e,t),n)}function cx(){}function FA(t,e){var n=Si();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&sx(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function VA(t,e){var n=Si();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&sx(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function BA(t,e,n){return vl&21?(Ji(n,e)||(n=qI(),fn.lanes|=n,Il|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qr=!0),t.memoizedState=n)}function qN(t,e){var n=kt;kt=n!==0&&4>n?n:4,t(!0);var r=um.transition;um.transition={};try{t(!1),e()}finally{kt=n,um.transition=r}}function UA(){return Si().memoizedState}function HN(t,e,n){var r=ha(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},jA(t))zA(e,n);else if(n=vA(t,e,n,r),n!==null){var i=Fr();Zi(n,t,r,i),GA(n,e,r)}}function WN(t,e,n){var r=ha(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(jA(t))zA(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,h=s(l,n);if(i.hasEagerState=!0,i.eagerState=h,Ji(h,l)){var f=e.interleaved;f===null?(i.next=i,ex(e)):(i.next=f.next,f.next=i),e.interleaved=i;return}}catch{}finally{}n=vA(t,e,i,r),n!==null&&(i=Fr(),Zi(n,t,r,i),GA(n,e,r))}}function jA(t){var e=t.alternate;return t===fn||e!==null&&e===fn}function zA(t,e){kh=H0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function GA(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Uy(t,n)}}var W0={readContext:Ci,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useInsertionEffect:wr,useLayoutEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useMutableSource:wr,useSyncExternalStore:wr,useId:wr,unstable_isNewReconciler:!1},KN={readContext:Ci,useCallback:function(t,e){return fs().memoizedState=[t,e===void 0?null:e],t},useContext:Ci,useEffect:j_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,c0(4194308,4,MA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return c0(4194308,4,t,e)},useInsertionEffect:function(t,e){return c0(4,2,t,e)},useMemo:function(t,e){var n=fs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=fs();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=HN.bind(null,fn,t),[r.memoizedState,t]},useRef:function(t){var e=fs();return t={current:t},e.memoizedState=t},useState:U_,useDebugValue:cx,useDeferredValue:function(t){return fs().memoizedState=t},useTransition:function(){var t=U_(!1),e=t[0];return t=qN.bind(null,t[1]),fs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=fn,i=fs();if(sn){if(n===void 0)throw Error(ye(407));n=n()}else{if(n=e(),nr===null)throw Error(ye(349));vl&30||SA(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,j_(RA.bind(null,r,s,t),[t]),r.flags|=2048,ld(9,bA.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=fs(),e=nr.identifierPrefix;if(sn){var n=Js,r=Zs;n=(r&~(1<<32-Yi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=od++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=GN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$N={readContext:Ci,useCallback:FA,useContext:Ci,useEffect:lx,useImperativeHandle:LA,useInsertionEffect:kA,useLayoutEffect:OA,useMemo:VA,useReducer:hm,useRef:DA,useState:function(){return hm(ad)},useDebugValue:cx,useDeferredValue:function(t){var e=Si();return BA(e,Hn.memoizedState,t)},useTransition:function(){var t=hm(ad)[0],e=Si().memoizedState;return[t,e]},useMutableSource:TA,useSyncExternalStore:CA,useId:UA,unstable_isNewReconciler:!1},QN={readContext:Ci,useCallback:FA,useContext:Ci,useEffect:lx,useImperativeHandle:LA,useInsertionEffect:kA,useLayoutEffect:OA,useMemo:VA,useReducer:dm,useRef:DA,useState:function(){return dm(ad)},useDebugValue:cx,useDeferredValue:function(t){var e=Si();return Hn===null?e.memoizedState=t:BA(e,Hn.memoizedState,t)},useTransition:function(){var t=dm(ad)[0],e=Si().memoizedState;return[t,e]},useMutableSource:TA,useSyncExternalStore:CA,useId:UA,unstable_isNewReconciler:!1};function ji(t,e){if(t&&t.defaultProps){e=mn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function yp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var G1={isMounted:function(t){return(t=t._reactInternals)?Bl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Fr(),i=ha(t),s=io(r,i);s.payload=e,n!=null&&(s.callback=n),e=ca(t,s,i),e!==null&&(Zi(e,t,i,r),a0(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Fr(),i=ha(t),s=io(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ca(t,s,i),e!==null&&(Zi(e,t,i,r),a0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Fr(),r=ha(t),i=io(n,r);i.tag=2,e!=null&&(i.callback=e),e=ca(t,i,r),e!==null&&(Zi(e,t,r,n),a0(e,t,r))}};function z_(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!ed(n,r)||!ed(i,s):!0}function qA(t,e,n){var r=!1,i=ya,s=e.contextType;return typeof s=="object"&&s!==null?s=Ci(s):(i=ei(e)?_l:Rr.current,r=e.contextTypes,s=(r=r!=null)?Zc(t,i):ya),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=G1,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function G_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&G1.enqueueReplaceState(e,e.state,null)}function xp(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},tx(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ci(s):(s=ei(e)?_l:Rr.current,i.context=Zc(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(yp(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&G1.enqueueReplaceState(i,i.state,null),G0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function nu(t,e){try{var n="",r=e;do n+=I3(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function fm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function wp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var XN=typeof WeakMap=="function"?WeakMap:Map;function HA(t,e,n){n=io(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$0||($0=!0,Rp=r),wp(t,e)},n}function WA(t,e,n){n=io(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){wp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){wp(t,e),typeof r!="function"&&(ua===null?ua=new Set([this]):ua.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function q_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new XN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=u4.bind(null,t,e,n),e.then(t,t))}function H_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function W_(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=io(-1,1),e.tag=2,ca(n,e,1))),n.lanes|=1),t)}var YN=yo.ReactCurrentOwner,Qr=!1;function kr(t,e,n,r){e.child=t===null?EA(e,null,n,r):eu(e,t.child,n,r)}function K_(t,e,n,r,i){n=n.render;var s=e.ref;return Mc(e,i),r=ox(t,e,n,r,s,i),n=ax(),t!==null&&!Qr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,lo(t,e,i)):(sn&&n&&$y(e),e.flags|=1,kr(t,e,r,i),e.child)}function $_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!yx(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,KA(t,e,s,r,i)):(t=f0(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:ed,n(l,r)&&t.ref===e.ref)return lo(t,e,i)}return e.flags|=1,t=da(s,r),t.ref=e.ref,t.return=e,e.child=t}function KA(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(ed(s,r)&&t.ref===e.ref)if(Qr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Qr=!0);else return e.lanes=t.lanes,lo(t,e,i)}return _p(t,e,n,r,i)}function $A(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$t(bc,ci),ci|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,$t(bc,ci),ci|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,$t(bc,ci),ci|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,$t(bc,ci),ci|=r;return kr(t,e,i,n),e.child}function QA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function _p(t,e,n,r,i){var s=ei(n)?_l:Rr.current;return s=Zc(e,s),Mc(e,i),n=ox(t,e,n,r,s,i),r=ax(),t!==null&&!Qr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,lo(t,e,i)):(sn&&r&&$y(e),e.flags|=1,kr(t,e,n,i),e.child)}function Q_(t,e,n,r,i){if(ei(n)){var s=!0;V0(e)}else s=!1;if(Mc(e,i),e.stateNode===null)u0(t,e),qA(e,n,r),xp(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,h=e.memoizedProps;l.props=h;var f=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=Ci(m):(m=ei(n)?_l:Rr.current,m=Zc(e,m));var x=n.getDerivedStateFromProps,E=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function";E||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==r||f!==m)&&G_(e,l,r,m),Lo=!1;var A=e.memoizedState;l.state=A,G0(e,r,l,i),f=e.memoizedState,h!==r||A!==f||Jr.current||Lo?(typeof x=="function"&&(yp(e,n,x,r),f=e.memoizedState),(h=Lo||z_(e,n,h,r,A,f,m))?(E||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=f),l.props=r,l.state=f,l.context=m,r=h):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,IA(t,e),h=e.memoizedProps,m=e.type===e.elementType?h:ji(e.type,h),l.props=m,E=e.pendingProps,A=l.context,f=n.contextType,typeof f=="object"&&f!==null?f=Ci(f):(f=ei(n)?_l:Rr.current,f=Zc(e,f));var N=n.getDerivedStateFromProps;(x=typeof N=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==E||A!==f)&&G_(e,l,r,f),Lo=!1,A=e.memoizedState,l.state=A,G0(e,r,l,i);var U=e.memoizedState;h!==E||A!==U||Jr.current||Lo?(typeof N=="function"&&(yp(e,n,N,r),U=e.memoizedState),(m=Lo||z_(e,n,m,r,A,U,f)||!1)?(x||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,U,f),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,U,f)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=U),l.props=r,l.state=U,l.context=f,r=m):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&A===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&A===t.memoizedState||(e.flags|=1024),r=!1)}return Ep(t,e,n,r,s,i)}function Ep(t,e,n,r,i,s){QA(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&O_(e,n,!1),lo(t,e,s);r=e.stateNode,YN.current=e;var h=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=eu(e,t.child,null,s),e.child=eu(e,null,h,s)):kr(t,e,h,s),e.memoizedState=r.state,i&&O_(e,n,!0),e.child}function XA(t){var e=t.stateNode;e.pendingContext?k_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&k_(t,e.context,!1),nx(t,e.containerInfo)}function X_(t,e,n,r,i){return Jc(),Xy(i),e.flags|=256,kr(t,e,n,r),e.child}var vp={dehydrated:null,treeContext:null,retryLane:0};function Ip(t){return{baseLanes:t,cachePool:null,transitions:null}}function YA(t,e,n){var r=e.pendingProps,i=hn.current,s=!1,l=(e.flags&128)!==0,h;if((h=l)||(h=t!==null&&t.memoizedState===null?!1:(i&2)!==0),h?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),$t(hn,i&1),t===null)return mp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=W1(l,r,0,null),t=yl(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ip(n),e.memoizedState=vp,t):ux(e,l));if(i=t.memoizedState,i!==null&&(h=i.dehydrated,h!==null))return ZN(t,e,l,r,h,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,h=i.sibling;var f={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=f,e.deletions=null):(r=da(i,f),r.subtreeFlags=i.subtreeFlags&14680064),h!==null?s=da(h,s):(s=yl(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?Ip(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=vp,r}return s=t.child,t=s.sibling,r=da(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ux(t,e){return e=W1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Vf(t,e,n,r){return r!==null&&Xy(r),eu(e,t.child,null,n),t=ux(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ZN(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=fm(Error(ye(422))),Vf(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=W1({mode:"visible",children:r.children},i,0,null),s=yl(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&eu(e,t.child,null,l),e.child.memoizedState=Ip(l),e.memoizedState=vp,s);if(!(e.mode&1))return Vf(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var h=r.dgst;return r=h,s=Error(ye(419)),r=fm(s,r,void 0),Vf(t,e,l,r)}if(h=(l&t.childLanes)!==0,Qr||h){if(r=nr,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ao(t,i),Zi(r,t,i,-1))}return px(),r=fm(Error(ye(421))),Vf(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=h4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,hi=la(i.nextSibling),di=e,sn=!0,Wi=null,t!==null&&(Ei[vi++]=Zs,Ei[vi++]=Js,Ei[vi++]=El,Zs=t.id,Js=t.overflow,El=e),e=ux(e,r.children),e.flags|=4096,e)}function Y_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),pp(t.return,e,n)}function gm(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ZA(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(kr(t,e,r.children,n),r=hn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Y_(t,n,e);else if(t.tag===19)Y_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if($t(hn,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&q0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),gm(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&q0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}gm(e,!0,n,null,s);break;case"together":gm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function u0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function lo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Il|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,n=da(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=da(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function JN(t,e,n){switch(e.tag){case 3:XA(e),Jc();break;case 5:AA(e);break;case 1:ei(e.type)&&V0(e);break;case 4:nx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;$t(j0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?($t(hn,hn.current&1),e.flags|=128,null):n&e.child.childLanes?YA(t,e,n):($t(hn,hn.current&1),t=lo(t,e,n),t!==null?t.sibling:null);$t(hn,hn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ZA(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$t(hn,hn.current),r)break;return null;case 22:case 23:return e.lanes=0,$A(t,e,n)}return lo(t,e,n)}var JA,Ap,eT,tT;JA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ap=function(){};eT=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,al(Is.current);var s=null;switch(n){case"input":i=Wm(t,i),r=Wm(t,r),s=[];break;case"select":i=mn({},i,{value:void 0}),r=mn({},r,{value:void 0}),s=[];break;case"textarea":i=Qm(t,i),r=Qm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=L0)}Ym(n,r);var l;n=null;for(m in i)if(!r.hasOwnProperty(m)&&i.hasOwnProperty(m)&&i[m]!=null)if(m==="style"){var h=i[m];for(l in h)h.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Kh.hasOwnProperty(m)?s||(s=[]):(s=s||[]).push(m,null));for(m in r){var f=r[m];if(h=i!=null?i[m]:void 0,r.hasOwnProperty(m)&&f!==h&&(f!=null||h!=null))if(m==="style")if(h){for(l in h)!h.hasOwnProperty(l)||f&&f.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in f)f.hasOwnProperty(l)&&h[l]!==f[l]&&(n||(n={}),n[l]=f[l])}else n||(s||(s=[]),s.push(m,n)),n=f;else m==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,h=h?h.__html:void 0,f!=null&&h!==f&&(s=s||[]).push(m,f)):m==="children"?typeof f!="string"&&typeof f!="number"||(s=s||[]).push(m,""+f):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(Kh.hasOwnProperty(m)?(f!=null&&m==="onScroll"&&Yt("scroll",t),s||h===f||(s=[])):(s=s||[]).push(m,f))}n&&(s=s||[]).push("style",n);var m=s;(e.updateQueue=m)&&(e.flags|=4)}};tT=function(t,e,n,r){n!==r&&(e.flags|=4)};function uh(t,e){if(!sn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function _r(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function e4(t,e,n){var r=e.pendingProps;switch(Qy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _r(e),null;case 1:return ei(e.type)&&F0(),_r(e),null;case 3:return r=e.stateNode,tu(),en(Jr),en(Rr),ix(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Lf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wi!==null&&(Dp(Wi),Wi=null))),Ap(t,e),_r(e),null;case 5:rx(e);var i=al(sd.current);if(n=e.type,t!==null&&e.stateNode!=null)eT(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ye(166));return _r(e),null}if(t=al(Is.current),Lf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[xs]=e,r[rd]=s,t=(e.mode&1)!==0,n){case"dialog":Yt("cancel",r),Yt("close",r);break;case"iframe":case"object":case"embed":Yt("load",r);break;case"video":case"audio":for(i=0;i<Eh.length;i++)Yt(Eh[i],r);break;case"source":Yt("error",r);break;case"img":case"image":case"link":Yt("error",r),Yt("load",r);break;case"details":Yt("toggle",r);break;case"input":o_(r,s),Yt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Yt("invalid",r);break;case"textarea":l_(r,s),Yt("invalid",r)}Ym(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var h=s[l];l==="children"?typeof h=="string"?r.textContent!==h&&(s.suppressHydrationWarning!==!0&&Mf(r.textContent,h,t),i=["children",h]):typeof h=="number"&&r.textContent!==""+h&&(s.suppressHydrationWarning!==!0&&Mf(r.textContent,h,t),i=["children",""+h]):Kh.hasOwnProperty(l)&&h!=null&&l==="onScroll"&&Yt("scroll",r)}switch(n){case"input":Sf(r),a_(r,s,!0);break;case"textarea":Sf(r),c_(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=L0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=RI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[xs]=e,t[rd]=r,JA(t,e,!1,!1),e.stateNode=t;e:{switch(l=Zm(n,r),n){case"dialog":Yt("cancel",t),Yt("close",t),i=r;break;case"iframe":case"object":case"embed":Yt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Eh.length;i++)Yt(Eh[i],t);i=r;break;case"source":Yt("error",t),i=r;break;case"img":case"image":case"link":Yt("error",t),Yt("load",t),i=r;break;case"details":Yt("toggle",t),i=r;break;case"input":o_(t,r),i=Wm(t,r),Yt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=mn({},r,{value:void 0}),Yt("invalid",t);break;case"textarea":l_(t,r),i=Qm(t,r),Yt("invalid",t);break;default:i=r}Ym(n,i),h=i;for(s in h)if(h.hasOwnProperty(s)){var f=h[s];s==="style"?DI(t,f):s==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&NI(t,f)):s==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&$h(t,f):typeof f=="number"&&$h(t,""+f):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Kh.hasOwnProperty(s)?f!=null&&s==="onScroll"&&Yt("scroll",t):f!=null&&Oy(t,s,f,l))}switch(n){case"input":Sf(t),a_(t,r,!1);break;case"textarea":Sf(t),c_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+pa(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Pc(t,!!r.multiple,s,!1):r.defaultValue!=null&&Pc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=L0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _r(e),null;case 6:if(t&&e.stateNode!=null)tT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ye(166));if(n=al(sd.current),al(Is.current),Lf(e)){if(r=e.stateNode,n=e.memoizedProps,r[xs]=e,(s=r.nodeValue!==n)&&(t=di,t!==null))switch(t.tag){case 3:Mf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Mf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xs]=e,e.stateNode=r}return _r(e),null;case 13:if(en(hn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(sn&&hi!==null&&e.mode&1&&!(e.flags&128))wA(),Jc(),e.flags|=98560,s=!1;else if(s=Lf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ye(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ye(317));s[xs]=e}else Jc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_r(e),s=!1}else Wi!==null&&(Dp(Wi),Wi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||hn.current&1?Kn===0&&(Kn=3):px())),e.updateQueue!==null&&(e.flags|=4),_r(e),null);case 4:return tu(),Ap(t,e),t===null&&td(e.stateNode.containerInfo),_r(e),null;case 10:return Jy(e.type._context),_r(e),null;case 17:return ei(e.type)&&F0(),_r(e),null;case 19:if(en(hn),s=e.memoizedState,s===null)return _r(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)uh(s,!1);else{if(Kn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=q0(t),l!==null){for(e.flags|=128,uh(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return $t(hn,hn.current&1|2),e.child}t=t.sibling}s.tail!==null&&Rn()>ru&&(e.flags|=128,r=!0,uh(s,!1),e.lanes=4194304)}else{if(!r)if(t=q0(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),uh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!sn)return _r(e),null}else 2*Rn()-s.renderingStartTime>ru&&n!==1073741824&&(e.flags|=128,r=!0,uh(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Rn(),e.sibling=null,n=hn.current,$t(hn,r?n&1|2:n&1),e):(_r(e),null);case 22:case 23:return mx(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ci&1073741824&&(_r(e),e.subtreeFlags&6&&(e.flags|=8192)):_r(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function t4(t,e){switch(Qy(e),e.tag){case 1:return ei(e.type)&&F0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return tu(),en(Jr),en(Rr),ix(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return rx(e),null;case 13:if(en(hn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));Jc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return en(hn),null;case 4:return tu(),null;case 10:return Jy(e.type._context),null;case 22:case 23:return mx(),null;case 24:return null;default:return null}}var Bf=!1,Cr=!1,n4=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function Sc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){In(t,e,r)}else n.current=null}function Tp(t,e,n){try{n()}catch(r){In(t,e,r)}}var Z_=!1;function r4(t,e){if(lp=k0,t=oA(),Ky(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,h=-1,f=-1,m=0,x=0,E=t,A=null;t:for(;;){for(var N;E!==n||i!==0&&E.nodeType!==3||(h=l+i),E!==s||r!==0&&E.nodeType!==3||(f=l+r),E.nodeType===3&&(l+=E.nodeValue.length),(N=E.firstChild)!==null;)A=E,E=N;for(;;){if(E===t)break t;if(A===n&&++m===i&&(h=l),A===s&&++x===r&&(f=l),(N=E.nextSibling)!==null)break;E=A,A=E.parentNode}E=N}n=h===-1||f===-1?null:{start:h,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(cp={focusedElem:t,selectionRange:n},k0=!1,Pe=e;Pe!==null;)if(e=Pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Pe=t;else for(;Pe!==null;){e=Pe;try{var U=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(U!==null){var D=U.memoizedProps,G=U.memoizedState,M=e.stateNode,b=M.getSnapshotBeforeUpdate(e.elementType===e.type?D:ji(e.type,D),G);M.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var P=e.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(V){In(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,Pe=t;break}Pe=e.return}return U=Z_,Z_=!1,U}function Oh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Tp(e,n,s)}i=i.next}while(i!==r)}}function q1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Cp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function nT(t){var e=t.alternate;e!==null&&(t.alternate=null,nT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xs],delete e[rd],delete e[dp],delete e[BN],delete e[UN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rT(t){return t.tag===5||t.tag===3||t.tag===4}function J_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=L0));else if(r!==4&&(t=t.child,t!==null))for(Sp(t,e,n),t=t.sibling;t!==null;)Sp(t,e,n),t=t.sibling}function bp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(bp(t,e,n),t=t.sibling;t!==null;)bp(t,e,n),t=t.sibling}var cr=null,Hi=!1;function Ro(t,e,n){for(n=n.child;n!==null;)iT(t,e,n),n=n.sibling}function iT(t,e,n){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(L1,n)}catch{}switch(n.tag){case 5:Cr||Sc(n,e);case 6:var r=cr,i=Hi;cr=null,Ro(t,e,n),cr=r,Hi=i,cr!==null&&(Hi?(t=cr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):cr.removeChild(n.stateNode));break;case 18:cr!==null&&(Hi?(t=cr,n=n.stateNode,t.nodeType===8?am(t.parentNode,n):t.nodeType===1&&am(t,n),Zh(t)):am(cr,n.stateNode));break;case 4:r=cr,i=Hi,cr=n.stateNode.containerInfo,Hi=!0,Ro(t,e,n),cr=r,Hi=i;break;case 0:case 11:case 14:case 15:if(!Cr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&Tp(n,e,l),i=i.next}while(i!==r)}Ro(t,e,n);break;case 1:if(!Cr&&(Sc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(h){In(n,e,h)}Ro(t,e,n);break;case 21:Ro(t,e,n);break;case 22:n.mode&1?(Cr=(r=Cr)||n.memoizedState!==null,Ro(t,e,n),Cr=r):Ro(t,e,n);break;default:Ro(t,e,n)}}function e2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new n4),e.forEach(function(r){var i=d4.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ui(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,h=l;e:for(;h!==null;){switch(h.tag){case 5:cr=h.stateNode,Hi=!1;break e;case 3:cr=h.stateNode.containerInfo,Hi=!0;break e;case 4:cr=h.stateNode.containerInfo,Hi=!0;break e}h=h.return}if(cr===null)throw Error(ye(160));iT(s,l,i),cr=null,Hi=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(m){In(i,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)sT(e,t),e=e.sibling}function sT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ui(e,t),ds(t),r&4){try{Oh(3,t,t.return),q1(3,t)}catch(D){In(t,t.return,D)}try{Oh(5,t,t.return)}catch(D){In(t,t.return,D)}}break;case 1:Ui(e,t),ds(t),r&512&&n!==null&&Sc(n,n.return);break;case 5:if(Ui(e,t),ds(t),r&512&&n!==null&&Sc(n,n.return),t.flags&32){var i=t.stateNode;try{$h(i,"")}catch(D){In(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,h=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{h==="input"&&s.type==="radio"&&s.name!=null&&SI(i,s),Zm(h,l);var m=Zm(h,s);for(l=0;l<f.length;l+=2){var x=f[l],E=f[l+1];x==="style"?DI(i,E):x==="dangerouslySetInnerHTML"?NI(i,E):x==="children"?$h(i,E):Oy(i,x,E,m)}switch(h){case"input":Km(i,s);break;case"textarea":bI(i,s);break;case"select":var A=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var N=s.value;N!=null?Pc(i,!!s.multiple,N,!1):A!==!!s.multiple&&(s.defaultValue!=null?Pc(i,!!s.multiple,s.defaultValue,!0):Pc(i,!!s.multiple,s.multiple?[]:"",!1))}i[rd]=s}catch(D){In(t,t.return,D)}}break;case 6:if(Ui(e,t),ds(t),r&4){if(t.stateNode===null)throw Error(ye(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(D){In(t,t.return,D)}}break;case 3:if(Ui(e,t),ds(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Zh(e.containerInfo)}catch(D){In(t,t.return,D)}break;case 4:Ui(e,t),ds(t);break;case 13:Ui(e,t),ds(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(fx=Rn())),r&4&&e2(t);break;case 22:if(x=n!==null&&n.memoizedState!==null,t.mode&1?(Cr=(m=Cr)||x,Ui(e,t),Cr=m):Ui(e,t),ds(t),r&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!x&&t.mode&1)for(Pe=t,x=t.child;x!==null;){for(E=Pe=x;Pe!==null;){switch(A=Pe,N=A.child,A.tag){case 0:case 11:case 14:case 15:Oh(4,A,A.return);break;case 1:Sc(A,A.return);var U=A.stateNode;if(typeof U.componentWillUnmount=="function"){r=A,n=A.return;try{e=r,U.props=e.memoizedProps,U.state=e.memoizedState,U.componentWillUnmount()}catch(D){In(r,n,D)}}break;case 5:Sc(A,A.return);break;case 22:if(A.memoizedState!==null){n2(E);continue}}N!==null?(N.return=A,Pe=N):n2(E)}x=x.sibling}e:for(x=null,E=t;;){if(E.tag===5){if(x===null){x=E;try{i=E.stateNode,m?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(h=E.stateNode,f=E.memoizedProps.style,l=f!=null&&f.hasOwnProperty("display")?f.display:null,h.style.display=PI("display",l))}catch(D){In(t,t.return,D)}}}else if(E.tag===6){if(x===null)try{E.stateNode.nodeValue=m?"":E.memoizedProps}catch(D){In(t,t.return,D)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===t)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===t)break e;for(;E.sibling===null;){if(E.return===null||E.return===t)break e;x===E&&(x=null),E=E.return}x===E&&(x=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:Ui(e,t),ds(t),r&4&&e2(t);break;case 21:break;default:Ui(e,t),ds(t)}}function ds(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(rT(n)){var r=n;break e}n=n.return}throw Error(ye(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&($h(i,""),r.flags&=-33);var s=J_(t);bp(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,h=J_(t);Sp(t,h,l);break;default:throw Error(ye(161))}}catch(f){In(t,t.return,f)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function i4(t,e,n){Pe=t,oT(t)}function oT(t,e,n){for(var r=(t.mode&1)!==0;Pe!==null;){var i=Pe,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||Bf;if(!l){var h=i.alternate,f=h!==null&&h.memoizedState!==null||Cr;h=Bf;var m=Cr;if(Bf=l,(Cr=f)&&!m)for(Pe=i;Pe!==null;)l=Pe,f=l.child,l.tag===22&&l.memoizedState!==null?r2(i):f!==null?(f.return=l,Pe=f):r2(i);for(;s!==null;)Pe=s,oT(s),s=s.sibling;Pe=i,Bf=h,Cr=m}t2(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Pe=s):t2(t)}}function t2(t){for(;Pe!==null;){var e=Pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Cr||q1(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Cr)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ji(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&B_(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}B_(e,l,n)}break;case 5:var h=e.stateNode;if(n===null&&e.flags&4){n=h;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var x=m.memoizedState;if(x!==null){var E=x.dehydrated;E!==null&&Zh(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}Cr||e.flags&512&&Cp(e)}catch(A){In(e,e.return,A)}}if(e===t){Pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Pe=n;break}Pe=e.return}}function n2(t){for(;Pe!==null;){var e=Pe;if(e===t){Pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Pe=n;break}Pe=e.return}}function r2(t){for(;Pe!==null;){var e=Pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{q1(4,e)}catch(f){In(e,n,f)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(f){In(e,i,f)}}var s=e.return;try{Cp(e)}catch(f){In(e,s,f)}break;case 5:var l=e.return;try{Cp(e)}catch(f){In(e,l,f)}}}catch(f){In(e,e.return,f)}if(e===t){Pe=null;break}var h=e.sibling;if(h!==null){h.return=e.return,Pe=h;break}Pe=e.return}}var s4=Math.ceil,K0=yo.ReactCurrentDispatcher,hx=yo.ReactCurrentOwner,Ai=yo.ReactCurrentBatchConfig,At=0,nr=null,Vn=null,dr=0,ci=0,bc=ba(0),Kn=0,cd=null,Il=0,H1=0,dx=0,Mh=null,$r=null,fx=0,ru=1/0,Qs=null,$0=!1,Rp=null,ua=null,Uf=!1,ta=null,Q0=0,Lh=0,Np=null,h0=-1,d0=0;function Fr(){return At&6?Rn():h0!==-1?h0:h0=Rn()}function ha(t){return t.mode&1?At&2&&dr!==0?dr&-dr:zN.transition!==null?(d0===0&&(d0=qI()),d0):(t=kt,t!==0||(t=window.event,t=t===void 0?16:YI(t.type)),t):1}function Zi(t,e,n,r){if(50<Lh)throw Lh=0,Np=null,Error(ye(185));Od(t,n,r),(!(At&2)||t!==nr)&&(t===nr&&(!(At&2)&&(H1|=n),Kn===4&&Vo(t,dr)),ti(t,r),n===1&&At===0&&!(e.mode&1)&&(ru=Rn()+500,j1&&Ra()))}function ti(t,e){var n=t.callbackNode;z3(t,e);var r=D0(t,t===nr?dr:0);if(r===0)n!==null&&d_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&d_(n),e===1)t.tag===0?jN(i2.bind(null,t)):pA(i2.bind(null,t)),FN(function(){!(At&6)&&Ra()}),n=null;else{switch(HI(r)){case 1:n=By;break;case 4:n=zI;break;case 16:n=P0;break;case 536870912:n=GI;break;default:n=P0}n=gT(n,aT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function aT(t,e){if(h0=-1,d0=0,At&6)throw Error(ye(327));var n=t.callbackNode;if(Lc()&&t.callbackNode!==n)return null;var r=D0(t,t===nr?dr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=X0(t,r);else{e=r;var i=At;At|=2;var s=cT();(nr!==t||dr!==e)&&(Qs=null,ru=Rn()+500,pl(t,e));do try{l4();break}catch(h){lT(t,h)}while(1);Zy(),K0.current=s,At=i,Vn!==null?e=0:(nr=null,dr=0,e=Kn)}if(e!==0){if(e===2&&(i=rp(t),i!==0&&(r=i,e=Pp(t,i))),e===1)throw n=cd,pl(t,0),Vo(t,r),ti(t,Rn()),n;if(e===6)Vo(t,r);else{if(i=t.current.alternate,!(r&30)&&!o4(i)&&(e=X0(t,r),e===2&&(s=rp(t),s!==0&&(r=s,e=Pp(t,s))),e===1))throw n=cd,pl(t,0),Vo(t,r),ti(t,Rn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ye(345));case 2:Za(t,$r,Qs);break;case 3:if(Vo(t,r),(r&130023424)===r&&(e=fx+500-Rn(),10<e)){if(D0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Fr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=hp(Za.bind(null,t,$r,Qs),e);break}Za(t,$r,Qs);break;case 4:if(Vo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-Yi(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=Rn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*s4(r/1960))-r,10<r){t.timeoutHandle=hp(Za.bind(null,t,$r,Qs),r);break}Za(t,$r,Qs);break;case 5:Za(t,$r,Qs);break;default:throw Error(ye(329))}}}return ti(t,Rn()),t.callbackNode===n?aT.bind(null,t):null}function Pp(t,e){var n=Mh;return t.current.memoizedState.isDehydrated&&(pl(t,e).flags|=256),t=X0(t,e),t!==2&&(e=$r,$r=n,e!==null&&Dp(e)),t}function Dp(t){$r===null?$r=t:$r.push.apply($r,t)}function o4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ji(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vo(t,e){for(e&=~dx,e&=~H1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yi(e),r=1<<n;t[n]=-1,e&=~r}}function i2(t){if(At&6)throw Error(ye(327));Lc();var e=D0(t,0);if(!(e&1))return ti(t,Rn()),null;var n=X0(t,e);if(t.tag!==0&&n===2){var r=rp(t);r!==0&&(e=r,n=Pp(t,r))}if(n===1)throw n=cd,pl(t,0),Vo(t,e),ti(t,Rn()),n;if(n===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Za(t,$r,Qs),ti(t,Rn()),null}function gx(t,e){var n=At;At|=1;try{return t(e)}finally{At=n,At===0&&(ru=Rn()+500,j1&&Ra())}}function Al(t){ta!==null&&ta.tag===0&&!(At&6)&&Lc();var e=At;At|=1;var n=Ai.transition,r=kt;try{if(Ai.transition=null,kt=1,t)return t()}finally{kt=r,Ai.transition=n,At=e,!(At&6)&&Ra()}}function mx(){ci=bc.current,en(bc)}function pl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,LN(n)),Vn!==null)for(n=Vn.return;n!==null;){var r=n;switch(Qy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&F0();break;case 3:tu(),en(Jr),en(Rr),ix();break;case 5:rx(r);break;case 4:tu();break;case 13:en(hn);break;case 19:en(hn);break;case 10:Jy(r.type._context);break;case 22:case 23:mx()}n=n.return}if(nr=t,Vn=t=da(t.current,null),dr=ci=e,Kn=0,cd=null,dx=H1=Il=0,$r=Mh=null,ol!==null){for(e=0;e<ol.length;e++)if(n=ol[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}ol=null}return t}function lT(t,e){do{var n=Vn;try{if(Zy(),l0.current=W0,H0){for(var r=fn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}H0=!1}if(vl=0,er=Hn=fn=null,kh=!1,od=0,hx.current=null,n===null||n.return===null){Kn=1,cd=e,Vn=null;break}e:{var s=t,l=n.return,h=n,f=e;if(e=dr,h.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var m=f,x=h,E=x.tag;if(!(x.mode&1)&&(E===0||E===11||E===15)){var A=x.alternate;A?(x.updateQueue=A.updateQueue,x.memoizedState=A.memoizedState,x.lanes=A.lanes):(x.updateQueue=null,x.memoizedState=null)}var N=H_(l);if(N!==null){N.flags&=-257,W_(N,l,h,s,e),N.mode&1&&q_(s,m,e),e=N,f=m;var U=e.updateQueue;if(U===null){var D=new Set;D.add(f),e.updateQueue=D}else U.add(f);break e}else{if(!(e&1)){q_(s,m,e),px();break e}f=Error(ye(426))}}else if(sn&&h.mode&1){var G=H_(l);if(G!==null){!(G.flags&65536)&&(G.flags|=256),W_(G,l,h,s,e),Xy(nu(f,h));break e}}s=f=nu(f,h),Kn!==4&&(Kn=2),Mh===null?Mh=[s]:Mh.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var M=HA(s,f,e);V_(s,M);break e;case 1:h=f;var b=s.type,P=s.stateNode;if(!(s.flags&128)&&(typeof b.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(ua===null||!ua.has(P)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=WA(s,h,e);V_(s,V);break e}}s=s.return}while(s!==null)}hT(n)}catch($){e=$,Vn===n&&n!==null&&(Vn=n=n.return);continue}break}while(1)}function cT(){var t=K0.current;return K0.current=W0,t===null?W0:t}function px(){(Kn===0||Kn===3||Kn===2)&&(Kn=4),nr===null||!(Il&268435455)&&!(H1&268435455)||Vo(nr,dr)}function X0(t,e){var n=At;At|=2;var r=cT();(nr!==t||dr!==e)&&(Qs=null,pl(t,e));do try{a4();break}catch(i){lT(t,i)}while(1);if(Zy(),At=n,K0.current=r,Vn!==null)throw Error(ye(261));return nr=null,dr=0,Kn}function a4(){for(;Vn!==null;)uT(Vn)}function l4(){for(;Vn!==null&&!k3();)uT(Vn)}function uT(t){var e=fT(t.alternate,t,ci);t.memoizedProps=t.pendingProps,e===null?hT(t):Vn=e,hx.current=null}function hT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=t4(n,e),n!==null){n.flags&=32767,Vn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kn=6,Vn=null;return}}else if(n=e4(n,e,ci),n!==null){Vn=n;return}if(e=e.sibling,e!==null){Vn=e;return}Vn=e=t}while(e!==null);Kn===0&&(Kn=5)}function Za(t,e,n){var r=kt,i=Ai.transition;try{Ai.transition=null,kt=1,c4(t,e,n,r)}finally{Ai.transition=i,kt=r}return null}function c4(t,e,n,r){do Lc();while(ta!==null);if(At&6)throw Error(ye(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(G3(t,s),t===nr&&(Vn=nr=null,dr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Uf||(Uf=!0,gT(P0,function(){return Lc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ai.transition,Ai.transition=null;var l=kt;kt=1;var h=At;At|=4,hx.current=null,r4(t,n),sT(n,t),RN(cp),k0=!!lp,cp=lp=null,t.current=n,i4(n),O3(),At=h,kt=l,Ai.transition=s}else t.current=n;if(Uf&&(Uf=!1,ta=t,Q0=i),s=t.pendingLanes,s===0&&(ua=null),F3(n.stateNode),ti(t,Rn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if($0)throw $0=!1,t=Rp,Rp=null,t;return Q0&1&&t.tag!==0&&Lc(),s=t.pendingLanes,s&1?t===Np?Lh++:(Lh=0,Np=t):Lh=0,Ra(),null}function Lc(){if(ta!==null){var t=HI(Q0),e=Ai.transition,n=kt;try{if(Ai.transition=null,kt=16>t?16:t,ta===null)var r=!1;else{if(t=ta,ta=null,Q0=0,At&6)throw Error(ye(331));var i=At;for(At|=4,Pe=t.current;Pe!==null;){var s=Pe,l=s.child;if(Pe.flags&16){var h=s.deletions;if(h!==null){for(var f=0;f<h.length;f++){var m=h[f];for(Pe=m;Pe!==null;){var x=Pe;switch(x.tag){case 0:case 11:case 15:Oh(8,x,s)}var E=x.child;if(E!==null)E.return=x,Pe=E;else for(;Pe!==null;){x=Pe;var A=x.sibling,N=x.return;if(nT(x),x===m){Pe=null;break}if(A!==null){A.return=N,Pe=A;break}Pe=N}}}var U=s.alternate;if(U!==null){var D=U.child;if(D!==null){U.child=null;do{var G=D.sibling;D.sibling=null,D=G}while(D!==null)}}Pe=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Pe=l;else e:for(;Pe!==null;){if(s=Pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Oh(9,s,s.return)}var M=s.sibling;if(M!==null){M.return=s.return,Pe=M;break e}Pe=s.return}}var b=t.current;for(Pe=b;Pe!==null;){l=Pe;var P=l.child;if(l.subtreeFlags&2064&&P!==null)P.return=l,Pe=P;else e:for(l=b;Pe!==null;){if(h=Pe,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:q1(9,h)}}catch($){In(h,h.return,$)}if(h===l){Pe=null;break e}var V=h.sibling;if(V!==null){V.return=h.return,Pe=V;break e}Pe=h.return}}if(At=i,Ra(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(L1,t)}catch{}r=!0}return r}finally{kt=n,Ai.transition=e}}return!1}function s2(t,e,n){e=nu(n,e),e=HA(t,e,1),t=ca(t,e,1),e=Fr(),t!==null&&(Od(t,1,e),ti(t,e))}function In(t,e,n){if(t.tag===3)s2(t,t,n);else for(;e!==null;){if(e.tag===3){s2(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ua===null||!ua.has(r))){t=nu(n,t),t=WA(e,t,1),e=ca(e,t,1),t=Fr(),e!==null&&(Od(e,1,t),ti(e,t));break}}e=e.return}}function u4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Fr(),t.pingedLanes|=t.suspendedLanes&n,nr===t&&(dr&n)===n&&(Kn===4||Kn===3&&(dr&130023424)===dr&&500>Rn()-fx?pl(t,0):dx|=n),ti(t,e)}function dT(t,e){e===0&&(t.mode&1?(e=Nf,Nf<<=1,!(Nf&130023424)&&(Nf=4194304)):e=1);var n=Fr();t=ao(t,e),t!==null&&(Od(t,e,n),ti(t,n))}function h4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),dT(t,n)}function d4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ye(314))}r!==null&&r.delete(e),dT(t,n)}var fT;fT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Jr.current)Qr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Qr=!1,JN(t,e,n);Qr=!!(t.flags&131072)}else Qr=!1,sn&&e.flags&1048576&&yA(e,U0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;u0(t,e),t=e.pendingProps;var i=Zc(e,Rr.current);Mc(e,n),i=ox(null,e,r,t,i,n);var s=ax();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ei(r)?(s=!0,V0(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,tx(e),i.updater=G1,e.stateNode=i,i._reactInternals=e,xp(e,r,t,n),e=Ep(null,e,r,!0,s,n)):(e.tag=0,sn&&s&&$y(e),kr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(u0(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=g4(r),t=ji(r,t),i){case 0:e=_p(null,e,r,t,n);break e;case 1:e=Q_(null,e,r,t,n);break e;case 11:e=K_(null,e,r,t,n);break e;case 14:e=$_(null,e,r,ji(r.type,t),n);break e}throw Error(ye(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ji(r,i),_p(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ji(r,i),Q_(t,e,r,i,n);case 3:e:{if(XA(e),t===null)throw Error(ye(387));r=e.pendingProps,s=e.memoizedState,i=s.element,IA(t,e),G0(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=nu(Error(ye(423)),e),e=X_(t,e,r,n,i);break e}else if(r!==i){i=nu(Error(ye(424)),e),e=X_(t,e,r,n,i);break e}else for(hi=la(e.stateNode.containerInfo.firstChild),di=e,sn=!0,Wi=null,n=EA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Jc(),r===i){e=lo(t,e,n);break e}kr(t,e,r,n)}e=e.child}return e;case 5:return AA(e),t===null&&mp(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,up(r,i)?l=null:s!==null&&up(r,s)&&(e.flags|=32),QA(t,e),kr(t,e,l,n),e.child;case 6:return t===null&&mp(e),null;case 13:return YA(t,e,n);case 4:return nx(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=eu(e,null,r,n):kr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ji(r,i),K_(t,e,r,i,n);case 7:return kr(t,e,e.pendingProps,n),e.child;case 8:return kr(t,e,e.pendingProps.children,n),e.child;case 12:return kr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,$t(j0,r._currentValue),r._currentValue=l,s!==null)if(Ji(s.value,l)){if(s.children===i.children&&!Jr.current){e=lo(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var h=s.dependencies;if(h!==null){l=s.child;for(var f=h.firstContext;f!==null;){if(f.context===r){if(s.tag===1){f=io(-1,n&-n),f.tag=2;var m=s.updateQueue;if(m!==null){m=m.shared;var x=m.pending;x===null?f.next=f:(f.next=x.next,x.next=f),m.pending=f}}s.lanes|=n,f=s.alternate,f!==null&&(f.lanes|=n),pp(s.return,n,e),h.lanes|=n;break}f=f.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(ye(341));l.lanes|=n,h=l.alternate,h!==null&&(h.lanes|=n),pp(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}kr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Mc(e,n),i=Ci(i),r=r(i),e.flags|=1,kr(t,e,r,n),e.child;case 14:return r=e.type,i=ji(r,e.pendingProps),i=ji(r.type,i),$_(t,e,r,i,n);case 15:return KA(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ji(r,i),u0(t,e),e.tag=1,ei(r)?(t=!0,V0(e)):t=!1,Mc(e,n),qA(e,r,i),xp(e,r,i,n),Ep(null,e,r,!0,t,n);case 19:return ZA(t,e,n);case 22:return $A(t,e,n)}throw Error(ye(156,e.tag))};function gT(t,e){return jI(t,e)}function f4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ii(t,e,n,r){return new f4(t,e,n,r)}function yx(t){return t=t.prototype,!(!t||!t.isReactComponent)}function g4(t){if(typeof t=="function")return yx(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ly)return 11;if(t===Fy)return 14}return 2}function da(t,e){var n=t.alternate;return n===null?(n=Ii(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function f0(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")yx(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case xc:return yl(n.children,i,s,e);case My:l=8,i|=8;break;case zm:return t=Ii(12,n,e,i|2),t.elementType=zm,t.lanes=s,t;case Gm:return t=Ii(13,n,e,i),t.elementType=Gm,t.lanes=s,t;case qm:return t=Ii(19,n,e,i),t.elementType=qm,t.lanes=s,t;case AI:return W1(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case vI:l=10;break e;case II:l=9;break e;case Ly:l=11;break e;case Fy:l=14;break e;case Mo:l=16,r=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=Ii(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function yl(t,e,n,r){return t=Ii(7,t,r,e),t.lanes=n,t}function W1(t,e,n,r){return t=Ii(22,t,r,e),t.elementType=AI,t.lanes=n,t.stateNode={isHidden:!1},t}function mm(t,e,n){return t=Ii(6,t,null,e),t.lanes=n,t}function pm(t,e,n){return e=Ii(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function m4(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xg(0),this.expirationTimes=Xg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function xx(t,e,n,r,i,s,l,h,f){return t=new m4(t,e,n,h,f),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ii(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},tx(s),t}function p4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function mT(t){if(!t)return ya;t=t._reactInternals;e:{if(Bl(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ei(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var n=t.type;if(ei(n))return mA(t,n,e)}return e}function pT(t,e,n,r,i,s,l,h,f){return t=xx(n,r,!0,t,i,s,l,h,f),t.context=mT(null),n=t.current,r=Fr(),i=ha(n),s=io(r,i),s.callback=e??null,ca(n,s,i),t.current.lanes=i,Od(t,i,r),ti(t,r),t}function K1(t,e,n,r){var i=e.current,s=Fr(),l=ha(i);return n=mT(n),e.context===null?e.context=n:e.pendingContext=n,e=io(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ca(i,e,l),t!==null&&(Zi(t,i,l,s),a0(t,i,l)),l}function Y0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function o2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function wx(t,e){o2(t,e),(t=t.alternate)&&o2(t,e)}function y4(){return null}var yT=typeof reportError=="function"?reportError:function(t){console.error(t)};function _x(t){this._internalRoot=t}$1.prototype.render=_x.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));K1(t,e,null,null)};$1.prototype.unmount=_x.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Al(function(){K1(null,t,null,null)}),e[oo]=null}};function $1(t){this._internalRoot=t}$1.prototype.unstable_scheduleHydration=function(t){if(t){var e=$I();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Fo.length&&e!==0&&e<Fo[n].priority;n++);Fo.splice(n,0,t),n===0&&XI(t)}};function Ex(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Q1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function a2(){}function x4(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var m=Y0(l);s.call(m)}}var l=pT(e,r,t,0,null,!1,!1,"",a2);return t._reactRootContainer=l,t[oo]=l.current,td(t.nodeType===8?t.parentNode:t),Al(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var h=r;r=function(){var m=Y0(f);h.call(m)}}var f=xx(t,0,!1,null,null,!1,!1,"",a2);return t._reactRootContainer=f,t[oo]=f.current,td(t.nodeType===8?t.parentNode:t),Al(function(){K1(e,f,n,r)}),f}function X1(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var h=i;i=function(){var f=Y0(l);h.call(f)}}K1(e,l,t,i)}else l=x4(n,e,t,i,r);return Y0(l)}WI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=_h(e.pendingLanes);n!==0&&(Uy(e,n|1),ti(e,Rn()),!(At&6)&&(ru=Rn()+500,Ra()))}break;case 13:Al(function(){var r=ao(t,1);if(r!==null){var i=Fr();Zi(r,t,1,i)}}),wx(t,1)}};jy=function(t){if(t.tag===13){var e=ao(t,134217728);if(e!==null){var n=Fr();Zi(e,t,134217728,n)}wx(t,134217728)}};KI=function(t){if(t.tag===13){var e=ha(t),n=ao(t,e);if(n!==null){var r=Fr();Zi(n,t,e,r)}wx(t,e)}};$I=function(){return kt};QI=function(t,e){var n=kt;try{return kt=t,e()}finally{kt=n}};ep=function(t,e,n){switch(e){case"input":if(Km(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=U1(r);if(!i)throw Error(ye(90));CI(r),Km(r,i)}}}break;case"textarea":bI(t,n);break;case"select":e=n.value,e!=null&&Pc(t,!!n.multiple,e,!1)}};MI=gx;LI=Al;var w4={usingClientEntryPoint:!1,Events:[Ld,vc,U1,kI,OI,gx]},hh={findFiberByHostInstance:sl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_4={bundleType:hh.bundleType,version:hh.version,rendererPackageName:hh.rendererPackageName,rendererConfig:hh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=BI(t),t===null?null:t.stateNode},findFiberByHostInstance:hh.findFiberByHostInstance||y4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jf.isDisabled&&jf.supportsFiber)try{L1=jf.inject(_4),vs=jf}catch{}}mi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w4;mi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ex(e))throw Error(ye(200));return p4(t,e,null,n)};mi.createRoot=function(t,e){if(!Ex(t))throw Error(ye(299));var n=!1,r="",i=yT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=xx(t,1,!1,null,null,n,!1,r,i),t[oo]=e.current,td(t.nodeType===8?t.parentNode:t),new _x(e)};mi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=BI(e),t=t===null?null:t.stateNode,t};mi.flushSync=function(t){return Al(t)};mi.hydrate=function(t,e,n){if(!Q1(e))throw Error(ye(200));return X1(null,t,e,!0,n)};mi.hydrateRoot=function(t,e,n){if(!Ex(t))throw Error(ye(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=yT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=pT(e,null,t,1,n??null,i,!1,s,l),t[oo]=e.current,td(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new $1(e)};mi.render=function(t,e,n){if(!Q1(e))throw Error(ye(200));return X1(null,t,e,!1,n)};mi.unmountComponentAtNode=function(t){if(!Q1(t))throw Error(ye(40));return t._reactRootContainer?(Al(function(){X1(null,null,t,!1,function(){t._reactRootContainer=null,t[oo]=null})}),!0):!1};mi.unstable_batchedUpdates=gx;mi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Q1(n))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return X1(t,e,n,!1,r)};mi.version="18.3.1-next-f1338f8080-20240426";function xT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xT)}catch(t){console.error(t)}}xT(),xI.exports=mi;var E4=xI.exports,l2=E4;Um.createRoot=l2.createRoot,Um.hydrateRoot=l2.hydrateRoot;var Y1=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},v4={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},$o,Sy,Xv,I4=(Xv=class{constructor(){gt(this,$o,v4);gt(this,Sy,!1)}setTimeoutProvider(t){Qe(this,$o,t)}setTimeout(t,e){return he(this,$o).setTimeout(t,e)}clearTimeout(t){he(this,$o).clearTimeout(t)}setInterval(t,e){return he(this,$o).setInterval(t,e)}clearInterval(t){he(this,$o).clearInterval(t)}},$o=new WeakMap,Sy=new WeakMap,Xv),kp=new I4;function A4(t){setTimeout(t,0)}var Z1=typeof window>"u"||"Deno"in globalThis;function zi(){}function T4(t,e){return typeof t=="function"?t(e):t}function C4(t){return typeof t=="number"&&t>=0&&t!==1/0}function S4(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Op(t,e){return typeof t=="function"?t(e):t}function b4(t,e){return typeof t=="function"?t(e):t}function c2(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:l,stale:h}=t;if(l){if(r){if(e.queryHash!==vx(l,e.options))return!1}else if(!hd(e.queryKey,l))return!1}if(n!=="all"){const f=e.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||i&&i!==e.state.fetchStatus||s&&!s(e))}function u2(t,e){const{exact:n,status:r,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(ud(e.options.mutationKey)!==ud(s))return!1}else if(!hd(e.options.mutationKey,s))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function vx(t,e){return((e==null?void 0:e.queryKeyHashFn)||ud)(t)}function ud(t){return JSON.stringify(t,(e,n)=>Mp(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function hd(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>hd(t[n],e[n])):!1}var R4=Object.prototype.hasOwnProperty;function wT(t,e){if(t===e)return t;const n=h2(t)&&h2(e);if(!n&&!(Mp(t)&&Mp(e)))return e;const i=(n?t:Object.keys(t)).length,s=n?e:Object.keys(e),l=s.length,h=n?new Array(l):{};let f=0;for(let m=0;m<l;m++){const x=n?m:s[m],E=t[x],A=e[x];if(E===A){h[x]=E,(n?m<i:R4.call(t,x))&&f++;continue}if(E===null||A===null||typeof E!="object"||typeof A!="object"){h[x]=A;continue}const N=wT(E,A);h[x]=N,N===E&&f++}return i===l&&f===i?t:h}function h2(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Mp(t){if(!d2(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!d2(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function d2(t){return Object.prototype.toString.call(t)==="[object Object]"}function N4(t){return new Promise(e=>{kp.setTimeout(e,t)})}function P4(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?wT(t,e):e}function D4(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function k4(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Ix=Symbol();function _T(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Ix?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ul,Qo,Gc,Yv,O4=(Yv=class extends Y1{constructor(){super();gt(this,ul,void 0);gt(this,Qo,void 0);gt(this,Gc,void 0);Qe(this,Gc,e=>{if(!Z1&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){he(this,Qo)||this.setEventListener(he(this,Gc))}onUnsubscribe(){var e;this.hasListeners()||((e=he(this,Qo))==null||e.call(this),Qe(this,Qo,void 0))}setEventListener(e){var n;Qe(this,Gc,e),(n=he(this,Qo))==null||n.call(this),Qe(this,Qo,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){he(this,ul)!==e&&(Qe(this,ul,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof he(this,ul)=="boolean"?he(this,ul):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ul=new WeakMap,Qo=new WeakMap,Gc=new WeakMap,Yv),ET=new O4;function M4(){let t,e;const n=new Promise((i,s)=>{t=i,e=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var L4=A4;function F4(){let t=[],e=0,n=h=>{h()},r=h=>{h()},i=L4;const s=h=>{e?t.push(h):i(()=>{n(h)})},l=()=>{const h=t;t=[],h.length&&i(()=>{r(()=>{h.forEach(f=>{n(f)})})})};return{batch:h=>{let f;e++;try{f=h()}finally{e--,e||l()}return f},batchCalls:h=>(...f)=>{s(()=>{h(...f)})},schedule:s,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{r=h},setScheduler:h=>{i=h}}}var Mr=F4(),qc,Xo,Hc,Zv,V4=(Zv=class extends Y1{constructor(){super();gt(this,qc,!0);gt(this,Xo,void 0);gt(this,Hc,void 0);Qe(this,Hc,e=>{if(!Z1&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){he(this,Xo)||this.setEventListener(he(this,Hc))}onUnsubscribe(){var e;this.hasListeners()||((e=he(this,Xo))==null||e.call(this),Qe(this,Xo,void 0))}setEventListener(e){var n;Qe(this,Hc,e),(n=he(this,Xo))==null||n.call(this),Qe(this,Xo,e(this.setOnline.bind(this)))}setOnline(e){he(this,qc)!==e&&(Qe(this,qc,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return he(this,qc)}},qc=new WeakMap,Xo=new WeakMap,Hc=new WeakMap,Zv),Z0=new V4;function B4(t){return Math.min(1e3*2**t,3e4)}function vT(t){return(t??"online")==="online"?Z0.isOnline():!0}var Lp=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function IT(t){let e=!1,n=0,r;const i=M4(),s=()=>i.status!=="pending",l=D=>{var G;if(!s()){const M=new Lp(D);A(M),(G=t.onCancel)==null||G.call(t,M)}},h=()=>{e=!0},f=()=>{e=!1},m=()=>ET.isFocused()&&(t.networkMode==="always"||Z0.isOnline())&&t.canRun(),x=()=>vT(t.networkMode)&&t.canRun(),E=D=>{s()||(r==null||r(),i.resolve(D))},A=D=>{s()||(r==null||r(),i.reject(D))},N=()=>new Promise(D=>{var G;r=M=>{(s()||m())&&D(M)},(G=t.onPause)==null||G.call(t)}).then(()=>{var D;r=void 0,s()||(D=t.onContinue)==null||D.call(t)}),U=()=>{if(s())return;let D;const G=n===0?t.initialPromise:void 0;try{D=G??t.fn()}catch(M){D=Promise.reject(M)}Promise.resolve(D).then(E).catch(M=>{var J;if(s())return;const b=t.retry??(Z1?0:3),P=t.retryDelay??B4,V=typeof P=="function"?P(n,M):P,$=b===!0||typeof b=="number"&&n<b||typeof b=="function"&&b(n,M);if(e||!$){A(M);return}n++,(J=t.onFail)==null||J.call(t,n,M),N4(V).then(()=>m()?void 0:N()).then(()=>{e?A(M):U()})})};return{promise:i,status:()=>i.status,cancel:l,continue:()=>(r==null||r(),i),cancelRetry:h,continueRetry:f,canStart:x,start:()=>(x()?U():N().then(U),i)}}var hl,Jv,AT=(Jv=class{constructor(){gt(this,hl,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),C4(this.gcTime)&&Qe(this,hl,kp.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Z1?1/0:5*60*1e3))}clearGcTimeout(){he(this,hl)&&(kp.clearTimeout(he(this,hl)),Qe(this,hl,void 0))}},hl=new WeakMap,Jv),dl,Wc,_i,fl,Zn,Nd,gl,Gi,Ks,eI,U4=(eI=class extends AT{constructor(n){super();gt(this,Gi);gt(this,dl,void 0);gt(this,Wc,void 0);gt(this,_i,void 0);gt(this,fl,void 0);gt(this,Zn,void 0);gt(this,Nd,void 0);gt(this,gl,void 0);Qe(this,gl,!1),Qe(this,Nd,n.defaultOptions),this.setOptions(n.options),this.observers=[],Qe(this,fl,n.client),Qe(this,_i,he(this,fl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,Qe(this,dl,f2(this.options)),this.state=n.state??he(this,dl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=he(this,Zn))==null?void 0:n.promise}setOptions(n){if(this.options={...he(this,Nd),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=f2(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),Qe(this,dl,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&he(this,_i).remove(this)}setData(n,r){const i=P4(this.state.data,n,this.options);return xr(this,Gi,Ks).call(this,{data:i,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),i}setState(n,r){xr(this,Gi,Ks).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var i,s;const r=(i=he(this,Zn))==null?void 0:i.promise;return(s=he(this,Zn))==null||s.cancel(n),r?r.then(zi).catch(zi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(he(this,dl))}isActive(){return this.observers.some(n=>b4(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ix||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>Op(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!S4(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=this.observers.find(i=>i.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=he(this,Zn))==null||r.continue()}onOnline(){var r;const n=this.observers.find(i=>i.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=he(this,Zn))==null||r.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),he(this,_i).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(r=>r!==n),this.observers.length||(he(this,Zn)&&(he(this,gl)?he(this,Zn).cancel({revert:!0}):he(this,Zn).cancelRetry()),this.scheduleGc()),he(this,_i).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xr(this,Gi,Ks).call(this,{type:"invalidate"})}async fetch(n,r){var m,x,E,A,N,U,D,G,M,b,P,V;if(this.state.fetchStatus!=="idle"&&((m=he(this,Zn))==null?void 0:m.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(he(this,Zn))return he(this,Zn).continueRetry(),he(this,Zn).promise}if(n&&this.setOptions(n),!this.options.queryFn){const $=this.observers.find(J=>J.options.queryFn);$&&this.setOptions($.options)}const i=new AbortController,s=$=>{Object.defineProperty($,"signal",{enumerable:!0,get:()=>(Qe(this,gl,!0),i.signal)})},l=()=>{const $=_T(this.options,r),k=(()=>{const L={client:he(this,fl),queryKey:this.queryKey,meta:this.meta};return s(L),L})();return Qe(this,gl,!1),this.options.persister?this.options.persister($,k,this):$(k)},f=(()=>{const $={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:he(this,fl),state:this.state,fetchFn:l};return s($),$})();(x=this.options.behavior)==null||x.onFetch(f,this),Qe(this,Wc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((E=f.fetchOptions)==null?void 0:E.meta))&&xr(this,Gi,Ks).call(this,{type:"fetch",meta:(A=f.fetchOptions)==null?void 0:A.meta}),Qe(this,Zn,IT({initialPromise:r==null?void 0:r.initialPromise,fn:f.fetchFn,onCancel:$=>{$ instanceof Lp&&$.revert&&this.setState({...he(this,Wc),fetchStatus:"idle"}),i.abort()},onFail:($,J)=>{xr(this,Gi,Ks).call(this,{type:"failed",failureCount:$,error:J})},onPause:()=>{xr(this,Gi,Ks).call(this,{type:"pause"})},onContinue:()=>{xr(this,Gi,Ks).call(this,{type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0}));try{const $=await he(this,Zn).start();if($===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData($),(U=(N=he(this,_i).config).onSuccess)==null||U.call(N,$,this),(G=(D=he(this,_i).config).onSettled)==null||G.call(D,$,this.state.error,this),$}catch($){if($ instanceof Lp){if($.silent)return he(this,Zn).promise;if($.revert){if(this.state.data===void 0)throw $;return this.state.data}}throw xr(this,Gi,Ks).call(this,{type:"error",error:$}),(b=(M=he(this,_i).config).onError)==null||b.call(M,$,this),(V=(P=he(this,_i).config).onSettled)==null||V.call(P,this.state.data,$,this),$}finally{this.scheduleGc()}}},dl=new WeakMap,Wc=new WeakMap,_i=new WeakMap,fl=new WeakMap,Zn=new WeakMap,Nd=new WeakMap,gl=new WeakMap,Gi=new WeakSet,Ks=function(n){const r=i=>{switch(n.type){case"failed":return{...i,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...j4(i.data,this.options),fetchMeta:n.meta??null};case"success":const s={...i,data:n.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:n.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Qe(this,Wc,n.manual?s:void 0),s;case"error":const l=n.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...n.state}}};this.state=r(this.state),Mr.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),he(this,_i).notify({query:this,type:"updated",action:n})})},eI);function j4(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:vT(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function f2(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function g2(t){return{onFetch:(e,n)=>{var x,E,A,N,U;const r=e.options,i=(A=(E=(x=e.fetchOptions)==null?void 0:x.meta)==null?void 0:E.fetchMore)==null?void 0:A.direction,s=((N=e.state.data)==null?void 0:N.pages)||[],l=((U=e.state.data)==null?void 0:U.pageParams)||[];let h={pages:[],pageParams:[]},f=0;const m=async()=>{let D=!1;const G=P=>{Object.defineProperty(P,"signal",{enumerable:!0,get:()=>(e.signal.aborted?D=!0:e.signal.addEventListener("abort",()=>{D=!0}),e.signal)})},M=_T(e.options,e.fetchOptions),b=async(P,V,$)=>{if(D)return Promise.reject();if(V==null&&P.pages.length)return Promise.resolve(P);const k=(()=>{const K={client:e.client,queryKey:e.queryKey,pageParam:V,direction:$?"backward":"forward",meta:e.options.meta};return G(K),K})(),L=await M(k),{maxPages:F}=e.options,H=$?k4:D4;return{pages:H(P.pages,L,F),pageParams:H(P.pageParams,V,F)}};if(i&&s.length){const P=i==="backward",V=P?z4:m2,$={pages:s,pageParams:l},J=V(r,$);h=await b($,J,P)}else{const P=t??s.length;do{const V=f===0?l[0]??r.initialPageParam:m2(r,h);if(f>0&&V==null)break;h=await b(h,V),f++}while(f<P)}return h};e.options.persister?e.fetchFn=()=>{var D,G;return(G=(D=e.options).persister)==null?void 0:G.call(D,m,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=m}}}function m2(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function z4(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Pd,ms,Dr,ml,ps,ko,tI,G4=(tI=class extends AT{constructor(n){super();gt(this,ps);gt(this,Pd,void 0);gt(this,ms,void 0);gt(this,Dr,void 0);gt(this,ml,void 0);Qe(this,Pd,n.client),this.mutationId=n.mutationId,Qe(this,Dr,n.mutationCache),Qe(this,ms,[]),this.state=n.state||q4(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){he(this,ms).includes(n)||(he(this,ms).push(n),this.clearGcTimeout(),he(this,Dr).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){Qe(this,ms,he(this,ms).filter(r=>r!==n)),this.scheduleGc(),he(this,Dr).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){he(this,ms).length||(this.state.status==="pending"?this.scheduleGc():he(this,Dr).remove(this))}continue(){var n;return((n=he(this,ml))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var h,f,m,x,E,A,N,U,D,G,M,b,P,V,$,J,k,L,F,H;const r=()=>{xr(this,ps,ko).call(this,{type:"continue"})},i={client:he(this,Pd),meta:this.options.meta,mutationKey:this.options.mutationKey};Qe(this,ml,IT({fn:()=>this.options.mutationFn?this.options.mutationFn(n,i):Promise.reject(new Error("No mutationFn found")),onFail:(K,W)=>{xr(this,ps,ko).call(this,{type:"failed",failureCount:K,error:W})},onPause:()=>{xr(this,ps,ko).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>he(this,Dr).canRun(this)}));const s=this.state.status==="pending",l=!he(this,ml).canStart();try{if(s)r();else{xr(this,ps,ko).call(this,{type:"pending",variables:n,isPaused:l}),await((f=(h=he(this,Dr).config).onMutate)==null?void 0:f.call(h,n,this,i));const W=await((x=(m=this.options).onMutate)==null?void 0:x.call(m,n,i));W!==this.state.context&&xr(this,ps,ko).call(this,{type:"pending",context:W,variables:n,isPaused:l})}const K=await he(this,ml).start();return await((A=(E=he(this,Dr).config).onSuccess)==null?void 0:A.call(E,K,n,this.state.context,this,i)),await((U=(N=this.options).onSuccess)==null?void 0:U.call(N,K,n,this.state.context,i)),await((G=(D=he(this,Dr).config).onSettled)==null?void 0:G.call(D,K,null,this.state.variables,this.state.context,this,i)),await((b=(M=this.options).onSettled)==null?void 0:b.call(M,K,null,n,this.state.context,i)),xr(this,ps,ko).call(this,{type:"success",data:K}),K}catch(K){try{throw await((V=(P=he(this,Dr).config).onError)==null?void 0:V.call(P,K,n,this.state.context,this,i)),await((J=($=this.options).onError)==null?void 0:J.call($,K,n,this.state.context,i)),await((L=(k=he(this,Dr).config).onSettled)==null?void 0:L.call(k,void 0,K,this.state.variables,this.state.context,this,i)),await((H=(F=this.options).onSettled)==null?void 0:H.call(F,void 0,K,n,this.state.context,i)),K}finally{xr(this,ps,ko).call(this,{type:"error",error:K})}}finally{he(this,Dr).runNext(this)}}},Pd=new WeakMap,ms=new WeakMap,Dr=new WeakMap,ml=new WeakMap,ps=new WeakSet,ko=function(n){const r=i=>{switch(n.type){case"failed":return{...i,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...i,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:n.error,failureCount:i.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Mr.batch(()=>{he(this,ms).forEach(i=>{i.onMutationUpdate(n)}),he(this,Dr).notify({mutation:this,type:"updated",action:n})})},tI);function q4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ys,qi,Dd,nI,H4=(nI=class extends Y1{constructor(e={}){super();gt(this,Ys,void 0);gt(this,qi,void 0);gt(this,Dd,void 0);this.config=e,Qe(this,Ys,new Set),Qe(this,qi,new Map),Qe(this,Dd,0)}build(e,n,r){const i=new G4({client:e,mutationCache:this,mutationId:++Af(this,Dd)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){he(this,Ys).add(e);const n=zf(e);if(typeof n=="string"){const r=he(this,qi).get(n);r?r.push(e):he(this,qi).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(he(this,Ys).delete(e)){const n=zf(e);if(typeof n=="string"){const r=he(this,qi).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&he(this,qi).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=zf(e);if(typeof n=="string"){const r=he(this,qi).get(n),i=r==null?void 0:r.find(s=>s.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=zf(e);if(typeof n=="string"){const i=(r=he(this,qi).get(n))==null?void 0:r.find(s=>s!==e&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Mr.batch(()=>{he(this,Ys).forEach(e=>{this.notify({type:"removed",mutation:e})}),he(this,Ys).clear(),he(this,qi).clear()})}getAll(){return Array.from(he(this,Ys))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>u2(n,r))}findAll(e={}){return this.getAll().filter(n=>u2(e,n))}notify(e){Mr.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Mr.batch(()=>Promise.all(e.map(n=>n.continue().catch(zi))))}},Ys=new WeakMap,qi=new WeakMap,Dd=new WeakMap,nI);function zf(t){var e;return(e=t.options.scope)==null?void 0:e.id}var ys,rI,W4=(rI=class extends Y1{constructor(e={}){super();gt(this,ys,void 0);this.config=e,Qe(this,ys,new Map)}build(e,n,r){const i=n.queryKey,s=n.queryHash??vx(i,n);let l=this.get(s);return l||(l=new U4({client:e,queryKey:i,queryHash:s,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(l)),l}add(e){he(this,ys).has(e.queryHash)||(he(this,ys).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=he(this,ys).get(e.queryHash);n&&(e.destroy(),n===e&&he(this,ys).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Mr.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return he(this,ys).get(e)}getAll(){return[...he(this,ys).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>c2(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>c2(e,r)):n}notify(e){Mr.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Mr.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Mr.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ys=new WeakMap,rI),En,Yo,Zo,Kc,$c,Jo,Qc,Xc,iI,K4=(iI=class{constructor(t={}){gt(this,En,void 0);gt(this,Yo,void 0);gt(this,Zo,void 0);gt(this,Kc,void 0);gt(this,$c,void 0);gt(this,Jo,void 0);gt(this,Qc,void 0);gt(this,Xc,void 0);Qe(this,En,t.queryCache||new W4),Qe(this,Yo,t.mutationCache||new H4),Qe(this,Zo,t.defaultOptions||{}),Qe(this,Kc,new Map),Qe(this,$c,new Map),Qe(this,Jo,0)}mount(){Af(this,Jo)._++,he(this,Jo)===1&&(Qe(this,Qc,ET.subscribe(async t=>{t&&(await this.resumePausedMutations(),he(this,En).onFocus())})),Qe(this,Xc,Z0.subscribe(async t=>{t&&(await this.resumePausedMutations(),he(this,En).onOnline())})))}unmount(){var t,e;Af(this,Jo)._--,he(this,Jo)===0&&((t=he(this,Qc))==null||t.call(this),Qe(this,Qc,void 0),(e=he(this,Xc))==null||e.call(this),Qe(this,Xc,void 0))}isFetching(t){return he(this,En).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return he(this,Yo).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=he(this,En).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=he(this,En).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Op(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return he(this,En).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=he(this,En).get(r.queryHash),s=i==null?void 0:i.state.data,l=T4(e,s);if(l!==void 0)return he(this,En).build(this,r).setData(l,{...n,manual:!0})}setQueriesData(t,e,n){return Mr.batch(()=>he(this,En).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=he(this,En).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=he(this,En);Mr.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=he(this,En);return Mr.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Mr.batch(()=>he(this,En).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(zi).catch(zi)}invalidateQueries(t,e={}){return Mr.batch(()=>(he(this,En).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Mr.batch(()=>he(this,En).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(zi)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(zi)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=he(this,En).build(this,e);return n.isStaleByTime(Op(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(zi).catch(zi)}fetchInfiniteQuery(t){return t.behavior=g2(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(zi).catch(zi)}ensureInfiniteQueryData(t){return t.behavior=g2(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Z0.isOnline()?he(this,Yo).resumePausedMutations():Promise.resolve()}getQueryCache(){return he(this,En)}getMutationCache(){return he(this,Yo)}getDefaultOptions(){return he(this,Zo)}setDefaultOptions(t){Qe(this,Zo,t)}setQueryDefaults(t,e){he(this,Kc).set(ud(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...he(this,Kc).values()],n={};return e.forEach(r=>{hd(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){he(this,$c).set(ud(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...he(this,$c).values()],n={};return e.forEach(r=>{hd(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...he(this,Zo).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=vx(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ix&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...he(this,Zo).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){he(this,En).clear(),he(this,Yo).clear()}},En=new WeakMap,Yo=new WeakMap,Zo=new WeakMap,Kc=new WeakMap,$c=new WeakMap,Jo=new WeakMap,Qc=new WeakMap,Xc=new WeakMap,iI),$4=ne.createContext(void 0),Q4=({client:t,children:e})=>(ne.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),_.jsx($4.Provider,{value:t,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dd(){return dd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dd.apply(this,arguments)}var na;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(na||(na={}));const p2="popstate";function X4(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:l,hash:h}=r.location;return Fp("",{pathname:s,search:l,hash:h},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:J0(i)}return Z4(e,n,null,t)}function Pn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function TT(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Y4(){return Math.random().toString(36).substr(2,8)}function y2(t,e){return{usr:t.state,key:t.key,idx:e}}function Fp(t,e,n,r){return n===void 0&&(n=null),dd({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?bu(e):e,{state:n,key:e&&e.key||r||Y4()})}function J0(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function bu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function Z4(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,l=i.history,h=na.Pop,f=null,m=x();m==null&&(m=0,l.replaceState(dd({},l.state,{idx:m}),""));function x(){return(l.state||{idx:null}).idx}function E(){h=na.Pop;let G=x(),M=G==null?null:G-m;m=G,f&&f({action:h,location:D.location,delta:M})}function A(G,M){h=na.Push;let b=Fp(D.location,G,M);n&&n(b,G),m=x()+1;let P=y2(b,m),V=D.createHref(b);try{l.pushState(P,"",V)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;i.location.assign(V)}s&&f&&f({action:h,location:D.location,delta:1})}function N(G,M){h=na.Replace;let b=Fp(D.location,G,M);n&&n(b,G),m=x();let P=y2(b,m),V=D.createHref(b);l.replaceState(P,"",V),s&&f&&f({action:h,location:D.location,delta:0})}function U(G){let M=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof G=="string"?G:J0(G);return b=b.replace(/ $/,"%20"),Pn(M,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,M)}let D={get action(){return h},get location(){return t(i,l)},listen(G){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(p2,E),f=G,()=>{i.removeEventListener(p2,E),f=null}},createHref(G){return e(i,G)},createURL:U,encodeLocation(G){let M=U(G);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:A,replace:N,go(G){return l.go(G)}};return D}var x2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(x2||(x2={}));function J4(t,e,n){return n===void 0&&(n="/"),eP(t,e,n,!1)}function eP(t,e,n,r){let i=typeof e=="string"?bu(e):e,s=Ax(i.pathname||"/",n);if(s==null)return null;let l=CT(t);tP(l);let h=null;for(let f=0;h==null&&f<l.length;++f){let m=dP(s);h=uP(l[f],m,r)}return h}function CT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,l,h)=>{let f={relativePath:h===void 0?s.path||"":h,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};f.relativePath.startsWith("/")&&(Pn(f.relativePath.startsWith(r),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(r.length));let m=fa([r,f.relativePath]),x=n.concat(f);s.children&&s.children.length>0&&(Pn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),CT(s.children,e,x,m)),!(s.path==null&&!s.index)&&e.push({path:m,score:lP(m,s.index),routesMeta:x})};return t.forEach((s,l)=>{var h;if(s.path===""||!((h=s.path)!=null&&h.includes("?")))i(s,l);else for(let f of ST(s.path))i(s,l,f)}),e}function ST(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let l=ST(r.join("/")),h=[];return h.push(...l.map(f=>f===""?s:[s,f].join("/"))),i&&h.push(...l),h.map(f=>t.startsWith("/")&&f===""?"/":f)}function tP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:cP(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const nP=/^:[\w-]+$/,rP=3,iP=2,sP=1,oP=10,aP=-2,w2=t=>t==="*";function lP(t,e){let n=t.split("/"),r=n.length;return n.some(w2)&&(r+=aP),e&&(r+=iP),n.filter(i=>!w2(i)).reduce((i,s)=>i+(nP.test(s)?rP:s===""?sP:oP),r)}function cP(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function uP(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},s="/",l=[];for(let h=0;h<r.length;++h){let f=r[h],m=h===r.length-1,x=s==="/"?e:e.slice(s.length)||"/",E=_2({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},x),A=f.route;if(!E&&m&&n&&!r[r.length-1].route.index&&(E=_2({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},x)),!E)return null;Object.assign(i,E.params),l.push({params:i,pathname:fa([s,E.pathname]),pathnameBase:pP(fa([s,E.pathnameBase])),route:A}),E.pathnameBase!=="/"&&(s=fa([s,E.pathnameBase]))}return l}function _2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=hP(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],l=s.replace(/(.)\/+$/,"$1"),h=i.slice(1);return{params:r.reduce((m,x,E)=>{let{paramName:A,isOptional:N}=x;if(A==="*"){let D=h[E]||"";l=s.slice(0,s.length-D.length).replace(/(.)\/+$/,"$1")}const U=h[E];return N&&!U?m[A]=void 0:m[A]=(U||"").replace(/%2F/g,"/"),m},{}),pathname:s,pathnameBase:l,pattern:t}}function hP(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),TT(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,h,f)=>(r.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function dP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return TT(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ax(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function fP(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?bu(t):t;return{pathname:n?n.startsWith("/")?n:gP(n,e):e,search:yP(r),hash:xP(i)}}function gP(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function ym(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function mP(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Tx(t,e){let n=mP(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Cx(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=bu(t):(i=dd({},t),Pn(!i.pathname||!i.pathname.includes("?"),ym("?","pathname","search",i)),Pn(!i.pathname||!i.pathname.includes("#"),ym("#","pathname","hash",i)),Pn(!i.search||!i.search.includes("#"),ym("#","search","hash",i)));let s=t===""||i.pathname==="",l=s?"/":i.pathname,h;if(l==null)h=n;else{let E=e.length-1;if(!r&&l.startsWith("..")){let A=l.split("/");for(;A[0]==="..";)A.shift(),E-=1;i.pathname=A.join("/")}h=E>=0?e[E]:"/"}let f=fP(i,h),m=l&&l!=="/"&&l.endsWith("/"),x=(s||l===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||x)&&(f.pathname+="/"),f}const fa=t=>t.join("/").replace(/\/\/+/g,"/"),pP=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),yP=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,xP=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function wP(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const bT=["post","put","patch","delete"];new Set(bT);const _P=["get",...bT];new Set(_P);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fd(){return fd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fd.apply(this,arguments)}const Sx=ne.createContext(null),EP=ne.createContext(null),Na=ne.createContext(null),J1=ne.createContext(null),xo=ne.createContext({outlet:null,matches:[],isDataRoute:!1}),RT=ne.createContext(null);function vP(t,e){let{relative:n}=e===void 0?{}:e;Ru()||Pn(!1);let{basename:r,navigator:i}=ne.useContext(Na),{hash:s,pathname:l,search:h}=DT(t,{relative:n}),f=l;return r!=="/"&&(f=l==="/"?r:fa([r,l])),i.createHref({pathname:f,search:h,hash:s})}function Ru(){return ne.useContext(J1)!=null}function Vd(){return Ru()||Pn(!1),ne.useContext(J1).location}function NT(t){ne.useContext(Na).static||ne.useLayoutEffect(t)}function ir(){let{isDataRoute:t}=ne.useContext(xo);return t?MP():IP()}function IP(){Ru()||Pn(!1);let t=ne.useContext(Sx),{basename:e,future:n,navigator:r}=ne.useContext(Na),{matches:i}=ne.useContext(xo),{pathname:s}=Vd(),l=JSON.stringify(Tx(i,n.v7_relativeSplatPath)),h=ne.useRef(!1);return NT(()=>{h.current=!0}),ne.useCallback(function(m,x){if(x===void 0&&(x={}),!h.current)return;if(typeof m=="number"){r.go(m);return}let E=Cx(m,JSON.parse(l),s,x.relative==="path");t==null&&e!=="/"&&(E.pathname=E.pathname==="/"?e:fa([e,E.pathname])),(x.replace?r.replace:r.push)(E,x.state,x)},[e,r,l,s,t])}function PT(){let{matches:t}=ne.useContext(xo),e=t[t.length-1];return e?e.params:{}}function DT(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=ne.useContext(Na),{matches:i}=ne.useContext(xo),{pathname:s}=Vd(),l=JSON.stringify(Tx(i,r.v7_relativeSplatPath));return ne.useMemo(()=>Cx(t,JSON.parse(l),s,n==="path"),[t,l,s,n])}function AP(t,e){return TP(t,e)}function TP(t,e,n,r){Ru()||Pn(!1);let{navigator:i}=ne.useContext(Na),{matches:s}=ne.useContext(xo),l=s[s.length-1],h=l?l.params:{};l&&l.pathname;let f=l?l.pathnameBase:"/";l&&l.route;let m=Vd(),x;if(e){var E;let G=typeof e=="string"?bu(e):e;f==="/"||(E=G.pathname)!=null&&E.startsWith(f)||Pn(!1),x=G}else x=m;let A=x.pathname||"/",N=A;if(f!=="/"){let G=f.replace(/^\//,"").split("/");N="/"+A.replace(/^\//,"").split("/").slice(G.length).join("/")}let U=J4(t,{pathname:N}),D=NP(U&&U.map(G=>Object.assign({},G,{params:Object.assign({},h,G.params),pathname:fa([f,i.encodeLocation?i.encodeLocation(G.pathname).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?f:fa([f,i.encodeLocation?i.encodeLocation(G.pathnameBase).pathname:G.pathnameBase])})),s,n,r);return e&&D?ne.createElement(J1.Provider,{value:{location:fd({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:na.Pop}},D):D}function CP(){let t=OP(),e=wP(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},e),n?ne.createElement("pre",{style:i},n):null,s)}const SP=ne.createElement(CP,null);class bP extends ne.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?ne.createElement(xo.Provider,{value:this.props.routeContext},ne.createElement(RT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RP(t){let{routeContext:e,match:n,children:r}=t,i=ne.useContext(Sx);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),ne.createElement(xo.Provider,{value:e},r)}function NP(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,h=(i=n)==null?void 0:i.errors;if(h!=null){let x=l.findIndex(E=>E.route.id&&(h==null?void 0:h[E.route.id])!==void 0);x>=0||Pn(!1),l=l.slice(0,Math.min(l.length,x+1))}let f=!1,m=-1;if(n&&r&&r.v7_partialHydration)for(let x=0;x<l.length;x++){let E=l[x];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(m=x),E.route.id){let{loaderData:A,errors:N}=n,U=E.route.loader&&A[E.route.id]===void 0&&(!N||N[E.route.id]===void 0);if(E.route.lazy||U){f=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((x,E,A)=>{let N,U=!1,D=null,G=null;n&&(N=h&&E.route.id?h[E.route.id]:void 0,D=E.route.errorElement||SP,f&&(m<0&&A===0?(LP("route-fallback",!1),U=!0,G=null):m===A&&(U=!0,G=E.route.hydrateFallbackElement||null)));let M=e.concat(l.slice(0,A+1)),b=()=>{let P;return N?P=D:U?P=G:E.route.Component?P=ne.createElement(E.route.Component,null):E.route.element?P=E.route.element:P=x,ne.createElement(RP,{match:E,routeContext:{outlet:x,matches:M,isDataRoute:n!=null},children:P})};return n&&(E.route.ErrorBoundary||E.route.errorElement||A===0)?ne.createElement(bP,{location:n.location,revalidation:n.revalidation,component:D,error:N,children:b(),routeContext:{outlet:null,matches:M,isDataRoute:!0}}):b()},null)}var kT=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(kT||{}),e1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(e1||{});function PP(t){let e=ne.useContext(Sx);return e||Pn(!1),e}function DP(t){let e=ne.useContext(EP);return e||Pn(!1),e}function kP(t){let e=ne.useContext(xo);return e||Pn(!1),e}function OT(t){let e=kP(),n=e.matches[e.matches.length-1];return n.route.id||Pn(!1),n.route.id}function OP(){var t;let e=ne.useContext(RT),n=DP(e1.UseRouteError),r=OT(e1.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function MP(){let{router:t}=PP(kT.UseNavigateStable),e=OT(e1.UseNavigateStable),n=ne.useRef(!1);return NT(()=>{n.current=!0}),ne.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,fd({fromRouteId:e},s)))},[t,e])}const E2={};function LP(t,e,n){!e&&!E2[t]&&(E2[t]=!0)}function FP(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function vr(t){let{to:e,replace:n,state:r,relative:i}=t;Ru()||Pn(!1);let{future:s,static:l}=ne.useContext(Na),{matches:h}=ne.useContext(xo),{pathname:f}=Vd(),m=ir(),x=Cx(e,Tx(h,s.v7_relativeSplatPath),f,i==="path"),E=JSON.stringify(x);return ne.useEffect(()=>m(JSON.parse(E),{replace:n,state:r,relative:i}),[m,E,i,n,r]),null}function Ir(t){Pn(!1)}function VP(t){let{basename:e="/",children:n=null,location:r,navigationType:i=na.Pop,navigator:s,static:l=!1,future:h}=t;Ru()&&Pn(!1);let f=e.replace(/^\/*/,"/"),m=ne.useMemo(()=>({basename:f,navigator:s,static:l,future:fd({v7_relativeSplatPath:!1},h)}),[f,h,s,l]);typeof r=="string"&&(r=bu(r));let{pathname:x="/",search:E="",hash:A="",state:N=null,key:U="default"}=r,D=ne.useMemo(()=>{let G=Ax(x,f);return G==null?null:{location:{pathname:G,search:E,hash:A,state:N,key:U},navigationType:i}},[f,x,E,A,N,U,i]);return D==null?null:ne.createElement(Na.Provider,{value:m},ne.createElement(J1.Provider,{children:n,value:D}))}function BP(t){let{children:e,location:n}=t;return AP(Vp(e),n)}new Promise(()=>{});function Vp(t,e){e===void 0&&(e=[]);let n=[];return ne.Children.forEach(t,(r,i)=>{if(!ne.isValidElement(r))return;let s=[...e,i];if(r.type===ne.Fragment){n.push.apply(n,Vp(r.props.children,s));return}r.type!==Ir&&Pn(!1),!r.props.index||!r.props.children||Pn(!1);let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Vp(r.props.children,s)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bp(){return Bp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bp.apply(this,arguments)}function UP(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function jP(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function zP(t,e){return t.button===0&&(!e||e==="_self")&&!jP(t)}const GP=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qP="6";try{window.__reactRouterVersion=qP}catch{}const HP="startTransition",v2=u3[HP];function WP(t){let{basename:e,children:n,future:r,window:i}=t,s=ne.useRef();s.current==null&&(s.current=X4({window:i,v5Compat:!0}));let l=s.current,[h,f]=ne.useState({action:l.action,location:l.location}),{v7_startTransition:m}=r||{},x=ne.useCallback(E=>{m&&v2?v2(()=>f(E)):f(E)},[f,m]);return ne.useLayoutEffect(()=>l.listen(x),[l,x]),ne.useEffect(()=>FP(r),[r]),ne.createElement(VP,{basename:e,children:n,location:h.location,navigationType:h.action,navigator:l,future:r})}const KP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$P=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gf=ne.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:l,state:h,target:f,to:m,preventScrollReset:x,viewTransition:E}=e,A=UP(e,GP),{basename:N}=ne.useContext(Na),U,D=!1;if(typeof m=="string"&&$P.test(m)&&(U=m,KP))try{let P=new URL(window.location.href),V=m.startsWith("//")?new URL(P.protocol+m):new URL(m),$=Ax(V.pathname,N);V.origin===P.origin&&$!=null?m=$+V.search+V.hash:D=!0}catch{}let G=vP(m,{relative:i}),M=QP(m,{replace:l,state:h,target:f,preventScrollReset:x,relative:i,viewTransition:E});function b(P){r&&r(P),P.defaultPrevented||M(P)}return ne.createElement("a",Bp({},A,{href:U||G,onClick:D||s?r:b,ref:n,target:f}))});var I2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(I2||(I2={}));var A2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(A2||(A2={}));function QP(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:l,viewTransition:h}=e===void 0?{}:e,f=ir(),m=Vd(),x=DT(t,{relative:l});return ne.useCallback(E=>{if(zP(E,n)){E.preventDefault();let A=r!==void 0?r:J0(m)===J0(x);f(t,{replace:A,state:i,preventScrollReset:s,relative:l,viewTransition:h})}},[m,f,x,r,i,n,t,s,l,h])}let XP={data:""},YP=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||XP,ZP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,JP=/\/\*[^]*?\*\/|  +/g,T2=/\n+/g,Bo=(t,e)=>{let n="",r="",i="";for(let s in t){let l=t[s];s[0]=="@"?s[1]=="i"?n=s+" "+l+";":r+=s[1]=="f"?Bo(l,s):s+"{"+Bo(l,s[1]=="k"?"":e)+"}":typeof l=="object"?r+=Bo(l,e?e.replace(/([^,])+/g,h=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,h):h?h+" "+f:f)):s):l!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Bo.p?Bo.p(s,l):s+":"+l+";")}return n+(e&&i?e+"{"+i+"}":i)+r},Hs={},MT=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+MT(t[n]);return e}return t},e8=(t,e,n,r,i)=>{let s=MT(t),l=Hs[s]||(Hs[s]=(f=>{let m=0,x=11;for(;m<f.length;)x=101*x+f.charCodeAt(m++)>>>0;return"go"+x})(s));if(!Hs[l]){let f=s!==t?t:(m=>{let x,E,A=[{}];for(;x=ZP.exec(m.replace(JP,""));)x[4]?A.shift():x[3]?(E=x[3].replace(T2," ").trim(),A.unshift(A[0][E]=A[0][E]||{})):A[0][x[1]]=x[2].replace(T2," ").trim();return A[0]})(t);Hs[l]=Bo(i?{["@keyframes "+l]:f}:f,n?"":"."+l)}let h=n&&Hs.g?Hs.g:null;return n&&(Hs.g=Hs[l]),((f,m,x,E)=>{E?m.data=m.data.replace(E,f):m.data.indexOf(f)===-1&&(m.data=x?f+m.data:m.data+f)})(Hs[l],e,r,h),l},t8=(t,e,n)=>t.reduce((r,i,s)=>{let l=e[s];if(l&&l.call){let h=l(n),f=h&&h.props&&h.props.className||/^go/.test(h)&&h;l=f?"."+f:h&&typeof h=="object"?h.props?"":Bo(h,""):h===!1?"":h}return r+i+(l??"")},"");function eg(t){let e=this||{},n=t.call?t(e.p):t;return e8(n.unshift?n.raw?t8(n,[].slice.call(arguments,1),e.p):n.reduce((r,i)=>Object.assign(r,i&&i.call?i(e.p):i),{}):n,YP(e.target),e.g,e.o,e.k)}let LT,Up,jp;eg.bind({g:1});let co=eg.bind({k:1});function n8(t,e,n,r){Bo.p=e,LT=t,Up=n,jp=r}function Pa(t,e){let n=this||{};return function(){let r=arguments;function i(s,l){let h=Object.assign({},s),f=h.className||i.className;n.p=Object.assign({theme:Up&&Up()},h),n.o=/ *go\d+/.test(f),h.className=eg.apply(n,r)+(f?" "+f:""),e&&(h.ref=l);let m=t;return t[0]&&(m=h.as||t,delete h.as),jp&&m[0]&&jp(h),LT(m,h)}return e?e(i):i}}var r8=t=>typeof t=="function",t1=(t,e)=>r8(t)?t(e):t,i8=(()=>{let t=0;return()=>(++t).toString()})(),FT=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),s8=20,bx="default",VT=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(l=>l.id===e.toast.id?{...l,...e.toast}:l)};case 2:let{toast:r}=e;return VT(t,{type:t.toasts.find(l=>l.id===r.id)?1:0,toast:r});case 3:let{toastId:i}=e;return{...t,toasts:t.toasts.map(l=>l.id===i||i===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(l=>l.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let s=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+s}))}}},g0=[],BT={toasts:[],pausedAt:void 0,settings:{toastLimit:s8}},ws={},UT=(t,e=bx)=>{ws[e]=VT(ws[e]||BT,t),g0.forEach(([n,r])=>{n===e&&r(ws[e])})},jT=t=>Object.keys(ws).forEach(e=>UT(t,e)),o8=t=>Object.keys(ws).find(e=>ws[e].toasts.some(n=>n.id===t)),tg=(t=bx)=>e=>{UT(e,t)},a8={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},l8=(t={},e=bx)=>{let[n,r]=ne.useState(ws[e]||BT),i=ne.useRef(ws[e]);ne.useEffect(()=>(i.current!==ws[e]&&r(ws[e]),g0.push([e,r]),()=>{let l=g0.findIndex(([h])=>h===e);l>-1&&g0.splice(l,1)}),[e]);let s=n.toasts.map(l=>{var h,f,m;return{...t,...t[l.type],...l,removeDelay:l.removeDelay||((h=t[l.type])==null?void 0:h.removeDelay)||(t==null?void 0:t.removeDelay),duration:l.duration||((f=t[l.type])==null?void 0:f.duration)||(t==null?void 0:t.duration)||a8[l.type],style:{...t.style,...(m=t[l.type])==null?void 0:m.style,...l.style}}});return{...n,toasts:s}},c8=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||i8()}),Bd=t=>(e,n)=>{let r=c8(e,t,n);return tg(r.toasterId||o8(r.id))({type:2,toast:r}),r.id},Wn=(t,e)=>Bd("blank")(t,e);Wn.error=Bd("error");Wn.success=Bd("success");Wn.loading=Bd("loading");Wn.custom=Bd("custom");Wn.dismiss=(t,e)=>{let n={type:3,toastId:t};e?tg(e)(n):jT(n)};Wn.dismissAll=t=>Wn.dismiss(void 0,t);Wn.remove=(t,e)=>{let n={type:4,toastId:t};e?tg(e)(n):jT(n)};Wn.removeAll=t=>Wn.remove(void 0,t);Wn.promise=(t,e,n)=>{let r=Wn.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let s=e.success?t1(e.success,i):void 0;return s?Wn.success(s,{id:r,...n,...n==null?void 0:n.success}):Wn.dismiss(r),i}).catch(i=>{let s=e.error?t1(e.error,i):void 0;s?Wn.error(s,{id:r,...n,...n==null?void 0:n.error}):Wn.dismiss(r)}),t};var u8=1e3,h8=(t,e="default")=>{let{toasts:n,pausedAt:r}=l8(t,e),i=ne.useRef(new Map).current,s=ne.useCallback((E,A=u8)=>{if(i.has(E))return;let N=setTimeout(()=>{i.delete(E),l({type:4,toastId:E})},A);i.set(E,N)},[]);ne.useEffect(()=>{if(r)return;let E=Date.now(),A=n.map(N=>{if(N.duration===1/0)return;let U=(N.duration||0)+N.pauseDuration-(E-N.createdAt);if(U<0){N.visible&&Wn.dismiss(N.id);return}return setTimeout(()=>Wn.dismiss(N.id,e),U)});return()=>{A.forEach(N=>N&&clearTimeout(N))}},[n,r,e]);let l=ne.useCallback(tg(e),[e]),h=ne.useCallback(()=>{l({type:5,time:Date.now()})},[l]),f=ne.useCallback((E,A)=>{l({type:1,toast:{id:E,height:A}})},[l]),m=ne.useCallback(()=>{r&&l({type:6,time:Date.now()})},[r,l]),x=ne.useCallback((E,A)=>{let{reverseOrder:N=!1,gutter:U=8,defaultPosition:D}=A||{},G=n.filter(P=>(P.position||D)===(E.position||D)&&P.height),M=G.findIndex(P=>P.id===E.id),b=G.filter((P,V)=>V<M&&P.visible).length;return G.filter(P=>P.visible).slice(...N?[b+1]:[0,b]).reduce((P,V)=>P+(V.height||0)+U,0)},[n]);return ne.useEffect(()=>{n.forEach(E=>{if(E.dismissed)s(E.id,E.removeDelay);else{let A=i.get(E.id);A&&(clearTimeout(A),i.delete(E.id))}})},[n,s]),{toasts:n,handlers:{updateHeight:f,startPause:h,endPause:m,calculateOffset:x}}},d8=co`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,f8=co`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,g8=co`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,m8=Pa("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${d8} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${f8} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${g8} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,p8=co`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,y8=Pa("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${p8} 1s linear infinite;
`,x8=co`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,w8=co`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_8=Pa("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${x8} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${w8} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,E8=Pa("div")`
  position: absolute;
`,v8=Pa("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,I8=co`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,A8=Pa("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${I8} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,T8=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?ne.createElement(A8,null,e):e:n==="blank"?null:ne.createElement(v8,null,ne.createElement(y8,{...r}),n!=="loading"&&ne.createElement(E8,null,n==="error"?ne.createElement(m8,{...r}):ne.createElement(_8,{...r})))},C8=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,S8=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,b8="0%{opacity:0;} 100%{opacity:1;}",R8="0%{opacity:1;} 100%{opacity:0;}",N8=Pa("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,P8=Pa("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,D8=(t,e)=>{let n=t.includes("top")?1:-1,[r,i]=FT()?[b8,R8]:[C8(n),S8(n)];return{animation:e?`${co(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${co(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},k8=ne.memo(({toast:t,position:e,style:n,children:r})=>{let i=t.height?D8(t.position||e||"top-center",t.visible):{opacity:0},s=ne.createElement(T8,{toast:t}),l=ne.createElement(P8,{...t.ariaProps},t1(t.message,t));return ne.createElement(N8,{className:t.className,style:{...i,...n,...t.style}},typeof r=="function"?r({icon:s,message:l}):ne.createElement(ne.Fragment,null,s,l))});n8(ne.createElement);var O8=({id:t,className:e,style:n,onHeightUpdate:r,children:i})=>{let s=ne.useCallback(l=>{if(l){let h=()=>{let f=l.getBoundingClientRect().height;r(t,f)};h(),new MutationObserver(h).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return ne.createElement("div",{ref:s,className:e,style:n},i)},M8=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:FT()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...i}},L8=eg`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,qf=16,F8=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:i,toasterId:s,containerStyle:l,containerClassName:h})=>{let{toasts:f,handlers:m}=h8(n,s);return ne.createElement("div",{"data-rht-toaster":s||"",style:{position:"fixed",zIndex:9999,top:qf,left:qf,right:qf,bottom:qf,pointerEvents:"none",...l},className:h,onMouseEnter:m.startPause,onMouseLeave:m.endPause},f.map(x=>{let E=x.position||e,A=m.calculateOffset(x,{reverseOrder:t,gutter:r,defaultPosition:e}),N=M8(E,A);return ne.createElement(O8,{id:x.id,key:x.id,onHeightUpdate:m.updateHeight,className:x.visible?L8:"",style:N},x.type==="custom"?t1(x.message,x):i?i(x):ne.createElement(k8,{toast:x,position:E}))}))},Fe=Wn;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},V8=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],l=t[n++],h=t[n++],f=((i&7)<<18|(s&63)<<12|(l&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const s=t[n++],l=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|l&63)}}return e.join("")},GT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],l=i+1<t.length,h=l?t[i+1]:0,f=i+2<t.length,m=f?t[i+2]:0,x=s>>2,E=(s&3)<<4|h>>4;let A=(h&15)<<2|m>>6,N=m&63;f||(N=64,l||(A=64)),r.push(n[x],n[E],n[A],n[N])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):V8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],h=i<t.length?n[t.charAt(i)]:0;++i;const m=i<t.length?n[t.charAt(i)]:64;++i;const E=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||h==null||m==null||E==null)throw new B8;const A=s<<2|h>>4;if(r.push(A),m!==64){const N=h<<4&240|m>>2;if(r.push(N),E!==64){const U=m<<6&192|E;r.push(U)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class B8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const U8=function(t){const e=zT(t);return GT.encodeByteArray(e,!0)},n1=function(t){return U8(t).replace(/\./g,"")},qT=function(t){try{return GT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z8=()=>j8().__FIREBASE_DEFAULTS__,G8=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},q8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&qT(t[1]);return e&&JSON.parse(e)},ng=()=>{try{return z8()||G8()||q8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},HT=t=>{var e,n;return(n=(e=ng())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Rx=t=>{const e=HT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},WT=()=>{var t;return(t=ng())===null||t===void 0?void 0:t.config},KT=t=>{var e;return(e=ng())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),h="";return[n1(JSON.stringify(n)),n1(JSON.stringify(l)),h].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function W8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($n())}function K8(){var t;const e=(t=ng())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Q8(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function X8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Y8(){const t=$n();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function QT(){return!K8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function XT(){try{return typeof indexedDB=="object"}catch{return!1}}function Z8(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J8="FirebaseError";class Ds extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=J8,Object.setPrototypeOf(this,Ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ud.prototype.create)}}class Ud{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],l=s?eD(s,r):"Error",h=`${this.serviceName}: ${l} (${i}).`;return new Ds(i,h,r)}}function eD(t,e){return t.replace(tD,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const tD=/\{\$([^}]+)}/g;function nD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function xa(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],l=e[i];if(C2(s)&&C2(l)){if(!xa(s,l))return!1}else if(s!==l)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function C2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function vh(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ih(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function rD(t,e){const n=new iD(t,e);return n.subscribe.bind(n)}class iD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");sD(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=xm),i.error===void 0&&(i.error=xm),i.complete===void 0&&(i.complete=xm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function xm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t){return t&&t._delegate?t._delegate:t}class uo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new H8;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lD(e))try{this.getOrInitializeService({instanceIdentifier:Ja})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ja){return this.instances.has(e)}getOptions(e=Ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(s);r===h&&l.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const l=this.instances.get(i);return l&&e(l,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aD(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ja){return this.component?this.component.multipleInstances?e:Ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aD(t){return t===Ja?void 0:t}function lD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new oD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ut||(ut={}));const uD={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},hD=ut.INFO,dD={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},fD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=dD[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nx{constructor(e){this.name=e,this._logLevel=hD,this._logHandler=fD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?uD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const gD=(t,e)=>e.some(n=>t instanceof n);let S2,b2;function mD(){return S2||(S2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pD(){return b2||(b2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YT=new WeakMap,zp=new WeakMap,ZT=new WeakMap,wm=new WeakMap,Px=new WeakMap;function yD(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",l)},s=()=>{n(ga(t.result)),i()},l=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",l)});return e.then(n=>{n instanceof IDBCursor&&YT.set(n,t)}).catch(()=>{}),Px.set(e,t),e}function xD(t){if(zp.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",l),t.removeEventListener("abort",l)},s=()=>{n(),i()},l=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",l),t.addEventListener("abort",l)});zp.set(t,e)}let Gp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return zp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ZT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ga(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wD(t){Gp=t(Gp)}function _D(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_m(this),e,...n);return ZT.set(r,e.sort?e.sort():[e]),ga(r)}:pD().includes(t)?function(...e){return t.apply(_m(this),e),ga(YT.get(this))}:function(...e){return ga(t.apply(_m(this),e))}}function ED(t){return typeof t=="function"?_D(t):(t instanceof IDBTransaction&&xD(t),gD(t,mD())?new Proxy(t,Gp):t)}function ga(t){if(t instanceof IDBRequest)return yD(t);if(wm.has(t))return wm.get(t);const e=ED(t);return e!==t&&(wm.set(t,e),Px.set(e,t)),e}const _m=t=>Px.get(t);function vD(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const l=indexedDB.open(t,e),h=ga(l);return r&&l.addEventListener("upgradeneeded",f=>{r(ga(l.result),f.oldVersion,f.newVersion,ga(l.transaction),f)}),n&&l.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),h.then(f=>{s&&f.addEventListener("close",()=>s()),i&&f.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const ID=["get","getKey","getAll","getAllKeys","count"],AD=["put","add","delete","clear"],Em=new Map;function R2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Em.get(e))return Em.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=AD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ID.includes(n)))return;const s=async function(l,...h){const f=this.transaction(l,i?"readwrite":"readonly");let m=f.store;return r&&(m=m.index(h.shift())),(await Promise.all([m[n](...h),i&&f.done]))[0]};return Em.set(e,s),s}wD(t=>({...t,get:(e,n,r)=>R2(e,n)||t.get(e,n,r),has:(e,n)=>!!R2(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(CD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function CD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qp="@firebase/app",N2="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=new Nx("@firebase/app"),SD="@firebase/app-compat",bD="@firebase/analytics-compat",RD="@firebase/analytics",ND="@firebase/app-check-compat",PD="@firebase/app-check",DD="@firebase/auth",kD="@firebase/auth-compat",OD="@firebase/database",MD="@firebase/data-connect",LD="@firebase/database-compat",FD="@firebase/functions",VD="@firebase/functions-compat",BD="@firebase/installations",UD="@firebase/installations-compat",jD="@firebase/messaging",zD="@firebase/messaging-compat",GD="@firebase/performance",qD="@firebase/performance-compat",HD="@firebase/remote-config",WD="@firebase/remote-config-compat",KD="@firebase/storage",$D="@firebase/storage-compat",QD="@firebase/firestore",XD="@firebase/vertexai-preview",YD="@firebase/firestore-compat",ZD="firebase",JD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r1="[DEFAULT]",e6={[qp]:"fire-core",[SD]:"fire-core-compat",[RD]:"fire-analytics",[bD]:"fire-analytics-compat",[PD]:"fire-app-check",[ND]:"fire-app-check-compat",[DD]:"fire-auth",[kD]:"fire-auth-compat",[OD]:"fire-rtdb",[MD]:"fire-data-connect",[LD]:"fire-rtdb-compat",[FD]:"fire-fn",[VD]:"fire-fn-compat",[BD]:"fire-iid",[UD]:"fire-iid-compat",[jD]:"fire-fcm",[zD]:"fire-fcm-compat",[GD]:"fire-perf",[qD]:"fire-perf-compat",[HD]:"fire-rc",[WD]:"fire-rc-compat",[KD]:"fire-gcs",[$D]:"fire-gcs-compat",[QD]:"fire-fst",[YD]:"fire-fst-compat",[XD]:"fire-vertex","fire-js":"fire-js",[ZD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1=new Map,t6=new Map,Hp=new Map;function P2(t,e){try{t.container.addComponent(e)}catch(n){ho.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function wa(t){const e=t.name;if(Hp.has(e))return ho.debug(`There were multiple attempts to register component ${e}.`),!1;Hp.set(e,t);for(const n of i1.values())P2(n,t);for(const n of t6.values())P2(n,t);return!0}function Ul(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function n6(t,e,n=r1){Ul(t,e).clearInstance(n)}function Qi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ma=new Ud("app","Firebase",r6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new uo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ma.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=JD;function JT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:r1,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ma.create("bad-app-name",{appName:String(i)});if(n||(n=WT()),!n)throw ma.create("no-options");const s=i1.get(i);if(s){if(xa(n,s.options)&&xa(r,s.config))return s;throw ma.create("duplicate-app",{appName:i})}const l=new cD(i);for(const f of Hp.values())l.addComponent(f);const h=new i6(n,r,l);return i1.set(i,h),h}function rg(t=r1){const e=i1.get(t);if(!e&&t===r1&&WT())return JT();if(!e)throw ma.create("no-app",{appName:t});return e}function Ti(t,e,n){var r;let i=(r=e6[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),l=e.match(/\s|\//);if(s||l){const h=[`Unable to register library "${i}" with version "${e}":`];s&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&l&&h.push("and"),l&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ho.warn(h.join(" "));return}wa(new uo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6="firebase-heartbeat-database",o6=1,gd="firebase-heartbeat-store";let vm=null;function eC(){return vm||(vm=vD(s6,o6,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(gd)}catch(n){console.warn(n)}}}}).catch(t=>{throw ma.create("idb-open",{originalErrorMessage:t.message})})),vm}async function a6(t){try{const n=(await eC()).transaction(gd),r=await n.objectStore(gd).get(tC(t));return await n.done,r}catch(e){if(e instanceof Ds)ho.warn(e.message);else{const n=ma.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ho.warn(n.message)}}}async function D2(t,e){try{const r=(await eC()).transaction(gd,"readwrite");await r.objectStore(gd).put(e,tC(t)),await r.done}catch(n){if(n instanceof Ds)ho.warn(n.message);else{const r=ma.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ho.warn(r.message)}}}function tC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6=1024,c6=30*24*60*60*1e3;class u6{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new d6(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=k2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(l=>l.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(l=>{const h=new Date(l.date).valueOf();return Date.now()-h<=c6}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ho.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=k2(),{heartbeatsToSend:r,unsentEntries:i}=h6(this._heartbeatsCache.heartbeats),s=n1(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return ho.warn(n),""}}}function k2(){return new Date().toISOString().substring(0,10)}function h6(t,e=l6){const n=[];let r=t.slice();for(const i of t){const s=n.find(l=>l.agent===i.agent);if(s){if(s.dates.push(i.date),O2(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),O2(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class d6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return XT()?Z8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await a6(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return D2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return D2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function O2(t){return n1(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f6(t){wa(new uo("platform-logger",e=>new TD(e),"PRIVATE")),wa(new uo("heartbeat",e=>new u6(e),"PRIVATE")),Ti(qp,N2,t),Ti(qp,N2,"esm2017"),Ti("fire-js","")}f6("");function Dx(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function nC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const g6=nC,rC=new Ud("auth","Firebase",nC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=new Nx("@firebase/auth");function m6(t,...e){s1.logLevel<=ut.WARN&&s1.warn(`Auth (${jl}): ${t}`,...e)}function m0(t,...e){s1.logLevel<=ut.ERROR&&s1.error(`Auth (${jl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(t,...e){throw kx(t,...e)}function As(t,...e){return kx(t,...e)}function iC(t,e,n){const r=Object.assign(Object.assign({},g6()),{[e]:n});return new Ud("auth","Firebase",r).create(e,{appName:t.name})}function Ts(t){return iC(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kx(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return rC.create(t,...e)}function Ke(t,e,...n){if(!t)throw kx(e,...n)}function eo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw m0(e),new Error(e)}function fo(t,e){t||eo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function p6(){return M2()==="http:"||M2()==="https:"}function M2(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(p6()||Q8()||"connection"in navigator)?navigator.onLine:!0}function x6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,n){this.shortDelay=e,this.longDelay=n,fo(n>e,"Short delay should be less than long delay!"),this.isMobile=W8()||X8()}get(){return y6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ox(t,e){fo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;eo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;eo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;eo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6=new zd(3e4,6e4);function Da(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ks(t,e,n,r,i={}){return oC(t,i,async()=>{let s={},l={};r&&(e==="GET"?l=r:s={body:JSON.stringify(r)});const h=jd(Object.assign({key:t.config.apiKey},l)).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const m=Object.assign({method:e,headers:f},s);return $8()||(m.referrerPolicy="no-referrer"),sC.fetch()(aC(t,t.config.apiHost,n,h),m)})}async function oC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},w6),e);try{const i=new v6(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const l=await s.json();if("needConfirmation"in l)throw Hf(t,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{const h=s.ok?l.errorMessage:l.error.message,[f,m]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hf(t,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Hf(t,"email-already-in-use",l);if(f==="USER_DISABLED")throw Hf(t,"user-disabled",l);const x=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw iC(t,x,m);es(t,x)}}catch(i){if(i instanceof Ds)throw i;es(t,"network-request-failed",{message:String(i)})}}async function Gd(t,e,n,r,i={}){const s=await ks(t,e,n,r,i);return"mfaPendingCredential"in s&&es(t,"multi-factor-auth-required",{_serverResponse:s}),s}function aC(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Ox(t.config,i):`${t.config.apiScheme}://${i}`}function E6(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class v6{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(As(this.auth,"network-request-failed")),_6.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Hf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=As(t,e,r);return i.customData._tokenResponse=n,i}function L2(t){return t!==void 0&&t.enterprise!==void 0}class I6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return E6(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function A6(t,e){return ks(t,"GET","/v2/recaptchaConfig",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T6(t,e){return ks(t,"POST","/v1/accounts:delete",e)}async function lC(t,e){return ks(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function C6(t,e=!1){const n=mt(t),r=await n.getIdToken(e),i=Mx(r);Ke(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,l=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Fh(Im(i.auth_time)),issuedAtTime:Fh(Im(i.iat)),expirationTime:Fh(Im(i.exp)),signInProvider:l||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Im(t){return Number(t)*1e3}function Mx(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return m0("JWT malformed, contained fewer than 3 sections"),null;try{const i=qT(n);return i?JSON.parse(i):(m0("Failed to decode base64 JWT payload"),null)}catch(i){return m0("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function F2(t){const e=Mx(t);return Ke(e,"internal-error"),Ke(typeof e.exp<"u","internal-error"),Ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ds&&S6(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function S6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fh(this.lastLoginAt),this.creationTime=Fh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o1(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Tl(t,lC(n,{idToken:r}));Ke(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const l=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?cC(s.providerUserInfo):[],h=N6(t.providerData,l),f=t.isAnonymous,m=!(t.email&&s.passwordHash)&&!(h!=null&&h.length),x=f?m:!1,E={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:h,metadata:new Kp(s.createdAt,s.lastLoginAt),isAnonymous:x};Object.assign(t,E)}async function R6(t){const e=mt(t);await o1(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N6(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function cC(t){return t.map(e=>{var{providerId:n}=e,r=Dx(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P6(t,e){const n=await oC(t,{},async()=>{const r=jd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,l=aC(t,i,"/v1/token",`key=${s}`),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",sC.fetch()(l,{method:"POST",headers:h,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function D6(t,e){return ks(t,"POST","/v2/accounts:revokeToken",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ke(e.idToken,"internal-error"),Ke(typeof e.idToken<"u","internal-error"),Ke(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):F2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ke(e.length!==0,"internal-error");const n=F2(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await P6(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,l=new Fc;return r&&(Ke(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),i&&(Ke(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),s&&(Ke(typeof s=="number","internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fc,this.toJSON())}_performRefresh(){return eo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(t,e){Ke(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class to{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=Dx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new b6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Kp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Tl(this,this.stsTokenManager.getToken(this.auth,e));return Ke(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return C6(this,e)}reload(){return R6(this)}_assign(e){this!==e&&(Ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new to(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await o1(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qi(this.auth.app))return Promise.reject(Ts(this.auth));const e=await this.getIdToken();return await Tl(this,T6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,l,h,f,m,x;const E=(r=n.displayName)!==null&&r!==void 0?r:void 0,A=(i=n.email)!==null&&i!==void 0?i:void 0,N=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,U=(l=n.photoURL)!==null&&l!==void 0?l:void 0,D=(h=n.tenantId)!==null&&h!==void 0?h:void 0,G=(f=n._redirectEventId)!==null&&f!==void 0?f:void 0,M=(m=n.createdAt)!==null&&m!==void 0?m:void 0,b=(x=n.lastLoginAt)!==null&&x!==void 0?x:void 0,{uid:P,emailVerified:V,isAnonymous:$,providerData:J,stsTokenManager:k}=n;Ke(P&&k,e,"internal-error");const L=Fc.fromJSON(this.name,k);Ke(typeof P=="string",e,"internal-error"),No(E,e.name),No(A,e.name),Ke(typeof V=="boolean",e,"internal-error"),Ke(typeof $=="boolean",e,"internal-error"),No(N,e.name),No(U,e.name),No(D,e.name),No(G,e.name),No(M,e.name),No(b,e.name);const F=new to({uid:P,auth:e,email:A,emailVerified:V,displayName:E,isAnonymous:$,photoURL:U,phoneNumber:N,tenantId:D,stsTokenManager:L,createdAt:M,lastLoginAt:b});return J&&Array.isArray(J)&&(F.providerData=J.map(H=>Object.assign({},H))),G&&(F._redirectEventId=G),F}static async _fromIdTokenResponse(e,n,r=!1){const i=new Fc;i.updateFromServerResponse(n);const s=new to({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await o1(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];Ke(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?cC(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),h=new Fc;h.updateFromIdToken(r);const f=new to({uid:i.localId,auth:e,stsTokenManager:h,isAnonymous:l}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Kp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=new Map;function no(t){fo(t instanceof Function,"Expected a class definition");let e=V2.get(t);return e?(fo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,V2.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}uC.type="NONE";const B2=uC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(t,e,n){return`firebase:${t}:${e}:${n}`}class Vc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=p0(this.userKey,i.apiKey,s),this.fullPersistenceKey=p0("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?to._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Vc(no(B2),e,r);const i=(await Promise.all(n.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let s=i[0]||no(B2);const l=p0(r,e.config.apiKey,e.name);let h=null;for(const m of n)try{const x=await m._get(l);if(x){const E=to._fromJSON(e,x);m!==s&&(h=E),s=m;break}}catch{}const f=i.filter(m=>m._shouldAllowMigration);return!s._shouldAllowMigration||!f.length?new Vc(s,e,r):(s=f[0],h&&await s._set(l,h.toJSON()),await Promise.all(n.map(async m=>{if(m!==s)try{await m._remove(l)}catch{}})),new Vc(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pC(e))return"Blackberry";if(yC(e))return"Webos";if(dC(e))return"Safari";if((e.includes("chrome/")||fC(e))&&!e.includes("edge/"))return"Chrome";if(mC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function hC(t=$n()){return/firefox\//i.test(t)}function dC(t=$n()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fC(t=$n()){return/crios\//i.test(t)}function gC(t=$n()){return/iemobile/i.test(t)}function mC(t=$n()){return/android/i.test(t)}function pC(t=$n()){return/blackberry/i.test(t)}function yC(t=$n()){return/webos/i.test(t)}function Lx(t=$n()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function k6(t=$n()){var e;return Lx(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function O6(){return Y8()&&document.documentMode===10}function xC(t=$n()){return Lx(t)||mC(t)||yC(t)||pC(t)||/windows phone/i.test(t)||gC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(t,e=[]){let n;switch(t){case"Browser":n=U2($n());break;case"Worker":n=`${U2($n())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${jl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((l,h)=>{try{const f=e(s);l(f)}catch(f){h(f)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L6(t,e={}){return ks(t,"GET","/v2/passwordPolicy",Da(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6=6;class V6{constructor(e){var n,r,i,s;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=l.minPasswordLength)!==null&&n!==void 0?n:F6,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,l,h;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(n=f.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),f.isValid&&(f.isValid=(r=f.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(i=f.containsLowercaseLetter)!==null&&i!==void 0?i:!0),f.isValid&&(f.isValid=(s=f.containsUppercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(l=f.containsNumericCharacter)!==null&&l!==void 0?l:!0),f.isValid&&(f.isValid=(h=f.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),f}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new j2(this),this.idTokenSubscription=new j2(this),this.beforeStateQueue=new M6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=rC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=no(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Vc.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await lC(this,{idToken:e}),r=await to._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Qi(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(h,h))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,h=i==null?void 0:i._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===h)&&(f!=null&&f.user)&&(i=f.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await o1(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=x6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qi(this.app))return Promise.reject(Ts(this));const n=e?mt(e):null;return n&&Ke(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qi(this.app)?Promise.reject(Ts(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qi(this.app)?Promise.reject(Ts(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(no(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await L6(this),n=new V6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ud("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await D6(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&no(e)||this._popupRedirectResolver;Ke(n,this,"argument-error"),this.redirectPersistenceManager=await Vc.create(this,[no(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let l=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ke(h,this,"internal-error"),h.then(()=>{l||s(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,r,i);return()=>{l=!0,f()}}else{const f=e.addObserver(n);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&m6(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function zl(t){return mt(t)}class j2{constructor(e){this.auth=e,this.observer=null,this.addObserver=rD(n=>this.observer=n)}get next(){return Ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ig={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function U6(t){ig=t}function _C(t){return ig.loadJS(t)}function j6(){return ig.recaptchaEnterpriseScript}function z6(){return ig.gapiScript}function G6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const q6="recaptcha-enterprise",H6="NO_RECAPTCHA";class W6{constructor(e){this.type=q6,this.auth=zl(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(l,h)=>{A6(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new I6(f);return s.tenantId==null?s._agentRecaptchaConfig=m:s._tenantRecaptchaConfigs[s.tenantId]=m,l(m.siteKey)}}).catch(f=>{h(f)})})}function i(s,l,h){const f=window.grecaptcha;L2(f)?f.enterprise.ready(()=>{f.enterprise.execute(s,{action:e}).then(m=>{l(m)}).catch(()=>{l(H6)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,l)=>{r(this.auth).then(h=>{if(!n&&L2(window.grecaptcha))i(h,s,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=j6();f.length!==0&&(f+=h),_C(f).then(()=>{i(h,s,l)}).catch(m=>{l(m)})}}).catch(h=>{l(h)})})}}async function z2(t,e,n,r=!1){const i=new W6(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const l=Object.assign({},e);return r?Object.assign(l,{captchaResp:s}):Object.assign(l,{captchaResponse:s}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function $p(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await z2(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await z2(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K6(t,e){const n=Ul(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(xa(s,e??{}))return i;es(i,"already-initialized")}return n.initialize({options:e})}function $6(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(no);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Q6(t,e,n){const r=zl(t);Ke(r._canInitEmulator,r,"emulator-config-failed"),Ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=EC(e),{host:l,port:h}=X6(e),f=h===null?"":`:${h}`;r.config.emulator={url:`${s}//${l}${f}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:l,port:h,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Y6()}function EC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function X6(t){const e=EC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:G2(r.substr(s.length+1))}}else{const[s,l]=r.split(":");return{host:s,port:G2(l)}}}function G2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Y6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return eo("not implemented")}_getIdTokenResponse(e){return eo("not implemented")}_linkToIdToken(e,n){return eo("not implemented")}_getReauthenticationResolver(e){return eo("not implemented")}}async function Z6(t,e){return ks(t,"POST","/v1/accounts:update",e)}async function J6(t,e){return ks(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ek(t,e){return Gd(t,"POST","/v1/accounts:signInWithPassword",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tk(t,e){return Gd(t,"POST","/v1/accounts:signInWithEmailLink",Da(t,e))}async function nk(t,e){return Gd(t,"POST","/v1/accounts:signInWithEmailLink",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md extends Fx{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new md(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new md(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $p(e,n,"signInWithPassword",ek);case"emailLink":return tk(e,{email:this._email,oobCode:this._password});default:es(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $p(e,r,"signUpPassword",J6);case"emailLink":return nk(e,{idToken:n,email:this._email,oobCode:this._password});default:es(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bc(t,e){return Gd(t,"POST","/v1/accounts:signInWithIdp",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk="http://localhost";class Cl extends Fx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Cl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):es("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=Dx(n,["providerId","signInMethod"]);if(!r||!i)return null;const l=new Cl(r,i);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){const n=this.buildRequest();return Bc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Bc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bc(e,n)}buildRequest(){const e={requestUri:rk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=jd(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function sk(t){const e=vh(Ih(t)).link,n=e?vh(Ih(e)).deep_link_id:null,r=vh(Ih(t)).deep_link_id;return(r?vh(Ih(r)).link:null)||r||n||e||t}class Vx{constructor(e){var n,r,i,s,l,h;const f=vh(Ih(e)),m=(n=f.apiKey)!==null&&n!==void 0?n:null,x=(r=f.oobCode)!==null&&r!==void 0?r:null,E=ik((i=f.mode)!==null&&i!==void 0?i:null);Ke(m&&x&&E,"argument-error"),this.apiKey=m,this.operation=E,this.code=x,this.continueUrl=(s=f.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(l=f.languageCode)!==null&&l!==void 0?l:null,this.tenantId=(h=f.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const n=sk(e);try{return new Vx(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(){this.providerId=Gl.PROVIDER_ID}static credential(e,n){return md._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Vx.parseLink(n);return Ke(r,"argument-error"),md._fromEmailAndCode(e,r.code,r.tenantId)}}Gl.PROVIDER_ID="password";Gl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Gl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd extends vC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo extends qd{constructor(){super("facebook.com")}static credential(e){return Cl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Uo.credential(e.oauthAccessToken)}catch{return null}}}Uo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Uo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo extends qd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Cl._fromParams({providerId:jo.PROVIDER_ID,signInMethod:jo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return jo.credentialFromTaggedObject(e)}static credentialFromError(e){return jo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return jo.credential(n,r)}catch{return null}}}jo.GOOGLE_SIGN_IN_METHOD="google.com";jo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends qd{constructor(){super("github.com")}static credential(e){return Cl._fromParams({providerId:zo.PROVIDER_ID,signInMethod:zo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zo.credentialFromTaggedObject(e)}static credentialFromError(e){return zo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zo.credential(e.oauthAccessToken)}catch{return null}}}zo.GITHUB_SIGN_IN_METHOD="github.com";zo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends qd{constructor(){super("twitter.com")}static credential(e,n){return Cl._fromParams({providerId:Go.PROVIDER_ID,signInMethod:Go.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Go.credentialFromTaggedObject(e)}static credentialFromError(e){return Go.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Go.credential(n,r)}catch{return null}}}Go.TWITTER_SIGN_IN_METHOD="twitter.com";Go.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ok(t,e){return Gd(t,"POST","/v1/accounts:signUp",Da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await to._fromIdTokenResponse(e,r,i),l=q2(r);return new Sl({user:s,providerId:l,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=q2(r);return new Sl({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function q2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1 extends Ds{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,a1.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new a1(e,n,r,i)}}function IC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?a1._fromErrorAndOperation(t,s,e,r):s})}async function ak(t,e,n=!1){const r=await Tl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Sl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AC(t,e,n=!1){const{auth:r}=t;if(Qi(r.app))return Promise.reject(Ts(r));const i="reauthenticate";try{const s=await Tl(t,IC(r,i,e,t),n);Ke(s.idToken,r,"internal-error");const l=Mx(s.idToken);Ke(l,r,"internal-error");const{sub:h}=l;return Ke(t.uid===h,r,"user-mismatch"),Sl._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&es(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TC(t,e,n=!1){if(Qi(t.app))return Promise.reject(Ts(t));const r="signIn",i=await IC(t,r,e),s=await Sl._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function lk(t,e){return TC(zl(t),e)}async function ck(t,e){return AC(mt(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CC(t){const e=zl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uk(t,e,n){if(Qi(t.app))return Promise.reject(Ts(t));const r=zl(t),l=await $p(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ok).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&CC(t),f}),h=await Sl._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(h.user),h}function hk(t,e,n){return Qi(t.app)?Promise.reject(Ts(t)):lk(mt(t),Gl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&CC(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(t,e){return ks(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SC(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=mt(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},l=await Tl(r,dk(r.auth,s));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const h=r.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=r.displayName,h.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function fk(t,e){const n=mt(t);return Qi(n.auth.app)?Promise.reject(Ts(n.auth)):bC(n,e,null)}function gk(t,e){return bC(mt(t),null,e)}async function bC(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const l=await Tl(t,Z6(r,s));await t._updateTokensIfNecessary(l,!0)}function mk(t,e,n,r){return mt(t).onIdTokenChanged(e,n,r)}function pk(t,e,n){return mt(t).beforeAuthStateChanged(e,n)}function yk(t,e,n,r){return mt(t).onAuthStateChanged(e,n,r)}function RC(t){return mt(t).signOut()}async function xk(t){return mt(t).delete()}const l1="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(l1,"1"),this.storage.removeItem(l1),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk=1e3,_k=10;class PC extends NC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((l,h,f)=>{this.notifyListeners(l,f)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(r);!n&&this.localCache[r]===l||this.notifyListeners(r,l)},s=this.storage.getItem(r);O6()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_k):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},wk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}PC.type="LOCAL";const Ek=PC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC extends NC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}DC.type="SESSION";const kC=DC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new sg(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,l=this.handlersMap[i];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const h=Array.from(l).map(async m=>m(n.origin,s)),f=await vk(h);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,l;return new Promise((h,f)=>{const m=Bx("",20);i.port1.start();const x=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:i,onMessage(E){const A=E;if(A.data.eventId===m)switch(A.data.status){case"ack":clearTimeout(x),s=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),h(A.data.response);break;default:clearTimeout(x),clearTimeout(s),f(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:n},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(){return window}function Ak(t){Cs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(){return typeof Cs().WorkerGlobalScope<"u"&&typeof Cs().importScripts=="function"}async function Tk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ck(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Sk(){return OC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC="firebaseLocalStorageDb",bk=1,c1="firebaseLocalStorage",LC="fbase_key";class Hd{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function og(t,e){return t.transaction([c1],e?"readwrite":"readonly").objectStore(c1)}function Rk(){const t=indexedDB.deleteDatabase(MC);return new Hd(t).toPromise()}function Qp(){const t=indexedDB.open(MC,bk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(c1,{keyPath:LC})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(c1)?e(r):(r.close(),await Rk(),e(await Qp()))})})}async function H2(t,e,n){const r=og(t,!0).put({[LC]:e,value:n});return new Hd(r).toPromise()}async function Nk(t,e){const n=og(t,!1).get(e),r=await new Hd(n).toPromise();return r===void 0?null:r.value}function W2(t,e){const n=og(t,!0).delete(e);return new Hd(n).toPromise()}const Pk=800,Dk=3;class FC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Dk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return OC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sg._getInstance(Sk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Tk(),!this.activeServiceWorker)return;this.sender=new Ik(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ck()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qp();return await H2(e,l1,"1"),await W2(e,l1),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>H2(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Nk(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>W2(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=og(i,!1).getAll();return new Hd(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Pk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FC.type="LOCAL";const kk=FC;new zd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(t,e){return e?no(e):(Ke(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux extends Fx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Mk(t){return TC(t.auth,new Ux(t),t.bypassAuthState)}function Lk(t){const{auth:e,user:n}=t;return Ke(n,e,"internal-error"),AC(n,new Ux(t),t.bypassAuthState)}async function Fk(t){const{auth:e,user:n}=t;return Ke(n,e,"internal-error"),ak(n,new Ux(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:l,type:h}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mk;case"linkViaPopup":case"linkViaRedirect":return Fk;case"reauthViaPopup":case"reauthViaRedirect":return Lk;default:es(this.auth,"internal-error")}}resolve(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk=new zd(2e3,1e4);class Rc extends VC{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Rc.currentPopupAction&&Rc.currentPopupAction.cancel(),Rc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ke(e,this.auth,"internal-error"),e}async onExecution(){fo(this.filter.length===1,"Popup operations only handle one event");const e=Bx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(As(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(As(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Rc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(As(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Vk.get())};e()}}Rc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk="pendingRedirect",y0=new Map;class Uk extends VC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=y0.get(this.auth._key());if(!e){try{const r=await jk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}y0.set(this.auth._key(),e)}return this.bypassAuthState||y0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jk(t,e){const n=qk(e),r=Gk(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function zk(t,e){y0.set(t._key(),e)}function Gk(t){return no(t._redirectPersistence)}function qk(t){return p0(Bk,t.config.apiKey,t.name)}async function Hk(t,e,n=!1){if(Qi(t.app))return Promise.reject(Ts(t));const r=zl(t),i=Ok(r,e),l=await new Uk(r,i,n).execute();return l&&!n&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk=10*60*1e3;class Kk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$k(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!BC(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(As(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Wk&&this.cachedEventUids.clear(),this.cachedEventUids.has(K2(e))}saveEventToCache(e){this.cachedEventUids.add(K2(e)),this.lastProcessedEventTime=Date.now()}}function K2(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function BC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $k(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return BC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qk(t,e={}){return ks(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Yk=/^https?/;async function Zk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Qk(t);for(const n of e)try{if(Jk(n))return}catch{}es(t,"unauthorized-domain")}function Jk(t){const e=Wp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===r}if(!Yk.test(n))return!1;if(Xk.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO=new zd(3e4,6e4);function $2(){const t=Cs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function tO(t){return new Promise((e,n)=>{var r,i,s;function l(){$2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$2(),n(As(t,"network-request-failed"))},timeout:eO.get()})}if(!((i=(r=Cs().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Cs().gapi)===null||s===void 0)&&s.load)l();else{const h=G6("iframefcb");return Cs()[h]=()=>{gapi.load?l():n(As(t,"network-request-failed"))},_C(`${z6()}?onload=${h}`).catch(f=>n(f))}}).catch(e=>{throw x0=null,e})}let x0=null;function nO(t){return x0=x0||tO(t),x0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO=new zd(5e3,15e3),iO="__/auth/iframe",sO="emulator/auth/iframe",oO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lO(t){const e=t.config;Ke(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ox(e,sO):`https://${t.config.authDomain}/${iO}`,r={apiKey:e.apiKey,appName:t.name,v:jl},i=aO.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${jd(r).slice(1)}`}async function cO(t){const e=await nO(t),n=Cs().gapi;return Ke(n,t,"internal-error"),e.open({where:document.body,url:lO(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oO,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const l=As(t,"network-request-failed"),h=Cs().setTimeout(()=>{s(l)},rO.get());function f(){Cs().clearTimeout(h),i(r)}r.ping(f).then(f,()=>{s(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},hO=500,dO=600,fO="_blank",gO="http://localhost";class Q2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mO(t,e,n,r=hO,i=dO){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const f=Object.assign(Object.assign({},uO),{width:r.toString(),height:i.toString(),top:s,left:l}),m=$n().toLowerCase();n&&(h=fC(m)?fO:n),hC(m)&&(e=e||gO,f.scrollbars="yes");const x=Object.entries(f).reduce((A,[N,U])=>`${A}${N}=${U},`,"");if(k6(m)&&h!=="_self")return pO(e||"",h),new Q2(null);const E=window.open(e||"",h,x);Ke(E,t,"popup-blocked");try{E.focus()}catch{}return new Q2(E)}function pO(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO="__/auth/handler",xO="emulator/auth/handler",wO=encodeURIComponent("fac");async function X2(t,e,n,r,i,s){Ke(t.config.authDomain,t,"auth-domain-config-required"),Ke(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:jl,eventId:i};if(e instanceof vC){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",nD(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,E]of Object.entries(s||{}))l[x]=E}if(e instanceof qd){const x=e.getScopes().filter(E=>E!=="");x.length>0&&(l.scopes=x.join(","))}t.tenantId&&(l.tid=t.tenantId);const h=l;for(const x of Object.keys(h))h[x]===void 0&&delete h[x];const f=await t._getAppCheckToken(),m=f?`#${wO}=${encodeURIComponent(f)}`:"";return`${_O(t)}?${jd(h).slice(1)}${m}`}function _O({config:t}){return t.emulator?Ox(t,xO):`https://${t.authDomain}/${yO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Am="webStorageSupport";class EO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kC,this._completeRedirectFn=Hk,this._overrideRedirectResult=zk}async _openPopup(e,n,r,i){var s;fo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const l=await X2(e,n,r,Wp(),i);return mO(e,l,Bx())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await X2(e,n,r,Wp(),i);return Ak(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(fo(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await cO(e),r=new Kk(e);return n.register("authEvent",i=>(Ke(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Am,{type:Am},i=>{var s;const l=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Am];l!==void 0&&n(!!l),es(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Zk(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return xC()||dC()||Lx()}}const vO=EO;var Y2="@firebase/auth",Z2="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TO(t){wa(new uo("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=r.options;Ke(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wC(t)},m=new B6(r,i,s,f);return $6(m,n),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),wa(new uo("auth-internal",e=>{const n=zl(e.getProvider("auth").getImmediate());return(r=>new IO(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ti(Y2,Z2,AO(t)),Ti(Y2,Z2,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO=5*60,SO=KT("authIdTokenMaxAge")||CO;let J2=null;const bO=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>SO)return;const i=n==null?void 0:n.token;J2!==i&&(J2=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function RO(t=rg()){const e=Ul(t,"auth");if(e.isInitialized())return e.getImmediate();const n=K6(t,{popupRedirectResolver:vO,persistence:[kk,Ek,kC]}),r=KT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const l=bO(s.toString());pk(n,l,()=>l(n.currentUser)),mk(n,h=>l(h))}}const i=HT("auth");return i&&Q6(n,`http://${i}`),n}function NO(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}U6({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=As("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",NO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TO("Browser");var eE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xl,UC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,L){function F(){}F.prototype=L.prototype,k.D=L.prototype,k.prototype=new F,k.prototype.constructor=k,k.C=function(H,K,W){for(var z=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)z[Ge-2]=arguments[Ge];return L.prototype[K].apply(H,z)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,L,F){F||(F=0);var H=Array(16);if(typeof L=="string")for(var K=0;16>K;++K)H[K]=L.charCodeAt(F++)|L.charCodeAt(F++)<<8|L.charCodeAt(F++)<<16|L.charCodeAt(F++)<<24;else for(K=0;16>K;++K)H[K]=L[F++]|L[F++]<<8|L[F++]<<16|L[F++]<<24;L=k.g[0],F=k.g[1],K=k.g[2];var W=k.g[3],z=L+(W^F&(K^W))+H[0]+3614090360&4294967295;L=F+(z<<7&4294967295|z>>>25),z=W+(K^L&(F^K))+H[1]+3905402710&4294967295,W=L+(z<<12&4294967295|z>>>20),z=K+(F^W&(L^F))+H[2]+606105819&4294967295,K=W+(z<<17&4294967295|z>>>15),z=F+(L^K&(W^L))+H[3]+3250441966&4294967295,F=K+(z<<22&4294967295|z>>>10),z=L+(W^F&(K^W))+H[4]+4118548399&4294967295,L=F+(z<<7&4294967295|z>>>25),z=W+(K^L&(F^K))+H[5]+1200080426&4294967295,W=L+(z<<12&4294967295|z>>>20),z=K+(F^W&(L^F))+H[6]+2821735955&4294967295,K=W+(z<<17&4294967295|z>>>15),z=F+(L^K&(W^L))+H[7]+4249261313&4294967295,F=K+(z<<22&4294967295|z>>>10),z=L+(W^F&(K^W))+H[8]+1770035416&4294967295,L=F+(z<<7&4294967295|z>>>25),z=W+(K^L&(F^K))+H[9]+2336552879&4294967295,W=L+(z<<12&4294967295|z>>>20),z=K+(F^W&(L^F))+H[10]+4294925233&4294967295,K=W+(z<<17&4294967295|z>>>15),z=F+(L^K&(W^L))+H[11]+2304563134&4294967295,F=K+(z<<22&4294967295|z>>>10),z=L+(W^F&(K^W))+H[12]+1804603682&4294967295,L=F+(z<<7&4294967295|z>>>25),z=W+(K^L&(F^K))+H[13]+4254626195&4294967295,W=L+(z<<12&4294967295|z>>>20),z=K+(F^W&(L^F))+H[14]+2792965006&4294967295,K=W+(z<<17&4294967295|z>>>15),z=F+(L^K&(W^L))+H[15]+1236535329&4294967295,F=K+(z<<22&4294967295|z>>>10),z=L+(K^W&(F^K))+H[1]+4129170786&4294967295,L=F+(z<<5&4294967295|z>>>27),z=W+(F^K&(L^F))+H[6]+3225465664&4294967295,W=L+(z<<9&4294967295|z>>>23),z=K+(L^F&(W^L))+H[11]+643717713&4294967295,K=W+(z<<14&4294967295|z>>>18),z=F+(W^L&(K^W))+H[0]+3921069994&4294967295,F=K+(z<<20&4294967295|z>>>12),z=L+(K^W&(F^K))+H[5]+3593408605&4294967295,L=F+(z<<5&4294967295|z>>>27),z=W+(F^K&(L^F))+H[10]+38016083&4294967295,W=L+(z<<9&4294967295|z>>>23),z=K+(L^F&(W^L))+H[15]+3634488961&4294967295,K=W+(z<<14&4294967295|z>>>18),z=F+(W^L&(K^W))+H[4]+3889429448&4294967295,F=K+(z<<20&4294967295|z>>>12),z=L+(K^W&(F^K))+H[9]+568446438&4294967295,L=F+(z<<5&4294967295|z>>>27),z=W+(F^K&(L^F))+H[14]+3275163606&4294967295,W=L+(z<<9&4294967295|z>>>23),z=K+(L^F&(W^L))+H[3]+4107603335&4294967295,K=W+(z<<14&4294967295|z>>>18),z=F+(W^L&(K^W))+H[8]+1163531501&4294967295,F=K+(z<<20&4294967295|z>>>12),z=L+(K^W&(F^K))+H[13]+2850285829&4294967295,L=F+(z<<5&4294967295|z>>>27),z=W+(F^K&(L^F))+H[2]+4243563512&4294967295,W=L+(z<<9&4294967295|z>>>23),z=K+(L^F&(W^L))+H[7]+1735328473&4294967295,K=W+(z<<14&4294967295|z>>>18),z=F+(W^L&(K^W))+H[12]+2368359562&4294967295,F=K+(z<<20&4294967295|z>>>12),z=L+(F^K^W)+H[5]+4294588738&4294967295,L=F+(z<<4&4294967295|z>>>28),z=W+(L^F^K)+H[8]+2272392833&4294967295,W=L+(z<<11&4294967295|z>>>21),z=K+(W^L^F)+H[11]+1839030562&4294967295,K=W+(z<<16&4294967295|z>>>16),z=F+(K^W^L)+H[14]+4259657740&4294967295,F=K+(z<<23&4294967295|z>>>9),z=L+(F^K^W)+H[1]+2763975236&4294967295,L=F+(z<<4&4294967295|z>>>28),z=W+(L^F^K)+H[4]+1272893353&4294967295,W=L+(z<<11&4294967295|z>>>21),z=K+(W^L^F)+H[7]+4139469664&4294967295,K=W+(z<<16&4294967295|z>>>16),z=F+(K^W^L)+H[10]+3200236656&4294967295,F=K+(z<<23&4294967295|z>>>9),z=L+(F^K^W)+H[13]+681279174&4294967295,L=F+(z<<4&4294967295|z>>>28),z=W+(L^F^K)+H[0]+3936430074&4294967295,W=L+(z<<11&4294967295|z>>>21),z=K+(W^L^F)+H[3]+3572445317&4294967295,K=W+(z<<16&4294967295|z>>>16),z=F+(K^W^L)+H[6]+76029189&4294967295,F=K+(z<<23&4294967295|z>>>9),z=L+(F^K^W)+H[9]+3654602809&4294967295,L=F+(z<<4&4294967295|z>>>28),z=W+(L^F^K)+H[12]+3873151461&4294967295,W=L+(z<<11&4294967295|z>>>21),z=K+(W^L^F)+H[15]+530742520&4294967295,K=W+(z<<16&4294967295|z>>>16),z=F+(K^W^L)+H[2]+3299628645&4294967295,F=K+(z<<23&4294967295|z>>>9),z=L+(K^(F|~W))+H[0]+4096336452&4294967295,L=F+(z<<6&4294967295|z>>>26),z=W+(F^(L|~K))+H[7]+1126891415&4294967295,W=L+(z<<10&4294967295|z>>>22),z=K+(L^(W|~F))+H[14]+2878612391&4294967295,K=W+(z<<15&4294967295|z>>>17),z=F+(W^(K|~L))+H[5]+4237533241&4294967295,F=K+(z<<21&4294967295|z>>>11),z=L+(K^(F|~W))+H[12]+1700485571&4294967295,L=F+(z<<6&4294967295|z>>>26),z=W+(F^(L|~K))+H[3]+2399980690&4294967295,W=L+(z<<10&4294967295|z>>>22),z=K+(L^(W|~F))+H[10]+4293915773&4294967295,K=W+(z<<15&4294967295|z>>>17),z=F+(W^(K|~L))+H[1]+2240044497&4294967295,F=K+(z<<21&4294967295|z>>>11),z=L+(K^(F|~W))+H[8]+1873313359&4294967295,L=F+(z<<6&4294967295|z>>>26),z=W+(F^(L|~K))+H[15]+4264355552&4294967295,W=L+(z<<10&4294967295|z>>>22),z=K+(L^(W|~F))+H[6]+2734768916&4294967295,K=W+(z<<15&4294967295|z>>>17),z=F+(W^(K|~L))+H[13]+1309151649&4294967295,F=K+(z<<21&4294967295|z>>>11),z=L+(K^(F|~W))+H[4]+4149444226&4294967295,L=F+(z<<6&4294967295|z>>>26),z=W+(F^(L|~K))+H[11]+3174756917&4294967295,W=L+(z<<10&4294967295|z>>>22),z=K+(L^(W|~F))+H[2]+718787259&4294967295,K=W+(z<<15&4294967295|z>>>17),z=F+(W^(K|~L))+H[9]+3951481745&4294967295,k.g[0]=k.g[0]+L&4294967295,k.g[1]=k.g[1]+(K+(z<<21&4294967295|z>>>11))&4294967295,k.g[2]=k.g[2]+K&4294967295,k.g[3]=k.g[3]+W&4294967295}r.prototype.u=function(k,L){L===void 0&&(L=k.length);for(var F=L-this.blockSize,H=this.B,K=this.h,W=0;W<L;){if(K==0)for(;W<=F;)i(this,k,W),W+=this.blockSize;if(typeof k=="string"){for(;W<L;)if(H[K++]=k.charCodeAt(W++),K==this.blockSize){i(this,H),K=0;break}}else for(;W<L;)if(H[K++]=k[W++],K==this.blockSize){i(this,H),K=0;break}}this.h=K,this.o+=L},r.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var L=1;L<k.length-8;++L)k[L]=0;var F=8*this.o;for(L=k.length-8;L<k.length;++L)k[L]=F&255,F/=256;for(this.u(k),k=Array(16),L=F=0;4>L;++L)for(var H=0;32>H;H+=8)k[F++]=this.g[L]>>>H&255;return k};function s(k,L){var F=h;return Object.prototype.hasOwnProperty.call(F,k)?F[k]:F[k]=L(k)}function l(k,L){this.h=L;for(var F=[],H=!0,K=k.length-1;0<=K;K--){var W=k[K]|0;H&&W==L||(F[K]=W,H=!1)}this.g=F}var h={};function f(k){return-128<=k&&128>k?s(k,function(L){return new l([L|0],0>L?-1:0)}):new l([k|0],0>k?-1:0)}function m(k){if(isNaN(k)||!isFinite(k))return E;if(0>k)return G(m(-k));for(var L=[],F=1,H=0;k>=F;H++)L[H]=k/F|0,F*=4294967296;return new l(L,0)}function x(k,L){if(k.length==0)throw Error("number format error: empty string");if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(k.charAt(0)=="-")return G(x(k.substring(1),L));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var F=m(Math.pow(L,8)),H=E,K=0;K<k.length;K+=8){var W=Math.min(8,k.length-K),z=parseInt(k.substring(K,K+W),L);8>W?(W=m(Math.pow(L,W)),H=H.j(W).add(m(z))):(H=H.j(F),H=H.add(m(z)))}return H}var E=f(0),A=f(1),N=f(16777216);t=l.prototype,t.m=function(){if(D(this))return-G(this).m();for(var k=0,L=1,F=0;F<this.g.length;F++){var H=this.i(F);k+=(0<=H?H:4294967296+H)*L,L*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(U(this))return"0";if(D(this))return"-"+G(this).toString(k);for(var L=m(Math.pow(k,6)),F=this,H="";;){var K=V(F,L).g;F=M(F,K.j(L));var W=((0<F.g.length?F.g[0]:F.h)>>>0).toString(k);if(F=K,U(F))return W+H;for(;6>W.length;)W="0"+W;H=W+H}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function U(k){if(k.h!=0)return!1;for(var L=0;L<k.g.length;L++)if(k.g[L]!=0)return!1;return!0}function D(k){return k.h==-1}t.l=function(k){return k=M(this,k),D(k)?-1:U(k)?0:1};function G(k){for(var L=k.g.length,F=[],H=0;H<L;H++)F[H]=~k.g[H];return new l(F,~k.h).add(A)}t.abs=function(){return D(this)?G(this):this},t.add=function(k){for(var L=Math.max(this.g.length,k.g.length),F=[],H=0,K=0;K<=L;K++){var W=H+(this.i(K)&65535)+(k.i(K)&65535),z=(W>>>16)+(this.i(K)>>>16)+(k.i(K)>>>16);H=z>>>16,W&=65535,z&=65535,F[K]=z<<16|W}return new l(F,F[F.length-1]&-2147483648?-1:0)};function M(k,L){return k.add(G(L))}t.j=function(k){if(U(this)||U(k))return E;if(D(this))return D(k)?G(this).j(G(k)):G(G(this).j(k));if(D(k))return G(this.j(G(k)));if(0>this.l(N)&&0>k.l(N))return m(this.m()*k.m());for(var L=this.g.length+k.g.length,F=[],H=0;H<2*L;H++)F[H]=0;for(H=0;H<this.g.length;H++)for(var K=0;K<k.g.length;K++){var W=this.i(H)>>>16,z=this.i(H)&65535,Ge=k.i(K)>>>16,se=k.i(K)&65535;F[2*H+2*K]+=z*se,b(F,2*H+2*K),F[2*H+2*K+1]+=W*se,b(F,2*H+2*K+1),F[2*H+2*K+1]+=z*Ge,b(F,2*H+2*K+1),F[2*H+2*K+2]+=W*Ge,b(F,2*H+2*K+2)}for(H=0;H<L;H++)F[H]=F[2*H+1]<<16|F[2*H];for(H=L;H<2*L;H++)F[H]=0;return new l(F,0)};function b(k,L){for(;(k[L]&65535)!=k[L];)k[L+1]+=k[L]>>>16,k[L]&=65535,L++}function P(k,L){this.g=k,this.h=L}function V(k,L){if(U(L))throw Error("division by zero");if(U(k))return new P(E,E);if(D(k))return L=V(G(k),L),new P(G(L.g),G(L.h));if(D(L))return L=V(k,G(L)),new P(G(L.g),L.h);if(30<k.g.length){if(D(k)||D(L))throw Error("slowDivide_ only works with positive integers.");for(var F=A,H=L;0>=H.l(k);)F=$(F),H=$(H);var K=J(F,1),W=J(H,1);for(H=J(H,2),F=J(F,2);!U(H);){var z=W.add(H);0>=z.l(k)&&(K=K.add(F),W=z),H=J(H,1),F=J(F,1)}return L=M(k,K.j(L)),new P(K,L)}for(K=E;0<=k.l(L);){for(F=Math.max(1,Math.floor(k.m()/L.m())),H=Math.ceil(Math.log(F)/Math.LN2),H=48>=H?1:Math.pow(2,H-48),W=m(F),z=W.j(L);D(z)||0<z.l(k);)F-=H,W=m(F),z=W.j(L);U(W)&&(W=A),K=K.add(W),k=M(k,z)}return new P(K,k)}t.A=function(k){return V(this,k).h},t.and=function(k){for(var L=Math.max(this.g.length,k.g.length),F=[],H=0;H<L;H++)F[H]=this.i(H)&k.i(H);return new l(F,this.h&k.h)},t.or=function(k){for(var L=Math.max(this.g.length,k.g.length),F=[],H=0;H<L;H++)F[H]=this.i(H)|k.i(H);return new l(F,this.h|k.h)},t.xor=function(k){for(var L=Math.max(this.g.length,k.g.length),F=[],H=0;H<L;H++)F[H]=this.i(H)^k.i(H);return new l(F,this.h^k.h)};function $(k){for(var L=k.g.length+1,F=[],H=0;H<L;H++)F[H]=k.i(H)<<1|k.i(H-1)>>>31;return new l(F,k.h)}function J(k,L){var F=L>>5;L%=32;for(var H=k.g.length-F,K=[],W=0;W<H;W++)K[W]=0<L?k.i(W+F)>>>L|k.i(W+F+1)<<32-L:k.i(W+F);return new l(K,k.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,UC=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=x,xl=l}).apply(typeof eE<"u"?eE:typeof self<"u"?self:typeof window<"u"?window:{});var Wf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jC,Ah,zC,w0,Xp,GC,qC,HC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,I,C){return p==Array.prototype||p==Object.prototype||(p[I]=C.value),p};function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wf=="object"&&Wf];for(var I=0;I<p.length;++I){var C=p[I];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var r=n(this);function i(p,I){if(I)e:{var C=r;p=p.split(".");for(var B=0;B<p.length-1;B++){var ee=p[B];if(!(ee in C))break e;C=C[ee]}p=p[p.length-1],B=C[p],I=I(B),I!=B&&I!=null&&e(C,p,{configurable:!0,writable:!0,value:I})}}function s(p,I){p instanceof String&&(p+="");var C=0,B=!1,ee={next:function(){if(!B&&C<p.length){var le=C++;return{value:I(le,p[le]),done:!1}}return B=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}i("Array.prototype.values",function(p){return p||function(){return s(this,function(I,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},h=this||self;function f(p){var I=typeof p;return I=I!="object"?I:p?Array.isArray(p)?"array":I:"null",I=="array"||I=="object"&&typeof p.length=="number"}function m(p){var I=typeof p;return I=="object"&&p!=null||I=="function"}function x(p,I,C){return p.call.apply(p.bind,arguments)}function E(p,I,C){if(!p)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,B),p.apply(I,ee)}}return function(){return p.apply(I,arguments)}}function A(p,I,C){return A=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:E,A.apply(null,arguments)}function N(p,I){var C=Array.prototype.slice.call(arguments,1);return function(){var B=C.slice();return B.push.apply(B,arguments),p.apply(this,B)}}function U(p,I){function C(){}C.prototype=I.prototype,p.aa=I.prototype,p.prototype=new C,p.prototype.constructor=p,p.Qb=function(B,ee,le){for(var ve=Array(arguments.length-2),vt=2;vt<arguments.length;vt++)ve[vt-2]=arguments[vt];return I.prototype[ee].apply(B,ve)}}function D(p){const I=p.length;if(0<I){const C=Array(I);for(let B=0;B<I;B++)C[B]=p[B];return C}return[]}function G(p,I){for(let C=1;C<arguments.length;C++){const B=arguments[C];if(f(B)){const ee=p.length||0,le=B.length||0;p.length=ee+le;for(let ve=0;ve<le;ve++)p[ee+ve]=B[ve]}else p.push(B)}}class M{constructor(I,C){this.i=I,this.j=C,this.h=0,this.g=null}get(){let I;return 0<this.h?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function b(p){return/^[\s\xa0]*$/.test(p)}function P(){var p=h.navigator;return p&&(p=p.userAgent)?p:""}function V(p){return V[" "](p),p}V[" "]=function(){};var $=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function J(p,I,C){for(const B in p)I.call(C,p[B],B,p)}function k(p,I){for(const C in p)I.call(void 0,p[C],C,p)}function L(p){const I={};for(const C in p)I[C]=p[C];return I}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function H(p,I){let C,B;for(let ee=1;ee<arguments.length;ee++){B=arguments[ee];for(C in B)p[C]=B[C];for(let le=0;le<F.length;le++)C=F[le],Object.prototype.hasOwnProperty.call(B,C)&&(p[C]=B[C])}}function K(p){var I=1;p=p.split(":");const C=[];for(;0<I&&p.length;)C.push(p.shift()),I--;return p.length&&C.push(p.join(":")),C}function W(p){h.setTimeout(()=>{throw p},0)}function z(){var p=Me;let I=null;return p.g&&(I=p.g,p.g=p.g.next,p.g||(p.h=null),I.next=null),I}class Ge{constructor(){this.h=this.g=null}add(I,C){const B=se.get();B.set(I,C),this.h?this.h.next=B:this.g=B,this.h=B}}var se=new M(()=>new rt,p=>p.reset());class rt{constructor(){this.next=this.g=this.h=null}set(I,C){this.h=I,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let Oe,Ie=!1,Me=new Ge,je=()=>{const p=h.Promise.resolve(void 0);Oe=()=>{p.then(Rt)}};var Rt=()=>{for(var p;p=z();){try{p.h.call(p.g)}catch(C){W(C)}var I=se;I.j(p),100>I.h&&(I.h++,p.next=I.g,I.g=p)}Ie=!1};function Xe(){this.s=this.s,this.C=this.C}Xe.prototype.s=!1,Xe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Xe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Tt(p,I){this.type=p,this.g=this.target=I,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var Bt=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var p=!1,I=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const C=()=>{};h.addEventListener("test",C,I),h.removeEventListener("test",C,I)}catch{}return p}();function mr(p,I){if(Tt.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var C=this.type=p.type,B=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=I,I=p.relatedTarget){if($){e:{try{V(I.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(I=null)}}else C=="mouseover"?I=p.fromElement:C=="mouseout"&&(I=p.toElement);this.relatedTarget=I,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ke[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&mr.aa.h.call(this)}}U(mr,Tt);var ke={2:"touch",3:"pen",4:"mouse"};mr.prototype.h=function(){mr.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Xn="closure_listenable_"+(1e6*Math.random()|0),ln=0;function Ni(p,I,C,B,ee){this.listener=p,this.proxy=null,this.src=I,this.type=C,this.capture=!!B,this.ha=ee,this.key=++ln,this.da=this.fa=!1}function Ur(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Tn(p){this.src=p,this.g={},this.h=0}Tn.prototype.add=function(p,I,C,B,ee){var le=p.toString();p=this.g[le],p||(p=this.g[le]=[],this.h++);var ve=ot(p,I,B,ee);return-1<ve?(I=p[ve],C||(I.fa=!1)):(I=new Ni(I,this.src,le,!!B,ee),I.fa=C,p.push(I)),I};function Pi(p,I){var C=I.type;if(C in p.g){var B=p.g[C],ee=Array.prototype.indexOf.call(B,I,void 0),le;(le=0<=ee)&&Array.prototype.splice.call(B,ee,1),le&&(Ur(I),p.g[C].length==0&&(delete p.g[C],p.h--))}}function ot(p,I,C,B){for(var ee=0;ee<p.length;++ee){var le=p[ee];if(!le.da&&le.listener==I&&le.capture==!!C&&le.ha==B)return ee}return-1}var ri="closure_lm_"+(1e6*Math.random()|0),sr={};function ts(p,I,C,B,ee){if(B&&B.once)return it(p,I,C,B,ee);if(Array.isArray(I)){for(var le=0;le<I.length;le++)ts(p,I[le],C,B,ee);return null}return C=be(C),p&&p[Xn]?p.K(I,C,m(B)?!!B.capture:!!B,ee):yn(p,I,C,!1,B,ee)}function yn(p,I,C,B,ee,le){if(!I)throw Error("Invalid event type");var ve=m(ee)?!!ee.capture:!!ee,vt=xe(p);if(vt||(p[ri]=vt=new Tn(p)),C=vt.add(I,C,B,ve,le),C.proxy)return C;if(B=Nt(),C.proxy=B,B.src=p,B.listener=C,p.addEventListener)Bt||(ee=ve),ee===void 0&&(ee=!1),p.addEventListener(I.toString(),B,ee);else if(p.attachEvent)p.attachEvent(ue(I.toString()),B);else if(p.addListener&&p.removeListener)p.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Nt(){function p(C){return I.call(p.src,p.listener,C)}const I=Ce;return p}function it(p,I,C,B,ee){if(Array.isArray(I)){for(var le=0;le<I.length;le++)it(p,I[le],C,B,ee);return null}return C=be(C),p&&p[Xn]?p.L(I,C,m(B)?!!B.capture:!!B,ee):yn(p,I,C,!0,B,ee)}function Q(p,I,C,B,ee){if(Array.isArray(I))for(var le=0;le<I.length;le++)Q(p,I[le],C,B,ee);else B=m(B)?!!B.capture:!!B,C=be(C),p&&p[Xn]?(p=p.i,I=String(I).toString(),I in p.g&&(le=p.g[I],C=ot(le,C,B,ee),-1<C&&(Ur(le[C]),Array.prototype.splice.call(le,C,1),le.length==0&&(delete p.g[I],p.h--)))):p&&(p=xe(p))&&(I=p.g[I.toString()],p=-1,I&&(p=ot(I,C,B,ee)),(C=-1<p?I[p]:null)&&X(C))}function X(p){if(typeof p!="number"&&p&&!p.da){var I=p.src;if(I&&I[Xn])Pi(I.i,p);else{var C=p.type,B=p.proxy;I.removeEventListener?I.removeEventListener(C,B,p.capture):I.detachEvent?I.detachEvent(ue(C),B):I.addListener&&I.removeListener&&I.removeListener(B),(C=xe(I))?(Pi(C,p),C.h==0&&(C.src=null,I[ri]=null)):Ur(p)}}}function ue(p){return p in sr?sr[p]:sr[p]="on"+p}function Ce(p,I){if(p.da)p=!0;else{I=new mr(I,this);var C=p.listener,B=p.ha||p.src;p.fa&&X(p),p=C.call(B,I)}return p}function xe(p){return p=p[ri],p instanceof Tn?p:null}var pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(p){return typeof p=="function"?p:(p[pe]||(p[pe]=function(I){return p.handleEvent(I)}),p[pe])}function We(){Xe.call(this),this.i=new Tn(this),this.M=this,this.F=null}U(We,Xe),We.prototype[Xn]=!0,We.prototype.removeEventListener=function(p,I,C,B){Q(this,p,I,C,B)};function qe(p,I){var C,B=p.F;if(B)for(C=[];B;B=B.F)C.push(B);if(p=p.M,B=I.type||I,typeof I=="string")I=new Tt(I,p);else if(I instanceof Tt)I.target=I.target||p;else{var ee=I;I=new Tt(B,p),H(I,ee)}if(ee=!0,C)for(var le=C.length-1;0<=le;le--){var ve=I.g=C[le];ee=Et(ve,B,!0,I)&&ee}if(ve=I.g=p,ee=Et(ve,B,!0,I)&&ee,ee=Et(ve,B,!1,I)&&ee,C)for(le=0;le<C.length;le++)ve=I.g=C[le],ee=Et(ve,B,!1,I)&&ee}We.prototype.N=function(){if(We.aa.N.call(this),this.i){var p=this.i,I;for(I in p.g){for(var C=p.g[I],B=0;B<C.length;B++)Ur(C[B]);delete p.g[I],p.h--}}this.F=null},We.prototype.K=function(p,I,C,B){return this.i.add(String(p),I,!1,C,B)},We.prototype.L=function(p,I,C,B){return this.i.add(String(p),I,!0,C,B)};function Et(p,I,C,B){if(I=p.i.g[String(I)],!I)return!0;I=I.concat();for(var ee=!0,le=0;le<I.length;++le){var ve=I[le];if(ve&&!ve.da&&ve.capture==C){var vt=ve.listener,qn=ve.ha||ve.src;ve.fa&&Pi(p.i,ve),ee=vt.call(qn,B)!==!1&&ee}}return ee&&!B.defaultPrevented}function ns(p,I,C){if(typeof p=="function")C&&(p=A(p,C));else if(p&&typeof p.handleEvent=="function")p=A(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(I)?-1:h.setTimeout(p,I||0)}function pr(p){p.g=ns(()=>{p.g=null,p.i&&(p.i=!1,pr(p))},p.l);const I=p.h;p.h=null,p.m.apply(null,I)}class Gu extends Xe{constructor(I,C){super(),this.m=I,this.l=C,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:pr(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bt(p){Xe.call(this),this.h=p,this.g={}}U(bt,Xe);var Ee=[];function tn(p){J(p.g,function(I,C){this.g.hasOwnProperty(C)&&X(I)},p),p.g={}}bt.prototype.N=function(){bt.aa.N.call(this),tn(this)},bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pt=h.JSON.stringify,Ht=h.JSON.parse,rs=class{stringify(p){return h.JSON.stringify(p,void 0)}parse(p){return h.JSON.parse(p,void 0)}};function Ua(){}Ua.prototype.h=null;function qu(p){return p.h||(p.h=p.i())}function yt(){}var ii={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function $l(){Tt.call(this,"d")}U($l,Tt);function Ql(){Tt.call(this,"c")}U(Ql,Tt);var Un={},Xl=null;function Cn(){return Xl=Xl||new We}Un.La="serverreachability";function Fs(p){Tt.call(this,Un.La,p)}U(Fs,Tt);function is(p){const I=Cn();qe(I,new Fs(I))}Un.STAT_EVENT="statevent";function si(p,I){Tt.call(this,Un.STAT_EVENT,p),this.stat=I}U(si,Tt);function or(p){const I=Cn();qe(I,new si(I,p))}Un.Ma="timingevent";function ss(p,I){Tt.call(this,Un.Ma,p),this.size=I}U(ss,Tt);function Vs(p,I){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){p()},I)}function On(){this.g=!0}On.prototype.xa=function(){this.g=!1};function Bs(p,I,C,B,ee,le){p.info(function(){if(p.g)if(le)for(var ve="",vt=le.split("&"),qn=0;qn<vt.length;qn++){var nt=vt[qn].split("=");if(1<nt.length){var bn=nt[0];nt=nt[1];var Pt=bn.split("_");ve=2<=Pt.length&&Pt[1]=="type"?ve+(bn+"="+nt+"&"):ve+(bn+"=redacted&")}}else ve=null;else ve=le;return"XMLHTTP REQ ("+B+") [attempt "+ee+"]: "+I+`
`+C+`
`+ve})}function jr(p,I,C,B,ee,le,ve){p.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ee+"]: "+I+`
`+C+`
`+le+" "+ve})}function Se(p,I,C,B){p.info(function(){return"XMLHTTP TEXT ("+I+"): "+Hu(p,C)+(B?" "+B:"")})}function Io(p,I){p.info(function(){return"TIMEOUT: "+I})}On.prototype.info=function(){};function Hu(p,I){if(!p.g)return I;if(!I)return null;try{var C=JSON.parse(I);if(C){for(p=0;p<C.length;p++)if(Array.isArray(C[p])){var B=C[p];if(!(2>B.length)){var ee=B[1];if(Array.isArray(ee)&&!(1>ee.length)){var le=ee[0];if(le!="noop"&&le!="stop"&&le!="close")for(var ve=1;ve<ee.length;ve++)ee[ve]=""}}}}return pt(C)}catch{return I}}var jn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Us={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ao;function js(){}U(js,Ua),js.prototype.g=function(){return new XMLHttpRequest},js.prototype.i=function(){return{}},Ao=new js;function zn(p,I,C,B){this.j=p,this.i=I,this.l=C,this.R=B||1,this.U=new bt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new df}function df(){this.i=null,this.g="",this.h=!1}var ff={},zr={};function Gn(p,I,C){p.L=1,p.v=ar(Wt(I)),p.m=C,p.P=!0,Ut(p,null)}function Ut(p,I){p.F=Date.now(),To(p),p.A=Wt(p.v);var C=p.A,B=p.R;Array.isArray(B)||(B=[String(B)]),So(C.i,"t",B),p.C=0,C=p.j.J,p.h=new df,p.g=Ft(p.j,C?I:null,!p.m),0<p.O&&(p.M=new Gu(A(p.Y,p,p.g),p.O)),I=p.U,C=p.g,B=p.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(Ee[0]=ee.toString()),ee=Ee);for(var le=0;le<ee.length;le++){var ve=ts(C,ee[le],B||I.handleEvent,!1,I.h||I);if(!ve)break;I.g[ve.key]=ve}I=p.H?L(p.H):{},p.m?(p.u||(p.u="POST"),I["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,I)):(p.u="GET",p.g.ea(p.A,p.u,null,I)),is(),Bs(p.i,p.u,p.A,p.l,p.R,p.m)}zn.prototype.ca=function(p){p=p.target;const I=this.M;I&&Li(p)==3?I.j():this.Y(p)},zn.prototype.Y=function(p){try{if(p==this.g)e:{const Pt=Li(this.g);var I=this.g.Ba();const qs=this.g.Z();if(!(3>Pt)&&(Pt!=3||this.g&&(this.h.h||this.g.oa()||St(this.g)))){this.J||Pt!=4||I==7||(I==8||0>=qs?is(3):is(2)),Ku(this);var C=this.g.Z();this.X=C;t:if(Wu(this)){var B=St(this.g);p="";var ee=B.length,le=Li(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gr(this),Mt(this);var ve="";break t}this.h.i=new h.TextDecoder}for(I=0;I<ee;I++)this.h.h=!0,p+=this.h.i.decode(B[I],{stream:!(le&&I==ee-1)});B.length=0,this.h.g+=p,this.C=0,ve=this.h.g}else ve=this.g.oa();if(this.o=C==200,jr(this.i,this.u,this.A,this.l,this.R,Pt,C),this.o){if(this.T&&!this.K){t:{if(this.g){var vt,qn=this.g;if((vt=qn.g?qn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(vt)){var nt=vt;break t}}nt=null}if(C=nt)Se(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$u(this,C);else{this.o=!1,this.s=3,or(12),Gr(this),Mt(this);break e}}if(this.P){C=!0;let _n;for(;!this.J&&this.C<ve.length;)if(_n=os(this,ve),_n==zr){Pt==4&&(this.s=4,or(14),C=!1),Se(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==ff){this.s=4,or(15),Se(this.i,this.l,ve,"[Invalid Chunk]"),C=!1;break}else Se(this.i,this.l,_n,null),$u(this,_n);if(Wu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pt!=4||ve.length!=0||this.h.h||(this.s=1,or(16),C=!1),this.o=this.o&&C,!C)Se(this.i,this.l,ve,"[Invalid Chunked Response]"),Gr(this),Mt(this);else if(0<ve.length&&!this.W){this.W=!0;var bn=this.j;bn.g==this&&bn.ba&&!bn.M&&(bn.j.info("Great, no buffering proxy detected. Bytes received: "+ve.length),un(bn),bn.M=!0,or(11))}}else Se(this.i,this.l,ve,null),$u(this,ve);Pt==4&&Gr(this),this.o&&!this.J&&(Pt==4?$a(this.j,this):(this.o=!1,To(this)))}else wf(this.g),C==400&&0<ve.indexOf("Unknown SID")?(this.s=3,or(12)):(this.s=0,or(13)),Gr(this),Mt(this)}}}catch{}finally{}};function Wu(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function os(p,I){var C=p.C,B=I.indexOf(`
`,C);return B==-1?zr:(C=Number(I.substring(C,B)),isNaN(C)?ff:(B+=1,B+C>I.length?zr:(I=I.slice(B,B+C),p.C=B+C,I)))}zn.prototype.cancel=function(){this.J=!0,Gr(this)};function To(p){p.S=Date.now()+p.I,de(p,p.I)}function de(p,I){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Vs(A(p.ba,p),I)}function Ku(p){p.B&&(h.clearTimeout(p.B),p.B=null)}zn.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Io(this.i,this.A),this.L!=2&&(is(),or(17)),Gr(this),this.s=2,Mt(this)):de(this,this.S-p)};function Mt(p){p.j.G==0||p.J||$a(p.j,p)}function Gr(p){Ku(p);var I=p.M;I&&typeof I.ma=="function"&&I.ma(),p.M=null,tn(p.U),p.g&&(I=p.g,p.g=null,I.abort(),I.ma())}function $u(p,I){try{var C=p.j;if(C.G!=0&&(C.g==p||ja(C.h,p))){if(!p.K&&ja(C.h,p)&&C.G==3){try{var B=C.Da.g.parse(I)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ee=B;if(ee[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<p.F)jt(C),oe(C);else break e;Ka(C),or(18)}}else C.za=ee[1],0<C.za-C.T&&37500>ee[2]&&C.F&&C.v==0&&!C.C&&(C.C=Vs(A(C.Za,C),6e3));if(1>=Yl(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else ft(C,11)}else if((p.K||C.g==p)&&jt(C),!b(I))for(ee=C.Da.g.parse(I),I=0;I<ee.length;I++){let nt=ee[I];if(C.T=nt[0],nt=nt[1],C.G==2)if(nt[0]=="c"){C.K=nt[1],C.ia=nt[2];const bn=nt[3];bn!=null&&(C.la=bn,C.j.info("VER="+C.la));const Pt=nt[4];Pt!=null&&(C.Aa=Pt,C.j.info("SVER="+C.Aa));const qs=nt[5];qs!=null&&typeof qs=="number"&&0<qs&&(B=1.5*qs,C.L=B,C.j.info("backChannelRequestTimeoutMs_="+B)),B=C;const _n=p.g;if(_n){const rc=_n.g?_n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rc){var le=B.h;le.g||rc.indexOf("spdy")==-1&&rc.indexOf("quic")==-1&&rc.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(za(le,le.h),le.h=null))}if(B.D){const Qa=_n.g?_n.g.getResponseHeader("X-HTTP-Session-Id"):null;Qa&&(B.ya=Qa,Ye(B.I,B.D,Qa))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-p.F,C.j.info("Handshake RTT: "+C.R+"ms")),B=C;var ve=p;if(B.qa=vf(B,B.J?B.ia:null,B.W),ve.K){xn(B.h,ve);var vt=ve,qn=B.L;qn&&(vt.I=qn),vt.B&&(Ku(vt),To(vt)),B.g=ve}else Ef(B);0<C.i.length&&wn(C)}else nt[0]!="stop"&&nt[0]!="close"||ft(C,7);else C.G==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?ft(C,7):eh(C):nt[0]!="noop"&&C.l&&C.l.ta(nt),C.v=0)}}is(4)}catch{}}var Ct=class{constructor(p,I){this.g=p,this.map=I}};function xt(p){this.l=p||10,h.PerformanceNavigationTiming?(p=h.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function st(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Yl(p){return p.h?1:p.g?p.g.size:0}function ja(p,I){return p.h?p.h==I:p.g?p.g.has(I):!1}function za(p,I){p.g?p.g.add(I):p.h=I}function xn(p,I){p.h&&p.h==I?p.h=null:p.g&&p.g.has(I)&&p.g.delete(I)}xt.prototype.cancel=function(){if(this.i=Di(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Di(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let I=p.i;for(const C of p.g.values())I=I.concat(C.D);return I}return D(p.i)}function Vg(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(f(p)){for(var I=[],C=p.length,B=0;B<C;B++)I.push(p[B]);return I}I=[],C=0;for(B in p)I[C++]=p[B];return I}function cn(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(f(p)||typeof p=="string"){var I=[];p=p.length;for(var C=0;C<p;C++)I.push(C);return I}I=[],C=0;for(const B in p)I[C++]=B;return I}}}function ki(p,I){if(p.forEach&&typeof p.forEach=="function")p.forEach(I,void 0);else if(f(p)||typeof p=="string")Array.prototype.forEach.call(p,I,void 0);else for(var C=cn(p),B=Vg(p),ee=B.length,le=0;le<ee;le++)I.call(void 0,B[le],C&&C[le],p)}var gf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Co(p,I){if(p){p=p.split("&");for(var C=0;C<p.length;C++){var B=p[C].indexOf("="),ee=null;if(0<=B){var le=p[C].substring(0,B);ee=p[C].substring(B+1)}else le=p[C];I(le,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function wt(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof wt){this.h=p.h,re(this,p.j),this.o=p.o,this.g=p.g,j(this,p.s),this.l=p.l;var I=p.i,C=new as;C.i=I.i,I.g&&(C.g=new Map(I.g),C.h=I.h),Ve(this,C),this.m=p.m}else p&&(I=String(p).match(gf))?(this.h=!1,re(this,I[1]||"",!0),this.o=Ga(I[2]||""),this.g=Ga(I[3]||"",!0),j(this,I[4]),this.l=Ga(I[5]||"",!0),Ve(this,I[6]||"",!0),this.m=Ga(I[7]||"")):(this.h=!1,this.i=new as(null,this.h))}wt.prototype.toString=function(){var p=[],I=this.j;I&&p.push(zs(I,Ue,!0),":");var C=this.g;return(C||I=="file")&&(p.push("//"),(I=this.o)&&p.push(zs(I,Ue,!0),"@"),p.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&p.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&p.push("/"),p.push(zs(C,C.charAt(0)=="/"?mf:Xt,!0))),(C=this.i.toString())&&p.push("?",C),(C=this.m)&&p.push("#",zs(C,Qu)),p.join("")};function Wt(p){return new wt(p)}function re(p,I,C){p.j=C?Ga(I,!0):I,p.j&&(p.j=p.j.replace(/:$/,""))}function j(p,I){if(I){if(I=Number(I),isNaN(I)||0>I)throw Error("Bad port number "+I);p.s=I}else p.s=null}function Ve(p,I,C){I instanceof as?(p.i=I,He(p.i,p.h)):(C||(I=zs(I,Bg)),p.i=new as(I,p.h))}function Ye(p,I,C){p.i.set(I,C)}function ar(p){return Ye(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Ga(p,I){return p?I?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function zs(p,I,C){return typeof p=="string"?(p=encodeURI(p).replace(I,qr),C&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function qr(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Ue=/[#\/\?@]/g,Xt=/[#\?:]/g,mf=/[#\?]/g,Bg=/[#\?@]/g,Qu=/#/g;function as(p,I){this.h=this.g=null,this.i=p||null,this.j=!!I}function xi(p){p.g||(p.g=new Map,p.h=0,p.i&&Co(p.i,function(I,C){p.add(decodeURIComponent(I.replace(/\+/g," ")),C)}))}t=as.prototype,t.add=function(p,I){xi(this),this.i=null,p=Nr(this,p);var C=this.g.get(p);return C||this.g.set(p,C=[]),C.push(I),this.h+=1,this};function pf(p,I){xi(p),I=Nr(p,I),p.g.has(I)&&(p.i=null,p.h-=p.g.get(I).length,p.g.delete(I))}function Sn(p,I){return xi(p),I=Nr(p,I),p.g.has(I)}t.forEach=function(p,I){xi(this),this.g.forEach(function(C,B){C.forEach(function(ee){p.call(I,ee,B,this)},this)},this)},t.na=function(){xi(this);const p=Array.from(this.g.values()),I=Array.from(this.g.keys()),C=[];for(let B=0;B<I.length;B++){const ee=p[B];for(let le=0;le<ee.length;le++)C.push(I[B])}return C},t.V=function(p){xi(this);let I=[];if(typeof p=="string")Sn(this,p)&&(I=I.concat(this.g.get(Nr(this,p))));else{p=Array.from(this.g.values());for(let C=0;C<p.length;C++)I=I.concat(p[C])}return I},t.set=function(p,I){return xi(this),this.i=null,p=Nr(this,p),Sn(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[I]),this.h+=1,this},t.get=function(p,I){return p?(p=this.V(p),0<p.length?String(p[0]):I):I};function So(p,I,C){pf(p,I),0<C.length&&(p.i=null,p.g.set(Nr(p,I),D(C)),p.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],I=Array.from(this.g.keys());for(var C=0;C<I.length;C++){var B=I[C];const le=encodeURIComponent(String(B)),ve=this.V(B);for(B=0;B<ve.length;B++){var ee=le;ve[B]!==""&&(ee+="="+encodeURIComponent(String(ve[B]))),p.push(ee)}}return this.i=p.join("&")};function Nr(p,I){return I=String(I),p.j&&(I=I.toLowerCase()),I}function He(p,I){I&&!p.j&&(xi(p),p.i=null,p.g.forEach(function(C,B){var ee=B.toLowerCase();B!=ee&&(pf(this,B),So(this,ee,C))},p)),p.j=I}function Ug(p,I){const C=new On;if(h.Image){const B=new Image;B.onload=N(Kt,C,"TestLoadImage: loaded",!0,I,B),B.onerror=N(Kt,C,"TestLoadImage: error",!1,I,B),B.onabort=N(Kt,C,"TestLoadImage: abort",!1,I,B),B.ontimeout=N(Kt,C,"TestLoadImage: timeout",!1,I,B),h.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=p}else I(!1)}function Ze(p,I){const C=new On,B=new AbortController,ee=setTimeout(()=>{B.abort(),Kt(C,"TestPingServer: timeout",!1,I)},1e4);fetch(p,{signal:B.signal}).then(le=>{clearTimeout(ee),le.ok?Kt(C,"TestPingServer: ok",!0,I):Kt(C,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(ee),Kt(C,"TestPingServer: error",!1,I)})}function Kt(p,I,C,B,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),B(C)}catch{}}function jg(){this.g=new rs}function Xu(p,I,C){const B=C||"";try{ki(p,function(ee,le){let ve=ee;m(ee)&&(ve=pt(ee)),I.push(B+le+"="+encodeURIComponent(ve))})}catch(ee){throw I.push(B+"type="+encodeURIComponent("_badmap")),ee}}function qa(p){this.l=p.Ub||null,this.j=p.eb||!1}U(qa,Ua),qa.prototype.g=function(){return new wi(this.l,this.j)},qa.prototype.i=function(p){return function(){return p}}({});function wi(p,I){We.call(this),this.D=p,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}U(wi,We),t=wi.prototype,t.open=function(p,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=I,this.readyState=1,Mi(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const I={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(I.body=p),(this.D||h).fetch(new Request(this.A,I)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Oi(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Mi(this)),this.g&&(this.readyState=3,Mi(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yf(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function yf(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var I=p.value?p.value:new Uint8Array(0);(I=this.v.decode(I,{stream:!p.done}))&&(this.response=this.responseText+=I)}p.done?Oi(this):Mi(this),this.readyState==3&&yf(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,Oi(this))},t.Qa=function(p){this.g&&(this.response=p,Oi(this))},t.ga=function(){this.g&&Oi(this)};function Oi(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Mi(p)}t.setRequestHeader=function(p,I){this.u.append(p,I)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],I=this.h.entries();for(var C=I.next();!C.done;)C=C.value,p.push(C[0]+": "+C[1]),C=I.next();return p.join(`\r
`)};function Mi(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(wi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function bo(p){let I="";return J(p,function(C,B){I+=B,I+=":",I+=C,I+=`\r
`}),I}function Zl(p,I,C){e:{for(B in C){var B=!1;break e}B=!0}B||(C=bo(C),typeof p=="string"?C!=null&&encodeURIComponent(String(C)):Ye(p,I,C))}function Lt(p){We.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}U(Lt,We);var Ha=/^https?$/i,yr=["POST","PUT"];t=Lt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,I,C,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);I=I?I.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ao.g(),this.v=this.o?qu(this.o):qu(Ao),this.g.onreadystatechange=A(this.Ea,this);try{this.B=!0,this.g.open(I,String(p),!0),this.B=!1}catch(le){Yu(this,le);return}if(p=C||"",C=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ee in B)C.set(ee,B[ee]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const le of B.keys())C.set(le,B.get(le));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(C.keys()).find(le=>le.toLowerCase()=="content-type"),ee=h.FormData&&p instanceof h.FormData,!(0<=Array.prototype.indexOf.call(yr,I,void 0))||B||ee||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,ve]of C)this.g.setRequestHeader(le,ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xf(this),this.u=!0,this.g.send(p),this.u=!1}catch(le){Yu(this,le)}};function Yu(p,I){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=I,p.m=5,Zu(p),Jl(p)}function Zu(p){p.A||(p.A=!0,qe(p,"complete"),qe(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,qe(this,"complete"),qe(this,"abort"),Jl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Jl(this,!0)),Lt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ju(this):this.bb())},t.bb=function(){Ju(this)};function Ju(p){if(p.h&&typeof l<"u"&&(!p.v[1]||Li(p)!=4||p.Z()!=2)){if(p.u&&Li(p)==4)ns(p.Ea,0,p);else if(qe(p,"readystatechange"),Li(p)==4){p.h=!1;try{const ve=p.Z();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var C;if(!(C=I)){var B;if(B=ve===0){var ee=String(p.D).match(gf)[1]||null;!ee&&h.self&&h.self.location&&(ee=h.self.location.protocol.slice(0,-1)),B=!Ha.test(ee?ee.toLowerCase():"")}C=B}if(C)qe(p,"complete"),qe(p,"success");else{p.m=6;try{var le=2<Li(p)?p.g.statusText:""}catch{le=""}p.l=le+" ["+p.Z()+"]",Zu(p)}}finally{Jl(p)}}}}function Jl(p,I){if(p.g){xf(p);const C=p.g,B=p.v[0]?()=>{}:null;p.g=null,p.v=null,I||qe(p,"ready");try{C.onreadystatechange=B}catch{}}}function xf(p){p.I&&(h.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function Li(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<Li(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var I=this.g.responseText;return p&&I.indexOf(p)==0&&(I=I.substring(p.length)),Ht(I)}};function St(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function wf(p){const I={};p=(p.g&&2<=Li(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<p.length;B++){if(b(p[B]))continue;var C=K(p[B]);const ee=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const le=I[ee]||[];I[ee]=le,le.push(C)}k(I,function(B){return B.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ls(p,I,C){return C&&C.internalChannelParams&&C.internalChannelParams[p]||I}function Fi(p){this.Aa=0,this.i=[],this.j=new On,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ls("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ls("baseRetryDelayMs",5e3,p),this.cb=ls("retryDelaySeedMs",1e4,p),this.Wa=ls("forwardChannelMaxRetries",2,p),this.wa=ls("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new xt(p&&p.concurrentRequestLimit),this.Da=new jg,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Fi.prototype,t.la=8,t.G=1,t.connect=function(p,I,C,B){or(0),this.W=p,this.H=I||{},C&&B!==void 0&&(this.H.OSID=C,this.H.OAID=B),this.F=this.X,this.I=vf(this,null,this.W),wn(this)};function eh(p){if(Je(p),p.G==3){var I=p.U++,C=Wt(p.I);if(Ye(C,"SID",p.K),Ye(C,"RID",I),Ye(C,"TYPE","terminate"),Wa(p,C),I=new zn(p,p.j,I),I.L=2,I.v=ar(Wt(C)),C=!1,h.navigator&&h.navigator.sendBeacon)try{C=h.navigator.sendBeacon(I.v.toString(),"")}catch{}!C&&h.Image&&(new Image().src=I.v,C=!0),C||(I.g=Ft(I.j,null),I.g.ea(I.v)),I.F=Date.now(),To(I)}ze(p)}function oe(p){p.g&&(un(p),p.g.cancel(),p.g=null)}function Je(p){oe(p),p.u&&(h.clearTimeout(p.u),p.u=null),jt(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&h.clearTimeout(p.s),p.s=null)}function wn(p){if(!st(p.h)&&!p.s){p.s=!0;var I=p.Ga;Oe||je(),Ie||(Oe(),Ie=!0),Me.add(I,p),p.B=0}}function ec(p,I){return Yl(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=I.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Vs(A(p.Ga,p,I),cs(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const ee=new zn(this,this.j,p);let le=this.o;if(this.S&&(le?(le=L(le),H(le,this.S)):le=this.S),this.m!==null||this.O||(ee.H=le,le=null),this.P)e:{for(var I=0,C=0;C<this.i.length;C++){t:{var B=this.i[C];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(I+=B,4096<I){I=C;break e}if(I===4096||C===this.i.length-1){I=C+1;break e}}I=1e3}else I=1e3;I=_f(this,ee,I),C=Wt(this.I),Ye(C,"RID",p),Ye(C,"CVER",22),this.D&&Ye(C,"X-HTTP-Session-Id",this.D),Wa(this,C),le&&(this.O?I="headers="+encodeURIComponent(String(bo(le)))+"&"+I:this.m&&Zl(C,this.m,le)),za(this.h,ee),this.Ua&&Ye(C,"TYPE","init"),this.P?(Ye(C,"$req",I),Ye(C,"SID","null"),ee.T=!0,Gn(ee,C,null)):Gn(ee,C,I),this.G=2}}else this.G==3&&(p?th(this,p):this.i.length==0||st(this.h)||th(this))};function th(p,I){var C;I?C=I.l:C=p.U++;const B=Wt(p.I);Ye(B,"SID",p.K),Ye(B,"RID",C),Ye(B,"AID",p.T),Wa(p,B),p.m&&p.o&&Zl(B,p.m,p.o),C=new zn(p,p.j,C,p.B+1),p.m===null&&(C.H=p.o),I&&(p.i=I.D.concat(p.i)),I=_f(p,C,1e3),C.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),za(p.h,C),Gn(C,B,I)}function Wa(p,I){p.H&&J(p.H,function(C,B){Ye(I,B,C)}),p.l&&ki({},function(C,B){Ye(I,B,C)})}function _f(p,I,C){C=Math.min(p.i.length,C);var B=p.l?A(p.l.Na,p.l,p):null;e:{var ee=p.i;let le=-1;for(;;){const ve=["count="+C];le==-1?0<C?(le=ee[0].g,ve.push("ofs="+le)):le=0:ve.push("ofs="+le);let vt=!0;for(let qn=0;qn<C;qn++){let nt=ee[qn].g;const bn=ee[qn].map;if(nt-=le,0>nt)le=Math.max(0,ee[qn].g-100),vt=!1;else try{Xu(bn,ve,"req"+nt+"_")}catch{B&&B(bn)}}if(vt){B=ve.join("&");break e}}}return p=p.i.splice(0,C),I.D=p,B}function Ef(p){if(!p.g&&!p.u){p.Y=1;var I=p.Fa;Oe||je(),Ie||(Oe(),Ie=!0),Me.add(I,p),p.v=0}}function Ka(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Vs(A(p.Fa,p),cs(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,tc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Vs(A(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,or(10),oe(this),tc(this))};function un(p){p.A!=null&&(h.clearTimeout(p.A),p.A=null)}function tc(p){p.g=new zn(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var I=Wt(p.qa);Ye(I,"RID","rpc"),Ye(I,"SID",p.K),Ye(I,"AID",p.T),Ye(I,"CI",p.F?"0":"1"),!p.F&&p.ja&&Ye(I,"TO",p.ja),Ye(I,"TYPE","xmlhttp"),Wa(p,I),p.m&&p.o&&Zl(I,p.m,p.o),p.L&&(p.g.I=p.L);var C=p.g;p=p.ia,C.L=1,C.v=ar(Wt(I)),C.m=null,C.P=!0,Ut(C,p)}t.Za=function(){this.C!=null&&(this.C=null,oe(this),Ka(this),or(19))};function jt(p){p.C!=null&&(h.clearTimeout(p.C),p.C=null)}function $a(p,I){var C=null;if(p.g==I){jt(p),un(p),p.g=null;var B=2}else if(ja(p.h,I))C=I.D,xn(p.h,I),B=1;else return;if(p.G!=0){if(I.o)if(B==1){C=I.m?I.m.length:0,I=Date.now()-I.F;var ee=p.B;B=Cn(),qe(B,new ss(B,C)),wn(p)}else Ef(p);else if(ee=I.s,ee==3||ee==0&&0<I.X||!(B==1&&ec(p,I)||B==2&&Ka(p)))switch(C&&0<C.length&&(I=p.h,I.i=I.i.concat(C)),ee){case 1:ft(p,5);break;case 4:ft(p,10);break;case 3:ft(p,6);break;default:ft(p,2)}}}function cs(p,I){let C=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(C*=2),C*I}function ft(p,I){if(p.j.info("Error code "+I),I==2){var C=A(p.fb,p),B=p.Xa;const ee=!B;B=new wt(B||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||re(B,"https"),ar(B),ee?Ug(B.toString(),C):Ze(B.toString(),C)}else or(2);p.G=0,p.l&&p.l.sa(I),ze(p),Je(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),or(2)):(this.j.info("Failed to ping google.com"),or(1))};function ze(p){if(p.G=0,p.ka=[],p.l){const I=Di(p.h);(I.length!=0||p.i.length!=0)&&(G(p.ka,I),G(p.ka,p.i),p.h.i.length=0,D(p.i),p.i.length=0),p.l.ra()}}function vf(p,I,C){var B=C instanceof wt?Wt(C):new wt(C);if(B.g!="")I&&(B.g=I+"."+B.g),j(B,B.s);else{var ee=h.location;B=ee.protocol,I=I?I+"."+ee.hostname:ee.hostname,ee=+ee.port;var le=new wt(null);B&&re(le,B),I&&(le.g=I),ee&&j(le,ee),C&&(le.l=C),B=le}return C=p.D,I=p.ya,C&&I&&Ye(B,C,I),Ye(B,"VER",p.la),Wa(p,B),B}function Ft(p,I,C){if(I&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return I=p.Ca&&!p.pa?new Lt(new qa({eb:C})):new Lt(p.pa),I.Ha(p.J),I}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function us(){}t=us.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Vi(){}Vi.prototype.g=function(p,I){return new Pr(p,I)};function Pr(p,I){We.call(this),this.g=new Fi(I),this.l=p,this.h=I&&I.messageUrlParams||null,p=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(p?p["X-WebChannel-Content-Type"]=I.messageContentType:p={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.va&&(p?p["X-WebChannel-Client-Profile"]=I.va:p={"X-WebChannel-Client-Profile":I.va}),this.g.S=p,(p=I&&I.Sb)&&!b(p)&&(this.g.m=p),this.v=I&&I.supportsCrossDomainXhr||!1,this.u=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!b(I)&&(this.g.D=I,p=this.h,p!==null&&I in p&&(p=this.h,I in p&&delete p[I])),this.j=new Gs(this)}U(Pr,We),Pr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Pr.prototype.close=function(){eh(this.g)},Pr.prototype.o=function(p){var I=this.g;if(typeof p=="string"){var C={};C.__data__=p,p=C}else this.u&&(C={},C.__data__=pt(p),p=C);I.i.push(new Ct(I.Ya++,p)),I.G==3&&wn(I)},Pr.prototype.N=function(){this.g.l=null,delete this.j,eh(this.g),delete this.g,Pr.aa.N.call(this)};function oi(p){$l.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var I=p.__sm__;if(I){e:{for(const C in I){p=C;break e}p=void 0}(this.i=p)&&(p=this.i,I=I!==null&&p in I?I[p]:void 0),this.data=I}else this.data=p}U(oi,$l);function nc(){Ql.call(this),this.status=1}U(nc,Ql);function Gs(p){this.g=p}U(Gs,us),Gs.prototype.ua=function(){qe(this.g,"a")},Gs.prototype.ta=function(p){qe(this.g,new oi(p))},Gs.prototype.sa=function(p){qe(this.g,new nc)},Gs.prototype.ra=function(){qe(this.g,"b")},Vi.prototype.createWebChannel=Vi.prototype.g,Pr.prototype.send=Pr.prototype.o,Pr.prototype.open=Pr.prototype.m,Pr.prototype.close=Pr.prototype.close,HC=function(){return new Vi},qC=function(){return Cn()},GC=Un,Xp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},jn.NO_ERROR=0,jn.TIMEOUT=8,jn.HTTP_ERROR=6,w0=jn,Us.COMPLETE="complete",zC=Us,yt.EventType=ii,ii.OPEN="a",ii.CLOSE="b",ii.ERROR="c",ii.MESSAGE="d",We.prototype.listen=We.prototype.K,Ah=yt,Lt.prototype.listenOnce=Lt.prototype.L,Lt.prototype.getLastError=Lt.prototype.Ka,Lt.prototype.getLastErrorCode=Lt.prototype.Ba,Lt.prototype.getStatus=Lt.prototype.Z,Lt.prototype.getResponseJson=Lt.prototype.Oa,Lt.prototype.getResponseText=Lt.prototype.oa,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Ha,jC=Lt}).apply(typeof Wf<"u"?Wf:typeof self<"u"?self:typeof window<"u"?window:{});const tE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};tr.UNAUTHENTICATED=new tr(null),tr.GOOGLE_CREDENTIALS=new tr("google-credentials-uid"),tr.FIRST_PARTY=new tr("first-party-uid"),tr.MOCK_USER=new tr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a=new Nx("@firebase/firestore");function dc(){return _a.logLevel}function BV(t){_a.setLogLevel(t)}function fe(t,...e){if(_a.logLevel<=ut.DEBUG){const n=e.map(jx);_a.debug(`Firestore (${Nu}): ${t}`,...n)}}function Nn(t,...e){if(_a.logLevel<=ut.ERROR){const n=e.map(jx);_a.error(`Firestore (${Nu}): ${t}`,...n)}}function bi(t,...e){if(_a.logLevel<=ut.WARN){const n=e.map(jx);_a.warn(`Firestore (${Nu}): ${t}`,...n)}}function jx(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(t="Unexpected state"){const e=`FIRESTORE (${Nu}) INTERNAL ASSERTION FAILED: `+t;throw Nn(e),new Error(e)}function De(t,e){t||Re()}function UV(t,e){t||Re()}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends Ds{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(tr.UNAUTHENTICATED))}shutdown(){}}class DO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class kO{constructor(e){this.t=e,this.currentUser=tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){De(this.o===void 0);let r=this.i;const i=f=>this.i!==r?(r=this.i,n(f)):Promise.resolve();let s=new rr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new rr,e.enqueueRetryable(()=>i(this.currentUser))};const l=()=>{const f=s;e.enqueueRetryable(async()=>{await f.promise,await i(this.currentUser)})},h=f=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(f=>h(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new rr)}},0),l()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(De(typeof r.accessToken=="string"),new WC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string"),new tr(e)}}class OO{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=tr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class MO{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new OO(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(tr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class KC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class LO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){De(this.o===void 0);const r=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const l=s.token!==this.R;return this.R=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(De(typeof n.token=="string"),this.R=n.token,new KC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class jV{getToken(){return Promise.resolve(new KC(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=FO(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function $e(t,e){return t<e?-1:t>e?1:0}function iu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function QC(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ge(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ge(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ge(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return gn.fromMillis(Date.now())}static fromDate(e){return gn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new gn(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?$e(this.nanoseconds,e.nanoseconds):$e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Be(e)}static min(){return new Be(new gn(0,0))}static max(){return new Be(new gn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,n,r){n===void 0?n=0:n>e.length&&Re(),r===void 0?r=e.length-n:r>e.length-n&&Re(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return pd.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof pd?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),l=n.get(i);if(s<l)return-1;if(s>l)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ht extends pd{construct(e,n,r){return new ht(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ge(ae.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ht(n)}static emptyPath(){return new ht([])}}const VO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class on extends pd{construct(e,n,r){return new on(e,n,r)}static isValidIdentifier(e){return VO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),on.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new on(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ge(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if(h==="\\"){if(i+1===e.length)throw new ge(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ge(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,i+=2}else h==="`"?(l=!l,i++):h!=="."||l?(r+=h,i++):(s(),i++)}if(s(),l)throw new ge(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new on(n)}static emptyPath(){return new on([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.path=e}static fromPath(e){return new Te(ht.fromString(e))}static fromName(e){return new Te(ht.fromString(e).popFirst(5))}static empty(){return new Te(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ht.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new ht(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Yp(t){return t.fields.find(e=>e.kind===2)}function el(t){return t.fields.filter(e=>e.kind!==2)}function BO(t,e){let n=$e(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=UO(t.fields[r],e.fields[r]),n!==0)return n;return $e(t.fields.length,e.fields.length)}su.UNKNOWN_ID=-1;class wl{constructor(e,n){this.fieldPath=e,this.kind=n}}function UO(t,e){const n=on.comparator(t.fieldPath,e.fieldPath);return n!==0?n:$e(t.kind,e.kind)}class ou{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new ou(0,gi.min())}}function XC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Be.fromTimestamp(r===1e9?new gn(n+1,0):new gn(n,r));return new gi(i,Te.empty(),e)}function YC(t){return new gi(t.readTime,t.key,-1)}class gi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new gi(Be.min(),Te.empty(),-1)}static max(){return new gi(Be.max(),Te.empty(),-1)}}function zx(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Te.comparator(t.documentKey,e.documentKey),n!==0?n:$e(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class JC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ka(t){if(t.code!==ae.FAILED_PRECONDITION||t.message!==ZC)throw t;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new te((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof te?n:te.resolve(n)}catch(n){return te.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):te.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):te.reject(n)}static resolve(e){return new te((n,r)=>{n(e)})}static reject(e){return new te((n,r)=>{r(e)})}static waitFor(e){return new te((n,r)=>{let i=0,s=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++s,l&&s===i&&n()},f=>r(f))}),l=!0,s===i&&n()})}static or(e){let n=te.resolve(!1);for(const r of e)n=n.next(i=>i?te.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new te((r,i)=>{const s=e.length,l=new Array(s);let h=0;for(let f=0;f<s;f++){const m=f;n(e[m]).next(x=>{l[m]=x,++h,h===s&&r(l)},x=>i(x))}})}static doWhile(e,n){return new te((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new rr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Vh(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Gx(r.target.error);this.V.reject(new Vh(e,i))}}static open(e,n,r,i){try{return new ag(n,e.transaction(i,r))}catch(s){throw new Vh(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(fe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new zO(n)}}class Ss{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Ss.S($n())===12.2&&Nn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return fe("SimpleDb","Removing database:",e),tl(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!XT())return!1;if(Ss.v())return!0;const e=$n(),n=Ss.S(e),r=0<n&&n<10,i=eS(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(fe("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const l=s.target.result;n(l)},i.onblocked=()=>{r(new Vh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const l=s.target.error;l.name==="VersionError"?r(new ge(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new ge(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new Vh(e,l))},i.onupgradeneeded=s=>{fe("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const l=s.target.result;this.p.O(l,i.transaction,s.oldVersion,this.version).next(()=>{fe("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let l=0;for(;;){++l;try{this.db=await this.M(e);const h=ag.open(this.db,e,s?"readonly":"readwrite",r),f=i(h).next(m=>(h.g(),m)).catch(m=>(h.abort(m),te.reject(m))).toPromise();return f.catch(()=>{}),await h.m,f}catch(h){const f=h,m=f.name!=="FirebaseError"&&l<3;if(fe("SimpleDb","Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class jO{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return tl(this.B.delete())}}class Vh extends ge{constructor(e,n){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Oa(t){return t.name==="IndexedDbTransactionError"}class zO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(fe("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(fe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),tl(r)}add(e){return fe("SimpleDb","ADD",this.store.name,e,e),tl(this.store.add(e))}get(e){return tl(this.store.get(e)).next(n=>(n===void 0&&(n=null),fe("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return fe("SimpleDb","DELETE",this.store.name,e),tl(this.store.delete(e))}count(){return fe("SimpleDb","COUNT",this.store.name),tl(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new te((l,h)=>{s.onerror=f=>{h(f.target.error)},s.onsuccess=f=>{l(f.target.result)}})}{const s=this.cursor(r),l=[];return this.W(s,(h,f)=>{l.push(f)}).next(()=>l)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new te((i,s)=>{r.onerror=l=>{s(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}j(e,n){fe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,l,h)=>h.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new te((r,i)=>{n.onerror=s=>{const l=Gx(s.target.error);i(l)},n.onsuccess=s=>{const l=s.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}W(e,n){const r=[];return new te((i,s)=>{e.onerror=l=>{s(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const f=new jO(h),m=n(h.primaryKey,h.value,f);if(m instanceof te){const x=m.catch(E=>(f.done(),te.reject(E)));r.push(x)}f.isDone?i():f.K===null?h.continue():h.continue(f.K)}}).next(()=>te.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function tl(t){return new te((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Gx(r.target.error);n(i)}})}let nE=!1;function Gx(t){const e=Ss.S($n());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ge("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return nE||(nE=!0,setTimeout(()=>{throw r},0)),r}}return t}class GO{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){fe("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{fe("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Oa(n)?fe("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await ka(n)}await this.X(6e4)})}}class qO{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return te.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(l!==null&&!r.has(l))return fe("IndexBackfiller",`Processing collection: ${l}`),this.ne(e,l,i).next(h=>{i-=h,r.add(l)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const l=s.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.re(i,s)).next(h=>(fe("IndexBackfiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,n,h))).next(()=>l.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const l=YC(s);zx(l,r)>0&&(r=l)}),new gi(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Xr.oe=-1;function Wd(t){return t==null}function yd(t){return t===0&&1/t==-1/0}function tS(t){return typeof t=="number"&&Number.isInteger(t)&&!yd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=rE(e)),e=HO(t.get(n),e);return rE(e)}function HO(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function rE(t){return t+""}function _s(t){const e=t.length;if(De(e>=2),e===2)return De(t.charAt(0)===""&&t.charAt(1)===""),ht.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const l=t.indexOf("",s);switch((l<0||l>n)&&Re(),t.charAt(l+1)){case"":const h=t.substring(s,l);let f;i.length===0?f=h:(i+=h,f=i,i=""),r.push(f);break;case"":i+=t.substring(s,l),i+="\0";break;case"":i+=t.substring(s,l+1);break;default:Re()}s=l+2}return new ht(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(t,e){return[t,Sr(e)]}function nS(t,e,n){return[t,Sr(e),n]}const WO={},KO=["prefixPath","collectionGroup","readTime","documentId"],$O=["prefixPath","collectionGroup","documentId"],QO=["collectionGroup","readTime","prefixPath","documentId"],XO=["canonicalId","targetId"],YO=["targetId","path"],ZO=["path","targetId"],JO=["collectionId","parent"],e5=["indexId","uid"],t5=["uid","sequenceNumber"],n5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],r5=["indexId","uid","orderedDocumentKey"],i5=["userId","collectionPath","documentId"],s5=["userId","collectionPath","largestBatchId"],o5=["userId","collectionGroup","largestBatchId"],rS=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],a5=[...rS,"documentOverlays"],iS=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],sS=iS,qx=[...sS,"indexConfiguration","indexState","indexEntries"],l5=qx,c5=[...qx,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp extends JC{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Qn(t,e){const n=Ae(t);return Ss.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ma(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function oS(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function aS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,n){this.comparator=e,this.root=n||ur.EMPTY}insert(e,n){return new Qt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ur.BLACK,null,null))}remove(e){return new Qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ur.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kf(this.root,e,this.comparator,!0)}}class Kf{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ur{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??ur.RED,this.left=i??ur.EMPTY,this.right=s??ur.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new ur(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ur.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return ur.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ur.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ur.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Re();const e=this.left.check();if(e!==this.right.check())throw Re();return e+(this.isRed()?0:1)}}ur.EMPTY=null,ur.RED=!0,ur.BLACK=!1;ur.EMPTY=new class{constructor(){this.size=0}get key(){throw Re()}get value(){throw Re()}get color(){throw Re()}get left(){throw Re()}get right(){throw Re()}copy(e,n,r,i,s){return this}insert(e,n,r){return new ur(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.comparator=e,this.data=new Qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new oE(this.data.getIterator())}getIteratorFrom(e){return new oE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Vt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Vt(this.comparator);return n.data=e,n}}class oE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ac(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.fields=e,e.sort(on.comparator)}static empty(){return new Yr([])}unionWith(e){let n=new Vt(on.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Yr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return iu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GV(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new lS("Invalid base64 string: "+s):s}}(e);return new An(n)}static fromUint8Array(e){const n=function(i){let s="";for(let l=0;l<i.length;++l)s+=String.fromCharCode(i[l]);return s}(e);return new An(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return $e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}An.EMPTY_BYTE_STRING=new An("");const u5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function go(t){if(De(!!t),typeof t=="string"){let e=0;const n=u5.exec(t);if(De(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rn(t.seconds),nanos:rn(t.nanos)}}function rn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function mo(t){return typeof t=="string"?An.fromBase64String(t):An.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function cg(t){const e=t.mapValue.fields.__previous_value__;return lg(e)?cg(e):e}function xd(t){const e=go(t.mapValue.fields.__local_write_time__.timestampValue);return new gn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,n,r,i,s,l,h,f,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=m}}class bl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new bl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof bl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},E0={nullValue:"NULL_VALUE"};function Ea(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?lg(t)?4:cS(t)?9007199254740991:ug(t)?10:11:Re()}function Ns(t,e){if(t===e)return!0;const n=Ea(t);if(n!==Ea(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xd(t).isEqual(xd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const l=go(i.timestampValue),h=go(s.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return mo(i.bytesValue).isEqual(mo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return rn(i.geoPointValue.latitude)===rn(s.geoPointValue.latitude)&&rn(i.geoPointValue.longitude)===rn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return rn(i.integerValue)===rn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const l=rn(i.doubleValue),h=rn(s.doubleValue);return l===h?yd(l)===yd(h):isNaN(l)&&isNaN(h)}return!1}(t,e);case 9:return iu(t.arrayValue.values||[],e.arrayValue.values||[],Ns);case 10:case 11:return function(i,s){const l=i.mapValue.fields||{},h=s.mapValue.fields||{};if(sE(l)!==sE(h))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(h[f]===void 0||!Ns(l[f],h[f])))return!1;return!0}(t,e);default:return Re()}}function wd(t,e){return(t.values||[]).find(n=>Ns(n,e))!==void 0}function va(t,e){if(t===e)return 0;const n=Ea(t),r=Ea(e);if(n!==r)return $e(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return $e(t.booleanValue,e.booleanValue);case 2:return function(s,l){const h=rn(s.integerValue||s.doubleValue),f=rn(l.integerValue||l.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(t,e);case 3:return aE(t.timestampValue,e.timestampValue);case 4:return aE(xd(t),xd(e));case 5:return $e(t.stringValue,e.stringValue);case 6:return function(s,l){const h=mo(s),f=mo(l);return h.compareTo(f)}(t.bytesValue,e.bytesValue);case 7:return function(s,l){const h=s.split("/"),f=l.split("/");for(let m=0;m<h.length&&m<f.length;m++){const x=$e(h[m],f[m]);if(x!==0)return x}return $e(h.length,f.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,l){const h=$e(rn(s.latitude),rn(l.latitude));return h!==0?h:$e(rn(s.longitude),rn(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return lE(t.arrayValue,e.arrayValue);case 10:return function(s,l){var h,f,m,x;const E=s.fields||{},A=l.fields||{},N=(h=E.value)===null||h===void 0?void 0:h.arrayValue,U=(f=A.value)===null||f===void 0?void 0:f.arrayValue,D=$e(((m=N==null?void 0:N.values)===null||m===void 0?void 0:m.length)||0,((x=U==null?void 0:U.values)===null||x===void 0?void 0:x.length)||0);return D!==0?D:lE(N,U)}(t.mapValue,e.mapValue);case 11:return function(s,l){if(s===ra.mapValue&&l===ra.mapValue)return 0;if(s===ra.mapValue)return 1;if(l===ra.mapValue)return-1;const h=s.fields||{},f=Object.keys(h),m=l.fields||{},x=Object.keys(m);f.sort(),x.sort();for(let E=0;E<f.length&&E<x.length;++E){const A=$e(f[E],x[E]);if(A!==0)return A;const N=va(h[f[E]],m[x[E]]);if(N!==0)return N}return $e(f.length,x.length)}(t.mapValue,e.mapValue);default:throw Re()}}function aE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return $e(t,e);const n=go(t),r=go(e),i=$e(n.seconds,r.seconds);return i!==0?i:$e(n.nanos,r.nanos)}function lE(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=va(n[i],r[i]);if(s)return s}return $e(n.length,r.length)}function au(t){return Jp(t)}function Jp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=go(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return mo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Jp(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const l of r)s?s=!1:i+=",",i+=`${l}:${Jp(n.fields[l])}`;return i+"}"}(t.mapValue):Re()}function v0(t){switch(Ea(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cg(t);return e?16+v0(e):16;case 5:return 2*t.stringValue.length;case 6:return mo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+v0(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Ma(r.fields,(s,l)=>{i+=s.length+v0(l)}),i}(t.mapValue);default:throw Re()}}function Rl(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ey(t){return!!t&&"integerValue"in t}function _d(t){return!!t&&"arrayValue"in t}function cE(t){return!!t&&"nullValue"in t}function uE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function I0(t){return!!t&&"mapValue"in t}function ug(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Bh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ma(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Bh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Bh(t.arrayValue.values[n]);return e}return Object.assign({},t)}function cS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const uS={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function d5(t){return"nullValue"in t?E0:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Rl(bl.empty(),Te.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?ug(t)?uS:{mapValue:{}}:Re()}function f5(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Rl(bl.empty(),Te.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?uS:"mapValue"in t?ug(t)?{mapValue:{}}:ra:Re()}function hE(t,e){const n=va(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function dE(t,e){const n=va(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e){this.value=e}static empty(){return new hr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!I0(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bh(n)}setAll(e){let n=on.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!n.isImmediateParentOf(h)){const f=this.getFieldsMap(n);this.applyChanges(f,r,i),r={},i=[],n=h.popLast()}l?r[h.lastSegment()]=Bh(l):i.push(h.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());I0(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ns(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];I0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ma(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new hr(Bh(this.value))}}function hS(t){const e=[];return Ma(t.fields,(n,r)=>{const i=new on([n]);if(I0(r)){const s=hS(r.mapValue).fields;if(s.length===0)e.push(i);else for(const l of s)e.push(i.child(l))}else e.push(i)}),new Yr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,n,r,i,s,l,h){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=l,this.documentState=h}static newInvalidDocument(e){return new Jt(e,0,Be.min(),Be.min(),Be.min(),hr.empty(),0)}static newFoundDocument(e,n,r,i){return new Jt(e,1,n,Be.min(),r,i,0)}static newNoDocument(e,n){return new Jt(e,2,n,Be.min(),Be.min(),hr.empty(),0)}static newUnknownDocument(e,n){return new Jt(e,3,n,Be.min(),Be.min(),hr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=hr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=hr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Jt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Jt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,n){this.position=e,this.inclusive=n}}function fE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],l=t.position[i];if(s.field.isKeyField()?r=Te.comparator(Te.fromName(l.referenceValue),n.key):r=va(l,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function gE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ns(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,n="asc"){this.field=e,this.dir=n}}function g5(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{}class dt extends dS{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new m5(e,n,r):n==="array-contains"?new x5(e,r):n==="in"?new xS(e,r):n==="not-in"?new w5(e,r):n==="array-contains-any"?new _5(e,r):new dt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new p5(e,r):new y5(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(va(n,this.value)):n!==null&&Ea(this.value)===Ea(n)&&this.matchesComparison(va(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dt extends dS{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Dt(e,n)}matches(e){return lu(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function lu(t){return t.op==="and"}function ty(t){return t.op==="or"}function Hx(t){return fS(t)&&lu(t)}function fS(t){for(const e of t.filters)if(e instanceof Dt)return!1;return!0}function ny(t){if(t instanceof dt)return t.field.canonicalString()+t.op.toString()+au(t.value);if(Hx(t))return t.filters.map(e=>ny(e)).join(",");{const e=t.filters.map(n=>ny(n)).join(",");return`${t.op}(${e})`}}function gS(t,e){return t instanceof dt?function(r,i){return i instanceof dt&&r.op===i.op&&r.field.isEqual(i.field)&&Ns(r.value,i.value)}(t,e):t instanceof Dt?function(r,i){return i instanceof Dt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,l,h)=>s&&gS(l,i.filters[h]),!0):!1}(t,e):void Re()}function mS(t,e){const n=t.filters.concat(e);return Dt.create(n,t.op)}function pS(t){return t instanceof dt?function(n){return`${n.field.canonicalString()} ${n.op} ${au(n.value)}`}(t):t instanceof Dt?function(n){return n.op.toString()+" {"+n.getFilters().map(pS).join(" ,")+"}"}(t):"Filter"}class m5 extends dt{constructor(e,n,r){super(e,n,r),this.key=Te.fromName(r.referenceValue)}matches(e){const n=Te.comparator(e.key,this.key);return this.matchesComparison(n)}}class p5 extends dt{constructor(e,n){super(e,"in",n),this.keys=yS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class y5 extends dt{constructor(e,n){super(e,"not-in",n),this.keys=yS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function yS(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Te.fromName(r.referenceValue))}class x5 extends dt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return _d(n)&&wd(n.arrayValue,this.value)}}class xS extends dt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&wd(this.value.arrayValue,n)}}class w5 extends dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(wd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!wd(this.value.arrayValue,n)}}class _5 extends dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!_d(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>wd(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e,n=null,r=[],i=[],s=null,l=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=l,this.endAt=h,this.ue=null}}function ry(t,e=null,n=[],r=[],i=null,s=null,l=null){return new E5(t,e,n,r,i,s,l)}function Nl(t){const e=Ae(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ny(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Wd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>au(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>au(r)).join(",")),e.ue=n}return e.ue}function Kd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!g5(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!gS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gE(t.startAt,e.startAt)&&gE(t.endAt,e.endAt)}function u1(t){return Te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function h1(t,e){return t.filters.filter(n=>n instanceof dt&&n.field.isEqual(e))}function mE(t,e,n){let r=E0,i=!0;for(const s of h1(t,e)){let l=E0,h=!0;switch(s.op){case"<":case"<=":l=d5(s.value);break;case"==":case"in":case">=":l=s.value;break;case">":l=s.value,h=!1;break;case"!=":case"not-in":l=E0}hE({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const l=n.position[s];hE({value:r,inclusive:i},{value:l,inclusive:n.inclusive})<0&&(r=l,i=n.inclusive);break}}return{value:r,inclusive:i}}function pE(t,e,n){let r=ra,i=!0;for(const s of h1(t,e)){let l=ra,h=!0;switch(s.op){case">=":case">":l=f5(s.value),h=!1;break;case"==":case"in":case"<=":l=s.value;break;case"<":l=s.value,h=!1;break;case"!=":case"not-in":l=ra}dE({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const l=n.position[s];dE({value:r,inclusive:i},{value:l,inclusive:n.inclusive})>0&&(r=l,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e,n=null,r=[],i=[],s=null,l="F",h=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=l,this.startAt=h,this.endAt=f,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function wS(t,e,n,r,i,s,l,h){return new wo(t,e,n,r,i,s,l,h)}function Pu(t){return new wo(t)}function yE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Wx(t){return t.collectionGroup!==null}function Uc(t){const e=Ae(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new Vt(on.comparator);return l.filters.forEach(f=>{f.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ed(s,r))}),n.has(on.keyField().canonicalString())||e.ce.push(new Ed(on.keyField(),r))}return e.ce}function br(t){const e=Ae(t);return e.le||(e.le=ES(e,Uc(t))),e.le}function _S(t){const e=Ae(t);return e.he||(e.he=ES(e,t.explicitOrderBy)),e.he}function ES(t,e){if(t.limitType==="F")return ry(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ed(i.field,s)});const n=t.endAt?new Ia(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ia(t.startAt.position,t.startAt.inclusive):null;return ry(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function iy(t,e){const n=t.filters.concat([e]);return new wo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function d1(t,e,n){return new wo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $d(t,e){return Kd(br(t),br(e))&&t.limitType===e.limitType}function vS(t){return`${Nl(br(t))}|lt:${t.limitType}`}function fc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>pS(i)).join(", ")}]`),Wd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>au(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>au(i)).join(",")),`Target(${r})`}(br(t))}; limitType=${t.limitType})`}function Qd(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Te.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Uc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(l,h,f){const m=fE(l,h,f);return l.inclusive?m<=0:m<0}(r.startAt,Uc(r),i)||r.endAt&&!function(l,h,f){const m=fE(l,h,f);return l.inclusive?m>=0:m>0}(r.endAt,Uc(r),i))}(t,e)}function IS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function AS(t){return(e,n)=>{let r=!1;for(const i of Uc(t)){const s=v5(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function v5(t,e,n){const r=t.field.isKeyField()?Te.comparator(e.key,n.key):function(s,l,h){const f=l.data.field(s),m=h.data.field(s);return f!==null&&m!==null?va(f,m):Re()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ma(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return aS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5=new Qt(Te.comparator);function Zr(){return I5}const TS=new Qt(Te.comparator);function Th(...t){let e=TS;for(const n of t)e=e.insert(n.key,n);return e}function CS(t){let e=TS;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Es(){return Uh()}function SS(){return Uh()}function Uh(){return new _o(t=>t.toString(),(t,e)=>t.isEqual(e))}const A5=new Qt(Te.comparator),T5=new Vt(Te.comparator);function tt(...t){let e=T5;for(const n of t)e=e.add(n);return e}const C5=new Vt($e);function Kx(){return C5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $x(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yd(e)?"-0":e}}function bS(t){return{integerValue:""+t}}function RS(t,e){return tS(e)?bS(e):$x(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(){this._=void 0}}function S5(t,e,n){return t instanceof cu?function(i,s){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&lg(s)&&(s=cg(s)),s&&(l.fields.__previous_value__=s),{mapValue:l}}(n,e):t instanceof Pl?PS(t,e):t instanceof Dl?DS(t,e):function(i,s){const l=NS(i,s),h=xE(l)+xE(i.Pe);return ey(l)&&ey(i.Pe)?bS(h):$x(i.serializer,h)}(t,e)}function b5(t,e,n){return t instanceof Pl?PS(t,e):t instanceof Dl?DS(t,e):n}function NS(t,e){return t instanceof uu?function(r){return ey(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class cu extends hg{}class Pl extends hg{constructor(e){super(),this.elements=e}}function PS(t,e){const n=kS(e);for(const r of t.elements)n.some(i=>Ns(i,r))||n.push(r);return{arrayValue:{values:n}}}class Dl extends hg{constructor(e){super(),this.elements=e}}function DS(t,e){let n=kS(e);for(const r of t.elements)n=n.filter(i=>!Ns(i,r));return{arrayValue:{values:n}}}class uu extends hg{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function xE(t){return rn(t.integerValue||t.doubleValue)}function kS(t){return _d(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,n){this.field=e,this.transform=n}}function R5(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Pl&&i instanceof Pl||r instanceof Dl&&i instanceof Dl?iu(r.elements,i.elements,Ns):r instanceof uu&&i instanceof uu?Ns(r.Pe,i.Pe):r instanceof cu&&i instanceof cu}(t.transform,e.transform)}class N5{constructor(e,n){this.version=e,this.transformResults=n}}class an{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new an}static exists(e){return new an(void 0,e)}static updateTime(e){return new an(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function A0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class dg{}function OS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ku(t.key,an.none()):new Du(t.key,t.data,an.none());{const n=t.data,r=hr.empty();let i=new Vt(on.comparator);for(let s of e.fields)if(!i.has(s)){let l=n.field(s);l===null&&s.length>1&&(s=s.popLast(),l=n.field(s)),l===null?r.delete(s):r.set(s,l),i=i.add(s)}return new Eo(t.key,r,new Yr(i.toArray()),an.none())}}function P5(t,e,n){t instanceof Du?function(i,s,l){const h=i.value.clone(),f=_E(i.fieldTransforms,s,l.transformResults);h.setAll(f),s.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(t,e,n):t instanceof Eo?function(i,s,l){if(!A0(i.precondition,s))return void s.convertToUnknownDocument(l.version);const h=_E(i.fieldTransforms,s,l.transformResults),f=s.data;f.setAll(MS(i)),f.setAll(h),s.convertToFoundDocument(l.version,f).setHasCommittedMutations()}(t,e,n):function(i,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,n)}function jh(t,e,n,r){return t instanceof Du?function(s,l,h,f){if(!A0(s.precondition,l))return h;const m=s.value.clone(),x=EE(s.fieldTransforms,f,l);return m.setAll(x),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(t,e,n,r):t instanceof Eo?function(s,l,h,f){if(!A0(s.precondition,l))return h;const m=EE(s.fieldTransforms,f,l),x=l.data;return x.setAll(MS(s)),x.setAll(m),l.convertToFoundDocument(l.version,x).setHasLocalMutations(),h===null?null:h.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(E=>E.field))}(t,e,n,r):function(s,l,h){return A0(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(t,e,n)}function D5(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=NS(r.transform,i||null);s!=null&&(n===null&&(n=hr.empty()),n.set(r.field,s))}return n||null}function wE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&iu(r,i,(s,l)=>R5(s,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Du extends dg{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Eo extends dg{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function MS(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function _E(t,e,n){const r=new Map;De(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],l=s.transform,h=e.data.field(s.field);r.set(s.field,b5(l,h,n[i]))}return r}function EE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,l=n.data.field(i.field);r.set(i.field,S5(s,l,e))}return r}class ku extends dg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Qx extends dg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&P5(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=jh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=jh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=SS();return this.mutations.forEach(i=>{const s=e.get(i.key),l=s.overlayedDocument;let h=this.applyToLocalView(l,s.mutatedFields);h=n.has(i.key)?null:h;const f=OS(l,h);f!==null&&r.set(i.key,f),l.isValidDocument()||l.convertToNoDocument(Be.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),tt())}isEqual(e){return this.batchId===e.batchId&&iu(this.mutations,e.mutations,(n,r)=>wE(n,r))&&iu(this.baseMutations,e.baseMutations,(n,r)=>wE(n,r))}}class Yx{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){De(e.mutations.length===r.length);let i=function(){return A5}();const s=e.mutations;for(let l=0;l<s.length;l++)i=i.insert(s[l].key,r[l].version);return new Yx(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ln,_t;function FS(t){switch(t){default:return Re();case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0}}function VS(t){if(t===void 0)return Nn("GRPC error has no .code"),ae.UNKNOWN;switch(t){case Ln.OK:return ae.OK;case Ln.CANCELLED:return ae.CANCELLED;case Ln.UNKNOWN:return ae.UNKNOWN;case Ln.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Ln.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Ln.INTERNAL:return ae.INTERNAL;case Ln.UNAVAILABLE:return ae.UNAVAILABLE;case Ln.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Ln.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Ln.NOT_FOUND:return ae.NOT_FOUND;case Ln.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Ln.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Ln.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Ln.ABORTED:return ae.ABORTED;case Ln.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Ln.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Ln.DATA_LOSS:return ae.DATA_LOSS;default:return Re()}}(_t=Ln||(Ln={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let f1=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O5=new xl([4294967295,4294967295],0);function vE(t){const e=BS().encode(t),n=new UC;return n.update(e),new Uint8Array(n.digest())}function IE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new xl([n,r],0),new xl([i,s],0)]}class Jx{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ch(`Invalid padding: ${n}`);if(r<0)throw new Ch(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ch(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ch(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=xl.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(xl.fromNumber(r)));return i.compare(O5)===1&&(i=new xl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=vE(e),[r,i]=IE(n);for(let s=0;s<this.hashCount;s++){const l=this.Ee(r,i,s);if(!this.de(l))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new Jx(s,i,n);return r.forEach(h=>l.insert(h)),l}insert(e){if(this.Ie===0)return;const n=vE(e),[r,i]=IE(n);for(let s=0;s<this.hashCount;s++){const l=this.Ee(r,i,s);this.Ae(l)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ch extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Zd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Yd(Be.min(),i,new Qt($e),Zr(),tt())}}class Zd{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zd(r,n,tt(),tt(),tt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class US{constructor(e,n){this.targetId=e,this.me=n}}class jS{constructor(e,n,r=An.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class AE{constructor(){this.fe=0,this.ge=CE(),this.pe=An.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=tt(),n=tt(),r=tt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Re()}}),new Zd(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=CE()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,De(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class M5{constructor(e){this.Le=e,this.Be=new Map,this.ke=Zr(),this.qe=TE(),this.Qe=new Qt($e)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Re()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(u1(s))if(r===0){const l=new Te(s.path);this.Ue(n,l,Jt.newNoDocument(l,Be.min()))}else De(r===1);else{const l=this.Ye(n);if(l!==r){const h=this.Ze(e),f=h?this.Xe(h,e,l):1;if(f!==0){this.je(n);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,m)}f1==null||f1.et(function(x,E,A,N,U){var D,G,M,b,P,V;const $={localCacheCount:x,existenceFilterCount:E.count,databaseId:A.database,projectId:A.projectId},J=E.unchangedNames;return J&&($.bloomFilter={applied:U===0,hashCount:(D=J==null?void 0:J.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(b=(M=(G=J==null?void 0:J.bits)===null||G===void 0?void 0:G.bitmap)===null||M===void 0?void 0:M.length)!==null&&b!==void 0?b:0,padding:(V=(P=J==null?void 0:J.bits)===null||P===void 0?void 0:P.padding)!==null&&V!==void 0?V:0,mightContain:k=>{var L;return(L=N==null?void 0:N.mightContain(k))!==null&&L!==void 0&&L}}),$}(l,e.me,this.Le.tt(),h,f))}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let l,h;try{l=mo(r).toUint8Array()}catch(f){if(f instanceof lS)return bi("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new Jx(l,i,s)}catch(f){return bi(f instanceof Ch?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.Ie===0?null:h}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const l=this.Le.tt(),h=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(h)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,l)=>{const h=this.Je(l);if(h){if(s.current&&u1(h.target)){const f=new Te(h.target.path);this.ke.get(f)!==null||this.it(l,f)||this.Ue(l,f,Jt.newNoDocument(f,e))}s.be&&(n.set(l,s.ve()),s.Ce())}});let r=tt();this.qe.forEach((s,l)=>{let h=!0;l.forEachWhile(f=>{const m=this.Je(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(r=r.add(s))}),this.ke.forEach((s,l)=>l.setReadTime(e));const i=new Yd(e,n,this.Qe,this.ke,r);return this.ke=Zr(),this.qe=TE(),this.Qe=new Qt($e),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new AE,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Vt($e),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||fe("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new AE),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function TE(){return new Qt(Te.comparator)}function CE(){return new Qt(Te.comparator)}const L5=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),F5=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),V5=(()=>({and:"AND",or:"OR"}))();class B5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function sy(t,e){return t.useProto3Json||Wd(e)?e:{value:e}}function hu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function U5(t,e){return hu(t,e.toTimestamp())}function Dn(t){return De(!!t),Be.fromTimestamp(function(n){const r=go(n);return new gn(r.seconds,r.nanos)}(t))}function ew(t,e){return oy(t,e).canonicalString()}function oy(t,e){const n=function(i){return new ht(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function GS(t){const e=ht.fromString(t);return De(JS(e)),e}function vd(t,e){return ew(t.databaseId,e.path)}function bs(t,e){const n=GS(e);if(n.get(1)!==t.databaseId.projectId)throw new ge(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ge(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Te(WS(n))}function qS(t,e){return ew(t.databaseId,e)}function HS(t){const e=GS(t);return e.length===4?ht.emptyPath():WS(e)}function ay(t){return new ht(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function WS(t){return De(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function SE(t,e,n){return{name:vd(t,e),fields:n.value.mapValue.fields}}function KS(t,e,n){const r=bs(t,e.name),i=Dn(e.updateTime),s=e.createTime?Dn(e.createTime):Be.min(),l=new hr({mapValue:{fields:e.fields}}),h=Jt.newFoundDocument(r,i,s,l);return n&&h.setHasCommittedMutations(),n?h.setHasCommittedMutations():h}function j5(t,e){return"found"in e?function(r,i){De(!!i.found),i.found.name,i.found.updateTime;const s=bs(r,i.found.name),l=Dn(i.found.updateTime),h=i.found.createTime?Dn(i.found.createTime):Be.min(),f=new hr({mapValue:{fields:i.found.fields}});return Jt.newFoundDocument(s,l,h,f)}(t,e):"missing"in e?function(r,i){De(!!i.missing),De(!!i.readTime);const s=bs(r,i.missing),l=Dn(i.readTime);return Jt.newNoDocument(s,l)}(t,e):Re()}function z5(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Re()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(m,x){return m.useProto3Json?(De(x===void 0||typeof x=="string"),An.fromBase64String(x||"")):(De(x===void 0||x instanceof Buffer||x instanceof Uint8Array),An.fromUint8Array(x||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){const x=m.code===void 0?ae.UNKNOWN:VS(m.code);return new ge(x,m.message||"")}(l);n=new jS(r,i,s,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=bs(t,r.document.name),s=Dn(r.document.updateTime),l=r.document.createTime?Dn(r.document.createTime):Be.min(),h=new hr({mapValue:{fields:r.document.fields}}),f=Jt.newFoundDocument(i,s,l,h),m=r.targetIds||[],x=r.removedTargetIds||[];n=new T0(m,x,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=bs(t,r.document),s=r.readTime?Dn(r.readTime):Be.min(),l=Jt.newNoDocument(i,s),h=r.removedTargetIds||[];n=new T0([],h,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=bs(t,r.document),s=r.removedTargetIds||[];n=new T0([],s,i,null)}else{if(!("filter"in e))return Re();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,l=new k5(i,s),h=r.targetId;n=new US(h,l)}}return n}function Id(t,e){let n;if(e instanceof Du)n={update:SE(t,e.key,e.value)};else if(e instanceof ku)n={delete:vd(t,e.key)};else if(e instanceof Eo)n={update:SE(t,e.key,e.data),updateMask:$5(e.fieldMask)};else{if(!(e instanceof Qx))return Re();n={verify:vd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,l){const h=l.transform;if(h instanceof cu)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Pl)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Dl)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof uu)return{fieldPath:l.field.canonicalString(),increment:h.Pe};throw Re()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:U5(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re()}(t,e.precondition)),n}function ly(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?an.updateTime(Dn(s.updateTime)):s.exists!==void 0?an.exists(s.exists):an.none()}(e.currentDocument):an.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(l,h){let f=null;if("setToServerValue"in h)De(h.setToServerValue==="REQUEST_TIME"),f=new cu;else if("appendMissingElements"in h){const x=h.appendMissingElements.values||[];f=new Pl(x)}else if("removeAllFromArray"in h){const x=h.removeAllFromArray.values||[];f=new Dl(x)}else"increment"in h?f=new uu(l,h.increment):Re();const m=on.fromServerFormat(h.fieldPath);return new Xd(m,f)}(t,i)):[];if(e.update){e.update.name;const i=bs(t,e.update.name),s=new hr({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=function(f){const m=f.fieldPaths||[];return new Yr(m.map(x=>on.fromServerFormat(x)))}(e.updateMask);return new Eo(i,s,l,n,r)}return new Du(i,s,n,r)}if(e.delete){const i=bs(t,e.delete);return new ku(i,n)}if(e.verify){const i=bs(t,e.verify);return new Qx(i,n)}return Re()}function G5(t,e){return t&&t.length>0?(De(e!==void 0),t.map(n=>function(i,s){let l=i.updateTime?Dn(i.updateTime):Dn(s);return l.isEqual(Be.min())&&(l=Dn(s)),new N5(l,i.transformResults||[])}(n,e))):[]}function $S(t,e){return{documents:[qS(t,e.path)]}}function fg(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=qS(t,i);const s=function(m){if(m.length!==0)return ZS(Dt.create(m,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const l=function(m){if(m.length!==0)return m.map(x=>function(A){return{field:qo(A.field),direction:H5(A.dir)}}(x))}(e.orderBy);l&&(n.structuredQuery.orderBy=l);const h=sy(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{_t:n,parent:i}}function QS(t,e,n,r){const{_t:i,parent:s}=fg(t,e),l={},h=[];let f=0;return n.forEach(m=>{const x=r?m.alias:"aggregate_"+f++;l[x]=m.alias,m.aggregateType==="count"?h.push({alias:x,count:{}}):m.aggregateType==="avg"?h.push({alias:x,avg:{field:qo(m.fieldPath)}}):m.aggregateType==="sum"&&h.push({alias:x,sum:{field:qo(m.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:i.structuredQuery},parent:i.parent},ut:l,parent:s}}function XS(t){let e=HS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){De(r===1);const x=n.from[0];x.allDescendants?i=x.collectionId:e=e.child(x.collectionId)}let s=[];n.where&&(s=function(E){const A=YS(E);return A instanceof Dt&&Hx(A)?A.getFilters():[A]}(n.where));let l=[];n.orderBy&&(l=function(E){return E.map(A=>function(U){return new Ed(gc(U.field),function(G){switch(G){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(U.direction))}(A))}(n.orderBy));let h=null;n.limit&&(h=function(E){let A;return A=typeof E=="object"?E.value:E,Wd(A)?null:A}(n.limit));let f=null;n.startAt&&(f=function(E){const A=!!E.before,N=E.values||[];return new Ia(N,A)}(n.startAt));let m=null;return n.endAt&&(m=function(E){const A=!E.before,N=E.values||[];return new Ia(N,A)}(n.endAt)),wS(e,i,l,s,h,"F",f,m)}function q5(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function YS(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=gc(n.unaryFilter.field);return dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=gc(n.unaryFilter.field);return dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=gc(n.unaryFilter.field);return dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=gc(n.unaryFilter.field);return dt.create(l,"!=",{nullValue:"NULL_VALUE"});default:return Re()}}(t):t.fieldFilter!==void 0?function(n){return dt.create(gc(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Re()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Dt.create(n.compositeFilter.filters.map(r=>YS(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Re()}}(n.compositeFilter.op))}(t):Re()}function H5(t){return L5[t]}function W5(t){return F5[t]}function K5(t){return V5[t]}function qo(t){return{fieldPath:t.canonicalString()}}function gc(t){return on.fromServerFormat(t.fieldPath)}function ZS(t){return t instanceof dt?function(n){if(n.op==="=="){if(uE(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NAN"}};if(cE(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(uE(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NOT_NAN"}};if(cE(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qo(n.field),op:W5(n.op),value:n.value}}}(t):t instanceof Dt?function(n){const r=n.getFilters().map(i=>ZS(i));return r.length===1?r[0]:{compositeFilter:{op:K5(n.op),filters:r}}}(t):Re()}function $5(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function JS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,n,r,i,s=Be.min(),l=Be.min(),h=An.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new ro(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e){this.ct=e}}function Q5(t,e){let n;if(e.document)n=KS(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Te.fromSegments(e.noDocument.path),i=Ol(e.noDocument.readTime);n=Jt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re();{const r=Te.fromSegments(e.unknownDocument.path),i=Ol(e.unknownDocument.version);n=Jt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new gn(i[0],i[1]);return Be.fromTimestamp(s)}(e.readTime)),n}function bE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:g1(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,l){return{name:vd(s,l.key),fields:l.data.value.mapValue.fields,updateTime:hu(s,l.version.toTimestamp()),createTime:hu(s,l.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:kl(e.version)};else{if(!e.isUnknownDocument())return Re();r.unknownDocument={path:n.path.toArray(),version:kl(e.version)}}return r}function g1(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function kl(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ol(t){const e=new gn(t.seconds,t.nanoseconds);return Be.fromTimestamp(e)}function nl(t,e){const n=(e.baseMutations||[]).map(s=>ly(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const l=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const h=e.mutations[s+1];l.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>ly(t.ct,s)),i=gn.fromMillis(e.localWriteTimeMs);return new Xx(e.batchId,i,n,r)}function Sh(t){const e=Ol(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ol(t.lastLimboFreeSnapshotVersion):Be.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return De(s.documents.length===1),br(Pu(HS(s.documents[0])))}(t.query):function(s){return br(XS(s))}(t.query),new ro(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,An.fromBase64String(t.resumeToken))}function tb(t,e){const n=kl(e.snapshotVersion),r=kl(e.lastLimboFreeSnapshotVersion);let i;i=u1(e.target)?$S(t.ct,e.target):fg(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Nl(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function tw(t){const e=XS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?d1(e,e.limit,"L"):e}function Tm(t,e){return new Zx(e.largestBatchId,ly(t.ct,e.overlayMutation))}function RE(t,e){const n=e.path.lastSegment();return[t,Sr(e.path.popLast()),n]}function NE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:kl(r.readTime),documentKey:Sr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{getBundleMetadata(e,n){return PE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ol(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return PE(e).put(function(i){return{bundleId:i.id,createTime:kl(Dn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return DE(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:tw(s.bundledQuery),readTime:Ol(s.readTime)}}(r)})}saveNamedQuery(e,n){return DE(e).put(function(i){return{name:i.name,readTime:kl(Dn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function PE(t){return Qn(t,"bundles")}function DE(t){return Qn(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new gg(e,r)}getOverlay(e,n){return dh(e).get(RE(this.userId,n)).next(r=>r?Tm(this.serializer,r):null)}getOverlays(e,n){const r=Es();return te.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,l)=>{const h=new Zx(n,l);i.push(this.ht(e,h))}),te.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(l=>i.add(Sr(l.getCollectionPath())));const s=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);s.push(dh(e).j("collectionPathOverlayIndex",h))}),te.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Es(),s=Sr(n),l=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return dh(e).U("collectionPathOverlayIndex",l).next(h=>{for(const f of h){const m=Tm(this.serializer,f);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Es();let l;const h=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return dh(e).J({index:"collectionGroupOverlayIndex",range:h},(f,m,x)=>{const E=Tm(this.serializer,m);s.size()<i||E.largestBatchId===l?(s.set(E.getKey(),E),l=E.largestBatchId):x.done()}).next(()=>s)}ht(e,n){return dh(e).put(function(i,s,l){const[h,f,m]=RE(s,l.mutation.key);return{userId:s,collectionPath:f,documentId:m,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Id(i.ct,l.mutation)}}(this.serializer,this.userId,n))}}function dh(t){return Qn(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{Pt(e){return Qn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?An.fromUint8Array(r):An.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(rn(e.integerValue));else if("doubleValue"in e){const r=rn(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),yd(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=go(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(mo(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?cS(e)?this.dt(n,Number.MAX_SAFE_INTEGER):ug(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Re()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const l="value",h=((i=(r=s[l].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(rn(h)),this.Vt(l,n),this.Tt(s[l],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),Te.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}rl.vt=new rl;function Z5(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function kE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const l=Z5(255&r[s]);if(i+=l,l!==8)break}return i}(t);return Math.ceil(e/8)}class J5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=kE(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=kE(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,s,!1),new Uint8Array(l.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class eM{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class tM{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class fh{constructor(){this.jt=new J5,this.Ht=new eM(this.jt),this.Jt=new tM(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new il(this.indexId,this.documentKey,this.arrayValue,r)}}function Po(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=OE(t.arrayValue,e.arrayValue),n!==0?n:(n=OE(t.directionalValue,e.directionalValue),n!==0?n:Te.comparator(t.documentKey,e.documentKey)))}function OE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(e){this.Xt=new Vt((n,r)=>on.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(De(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Yp(e);if(n!==void 0&&!this.sn(n))return!1;const r=el(e);let i=new Set,s=0,l=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const h=this.Xt.getIterator().getNext();if(!i.has(h.field.canonicalString())){const f=r[s];if(!this.on(h,f)||!this._n(this.en[l++],f))return!1}++s}for(;s<r.length;++s){const h=r[s];if(l>=this.en.length||!this._n(this.en[l++],h))return!1}return!0}an(){if(this.nn)return null;let e=new Vt(on.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new wl(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new wl(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new wl(r.field,r.dir==="asc"?0:1)));return new su(su.UNKNOWN_ID,this.collectionId,n,ou.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(t){var e,n;if(De(t instanceof dt||t instanceof Dt),t instanceof dt){if(t instanceof xS){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>dt.create(t.field,"==",s)))||[];return Dt.create(i,"or")}return t}const r=t.filters.map(i=>nb(i));return Dt.create(r,t.op)}function nM(t){if(t.getFilters().length===0)return[];const e=hy(nb(t));return De(rb(e)),cy(e)||uy(e)?[e]:e.getFilters()}function cy(t){return t instanceof dt}function uy(t){return t instanceof Dt&&Hx(t)}function rb(t){return cy(t)||uy(t)||function(n){if(n instanceof Dt&&ty(n)){for(const r of n.getFilters())if(!cy(r)&&!uy(r))return!1;return!0}return!1}(t)}function hy(t){if(De(t instanceof dt||t instanceof Dt),t instanceof dt)return t;if(t.filters.length===1)return hy(t.filters[0]);const e=t.filters.map(r=>hy(r));let n=Dt.create(e,t.op);return n=m1(n),rb(n)?n:(De(n instanceof Dt),De(lu(n)),De(n.filters.length>1),n.filters.reduce((r,i)=>nw(r,i)))}function nw(t,e){let n;return De(t instanceof dt||t instanceof Dt),De(e instanceof dt||e instanceof Dt),n=t instanceof dt?e instanceof dt?function(i,s){return Dt.create([i,s],"and")}(t,e):LE(t,e):e instanceof dt?LE(e,t):function(i,s){if(De(i.filters.length>0&&s.filters.length>0),lu(i)&&lu(s))return mS(i,s.getFilters());const l=ty(i)?i:s,h=ty(i)?s:i,f=l.filters.map(m=>nw(m,h));return Dt.create(f,"or")}(t,e),m1(n)}function LE(t,e){if(lu(e))return mS(e,t.getFilters());{const n=e.filters.map(r=>nw(t,r));return Dt.create(n,"or")}}function m1(t){if(De(t instanceof dt||t instanceof Dt),t instanceof dt)return t;const e=t.getFilters();if(e.length===1)return m1(e[0]);if(fS(t))return t;const n=e.map(i=>m1(i)),r=[];return n.forEach(i=>{i instanceof dt?r.push(i):i instanceof Dt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Dt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(){this.un=new rw}addToCollectionParentIndex(e,n){return this.un.add(n),te.resolve()}getCollectionParents(e,n){return te.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return te.resolve()}deleteFieldIndex(e,n){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,n){return te.resolve()}getDocumentsMatchingTarget(e,n){return te.resolve(null)}getIndexType(e,n){return te.resolve(0)}getFieldIndexes(e,n){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,n){return te.resolve(gi.min())}getMinOffsetFromCollectionGroup(e,n){return te.resolve(gi.min())}updateCollectionGroup(e,n,r){return te.resolve()}updateIndexEntries(e,n){return te.resolve()}}class rw{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Vt(ht.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Vt(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f=new Uint8Array(0);class iM{constructor(e,n){this.databaseId=n,this.cn=new rw,this.ln=new _o(r=>Nl(r),(r,i)=>Kd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:Sr(i)};return FE(e).put(s)}return te.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[QC(n),""],!1,!0);return FE(e).U(i).next(s=>{for(const l of s){if(l.collectionId!==n)break;r.push(_s(l.parent))}return r})}addFieldIndex(e,n){const r=gh(e),i=function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map(f=>[f.fieldPath.canonicalString(),f.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const l=cc(e);return s.next(h=>{l.put(NE(h,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=gh(e),i=cc(e),s=lc(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=gh(e),r=lc(e),i=cc(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return te.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new ME(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=lc(e);let i=!0;const s=new Map;return te.forEach(this.hn(n),l=>this.Pn(e,l).next(h=>{i&&(i=!!h),s.set(l,h)})).next(()=>{if(i){let l=tt();const h=[];return te.forEach(s,(f,m)=>{fe("IndexedDbIndexManager",`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(f)} to execute ${Nl(n)}`);const x=function(P,V){const $=Yp(V);if($===void 0)return null;for(const J of h1(P,$.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(m,f),E=function(P,V){const $=new Map;for(const J of el(V))for(const k of h1(P,J.fieldPath))switch(k.op){case"==":case"in":$.set(J.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return $.set(J.fieldPath.canonicalString(),k.value),Array.from($.values())}return null}(m,f),A=function(P,V){const $=[];let J=!0;for(const k of el(V)){const L=k.kind===0?mE(P,k.fieldPath,P.startAt):pE(P,k.fieldPath,P.startAt);$.push(L.value),J&&(J=L.inclusive)}return new Ia($,J)}(m,f),N=function(P,V){const $=[];let J=!0;for(const k of el(V)){const L=k.kind===0?pE(P,k.fieldPath,P.endAt):mE(P,k.fieldPath,P.endAt);$.push(L.value),J&&(J=L.inclusive)}return new Ia($,J)}(m,f),U=this.In(f,m,A),D=this.In(f,m,N),G=this.Tn(f,m,E),M=this.En(f.indexId,x,U,A.inclusive,D,N.inclusive,G);return te.forEach(M,b=>r.G(b,n.limit).next(P=>{P.forEach(V=>{const $=Te.fromSegments(V.documentKey);l.has($)||(l=l.add($),h.push($))})}))}).next(()=>h)}return te.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=nM(Dt.create(e.filters,"and")).map(r=>ry(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,l,h){const f=(n!=null?n.length:1)*Math.max(r.length,s.length),m=f/(n!=null?n.length:1),x=[];for(let E=0;E<f;++E){const A=n?this.dn(n[E/m]):$f,N=this.An(e,A,r[E%m],i),U=this.Rn(e,A,s[E%m],l),D=h.map(G=>this.An(e,A,G,!0));x.push(...this.createRange(N,U,D))}return x}An(e,n,r,i){const s=new il(e,Te.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new il(e,Te.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new ME(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let l=null;for(const h of s)r.rn(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,n){let r=2;const i=this.hn(n);return te.forEach(i,s=>this.Pn(e,s).next(l=>{l?r!==0&&l.fields.length<function(f){let m=new Vt(on.comparator),x=!1;for(const E of f.filters)for(const A of E.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?x=!0:m=m.add(A.field));for(const E of f.orderBy)E.field.isKeyField()||(m=m.add(E.field));return m.size+(x?1:0)}(s)&&(r=1):r=0})).next(()=>function(l){return l.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new fh;for(const i of el(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const l=r.Yt(i.kind);rl.vt.It(s,l)}return r.zt()}dn(e){const n=new fh;return rl.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new fh;return rl.vt.It(Rl(this.databaseId,n),r.Yt(function(s){const l=el(s);return l.length===0?0:l[l.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new fh);let s=0;for(const l of el(e)){const h=r[s++];for(const f of i)if(this.fn(n,l.fieldPath)&&_d(h))i=this.gn(i,l,h);else{const m=f.Yt(l.kind);rl.vt.It(h,m)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const l of r.arrayValue.values||[])for(const h of i){const f=new fh;f.seed(h.zt()),rl.vt.It(l,f.Yt(n.kind)),s.push(f)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof dt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=gh(e),i=cc(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const l=[];return te.forEach(s,h=>i.get([h.indexId,this.uid]).next(f=>{l.push(function(x,E){const A=E?new ou(E.sequenceNumber,new gi(Ol(E.readTime),new Te(_s(E.documentKey)),E.largestBatchId)):ou.empty(),N=x.fields.map(([U,D])=>new wl(on.fromServerFormat(U),D));return new su(x.indexId,x.collectionGroup,N,A)}(h,f))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:$e(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=gh(e),s=cc(e);return this.yn(e).next(l=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(h=>te.forEach(h,f=>s.put(NE(f.indexId,this.uid,l,r)))))}updateIndexEntries(e,n){const r=new Map;return te.forEach(n,(i,s)=>{const l=r.get(i.collectionGroup);return(l?te.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),te.forEach(h,f=>this.wn(e,i,f).next(m=>{const x=this.Sn(s,f);return m.isEqual(x)?te.resolve():this.bn(e,s,f,m,x)}))))})}Dn(e,n,r,i){return lc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return lc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=lc(e);let s=new Vt(Po);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(l,h)=>{s=s.add(new il(r.indexId,n,h.arrayValue,h.directionalValue))}).next(()=>s)}Sn(e,n){let r=new Vt(Po);const i=this.Vn(n,e);if(i==null)return r;const s=Yp(n);if(s!=null){const l=e.data.field(s.fieldPath);if(_d(l))for(const h of l.arrayValue.values||[])r=r.add(new il(n.indexId,e.key,this.dn(h),i))}else r=r.add(new il(n.indexId,e.key,$f,i));return r}bn(e,n,r,i,s){fe("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const l=[];return function(f,m,x,E,A){const N=f.getIterator(),U=m.getIterator();let D=ac(N),G=ac(U);for(;D||G;){let M=!1,b=!1;if(D&&G){const P=x(D,G);P<0?b=!0:P>0&&(M=!0)}else D!=null?b=!0:M=!0;M?(E(G),G=ac(U)):b?(A(D),D=ac(N)):(D=ac(N),G=ac(U))}}(i,s,Po,h=>{l.push(this.Dn(e,n,r,h))},h=>{l.push(this.vn(e,n,r,h))}),te.waitFor(l)}yn(e){let n=1;return cc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((l,h)=>Po(l,h)).filter((l,h,f)=>!h||Po(l,f[h-1])!==0);const i=[];i.push(e);for(const l of r){const h=Po(l,e),f=Po(l,n);if(h===0)i[0]=e.Zt();else if(h>0&&f<0)i.push(l),i.push(l.Zt());else if(f>0)break}i.push(n);const s=[];for(let l=0;l<i.length;l+=2){if(this.Cn(i[l],i[l+1]))return[];const h=[i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,$f,[]],f=[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,$f,[]];s.push(IDBKeyRange.bound(h,f))}return s}Cn(e,n){return Po(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(VE)}getMinOffset(e,n){return te.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||Re())).next(VE)}}function FE(t){return Qn(t,"collectionParents")}function lc(t){return Qn(t,"indexEntries")}function gh(t){return Qn(t,"indexConfiguration")}function cc(t){return Qn(t,"indexState")}function VE(t){De(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;zx(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new gi(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Tr{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],l=IDBKeyRange.only(n.batchId);let h=0;const f=r.J({range:l},(x,E,A)=>(h++,A.delete()));s.push(f.next(()=>{De(h===1)}));const m=[];for(const x of n.mutations){const E=nS(e,x.key.path,n.batchId);s.push(i.delete(E)),m.push(x.key)}return te.waitFor(s).next(()=>m)}function p1(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Re();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(41943040,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);class mg{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){De(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new mg(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).J({index:"userMutationsIndex",range:r},(i,s,l)=>{n=!1,l.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=mc(e),l=Do(e);return l.add({}).next(h=>{De(typeof h=="number");const f=new Xx(h,n,r,i),m=function(N,U,D){const G=D.baseMutations.map(b=>Id(N.ct,b)),M=D.mutations.map(b=>Id(N.ct,b));return{userId:U,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:G,mutations:M}}(this.serializer,this.userId,f),x=[];let E=new Vt((A,N)=>$e(A.canonicalString(),N.canonicalString()));for(const A of i){const N=nS(this.userId,A.key.path,h);E=E.add(A.key.path.popLast()),x.push(l.put(m)),x.push(s.put(N,WO))}return E.forEach(A=>{x.push(this.indexManager.addToCollectionParentIndex(e,A))}),e.addOnCommittedListener(()=>{this.Fn[h]=f.keys()}),te.waitFor(x).next(()=>f)})}lookupMutationBatch(e,n){return Do(e).get(n).next(r=>r?(De(r.userId===this.userId),nl(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?te.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Do(e).J({index:"userMutationsIndex",range:i},(l,h,f)=>{h.userId===this.userId&&(De(h.batchId>=r),s=nl(this.serializer,h)),f.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Do(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,l)=>{r=s.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).U("userMutationsIndex",n).next(r=>r.map(i=>nl(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=_0(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return mc(e).J({range:i},(l,h,f)=>{const[m,x,E]=l,A=_s(x);if(m===this.userId&&n.path.isEqual(A))return Do(e).get(E).next(N=>{if(!N)throw Re();De(N.userId===this.userId),s.push(nl(this.serializer,N))});f.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Vt($e);const i=[];return n.forEach(s=>{const l=_0(this.userId,s.path),h=IDBKeyRange.lowerBound(l),f=mc(e).J({range:h},(m,x,E)=>{const[A,N,U]=m,D=_s(N);A===this.userId&&s.path.isEqual(D)?r=r.add(U):E.done()});i.push(f)}),te.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=_0(this.userId,r),l=IDBKeyRange.lowerBound(s);let h=new Vt($e);return mc(e).J({range:l},(f,m,x)=>{const[E,A,N]=f,U=_s(A);E===this.userId&&r.isPrefixOf(U)?U.length===i&&(h=h.add(N)):x.done()}).next(()=>this.xn(e,h))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Do(e).get(s).next(l=>{if(l===null)throw Re();De(l.userId===this.userId),r.push(nl(this.serializer,l))}))}),te.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ib(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),te.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return te.resolve();const r=IDBKeyRange.lowerBound(function(l){return[l]}(this.userId)),i=[];return mc(e).J({range:r},(s,l,h)=>{if(s[0]===this.userId){const f=_s(s[1]);i.push(f)}else h.done()}).next(()=>{De(i.length===0)})})}containsKey(e,n){return sb(e,this.userId,n)}Nn(e){return ob(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function sb(t,e,n){const r=_0(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let l=!1;return mc(t).J({range:s,H:!0},(h,f,m)=>{const[x,E,A]=h;x===e&&E===i&&(l=!0),m.done()}).next(()=>l)}function Do(t){return Qn(t,"mutations")}function mc(t){return Qn(t,"documentMutations")}function ob(t){return Qn(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ml(0)}static kn(){return new Ml(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new Ml(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Be.fromTimestamp(new gn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>uc(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(De(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return uc(e).J((l,h)=>{const f=Sh(h);f.sequenceNumber<=n&&r.get(f.targetId)===null&&(i++,s.push(this.removeTargetData(e,f)))}).next(()=>te.waitFor(s)).next(()=>i)}forEachTarget(e,n){return uc(e).J((r,i)=>{const s=Sh(i);n(s)})}qn(e){return UE(e).get("targetGlobalKey").next(n=>(De(n!==null),n))}Qn(e,n){return UE(e).put("targetGlobalKey",n)}Kn(e,n){return uc(e).put(tb(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Nl(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return uc(e).J({range:i,index:"queryTargetsIndex"},(l,h,f)=>{const m=Sh(h);Kd(n,m.target)&&(s=m,f.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Ho(e);return n.forEach(l=>{const h=Sr(l.path);i.push(s.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),te.waitFor(i)}removeMatchingKeys(e,n,r){const i=Ho(e);return te.forEach(n,s=>{const l=Sr(s.path);return te.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Ho(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Ho(e);let s=tt();return i.J({range:r,H:!0},(l,h,f)=>{const m=_s(l[1]),x=new Te(m);s=s.add(x)}).next(()=>s)}containsKey(e,n){const r=Sr(n.path),i=IDBKeyRange.bound([r],[QC(r)],!1,!0);let s=0;return Ho(e).J({index:"documentTargetsIndex",H:!0,range:i},([l,h],f,m)=>{l!==0&&(s++,m.done())}).next(()=>s>0)}ot(e,n){return uc(e).get(n).next(r=>r?Sh(r):null)}}function uc(t){return Qn(t,"targets")}function UE(t){return Qn(t,"targetGlobal")}function Ho(t){return Qn(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE([t,e],[n,r]){const i=$e(t,n);return i===0?$e(e,r):i}class oM{constructor(e){this.Un=e,this.buffer=new Vt(jE),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();jE(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class ab{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){fe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Oa(n)?fe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ka(n)}await this.Hn(3e5)})}}class aM{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return te.resolve(Xr.oe);const r=new oM(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(BE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),BE):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,l,h,f,m;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(E=>(E>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),i=this.params.maximumSequenceNumbersToCollect):i=E,l=Date.now(),this.nthSequenceNumber(e,i))).next(E=>(r=E,h=Date.now(),this.removeTargets(e,r,n))).next(E=>(s=E,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(E=>(m=Date.now(),dc()<=ut.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-x}ms
	Determined least recently used ${i} in `+(h-l)+`ms
	Removed ${s} targets in `+(f-h)+`ms
	Removed ${E} documents in `+(m-f)+`ms
Total Duration: ${m-x}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:E})))}}function lb(t,e){return new aM(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(e,n){this.db=e,this.garbageCollector=lb(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return Qf(e,r)}removeReference(e,n,r){return Qf(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Qf(e,n)}nr(e,n){return function(i,s){let l=!1;return ob(i).Y(h=>sb(i,h,s).next(f=>(f&&(l=!0),te.resolve(!f)))).next(()=>l)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(l,h)=>{if(h<=n){const f=this.nr(e,l).next(m=>{if(!m)return s++,r.getEntry(e,l).next(()=>(r.removeEntry(l,Be.min()),Ho(e).delete(function(E){return[0,Sr(E.path)]}(l))))});i.push(f)}}).next(()=>te.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Qf(e,n)}tr(e,n){const r=Ho(e);let i,s=Xr.oe;return r.J({index:"documentTargetsIndex"},([l,h],{path:f,sequenceNumber:m})=>{l===0?(s!==Xr.oe&&n(new Te(_s(i)),s),s=m,i=f):s=Xr.oe}).next(()=>{s!==Xr.oe&&n(new Te(_s(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Qf(t,e){return Ho(t).put(function(r,i){return{targetId:0,path:Sr(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(){this.changes=new _o(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Jt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?te.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Xa(e).put(r)}removeEntry(e,n,r){return Xa(e).delete(function(s,l){const h=s.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],g1(l),h[h.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Jt.newInvalidDocument(n);return Xa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(mh(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:Jt.newInvalidDocument(n)};return Xa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(mh(n))},(i,s)=>{r={document:this.ir(n,s),size:p1(s)}}).next(()=>r)}getEntries(e,n){let r=Zr();return this._r(e,n,(i,s)=>{const l=this.ir(i,s);r=r.insert(i,l)}).next(()=>r)}ar(e,n){let r=Zr(),i=new Qt(Te.comparator);return this._r(e,n,(s,l)=>{const h=this.ir(s,l);r=r.insert(s,h),i=i.insert(s,p1(l))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return te.resolve();let i=new Vt(qE);n.forEach(f=>i=i.add(f));const s=IDBKeyRange.bound(mh(i.first()),mh(i.last())),l=i.getIterator();let h=l.getNext();return Xa(e).J({index:"documentKeyIndex",range:s},(f,m,x)=>{const E=Te.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&qE(h,E)<0;)r(h,null),h=l.getNext();h&&h.isEqual(E)&&(r(h,m),h=l.hasNext()?l.getNext():null),h?x.$(mh(h)):x.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const l=n.path,h=[l.popLast().toArray(),l.lastSegment(),g1(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xa(e).U(IDBKeyRange.bound(h,f,!0)).next(m=>{s==null||s.incrementDocumentReadCount(m.length);let x=Zr();for(const E of m){const A=this.ir(Te.fromSegments(E.prefixPath.concat(E.collectionGroup,E.documentId)),E);A.isFoundDocument()&&(Qd(n,A)||i.has(A.key))&&(x=x.insert(A.key,A))}return x})}getAllFromCollectionGroup(e,n,r,i){let s=Zr();const l=GE(n,r),h=GE(n,gi.max());return Xa(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(f,m,x)=>{const E=this.ir(Te.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(E.key,E),s.size===i&&x.done()}).next(()=>s)}newChangeBuffer(e){return new uM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return zE(e).get("remoteDocumentGlobalKey").next(n=>(De(!!n),n))}rr(e,n){return zE(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=Q5(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Be.min())))return r}return Jt.newInvalidDocument(e)}}function ub(t){return new cM(t)}class uM extends cb{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new _o(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Vt((s,l)=>$e(s.canonicalString(),l.canonicalString()));return this.changes.forEach((s,l)=>{const h=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,h.readTime)),l.isValidDocument()){const f=bE(this.cr.serializer,l);i=i.add(s.path.popLast());const m=p1(f);r+=m-h.size,n.push(this.cr.addEntry(e,s,f))}else if(r-=h.size,this.trackRemovals){const f=bE(this.cr.serializer,l.convertToNoDocument(Be.min()));n.push(this.cr.addEntry(e,s,f))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),te.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,l)=>{this.lr.set(s,{size:l,readTime:r.get(s).readTime})}),r))}}function zE(t){return Qn(t,"remoteDocumentGlobal")}function Xa(t){return Qn(t,"remoteDocumentsV14")}function mh(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function GE(t,e){const n=e.documentKey.path.toArray();return[t,g1(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function qE(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=$e(n[s],r[s]),i)return i;return i=$e(n.length,r.length),i||(i=$e(n[n.length-2],r[r.length-2]),i||$e(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&jh(r.mutation,i,Yr.empty(),gn.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,tt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=tt()){const i=Es();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let l=Th();return s.forEach((h,f)=>{l=l.insert(h,f.overlayedDocument)}),l}))}getOverlayedDocuments(e,n){const r=Es();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,tt()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((l,h)=>{n.set(l,h)})})}computeViews(e,n,r,i){let s=Zr();const l=Uh(),h=function(){return Uh()}();return n.forEach((f,m)=>{const x=r.get(m.key);i.has(m.key)&&(x===void 0||x.mutation instanceof Eo)?s=s.insert(m.key,m):x!==void 0?(l.set(m.key,x.mutation.getFieldMask()),jh(x.mutation,m,x.mutation.getFieldMask(),gn.now())):l.set(m.key,Yr.empty())}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((m,x)=>l.set(m,x)),n.forEach((m,x)=>{var E;return h.set(m,new hM(x,(E=l.get(m))!==null&&E!==void 0?E:null))}),h))}recalculateAndSaveOverlays(e,n){const r=Uh();let i=new Qt((l,h)=>l-h),s=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(l=>{for(const h of l)h.keys().forEach(f=>{const m=n.get(f);if(m===null)return;let x=r.get(f)||Yr.empty();x=h.applyToLocalView(m,x),r.set(f,x);const E=(i.get(h.batchId)||tt()).add(f);i=i.insert(h.batchId,E)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,x=f.value,E=SS();x.forEach(A=>{if(!s.has(A)){const N=OS(n.get(A),r.get(A));N!==null&&E.set(A,N),s=s.add(A)}}),l.push(this.documentOverlayCache.saveOverlays(e,m,E))}return te.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(l){return Te.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Wx(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const l=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):te.resolve(Es());let h=-1,f=s;return l.next(m=>te.forEach(m,(x,E)=>(h<E.largestBatchId&&(h=E.largestBatchId),s.get(x)?te.resolve():this.remoteDocumentCache.getEntry(e,x).next(A=>{f=f.insert(x,A)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,f,m,tt())).next(x=>({batchId:h,changes:CS(x)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Te(n)).next(r=>{let i=Th();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let l=Th();return this.indexManager.getCollectionParents(e,s).next(h=>te.forEach(h,f=>{const m=function(E,A){return new wo(A,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)}(n,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next(x=>{x.forEach((E,A)=>{l=l.insert(E,A)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(l=>{s.forEach((f,m)=>{const x=m.getKey();l.get(x)===null&&(l=l.insert(x,Jt.newInvalidDocument(x)))});let h=Th();return l.forEach((f,m)=>{const x=s.get(f);x!==void 0&&jh(x.mutation,m,Yr.empty(),gn.now()),Qd(n,m)&&(h=h.insert(f,m))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return te.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Dn(i.createTime)}}(n)),te.resolve()}getNamedQuery(e,n){return te.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:tw(i.bundledQuery),readTime:Dn(i.readTime)}}(n)),te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(){this.overlays=new Qt(Te.comparator),this.Ir=new Map}getOverlay(e,n){return te.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Es();return te.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),te.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),te.resolve()}getOverlaysForCollection(e,n,r){const i=Es(),s=n.length+1,l=new Te(n.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===s&&f.largestBatchId>r&&i.set(f.getKey(),f)}return te.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Qt((m,x)=>m-x);const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>r){let x=s.get(m.largestBatchId);x===null&&(x=Es(),s=s.insert(m.largestBatchId,x)),x.set(m.getKey(),m)}}const h=Es(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,x)=>h.set(m,x)),!(h.size()>=i)););return te.resolve(h)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const l=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Zx(n,r));let s=this.Ir.get(n);s===void 0&&(s=tt(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(){this.sessionToken=An.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(){this.Tr=new Vt(Jn.Er),this.dr=new Vt(Jn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Jn(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Jn(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Te(new ht([])),r=new Jn(n,e),i=new Jn(n,e+1),s=[];return this.dr.forEachInRange([r,i],l=>{this.Vr(l),s.push(l.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Te(new ht([])),r=new Jn(n,e),i=new Jn(n,e+1);let s=tt();return this.dr.forEachInRange([r,i],l=>{s=s.add(l.key)}),s}containsKey(e){const n=new Jn(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Jn{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Te.comparator(e.key,n.key)||$e(e.wr,n.wr)}static Ar(e,n){return $e(e.wr,n.wr)||Te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Vt(Jn.Er)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Xx(s,n,r,i);this.mutationQueue.push(l);for(const h of i)this.br=this.br.add(new Jn(h.key,s)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return te.resolve(l)}lookupMutationBatch(e,n){return te.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return te.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Jn(n,0),i=new Jn(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],l=>{const h=this.Dr(l.wr);s.push(h)}),te.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Vt($e);return n.forEach(i=>{const s=new Jn(i,0),l=new Jn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,l],h=>{r=r.add(h.wr)})}),te.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Te.isDocumentKey(s)||(s=s.child(""));const l=new Jn(new Te(s),0);let h=new Vt($e);return this.br.forEachWhile(f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(f.wr)),!0)},l),te.resolve(this.Cr(h))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){De(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return te.forEach(n.mutations,i=>{const s=new Jn(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Jn(n,0),i=this.br.firstAfterOrEqual(r);return te.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.Mr=e,this.docs=function(){return new Qt(Te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,l=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return te.resolve(r?r.document.mutableCopy():Jt.newInvalidDocument(n))}getEntries(e,n){let r=Zr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Jt.newInvalidDocument(i))}),te.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Zr();const l=n.path,h=new Te(l.child("")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:m,value:{document:x}}=f.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||zx(YC(x),r)<=0||(i.has(x.key)||Qd(n,x))&&(s=s.insert(x.key,x.mutableCopy()))}return te.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Re()}Or(e,n){return te.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new yM(this)}getSize(e){return te.resolve(this.size)}}class yM extends cb{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),te.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.persistence=e,this.Nr=new _o(n=>Nl(n),Kd),this.lastRemoteSnapshotVersion=Be.min(),this.highestTargetId=0,this.Lr=0,this.Br=new iw,this.targetCount=0,this.kr=Ml.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),te.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Ml(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,te.resolve()}updateTargetData(e,n){return this.Kn(n),te.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((l,h)=>{h.sequenceNumber<=n&&r.get(h.targetId)===null&&(this.Nr.delete(l),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),te.waitFor(s).next(()=>i)}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return te.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),te.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(l=>{s.push(i.markPotentiallyOrphaned(e,l))}),te.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),te.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return te.resolve(r)}containsKey(e,n){return te.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Xr(0),this.Kr=!1,this.Kr=!0,this.$r=new gM,this.referenceDelegate=e(this),this.Ur=new xM(this),this.indexManager=new rM,this.remoteDocumentCache=function(i){return new pM(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new eb(n),this.Gr=new dM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new fM,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new mM(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){fe("MemoryPersistence","Starting transaction:",e);const i=new wM(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return te.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class wM extends JC{constructor(e){super(),this.currentSequenceNumber=e}}class pg{constructor(e){this.persistence=e,this.Jr=new iw,this.Yr=null}static Zr(e){return new pg(e)}get Xr(){if(this.Yr)return this.Yr;throw Re()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),te.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),te.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),te.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.Xr,r=>{const i=Te.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Be.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return te.or([()=>te.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}class y1{constructor(e,n){this.persistence=e,this.ti=new _o(r=>Sr(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=lb(this,n)}static Zr(e,n){return new y1(e,n)}zr(){}jr(e){return te.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Yn(e){const n=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}Zn(e,n){return te.forEach(this.ti,(r,i)=>this.nr(e,r,i).next(s=>s?te.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Or(e,l=>this.nr(e,l,n).next(h=>{h||(r++,s.removeEntry(l,Be.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ti.set(n,e.currentSequenceNumber),te.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),te.resolve()}removeReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),te.resolve()}updateLimboDocument(e,n){return this.ti.set(n,e.currentSequenceNumber),te.resolve()}Wr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=v0(e.data.value)),n}nr(e,n,r){return te.or([()=>this.persistence.Hr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.ti.get(n);return te.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{constructor(e){this.serializer=e}O(e,n,r,i){const s=new ag("createOrUpgrade",n);r<1&&i>=1&&(function(f){f.createObjectStore("owner")}(e),function(f){f.createObjectStore("mutationQueues",{keyPath:"userId"}),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",iE,{unique:!0}),f.createObjectStore("documentMutations")}(e),HE(e),function(f){f.createObjectStore("remoteDocuments")}(e));let l=te.resolve();return r<3&&i>=3&&(r!==0&&(function(f){f.deleteObjectStore("targetDocuments"),f.deleteObjectStore("targets"),f.deleteObjectStore("targetGlobal")}(e),HE(e)),l=l.next(()=>function(f){const m=f.store("targetGlobal"),x={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Be.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",x)}(s))),r<4&&i>=4&&(r!==0&&(l=l.next(()=>function(f,m){return m.store("mutations").U().next(x=>{f.deleteObjectStore("mutations"),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",iE,{unique:!0});const E=m.store("mutations"),A=x.map(N=>E.put(N));return te.waitFor(A)})}(e,s))),l=l.next(()=>{(function(f){f.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(l=l.next(()=>this.ni(s))),r<6&&i>=6&&(l=l.next(()=>(function(f){f.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(l=l.next(()=>this.ii(s))),r<8&&i>=8&&(l=l.next(()=>this.si(e,s))),r<9&&i>=9&&(l=l.next(()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(l=l.next(()=>this.oi(s))),r<11&&i>=11&&(l=l.next(()=>{(function(f){f.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(f){f.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{(function(f){const m=f.createObjectStore("documentOverlays",{keyPath:i5});m.createIndex("collectionPathOverlayIndex",s5,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",o5,{unique:!1})})(e)})),r<13&&i>=13&&(l=l.next(()=>function(f){const m=f.createObjectStore("remoteDocumentsV14",{keyPath:KO});m.createIndex("documentKeyIndex",$O),m.createIndex("collectionGroupIndex",QO)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.ai(e,s))),r<15&&i>=15&&(l=l.next(()=>function(f){f.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),f.createObjectStore("indexState",{keyPath:e5}).createIndex("sequenceNumberIndex",t5,{unique:!1}),f.createObjectStore("indexEntries",{keyPath:n5}).createIndex("documentKeyIndex",r5,{unique:!1})}(e))),r<16&&i>=16&&(l=l.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(l=l.next(()=>{(function(f){f.createObjectStore("globals",{keyPath:"name"})})(e)})),l}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=p1(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>te.forEach(i,s=>{const l=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",l).next(h=>te.forEach(h,f=>{De(f.userId===s.userId);const m=nl(this.serializer,f);return ib(e,s.userId,m).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((l,h)=>{const f=new ht(l),m=function(E){return[0,Sr(E)]}(f);s.push(n.get(m).next(x=>x?te.resolve():(E=>n.put({targetId:0,path:Sr(E),sequenceNumber:i.highestListenSequenceNumber}))(f)))}).next(()=>te.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:JO});const r=n.store("collectionParents"),i=new rw,s=l=>{if(i.add(l)){const h=l.lastSegment(),f=l.popLast();return r.put({collectionId:h,parent:Sr(f)})}};return n.store("remoteDocuments").J({H:!0},(l,h)=>{const f=new ht(l);return s(f.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([l,h,f],m)=>{const x=_s(h);return s(x.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=Sh(i),l=tb(this.serializer,s);return n.put(l)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,l)=>{const h=n.store("remoteDocumentsV14"),f=function(E){return E.document?new Te(ht.fromString(E.document.name).popFirst(5)):E.noDocument?Te.fromSegments(E.noDocument.path):E.unknownDocument?Te.fromSegments(E.unknownDocument.path):Re()}(l).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(m))}).next(()=>te.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=ub(this.serializer),s=new sw(pg.Zr,this.serializer.ct);return r.U().next(l=>{const h=new Map;return l.forEach(f=>{var m;let x=(m=h.get(f.userId))!==null&&m!==void 0?m:tt();nl(this.serializer,f).keys().forEach(E=>x=x.add(E)),h.set(f.userId,x)}),te.forEach(h,(f,m)=>{const x=new tr(m),E=gg.lt(this.serializer,x),A=s.getIndexManager(x),N=mg.lt(x,this.serializer,A,s.referenceDelegate);return new hb(i,N,E,A).recalculateAndSaveOverlaysForDocumentKeys(new Zp(n,Xr.oe),f).next()})})}}function HE(t){t.createObjectStore("targetDocuments",{keyPath:YO}).createIndex("documentTargetsIndex",ZO,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",XO,{unique:!0}),t.createObjectStore("targetGlobal")}const Cm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ow{constructor(e,n,r,i,s,l,h,f,m,x,E=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=l,this.document=h,this.ci=m,this.li=x,this.hi=E,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=A=>Promise.resolve(),!ow.D())throw new ge(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new lM(this,i),this.Ai=n+"main",this.serializer=new eb(f),this.Ri=new Ss(this.Ai,this.hi,new _M(this.serializer)),this.$r=new Y5,this.Ur=new sM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ub(this.serializer),this.Gr=new X5,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,x===!1&&Nn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ge(ae.FAILED_PRECONDITION,Cm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Xr(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Xf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Oa(e))return fe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ph(e).get("owner").next(n=>te.resolve(this.vi(n)))}Ci(e){return Xf(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Qn(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),l=i.filter(h=>s.indexOf(h)===-1);return te.forEach(l,h=>r.delete(h.clientId)).next(()=>l)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?te.resolve(!0):ph(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ge(ae.FAILED_PRECONDITION,Cm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Xf(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(s||l&&h)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&fe("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Zp(e,Xr.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Xf(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return mg.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new iM(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return gg.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){fe("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(f){return f===17?c5:f===16?l5:f===15?qx:f===14?sS:f===13?iS:f===12?a5:f===11?rS:void Re()}(this.hi);let l;return this.Ri.runTransaction(e,i,s,h=>(l=new Zp(h,this.Qr?this.Qr.next():Xr.oe),n==="readwrite-primary"?this.wi(l).next(f=>!!f||this.Si(l)).next(f=>{if(!f)throw Nn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ge(ae.FAILED_PRECONDITION,ZC);return r(l)}).next(f=>this.Di(l).next(()=>f)):this.Ki(l).next(()=>r(l)))).then(h=>(l.raiseOnCommittedEvent(),h))}Ki(e){return ph(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ge(ae.FAILED_PRECONDITION,Cm)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ph(e).put("owner",n)}static D(){return Ss.D()}bi(e){const n=ph(e);return n.get("owner").next(r=>this.vi(r)?(fe("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):te.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Nn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;QT()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return fe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Nn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Nn("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ph(t){return Qn(t,"owner")}function Xf(t){return Qn(t,"clientMetadata")}function aw(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=tt(),i=tt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new lw(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return QT()?8:eS($n())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(l=>{s.result=l}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(l=>{s.result=l})}).next(()=>{if(s.result)return;const l=new EM;return this.Xi(e,n,l).next(h=>{if(s.result=h,this.zi)return this.es(e,n,l,h.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(dc()<=ut.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",fc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),te.resolve()):(dc()<=ut.DEBUG&&fe("QueryEngine","Query:",fc(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(dc()<=ut.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",fc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,br(n))):te.resolve())}Yi(e,n){if(yE(n))return te.resolve(null);let r=br(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=d1(n,null,"F"),r=br(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const l=tt(...s);return this.Ji.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const m=this.ts(n,h);return this.ns(n,m,l,f.readTime)?this.Yi(e,d1(n,null,"F")):this.rs(e,m,n,f)}))})))}Zi(e,n,r,i){return yE(n)||i.isEqual(Be.min())?te.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const l=this.ts(n,s);return this.ns(n,l,r,i)?te.resolve(null):(dc()<=ut.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fc(n)),this.rs(e,l,n,XC(i,-1)).next(h=>h))})}ts(e,n){let r=new Vt(AS(e));return n.forEach((i,s)=>{Qd(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return dc()<=ut.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",fc(n)),this.Ji.getDocumentsMatchingQuery(e,n,gi.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(l=>{s=s.insert(l.key,l)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Qt($e),this._s=new _o(s=>Nl(s),Kd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hb(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function fb(t,e,n,r){return new vM(t,e,n,r)}async function gb(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const l=[],h=[];let f=tt();for(const m of i){l.push(m.batchId);for(const x of m.mutations)f=f.add(x.key)}for(const m of s){h.push(m.batchId);for(const x of m.mutations)f=f.add(x.key)}return n.localDocuments.getDocuments(r,f).next(m=>({hs:m,removedBatchIds:l,addedBatchIds:h}))})})}function IM(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(h,f,m,x){const E=m.batch,A=E.keys();let N=te.resolve();return A.forEach(U=>{N=N.next(()=>x.getEntry(f,U)).next(D=>{const G=m.docVersions.get(U);De(G!==null),D.version.compareTo(G)<0&&(E.applyToRemoteDocument(D,m),D.isValidDocument()&&(D.setReadTime(m.commitVersion),x.addEntry(D)))})}),N.next(()=>h.mutationQueue.removeMutationBatch(f,E))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let f=tt();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(f=f.add(h.batch.mutations[m].key));return f}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function mb(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function AM(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const l=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const h=[];e.targetChanges.forEach((x,E)=>{const A=i.get(E);if(!A)return;h.push(n.Ur.removeMatchingKeys(s,x.removedDocuments,E).next(()=>n.Ur.addMatchingKeys(s,x.addedDocuments,E)));let N=A.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(E)!==null?N=N.withResumeToken(An.EMPTY_BYTE_STRING,Be.min()).withLastLimboFreeSnapshotVersion(Be.min()):x.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(x.resumeToken,r)),i=i.insert(E,N),function(D,G,M){return D.resumeToken.approximateByteSize()===0||G.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(A,N,x)&&h.push(n.Ur.updateTargetData(s,N))});let f=Zr(),m=tt();if(e.documentUpdates.forEach(x=>{e.resolvedLimboDocuments.has(x)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(s,x))}),h.push(pb(s,l,e.documentUpdates).next(x=>{f=x.Ps,m=x.Is})),!r.isEqual(Be.min())){const x=n.Ur.getLastRemoteSnapshotVersion(s).next(E=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));h.push(x)}return te.waitFor(h).next(()=>l.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,f,m)).next(()=>f)}).then(s=>(n.os=i,s))}function pb(t,e,n){let r=tt(),i=tt();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let l=Zr();return n.forEach((h,f)=>{const m=s.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(Be.min())?(e.removeEntry(h,f.readTime),l=l.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),l=l.insert(h,f)):fe("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)}),{Ps:l,Is:i}})}function TM(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function du(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,te.resolve(i)):n.Ur.allocateTargetId(r).next(l=>(i=new ro(e,l,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function fu(t,e,n){const r=Ae(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,l=>r.persistence.referenceDelegate.removeTarget(l,i))}catch(l){if(!Oa(l))throw l;fe("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function x1(t,e,n){const r=Ae(t);let i=Be.min(),s=tt();return r.persistence.runTransaction("Execute query","readwrite",l=>function(f,m,x){const E=Ae(f),A=E._s.get(x);return A!==void 0?te.resolve(E.os.get(A)):E.Ur.getTargetData(m,x)}(r,l,br(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(l,h.targetId).next(f=>{s=f})}).next(()=>r.ss.getDocumentsMatchingQuery(l,e,n?i:Be.min(),n?s:tt())).next(h=>(wb(r,IS(e),h),{documents:h,Ts:s})))}function yb(t,e){const n=Ae(t),r=Ae(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(l=>l?l.target:null))}function xb(t,e){const n=Ae(t),r=n.us.get(e)||Be.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,XC(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(wb(n,e,i),i))}function wb(t,e,n){let r=t.us.get(e)||Be.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}async function CM(t,e,n,r){const i=Ae(t);let s=tt(),l=Zr();for(const m of n){const x=e.Es(m.metadata.name);m.document&&(s=s.add(x));const E=e.ds(m);E.setReadTime(e.As(m.metadata.readTime)),l=l.insert(x,E)}const h=i.cs.newChangeBuffer({trackRemovals:!0}),f=await du(i,function(x){return br(Pu(ht.fromString(`__bundle__/docs/${x}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",m=>pb(m,h,l).next(x=>(h.apply(m),x)).next(x=>i.Ur.removeMatchingKeysForTargetId(m,f.targetId).next(()=>i.Ur.addMatchingKeys(m,s,f.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(m,x.Ps,x.Is)).next(()=>x.Ps)))}async function SM(t,e,n=tt()){const r=await du(t,br(tw(e.bundledQuery))),i=Ae(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const l=Dn(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Gr.saveNamedQuery(s,e);const h=r.withResumeToken(An.EMPTY_BYTE_STRING,l);return i.os=i.os.insert(h.targetId,h),i.Ur.updateTargetData(s,h).next(()=>i.Ur.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Ur.addMatchingKeys(s,n,r.targetId)).next(()=>i.Gr.saveNamedQuery(s,e))})}function WE(t,e){return`firestore_clients_${t}_${e}`}function KE(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Sm(t,e){return`firestore_targets_${t}_${e}`}class w1{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let s,l=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(s=new ge(i.error.code,i.error.message))),l?new w1(e,n,i.state,s):(Nn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zh{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new ge(r.error.code,r.error.message))),s?new zh(e,r.state,i):(Nn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _1{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Kx();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=tS(r.activeTargetIds[l]),s=s.add(r.activeTargetIds[l]);return i?new _1(e,s):(Nn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class cw{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new cw(n.clientId,n.onlineState):(Nn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class dy{constructor(){this.activeTargetIds=Kx()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bm{constructor(e,n,r,i,s){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Qt($e),this.started=!1,this.bs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=WE(this.persistenceKey,this.ps),this.vs=function(f){return`firestore_sequence_number_${f}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new dy),this.Cs=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.xs=function(f){return`firestore_online_state_${f}`}(this.persistenceKey),this.Os=function(f){return`firestore_bundle_loaded_v2_${f}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(WE(this.persistenceKey,r));if(i){const s=_1.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Sm(this.persistenceKey,e));if(i){const s=zh.Rs(e,i);s&&(r=s.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Sm(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return fe("SharedClientState","READ",e,n),n}setItem(e,n){fe("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){fe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(fe("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Nn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(s){let l=Xr.oe;if(s!=null)try{const h=JSON.parse(s);De(typeof h=="number"),l=h}catch(h){Nn("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(n.newValue);r!==Xr.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new w1(this.currentUser,e,n,r),s=KE(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const n=KE(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=Sm(this.persistenceKey,e),s=new zh(e,n,r);this.setItem(i,s.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return _1.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return w1.Rs(new tr(s),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return zh.Rs(i,n)}Ls(e){return cw.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);fe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),l=[],h=[];return s.forEach(f=>{i.has(f)||l.push(f)}),i.forEach(f=>{s.has(f)||h.push(f)}),this.syncEngine.io(l,h).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=Kx();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class _b{constructor(){this.so=new dy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new dy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){fe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){fe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yf=null;function Rm(){return Yf===null?Yf=function(){return 268435456+Math.round(2147483648*Math.random())}():Yf++,"0x"+Yf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Er="WebChannelConnection";class PM extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,l){const h=Rm(),f=this.xo(n,r.toUriEncodedString());fe("RestConnection",`Sending RPC '${n}' ${h}:`,f,i);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,s,l),this.No(n,f,m,i).then(x=>(fe("RestConnection",`Received RPC '${n}' ${h}: `,x),x),x=>{throw bi("RestConnection",`RPC '${n}' ${h} failed with error: `,x,"url: ",f,"request:",i),x})}Lo(n,r,i,s,l,h){return this.Mo(n,r,i,s,l)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Nu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,l)=>n[l]=s),i&&i.headers.forEach((s,l)=>n[l]=s)}xo(n,r){const i=RM[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Rm();return new Promise((l,h)=>{const f=new jC;f.setWithCredentials(!0),f.listenOnce(zC.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case w0.NO_ERROR:const x=f.getResponseJson();fe(Er,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(x)),l(x);break;case w0.TIMEOUT:fe(Er,`RPC '${e}' ${s} timed out`),h(new ge(ae.DEADLINE_EXCEEDED,"Request time out"));break;case w0.HTTP_ERROR:const E=f.getStatus();if(fe(Er,`RPC '${e}' ${s} failed with status:`,E,"response text:",f.getResponseText()),E>0){let A=f.getResponseJson();Array.isArray(A)&&(A=A[0]);const N=A==null?void 0:A.error;if(N&&N.status&&N.message){const U=function(G){const M=G.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(M)>=0?M:ae.UNKNOWN}(N.status);h(new ge(U,N.message))}else h(new ge(ae.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new ge(ae.UNAVAILABLE,"Connection failed."));break;default:Re()}}finally{fe(Er,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(i);fe(Er,`RPC '${e}' ${s} sending request:`,i),f.send(n,"POST",m,r,15)})}Bo(e,n,r){const i=Rm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=HC(),h=qC(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Oo(f.initMessageHeaders,n,r),f.encodeInitMessageHeaders=!0;const x=s.join("");fe(Er,`Creating RPC '${e}' stream ${i}: ${x}`,f);const E=l.createWebChannel(x,f);let A=!1,N=!1;const U=new NM({Io:G=>{N?fe(Er,`Not sending because RPC '${e}' stream ${i} is closed:`,G):(A||(fe(Er,`Opening RPC '${e}' stream ${i} transport.`),E.open(),A=!0),fe(Er,`RPC '${e}' stream ${i} sending:`,G),E.send(G))},To:()=>E.close()}),D=(G,M,b)=>{G.listen(M,P=>{try{b(P)}catch(V){setTimeout(()=>{throw V},0)}})};return D(E,Ah.EventType.OPEN,()=>{N||(fe(Er,`RPC '${e}' stream ${i} transport opened.`),U.yo())}),D(E,Ah.EventType.CLOSE,()=>{N||(N=!0,fe(Er,`RPC '${e}' stream ${i} transport closed`),U.So())}),D(E,Ah.EventType.ERROR,G=>{N||(N=!0,bi(Er,`RPC '${e}' stream ${i} transport errored:`,G),U.So(new ge(ae.UNAVAILABLE,"The operation could not be completed")))}),D(E,Ah.EventType.MESSAGE,G=>{var M;if(!N){const b=G.data[0];De(!!b);const P=b,V=P.error||((M=P[0])===null||M===void 0?void 0:M.error);if(V){fe(Er,`RPC '${e}' stream ${i} received error:`,V);const $=V.status;let J=function(F){const H=Ln[F];if(H!==void 0)return VS(H)}($),k=V.message;J===void 0&&(J=ae.INTERNAL,k="Unknown error status: "+$+" with message "+V.message),N=!0,U.So(new ge(J,k)),E.close()}else fe(Er,`RPC '${e}' stream ${i} received:`,b),U.bo(b)}}),D(h,GC.STAT_EVENT,G=>{G.stat===Xp.PROXY?fe(Er,`RPC '${e}' stream ${i} detected buffering proxy`):G.stat===Xp.NOPROXY&&fe(Er,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{U.wo()},0),U}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eb(){return typeof window<"u"?window:null}function C0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(t){return new B5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(e,n,r,i,s,l,h,f){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===ae.RESOURCE_EXHAUSTED?(Nn(n.toString()),Nn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ge(ae.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return fe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(fe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class DM extends vb{constructor(e,n,r,i,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,l),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=z5(this.serializer,e),r=function(s){if(!("targetChange"in s))return Be.min();const l=s.targetChange;return l.targetIds&&l.targetIds.length?Be.min():l.readTime?Dn(l.readTime):Be.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=ay(this.serializer),n.addTarget=function(s,l){let h;const f=l.target;if(h=u1(f)?{documents:$S(s,f)}:{query:fg(s,f)._t},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=zS(s,l.resumeToken);const m=sy(s,l.expectedCount);m!==null&&(h.expectedCount=m)}else if(l.snapshotVersion.compareTo(Be.min())>0){h.readTime=hu(s,l.snapshotVersion.toTimestamp());const m=sy(s,l.expectedCount);m!==null&&(h.expectedCount=m)}return h}(this.serializer,e);const r=q5(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=ay(this.serializer),n.removeTarget=e,this.a_(n)}}class kM extends vb{constructor(e,n,r,i,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,l),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return De(!!e.streamToken),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){De(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=G5(e.writeResults,e.commitTime),r=Dn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=ay(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Id(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ge(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Mo(e,oy(n,r),i,s,l)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ge(ae.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Lo(e,oy(n,r),i,l,h,s)).catch(l=>{throw l.name==="FirebaseError"?(l.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ge(ae.UNKNOWN,l.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class MM{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Nn(n),this.D_=!1):fe("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(l=>{r.enqueueAndForget(async()=>{La(this)&&(fe("RemoteStore","Restarting streams for network reachability change."),await async function(f){const m=Ae(f);m.L_.add(4),await Ou(m),m.q_.set("Unknown"),m.L_.delete(4),await ef(m)}(this))})}),this.q_=new MM(r,i)}}async function ef(t){if(La(t))for(const e of t.B_)await e(!0)}async function Ou(t){for(const e of t.B_)await e(!1)}function yg(t,e){const n=Ae(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),fw(n)?dw(n):Lu(n).r_()&&hw(n,e))}function gu(t,e){const n=Ae(t),r=Lu(n);n.N_.delete(e),r.r_()&&Ib(n,e),n.N_.size===0&&(r.r_()?r.o_():La(n)&&n.q_.set("Unknown"))}function hw(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Be.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Lu(t).A_(e)}function Ib(t,e){t.Q_.xe(e),Lu(t).R_(e)}function dw(t){t.Q_=new M5({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Lu(t).start(),t.q_.v_()}function fw(t){return La(t)&&!Lu(t).n_()&&t.N_.size>0}function La(t){return Ae(t).L_.size===0}function Ab(t){t.Q_=void 0}async function FM(t){t.q_.set("Online")}async function VM(t){t.N_.forEach((e,n)=>{hw(t,e)})}async function BM(t,e){Ab(t),fw(t)?(t.q_.M_(e),dw(t)):t.q_.set("Unknown")}async function UM(t,e,n){if(t.q_.set("Online"),e instanceof jS&&e.state===2&&e.cause)try{await async function(i,s){const l=s.cause;for(const h of s.targetIds)i.N_.has(h)&&(await i.remoteSyncer.rejectListen(h,l),i.N_.delete(h),i.Q_.removeTarget(h))}(t,e)}catch(r){fe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await E1(t,r)}else if(e instanceof T0?t.Q_.Ke(e):e instanceof US?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Be.min()))try{const r=await mb(t.localStore);n.compareTo(r)>=0&&await function(s,l){const h=s.Q_.rt(l);return h.targetChanges.forEach((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const x=s.N_.get(m);x&&s.N_.set(m,x.withResumeToken(f.resumeToken,l))}}),h.targetMismatches.forEach((f,m)=>{const x=s.N_.get(f);if(!x)return;s.N_.set(f,x.withResumeToken(An.EMPTY_BYTE_STRING,x.snapshotVersion)),Ib(s,f);const E=new ro(x.target,f,m,x.sequenceNumber);hw(s,E)}),s.remoteSyncer.applyRemoteEvent(h)}(t,n)}catch(r){fe("RemoteStore","Failed to raise snapshot:",r),await E1(t,r)}}async function E1(t,e,n){if(!Oa(e))throw e;t.L_.add(1),await Ou(t),t.q_.set("Offline"),n||(n=()=>mb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{fe("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await ef(t)})}function Tb(t,e){return e().catch(n=>E1(t,n,e))}async function Mu(t){const e=Ae(t),n=Aa(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;jM(e);)try{const i=await TM(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,zM(e,i)}catch(i){await E1(e,i)}Cb(e)&&Sb(e)}function jM(t){return La(t)&&t.O_.length<10}function zM(t,e){t.O_.push(e);const n=Aa(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Cb(t){return La(t)&&!Aa(t).n_()&&t.O_.length>0}function Sb(t){Aa(t).start()}async function GM(t){Aa(t).p_()}async function qM(t){const e=Aa(t);for(const n of t.O_)e.m_(n.mutations)}async function HM(t,e,n){const r=t.O_.shift(),i=Yx.from(r,e,n);await Tb(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Mu(t)}async function WM(t,e){e&&Aa(t).V_&&await async function(r,i){if(function(l){return FS(l)&&l!==ae.ABORTED}(i.code)){const s=r.O_.shift();Aa(r).s_(),await Tb(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Mu(r)}}(t,e),Cb(t)&&Sb(t)}async function QE(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),fe("RemoteStore","RemoteStore received new credentials");const r=La(n);n.L_.add(3),await Ou(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await ef(n)}async function fy(t,e){const n=Ae(t);e?(n.L_.delete(2),await ef(n)):e||(n.L_.add(2),await Ou(n),n.q_.set("Unknown"))}function Lu(t){return t.K_||(t.K_=function(n,r,i){const s=Ae(n);return s.w_(),new DM(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:FM.bind(null,t),Ro:VM.bind(null,t),mo:BM.bind(null,t),d_:UM.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),fw(t)?dw(t):t.q_.set("Unknown")):(await t.K_.stop(),Ab(t))})),t.K_}function Aa(t){return t.U_||(t.U_=function(n,r,i){const s=Ae(n);return s.w_(),new kM(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:GM.bind(null,t),mo:WM.bind(null,t),f_:qM.bind(null,t),g_:HM.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Mu(t)):(await t.U_.stop(),t.O_.length>0&&(fe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const l=Date.now()+r,h=new gw(e,n,l,i,s);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fu(t,e){if(Nn("AsyncQueue",`${e}: ${t}`),Oa(t))return new ge(ae.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Te.comparator(n.key,r.key):(n,r)=>Te.comparator(n.key,r.key),this.keyedMap=Th(),this.sortedSet=new Qt(this.comparator)}static emptySet(e){return new jc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof jc)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new jc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(){this.W_=new Qt(Te.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Re():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class mu{constructor(e,n,r,i,s,l,h,f,m){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,n,r,i,s){const l=[];return n.forEach(h=>{l.push({type:0,doc:h})}),new mu(e,n,jc.emptySet(n),l,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$d(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class $M{constructor(){this.queries=YE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=YE(),s.forEach((l,h)=>{for(const f of h.j_)f.onError(r)})})(this,new ge(ae.ABORTED,"Firestore shutting down"))}}function YE(){return new _o(t=>vS(t),$d)}async function mw(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new KM,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(l){const h=Fu(l,`Initialization of query '${fc(e.query)}' failed`);return void e.onError(h)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&yw(n)}async function pw(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const l=s.j_.indexOf(e);l>=0&&(s.j_.splice(l,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function QM(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,l=n.queries.get(s);if(l){for(const h of l.j_)h.X_(i)&&(r=!0);l.z_=i}}r&&yw(n)}function XM(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function yw(t){t.Y_.forEach(e=>{e.next()})}var gy,ZE;(ZE=gy||(gy={})).ea="default",ZE.Cache="cache";class xw{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new mu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=mu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==gy.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e,n){this.aa=e,this.byteLength=n}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){this.serializer=e}Es(e){return bs(this.serializer,e)}ds(e){return e.metadata.exists?KS(this.serializer,e.document,!1):Jt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Dn(e)}}class ZM{constructor(e,n,r){this.ca=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=bb(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++n;const r=ht.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ha(e){const n=new Map,r=new JE(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Es(i.metadata.name);for(const l of i.metadata.queries){const h=(n.get(l)||tt()).add(s);n.set(l,h)}}return n}async complete(){const e=await CM(this.localStore,new JE(this.serializer),this.documents,this.ca.id),n=this.ha(this.documents);for(const r of this.queries)await SM(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function bb(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e){this.key=e}}class Nb{constructor(e){this.key=e}}class Pb{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=tt(),this.mutatedKeys=tt(),this.Aa=AS(e),this.Ra=new jc(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new XE,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,l=i,h=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((x,E)=>{const A=i.get(x),N=Qd(this.query,E)?E:null,U=!!A&&this.mutatedKeys.has(A.key),D=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let G=!1;A&&N?A.data.isEqual(N.data)?U!==D&&(r.track({type:3,doc:N}),G=!0):this.ga(A,N)||(r.track({type:2,doc:N}),G=!0,(f&&this.Aa(N,f)>0||m&&this.Aa(N,m)<0)&&(h=!0)):!A&&N?(r.track({type:0,doc:N}),G=!0):A&&!N&&(r.track({type:1,doc:A}),G=!0,(f||m)&&(h=!0)),G&&(N?(l=l.add(N),s=D?s.add(x):s.delete(x)):(l=l.delete(x),s=s.delete(x)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const x=this.query.limitType==="F"?l.last():l.first();l=l.delete(x.key),s=s.delete(x.key),r.track({type:1,doc:x})}return{Ra:l,fa:r,ns:h,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const l=e.fa.G_();l.sort((x,E)=>function(N,U){const D=G=>{switch(G){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re()}};return D(N)-D(U)}(x.type,E.type)||this.Aa(x.doc,E.doc)),this.pa(r),i=i!=null&&i;const h=n&&!i?this.ya():[],f=this.da.size===0&&this.current&&!i?1:0,m=f!==this.Ea;return this.Ea=f,l.length!==0||m?{snapshot:new mu(this.query,e.Ra,s,l,e.mutatedKeys,f===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new XE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=tt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Nb(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Rb(r))}),n}ba(e){this.Ta=e.Ts,this.da=tt();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return mu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class JM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class e9{constructor(e){this.key=e,this.va=!1}}class t9{constructor(e,n,r,i,s,l){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Ca={},this.Fa=new _o(h=>vS(h),$d),this.Ma=new Map,this.xa=new Set,this.Oa=new Qt(Te.comparator),this.Na=new Map,this.La=new iw,this.Ba={},this.ka=new Map,this.qa=Ml.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function n9(t,e,n=!0){const r=xg(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Db(r,e,n,!0),i}async function r9(t,e){const n=xg(t);await Db(n,e,!0,!1)}async function Db(t,e,n,r){const i=await du(t.localStore,br(e)),s=i.targetId,l=t.sharedClientState.addLocalQueryTarget(s,n);let h;return r&&(h=await ww(t,e,s,l==="current",i.resumeToken)),t.isPrimaryClient&&n&&yg(t.remoteStore,i),h}async function ww(t,e,n,r,i){t.Ka=(E,A,N)=>async function(D,G,M,b){let P=G.view.ma(M);P.ns&&(P=await x1(D.localStore,G.query,!1).then(({documents:k})=>G.view.ma(k,P)));const V=b&&b.targetChanges.get(G.targetId),$=b&&b.targetMismatches.get(G.targetId)!=null,J=G.view.applyChanges(P,D.isPrimaryClient,V,$);return my(D,G.targetId,J.wa),J.snapshot}(t,E,A,N);const s=await x1(t.localStore,e,!0),l=new Pb(e,s.Ts),h=l.ma(s.documents),f=Zd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),m=l.applyChanges(h,t.isPrimaryClient,f);my(t,n,m.wa);const x=new JM(e,n,l);return t.Fa.set(e,x),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),m.snapshot}async function i9(t,e,n){const r=Ae(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(l=>!$d(l,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await fu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&gu(r.remoteStore,i.targetId),pu(r,i.targetId)}).catch(ka)):(pu(r,i.targetId),await fu(r.localStore,i.targetId,!0))}async function s9(t,e){const n=Ae(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),gu(n.remoteStore,r.targetId))}async function o9(t,e,n){const r=Iw(t);try{const i=await function(l,h){const f=Ae(l),m=gn.now(),x=h.reduce((N,U)=>N.add(U.key),tt());let E,A;return f.persistence.runTransaction("Locally write mutations","readwrite",N=>{let U=Zr(),D=tt();return f.cs.getEntries(N,x).next(G=>{U=G,U.forEach((M,b)=>{b.isValidDocument()||(D=D.add(M))})}).next(()=>f.localDocuments.getOverlayedDocuments(N,U)).next(G=>{E=G;const M=[];for(const b of h){const P=D5(b,E.get(b.key).overlayedDocument);P!=null&&M.push(new Eo(b.key,P,hS(P.value.mapValue),an.exists(!0)))}return f.mutationQueue.addMutationBatch(N,m,M,h)}).next(G=>{A=G;const M=G.applyToLocalDocumentSet(E,D);return f.documentOverlayCache.saveOverlays(N,G.batchId,M)})}).then(()=>({batchId:A.batchId,changes:CS(E)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(l,h,f){let m=l.Ba[l.currentUser.toKey()];m||(m=new Qt($e)),m=m.insert(h,f),l.Ba[l.currentUser.toKey()]=m}(r,i.batchId,n),await vo(r,i.changes),await Mu(r.remoteStore)}catch(i){const s=Fu(i,"Failed to persist write");n.reject(s)}}async function kb(t,e){const n=Ae(t);try{const r=await AM(n.localStore,e);e.targetChanges.forEach((i,s)=>{const l=n.Na.get(s);l&&(De(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.va=!0:i.modifiedDocuments.size>0?De(l.va):i.removedDocuments.size>0&&(De(l.va),l.va=!1))}),await vo(n,r,e)}catch(r){await ka(r)}}function ev(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,l)=>{const h=l.view.Z_(e);h.snapshot&&i.push(h.snapshot)}),function(l,h){const f=Ae(l);f.onlineState=h;let m=!1;f.queries.forEach((x,E)=>{for(const A of E.j_)A.Z_(h)&&(m=!0)}),m&&yw(f)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function a9(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let l=new Qt(Te.comparator);l=l.insert(s,Jt.newNoDocument(s,Be.min()));const h=tt().add(s),f=new Yd(Be.min(),new Map,new Qt($e),l,h);await kb(r,f),r.Oa=r.Oa.remove(s),r.Na.delete(e),vw(r)}else await fu(r.localStore,e,!1).then(()=>pu(r,e,n)).catch(ka)}async function l9(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await IM(n.localStore,e);Ew(n,r,null),_w(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await vo(n,i)}catch(i){await ka(i)}}async function c9(t,e,n){const r=Ae(t);try{const i=await function(l,h){const f=Ae(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let x;return f.mutationQueue.lookupMutationBatch(m,h).next(E=>(De(E!==null),x=E.keys(),f.mutationQueue.removeMutationBatch(m,E))).next(()=>f.mutationQueue.performConsistencyCheck(m)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(m,x,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,x)).next(()=>f.localDocuments.getDocuments(m,x))})}(r.localStore,e);Ew(r,e,n),_w(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await vo(r,i)}catch(i){await ka(i)}}async function u9(t,e){const n=Ae(t);La(n.remoteStore)||fe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(l){const h=Ae(l);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",f=>h.mutationQueue.getHighestUnacknowledgedBatchId(f))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ka.get(r)||[];i.push(e),n.ka.set(r,i)}catch(r){const i=Fu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function _w(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Ew(t,e,n){const r=Ae(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function pu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Ob(t,r)})}function Ob(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(gu(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),vw(t))}function my(t,e,n){for(const r of n)r instanceof Rb?(t.La.addReference(r.key,e),h9(t,r)):r instanceof Nb?(fe("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Ob(t,r.key)):Re()}function h9(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(fe("SyncEngine","New document in limbo: "+n),t.xa.add(r),vw(t))}function vw(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Te(ht.fromString(e)),r=t.qa.next();t.Na.set(r,new e9(n)),t.Oa=t.Oa.insert(n,r),yg(t.remoteStore,new ro(br(Pu(n.path)),r,"TargetPurposeLimboResolution",Xr.oe))}}async function vo(t,e,n){const r=Ae(t),i=[],s=[],l=[];r.Fa.isEmpty()||(r.Fa.forEach((h,f)=>{l.push(r.Ka(f,e,n).then(m=>{var x;if((m||n)&&r.isPrimaryClient){const E=m?!m.fromCache:(x=n==null?void 0:n.targetChanges.get(f.targetId))===null||x===void 0?void 0:x.current;r.sharedClientState.updateQueryState(f.targetId,E?"current":"not-current")}if(m){i.push(m);const E=lw.Wi(f.targetId,m);s.push(E)}}))}),await Promise.all(l),r.Ca.d_(i),await async function(f,m){const x=Ae(f);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>te.forEach(m,A=>te.forEach(A.$i,N=>x.persistence.referenceDelegate.addReference(E,A.targetId,N)).next(()=>te.forEach(A.Ui,N=>x.persistence.referenceDelegate.removeReference(E,A.targetId,N)))))}catch(E){if(!Oa(E))throw E;fe("LocalStore","Failed to update sequence numbers: "+E)}for(const E of m){const A=E.targetId;if(!E.fromCache){const N=x.os.get(A),U=N.snapshotVersion,D=N.withLastLimboFreeSnapshotVersion(U);x.os=x.os.insert(A,D)}}}(r.localStore,s))}async function d9(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){fe("SyncEngine","User change. New user:",e.toKey());const r=await gb(n.localStore,e);n.currentUser=e,function(s,l){s.ka.forEach(h=>{h.forEach(f=>{f.reject(new ge(ae.CANCELLED,l))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await vo(n,r.hs)}}function f9(t,e){const n=Ae(t),r=n.Na.get(e);if(r&&r.va)return tt().add(r.key);{let i=tt();const s=n.Ma.get(e);if(!s)return i;for(const l of s){const h=n.Fa.get(l);i=i.unionWith(h.view.Va)}return i}}async function g9(t,e){const n=Ae(t),r=await x1(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&my(n,e.targetId,i.wa),i}async function m9(t,e){const n=Ae(t);return xb(n.localStore,e).then(r=>vo(n,r))}async function p9(t,e,n,r){const i=Ae(t),s=await function(h,f){const m=Ae(h),x=Ae(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",E=>x.Mn(E,f).next(A=>A?m.localDocuments.getDocuments(E,A):te.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Mu(i.remoteStore):n==="acknowledged"||n==="rejected"?(Ew(i,e,r||null),_w(i,e),function(h,f){Ae(Ae(h).mutationQueue).On(f)}(i.localStore,e)):Re(),await vo(i,s)):fe("SyncEngine","Cannot apply mutation batch with id: "+e)}async function y9(t,e){const n=Ae(t);if(xg(n),Iw(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await tv(n,r.toArray());n.Qa=!0,await fy(n.remoteStore,!0);for(const s of i)yg(n.remoteStore,s)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((s,l)=>{n.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(pu(n,l),fu(n.localStore,l,!0))),gu(n.remoteStore,l)}),await i,await tv(n,r),function(l){const h=Ae(l);h.Na.forEach((f,m)=>{gu(h.remoteStore,m)}),h.La.pr(),h.Na=new Map,h.Oa=new Qt(Te.comparator)}(n),n.Qa=!1,await fy(n.remoteStore,!1)}}async function tv(t,e,n){const r=Ae(t),i=[],s=[];for(const l of e){let h;const f=r.Ma.get(l);if(f&&f.length!==0){h=await du(r.localStore,br(f[0]));for(const m of f){const x=r.Fa.get(m),E=await g9(r,x);E.snapshot&&s.push(E.snapshot)}}else{const m=await yb(r.localStore,l);h=await du(r.localStore,m),await ww(r,Mb(m),l,!1,h.resumeToken)}i.push(h)}return r.Ca.d_(s),i}function Mb(t){return wS(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function x9(t){return function(n){return Ae(Ae(n).persistence).Qi()}(Ae(t).localStore)}async function w9(t,e,n,r){const i=Ae(t);if(i.Qa)return void fe("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const l=await xb(i.localStore,IS(s[0])),h=Yd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",An.EMPTY_BYTE_STRING);await vo(i,l,h);break}case"rejected":await fu(i.localStore,e,!0),pu(i,e,r);break;default:Re()}}async function _9(t,e,n){const r=xg(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){fe("SyncEngine","Adding an already active target "+i);continue}const s=await yb(r.localStore,i),l=await du(r.localStore,s);await ww(r,Mb(s),l.targetId,!1,l.resumeToken),yg(r.remoteStore,l)}for(const i of n)r.Ma.has(i)&&await fu(r.localStore,i,!1).then(()=>{gu(r.remoteStore,i),pu(r,i)}).catch(ka)}}function xg(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=f9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=a9.bind(null,e),e.Ca.d_=QM.bind(null,e.eventManager),e.Ca.$a=XM.bind(null,e.eventManager),e}function Iw(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=l9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=c9.bind(null,e),e}function E9(t,e,n){const r=Ae(t);(async function(s,l,h){try{const f=await l.getMetadata();if(await function(N,U){const D=Ae(N),G=Dn(U.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",M=>D.Gr.getBundleMetadata(M,U.id)).then(M=>!!M&&M.createTime.compareTo(G)>=0)}(s.localStore,f))return await l.close(),h._completeWith(function(N){return{taskState:"Success",documentsLoaded:N.totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}}(f)),Promise.resolve(new Set);h._updateProgress(bb(f));const m=new ZM(f,s.localStore,l.serializer);let x=await l.Ua();for(;x;){const A=await m.la(x);A&&h._updateProgress(A),x=await l.Ua()}const E=await m.complete();return await vo(s,E.Ia,void 0),await function(N,U){const D=Ae(N);return D.persistence.runTransaction("Save bundle","readwrite",G=>D.Gr.saveBundleMetadata(G,U))}(s.localStore,f),h._completeWith(E.progress),Promise.resolve(E.Pa)}catch(f){return bi("SyncEngine",`Loading bundle failed with ${f}`),h._failWith(f),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Ta{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return fb(this.persistence,new db,e.initialUser,this.serializer)}Ga(e){return new sw(pg.Zr,this.serializer)}Wa(e){return new _b}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ta.provider={build:()=>new Ta};class v9 extends Ta{constructor(e){super(),this.cacheSizeBytes=e}ja(e,n){De(this.persistence.referenceDelegate instanceof y1);const r=this.persistence.referenceDelegate.garbageCollector;return new ab(r,e.asyncQueue,n)}Ga(e){const n=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new sw(r=>y1.Zr(r,n),this.serializer)}}class Aw extends Ta{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Iw(this.Ja.syncEngine),await Mu(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return fb(this.persistence,new db,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new ab(r,e.asyncQueue,n)}Ha(e,n){const r=new qO(n,this.persistence);return new GO(e.asyncQueue,r)}Ga(e){const n=aw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new ow(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Eb(),C0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new _b}}class Lb extends Aw{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof bm&&(this.sharedClientState.syncEngine={no:p9.bind(null,n),ro:w9.bind(null,n),io:_9.bind(null,n),Qi:x9.bind(null,n),eo:m9.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await y9(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=Eb();if(!bm.D(n))throw new ge(ae.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=aw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new bm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ca{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ev(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=d9.bind(null,this.syncEngine),await fy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $M}()}createDatastore(e){const n=Jd(e.databaseInfo.databaseId),r=function(s){return new PM(s)}(e.databaseInfo);return function(s,l,h,f){return new OM(s,l,h,f)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,l,h){return new LM(r,i,s,l,h)}(this.localStore,this.datastore,e.asyncQueue,n=>ev(this.syncEngine,n,0),function(){return $E.D()?new $E:new bM}())}createSyncEngine(e,n){return function(i,s,l,h,f,m,x){const E=new t9(i,s,l,h,f,m);return x&&(E.Qa=!0),E}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);fe("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ou(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Ca.provider={build:()=>new Ca};function nv(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Nn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(e,n){this.Xa=e,this.serializer=n,this.metadata=new rr,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const n=this.eu.decode(e),r=Number(n);isNaN(r)&&this.ru(`length string (${n}) is not valid number`);const i=await this.iu(r);return new YM(JSON.parse(i),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const n=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A9{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ge(ae.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const l=Ae(i),h={documents:s.map(E=>vd(l.serializer,E))},f=await l.Lo("BatchGetDocuments",l.serializer.databaseId,ht.emptyPath(),h,s.length),m=new Map;f.forEach(E=>{const A=j5(l.serializer,E);m.set(A.key.toString(),A)});const x=[];return s.forEach(E=>{const A=m.get(E.toString());De(!!A),x.push(A)}),x}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ku(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=Te.fromPath(r);this.mutations.push(new Qx(i,this.precondition(i)))}),await async function(r,i){const s=Ae(r),l={writes:i.map(h=>Id(s.serializer,h))};await s.Mo("Commit",s.serializer.databaseId,ht.emptyPath(),l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Re();n=Be.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new ge(ae.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Be.min())?an.exists(!1):an.updateTime(n):an.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Be.min()))throw new ge(ae.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return an.updateTime(n)}return an.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new uw(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new A9(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!Wd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!FS(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=tr.UNAUTHENTICATED,this.clientId=$C.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async l=>{fe("FirestoreClient","Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(r,l=>(fe("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Fu(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Nm(t,e){t.asyncQueue.verifyOperationInProgress(),fe("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await gb(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function rv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Tw(t);fe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>QE(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>QE(e.remoteStore,i)),t._onlineComponents=e}async function Tw(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){fe("FirestoreClient","Using user provided OfflineComponentProvider");try{await Nm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===ae.FAILED_PRECONDITION||i.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;bi("Error using user provided cache. Falling back to memory cache: "+n),await Nm(t,new Ta)}}else fe("FirestoreClient","Using default OfflineComponentProvider"),await Nm(t,new Ta);return t._offlineComponents}async function _g(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(fe("FirestoreClient","Using user provided OnlineComponentProvider"),await rv(t,t._uninitializedComponentsProvider._online)):(fe("FirestoreClient","Using default OnlineComponentProvider"),await rv(t,new Ca))),t._onlineComponents}function Fb(t){return Tw(t).then(e=>e.persistence)}function Vu(t){return Tw(t).then(e=>e.localStore)}function Vb(t){return _g(t).then(e=>e.remoteStore)}function Cw(t){return _g(t).then(e=>e.syncEngine)}function Bb(t){return _g(t).then(e=>e.datastore)}async function yu(t){const e=await _g(t),n=e.eventManager;return n.onListen=n9.bind(null,e.syncEngine),n.onUnlisten=i9.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=r9.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=s9.bind(null,e.syncEngine),n}function S9(t){return t.asyncQueue.enqueue(async()=>{const e=await Fb(t),n=await Vb(t);return e.setNetworkEnabled(!0),function(i){const s=Ae(i);return s.L_.delete(0),ef(s)}(n)})}function b9(t){return t.asyncQueue.enqueue(async()=>{const e=await Fb(t),n=await Vb(t);return e.setNetworkEnabled(!1),async function(i){const s=Ae(i);s.L_.add(0),await Ou(s),s.q_.set("Offline")}(n)})}function R9(t,e){const n=new rr;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,l){try{const h=await function(m,x){const E=Ae(m);return E.persistence.runTransaction("read document","readonly",A=>E.localDocuments.getDocument(A,x))}(i,s);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new ge(ae.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const f=Fu(h,`Failed to get document '${s} from cache`);l.reject(f)}}(await Vu(t),e,n)),n.promise}function Ub(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(s,l,h,f,m){const x=new wg({next:A=>{x.Za(),l.enqueueAndForget(()=>pw(s,E));const N=A.docs.has(h);!N&&A.fromCache?m.reject(new ge(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&A.fromCache&&f&&f.source==="server"?m.reject(new ge(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(A)},error:A=>m.reject(A)}),E=new xw(Pu(h.path),x,{includeMetadataChanges:!0,_a:!0});return mw(s,E)}(await yu(t),t.asyncQueue,e,n,r)),r.promise}function N9(t,e){const n=new rr;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,l){try{const h=await x1(i,s,!0),f=new Pb(s,h.Ts),m=f.ma(h.documents),x=f.applyChanges(m,!1);l.resolve(x.snapshot)}catch(h){const f=Fu(h,`Failed to execute query '${s} against cache`);l.reject(f)}}(await Vu(t),e,n)),n.promise}function jb(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(s,l,h,f,m){const x=new wg({next:A=>{x.Za(),l.enqueueAndForget(()=>pw(s,E)),A.fromCache&&f.source==="server"?m.reject(new ge(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(A)},error:A=>m.reject(A)}),E=new xw(h,x,{includeMetadataChanges:!0,_a:!0});return mw(s,E)}(await yu(t),t.asyncQueue,e,n,r)),r.promise}function P9(t,e,n){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await Bb(t);r.resolve(async function(l,h,f){var m;const x=Ae(l),{request:E,ut:A,parent:N}=QS(x.serializer,_S(h),f);x.connection.Fo||delete E.parent;const U=(await x.Lo("RunAggregationQuery",x.serializer.databaseId,N,E,1)).filter(G=>!!G.result);De(U.length===1);const D=(m=U[0].result)===null||m===void 0?void 0:m.aggregateFields;return Object.keys(D).reduce((G,M)=>(G[A[M]]=D[M],G),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}function D9(t,e){const n=new wg(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){Ae(i).Y_.add(s),s.next()}(await yu(t),n)),()=>{n.Za(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){Ae(i).Y_.delete(s)}(await yu(t),n))}}function k9(t,e,n,r){const i=function(l,h){let f;return f=typeof l=="string"?BS().encode(l):l,function(x,E){return new I9(x,E)}(function(x,E){if(x instanceof Uint8Array)return nv(x,E);if(x instanceof ArrayBuffer)return nv(new Uint8Array(x),E);if(x instanceof ReadableStream)return x.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(f),h)}(n,Jd(e));t.asyncQueue.enqueueAndForget(async()=>{E9(await Cw(t),i,r)})}function O9(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=Ae(r);return s.persistence.runTransaction("Get named query","readonly",l=>s.Gr.getNamedQuery(l,i))}(await Vu(t),e))}function M9(t,e){return t.asyncQueue.enqueue(async()=>async function(r,i){const s=Ae(r),l=s.indexManager,h=[];return s.persistence.runTransaction("Configure indexes","readwrite",f=>l.getFieldIndexes(f).next(m=>function(E,A,N,U,D){E=[...E],A=[...A],E.sort(N),A.sort(N);const G=E.length,M=A.length;let b=0,P=0;for(;b<M&&P<G;){const V=N(E[P],A[b]);V<0?D(E[P++]):V>0?U(A[b++]):(b++,P++)}for(;b<M;)U(A[b++]);for(;P<G;)D(E[P++])}(m,i,BO,x=>{h.push(l.addFieldIndex(f,x))},x=>{h.push(l.deleteFieldIndex(f,x))})).next(()=>te.waitFor(h)))}(await Vu(t),e))}function L9(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){Ae(r).ss.zi=i}(await Vu(t),e))}function F9(t){return t.asyncQueue.enqueue(async()=>function(n){const r=Ae(n),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",s=>i.deleteAllFieldIndexes(s))}(await Vu(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t,e,n){if(!n)throw new ge(ae.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function V9(t,e,n,r){if(e===!0&&r===!0)throw new ge(ae.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function sv(t){if(!Te.isDocumentKey(t))throw new ge(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ov(t){if(Te.isDocumentKey(t))throw new ge(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Eg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Re()}function at(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ge(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Eg(t);throw new ge(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Gb(t,e){if(e<=0)throw new ge(ae.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}V9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zb((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ge(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ge(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ge(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new av({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new av(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PO;switch(r.type){case"firstParty":return new MO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ge(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=iv.get(n);r&&(fe("ComponentProvider","Removing Datastore"),iv.delete(n),r.terminate())}(this),Promise.resolve()}}function B9(t,e,n,r={}){var i;const s=(t=at(t,tf))._getSettings(),l=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==l&&bi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:l,ssl:!1})),r.mockUserToken){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=tr.MOCK_USER;else{h=$T(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new ge(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new tr(m)}t._authCredentials=new DO(new WC(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new gr(this.firestore,e,this._query)}}class kn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kn(this.firestore,e,this._key)}}class Rs extends gr{constructor(e,n,r){super(e,n,Pu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new Te(e))}withConverter(e){return new Rs(this.firestore,e,this._path)}}function Fa(t,e,...n){if(t=mt(t),Sw("collection","path",e),t instanceof tf){const r=ht.fromString(e,...n);return ov(r),new Rs(t,null,r)}{if(!(t instanceof kn||t instanceof Rs))throw new ge(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ht.fromString(e,...n));return ov(r),new Rs(t.firestore,null,r)}}function WV(t,e){if(t=at(t,tf),Sw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ge(ae.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new gr(t,null,function(r){return new wo(ht.emptyPath(),r)}(e))}function Lr(t,e,...n){if(t=mt(t),arguments.length===1&&(e=$C.newId()),Sw("doc","path",e),t instanceof tf){const r=ht.fromString(e,...n);return sv(r),new kn(t,null,new Te(r))}{if(!(t instanceof kn||t instanceof Rs))throw new ge(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ht.fromString(e,...n));return sv(r),new kn(t.firestore,t instanceof Rs?t.converter:null,new Te(r))}}function KV(t,e){return t=mt(t),e=mt(e),(t instanceof kn||t instanceof Rs)&&(e instanceof kn||e instanceof Rs)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function qb(t,e){return t=mt(t),e=mt(e),t instanceof gr&&e instanceof gr&&t.firestore===e.firestore&&$d(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uw(this,"async_queue_retry"),this.Vu=()=>{const r=C0();r&&fe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=C0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=C0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new rr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Oa(e))throw e;fe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(r);throw Nn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=gw.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Re()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function py(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class U9{constructor(){this._progressObserver={},this._taskCompletionResolver=new rr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=-1;class qt extends tf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new lv,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new lv(e),this._firestoreClient=void 0,await e}}}function QV(t,e,n){n||(n="(default)");const r=Ul(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(xa(s,e))return i;throw new ge(ae.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ge(ae.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function j9(t,e){const n=typeof t=="object"?t:rg(),r=typeof t=="string"?t:e||"(default)",i=Ul(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Rx("firestore");s&&B9(i,...s)}return i}function pn(t){if(t._terminated)throw new ge(ae.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Hb(t),t._firestoreClient}function Hb(t){var e,n,r;const i=t._freezeSettings(),s=function(h,f,m,x){return new h5(h,f,m,x.host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,zb(x.experimentalLongPollingOptions),x.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new C9(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(h){const f=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(f),_online:f}}(t._componentsProvider))}function XV(t,e){bi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return Wb(t,Ca.provider,{build:r=>new Aw(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function YV(t){bi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();Wb(t,Ca.provider,{build:n=>new Lb(n,e.cacheSizeBytes)})}function Wb(t,e,n){if((t=at(t,qt))._firestoreClient||t._terminated)throw new ge(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ge(ae.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Hb(t)}function ZV(t){if(t._initialized&&!t._terminated)throw new ge(ae.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new rr;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Ss.D())return Promise.resolve();const i=r+"main";await Ss.delete(i)}(aw(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function JV(t){return function(n){const r=new rr;return n.asyncQueue.enqueueAndForget(async()=>u9(await Cw(n),r)),r.promise}(pn(t=at(t,qt)))}function eB(t){return S9(pn(t=at(t,qt)))}function tB(t){return b9(pn(t=at(t,qt)))}function nB(t){return n6(t.app,"firestore",t._databaseId.database),t._delete()}function rB(t,e){const n=pn(t=at(t,qt)),r=new U9;return k9(n,t._databaseId,e,r),r}function iB(t,e){return O9(pn(t=at(t,qt)),e).then(n=>n?new gr(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class z9{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ll(An.fromBase64String(e))}catch(n){throw new ge(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ll(An.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ge(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new on(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function sB(){return new ql("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ge(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ge(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return $e(this._lat,e._lat)||$e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G9=/^__.*__$/;class q9{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Eo(e,this.data,this.fieldMask,n,this.fieldTransforms):new Du(e,this.data,n,this.fieldTransforms)}}class Kb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Eo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function $b(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re()}}class Ig{constructor(e,n,r,i,s,l){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ig(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return v1(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if($b(this.Cu)&&G9.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class H9{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Jd(e)}Qu(e,n,r,i=!1){return new Ig({Cu:e,methodName:n,qu:r,path:on.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wl(t){const e=t._freezeSettings(),n=Jd(t._databaseId);return new H9(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ag(t,e,n,r,i,s={}){const l=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);Mw("Data must be an object, but it was:",l,r);const h=Yb(r,l);let f,m;if(s.merge)f=new Yr(l.fieldMask),m=l.fieldTransforms;else if(s.mergeFields){const x=[];for(const E of s.mergeFields){const A=Td(e,E,n);if(!l.contains(A))throw new ge(ae.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);Jb(x,A)||x.push(A)}f=new Yr(x),m=l.fieldTransforms.filter(E=>f.covers(E.field))}else f=null,m=l.fieldTransforms;return new q9(new hr(h),f,m)}class nf extends Hl{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nf}}function Qb(t,e,n){return new Ig({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Rw extends Hl{_toFieldTransform(e){return new Xd(e.path,new cu)}isEqual(e){return e instanceof Rw}}class Nw extends Hl{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=Qb(this,e,!0),r=this.Ku.map(s=>Kl(s,n)),i=new Pl(r);return new Xd(e.path,i)}isEqual(e){return e instanceof Nw&&xa(this.Ku,e.Ku)}}class Pw extends Hl{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=Qb(this,e,!0),r=this.Ku.map(s=>Kl(s,n)),i=new Dl(r);return new Xd(e.path,i)}isEqual(e){return e instanceof Pw&&xa(this.Ku,e.Ku)}}class Dw extends Hl{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new uu(e.serializer,RS(e.serializer,this.$u));return new Xd(e.path,n)}isEqual(e){return e instanceof Dw&&this.$u===e.$u}}function kw(t,e,n,r){const i=t.Qu(1,e,n);Mw("Data must be an object, but it was:",i,r);const s=[],l=hr.empty();Ma(r,(f,m)=>{const x=Tg(e,f,n);m=mt(m);const E=i.Nu(x);if(m instanceof nf)s.push(x);else{const A=Kl(m,E);A!=null&&(s.push(x),l.set(x,A))}});const h=new Yr(s);return new Kb(l,h,i.fieldTransforms)}function Ow(t,e,n,r,i,s){const l=t.Qu(1,e,n),h=[Td(e,r,n)],f=[i];if(s.length%2!=0)throw new ge(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<s.length;A+=2)h.push(Td(e,s[A])),f.push(s[A+1]);const m=[],x=hr.empty();for(let A=h.length-1;A>=0;--A)if(!Jb(m,h[A])){const N=h[A];let U=f[A];U=mt(U);const D=l.Nu(N);if(U instanceof nf)m.push(N);else{const G=Kl(U,D);G!=null&&(m.push(N),x.set(N,G))}}const E=new Yr(m);return new Kb(x,E,l.fieldTransforms)}function Xb(t,e,n,r=!1){return Kl(n,t.Qu(r?4:3,e))}function Kl(t,e){if(Zb(t=mt(t)))return Mw("Unsupported field value:",e,t),Yb(t,e);if(t instanceof Hl)return function(r,i){if(!$b(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let l=0;for(const h of r){let f=Kl(h,i.Lu(l));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),l++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=mt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return RS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=gn.fromDate(r);return{timestampValue:hu(i.serializer,s)}}if(r instanceof gn){const s=new gn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:hu(i.serializer,s)}}if(r instanceof bw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ll)return{bytesValue:zS(i.serializer,r._byteString)};if(r instanceof kn){const s=i.databaseId,l=r.firestore._databaseId;if(!l.isEqual(s))throw i.Bu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ew(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof vg)return function(l,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:l.toArray().map(f=>{if(typeof f!="number")throw h.Bu("VectorValues must only contain numeric values.");return $x(h.serializer,f)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Eg(r)}`)}(t,e)}function Yb(t,e){const n={};return aS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ma(t,(r,i)=>{const s=Kl(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Zb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gn||t instanceof bw||t instanceof Ll||t instanceof kn||t instanceof Hl||t instanceof vg)}function Mw(t,e,n){if(!Zb(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Eg(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Td(t,e,n){if((e=mt(e))instanceof ql)return e._internalPath;if(typeof e=="string")return Tg(t,e);throw v1("Field path arguments must be of type string or ",t,!1,void 0,n)}const W9=new RegExp("[~\\*/\\[\\]]");function Tg(t,e,n){if(e.search(W9)>=0)throw v1(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ql(...e.split("."))._internalPath}catch{throw v1(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function v1(t,e,n,r,i){const s=r&&!r.isEmpty(),l=i!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(s||l)&&(f+=" (found",s&&(f+=` in field ${r}`),l&&(f+=` in document ${i}`),f+=")"),new ge(ae.INVALID_ARGUMENT,h+t+f)}function Jb(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new K9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Cg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class K9 extends Cd{data(){return super.data()}}function Cg(t,e){return typeof e=="string"?Tg(t,e):e instanceof ql?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ge(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Lw{}class rf extends Lw{}function Bu(t,e,...n){let r=[];e instanceof Lw&&r.push(e),r=r.concat(n),function(s){const l=s.filter(f=>f instanceof Uu).length,h=s.filter(f=>f instanceof sf).length;if(l>1||l>0&&h>0)throw new ge(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class sf extends rf{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new sf(e,n,r)}_apply(e){const n=this._parse(e);return nR(e._query,n),new gr(e.firestore,e.converter,iy(e._query,n))}_parse(e){const n=Wl(e.firestore);return function(s,l,h,f,m,x,E){let A;if(m.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new ge(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){uv(E,x);const N=[];for(const U of E)N.push(cv(f,s,U));A={arrayValue:{values:N}}}else A=cv(f,s,E)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||uv(E,x),A=Xb(h,l,E,x==="in"||x==="not-in");return dt.create(m,x,A)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Sd(t,e,n){const r=e,i=Cg("where",t);return sf._create(i,r,n)}class Uu extends Lw{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Uu(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Dt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let l=i;const h=s.getFlattenedFilters();for(const f of h)nR(l,f),l=iy(l,f)}(e._query,n),new gr(e.firestore,e.converter,iy(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function oB(...t){return t.forEach(e=>rR("or",e)),Uu._create("or",t)}function aB(...t){return t.forEach(e=>rR("and",e)),Uu._create("and",t)}class Fw extends rf{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Fw(e,n)}_apply(e){const n=function(i,s,l){if(i.startAt!==null)throw new ge(ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ge(ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ed(s,l)}(e._query,this._field,this._direction);return new gr(e.firestore,e.converter,function(i,s){const l=i.explicitOrderBy.concat([s]);return new wo(i.path,i.collectionGroup,l,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Sg(t,e="asc"){const n=e,r=Cg("orderBy",t);return Fw._create(r,n)}class bg extends rf{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new bg(e,n,r)}_apply(e){return new gr(e.firestore,e.converter,d1(e._query,this._limit,this._limitType))}}function lB(t){return Gb("limit",t),bg._create("limit",t,"F")}function cB(t){return Gb("limitToLast",t),bg._create("limitToLast",t,"L")}class Rg extends rf{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Rg(e,n,r)}_apply(e){const n=tR(e,this.type,this._docOrFields,this._inclusive);return new gr(e.firestore,e.converter,function(i,s){return new wo(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function uB(...t){return Rg._create("startAt",t,!0)}function hB(...t){return Rg._create("startAfter",t,!1)}class Ng extends rf{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Ng(e,n,r)}_apply(e){const n=tR(e,this.type,this._docOrFields,this._inclusive);return new gr(e.firestore,e.converter,function(i,s){return new wo(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function dB(...t){return Ng._create("endBefore",t,!1)}function fB(...t){return Ng._create("endAt",t,!0)}function tR(t,e,n,r){if(n[0]=mt(n[0]),n[0]instanceof Cd)return function(s,l,h,f,m){if(!f)throw new ge(ae.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const x=[];for(const E of Uc(s))if(E.field.isKeyField())x.push(Rl(l,f.key));else{const A=f.data.field(E.field);if(lg(A))throw new ge(ae.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+E.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(A===null){const N=E.field.canonicalString();throw new ge(ae.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}x.push(A)}return new Ia(x,m)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Wl(t.firestore);return function(l,h,f,m,x,E){const A=l.explicitOrderBy;if(x.length>A.length)throw new ge(ae.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let U=0;U<x.length;U++){const D=x[U];if(A[U].field.isKeyField()){if(typeof D!="string")throw new ge(ae.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof D}`);if(!Wx(l)&&D.indexOf("/")!==-1)throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${D}' contains a slash.`);const G=l.path.child(ht.fromString(D));if(!Te.isDocumentKey(G))throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${G}' is not because it contains an odd number of segments.`);const M=new Te(G);N.push(Rl(h,M))}else{const G=Xb(f,m,D);N.push(G)}}return new Ia(N,E)}(t._query,t.firestore._databaseId,i,e,n,r)}}function cv(t,e,n){if(typeof(n=mt(n))=="string"){if(n==="")throw new ge(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wx(e)&&n.indexOf("/")!==-1)throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ht.fromString(n));if(!Te.isDocumentKey(r))throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Rl(t,new Te(r))}if(n instanceof kn)return Rl(t,n._key);throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Eg(n)}.`)}function uv(t,e){if(!Array.isArray(t)||t.length===0)throw new ge(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function nR(t,e){const n=function(i,s){for(const l of i)for(const h of l.getFlattenedFilters())if(s.indexOf(h.op)>=0)return h.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ge(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function rR(t,e){if(!(e instanceof sf||e instanceof Uu))throw new ge(ae.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class iR{convertValue(e,n="none"){switch(Ea(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(mo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Re()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ma(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(l=>rn(l.doubleValue));return new vg(s)}convertGeoPoint(e){return new bw(rn(e.latitude),rn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=cg(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(xd(e));default:return null}}convertTimestamp(e){const n=go(e);return new gn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ht.fromString(e);De(JS(r));const i=new bl(r.get(1),r.get(3)),s=new Te(r.popFirst(5));return i.isEqual(n)||Nn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class $9 extends iR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ll(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gB(t){return new Ad("sum",Td("sum",t))}function mB(t){return new Ad("avg",Td("average",t))}function Q9(){return new Ad("count")}function pB(t,e){var n,r;return t instanceof Ad&&e instanceof Ad&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)===null||n===void 0?void 0:n.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function yB(t,e){return qb(t.query,e.query)&&xa(t.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xu extends Cd{constructor(e,n,r,i,s,l){super(e,n,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new S0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Cg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class S0 extends xu{data(e={}){return super.data(e)}}class wu{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ll(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new S0(this._firestore,this._userDataWriter,r.key,r,new ll(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ge(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map(h=>{const f=new S0(i._firestore,i._userDataWriter,h.doc.key,h.doc,new ll(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}})}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(h=>s||h.type!==3).map(h=>{const f=new S0(i._firestore,i._userDataWriter,h.doc.key,h.doc,new ll(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,x=-1;return h.type!==0&&(m=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),x=l.indexOf(h.doc.key)),{type:X9(h.type),doc:f,oldIndex:m,newIndex:x}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function X9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re()}}function xB(t,e){return t instanceof xu&&e instanceof xu?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof wu&&e instanceof wu&&t._firestore===e._firestore&&qb(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(t){t=at(t,kn);const e=at(t.firestore,qt);return Ub(pn(e),t._key).then(n=>Vw(e,t,n))}class Va extends iR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ll(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,n)}}function wB(t){t=at(t,kn);const e=at(t.firestore,qt),n=pn(e),r=new Va(e);return R9(n,t._key).then(i=>new xu(e,r,t._key,i,new ll(i!==null&&i.hasLocalMutations,!0),t.converter))}function _B(t){t=at(t,kn);const e=at(t.firestore,qt);return Ub(pn(e),t._key,{source:"server"}).then(n=>Vw(e,t,n))}function ju(t){t=at(t,gr);const e=at(t.firestore,qt),n=pn(e),r=new Va(e);return eR(t._query),jb(n,t._query).then(i=>new wu(e,r,t,i))}function EB(t){t=at(t,gr);const e=at(t.firestore,qt),n=pn(e),r=new Va(e);return N9(n,t._query).then(i=>new wu(e,r,t,i))}function vB(t){t=at(t,gr);const e=at(t.firestore,qt),n=pn(e),r=new Va(e);return jb(n,t._query,{source:"server"}).then(i=>new wu(e,r,t,i))}function Pm(t,e,n){t=at(t,kn);const r=at(t.firestore,qt),i=Pg(t.converter,e,n);return of(r,[Ag(Wl(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,an.none())])}function po(t,e,n,...r){t=at(t,kn);const i=at(t.firestore,qt),s=Wl(i);let l;return l=typeof(e=mt(e))=="string"||e instanceof ql?Ow(s,"updateDoc",t._key,e,n,r):kw(s,"updateDoc",t._key,e),of(i,[l.toMutation(t._key,an.exists(!0))])}function IB(t){return of(at(t.firestore,qt),[new ku(t._key,an.none())])}function sR(t,e){const n=at(t.firestore,qt),r=Lr(t),i=Pg(t.converter,e);return of(n,[Ag(Wl(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,an.exists(!1))]).then(()=>r)}function AB(t,...e){var n,r,i;t=mt(t);let s={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||py(e[l])||(s=e[l],l++);const h={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(py(e[l])){const E=e[l];e[l]=(n=E.next)===null||n===void 0?void 0:n.bind(E),e[l+1]=(r=E.error)===null||r===void 0?void 0:r.bind(E),e[l+2]=(i=E.complete)===null||i===void 0?void 0:i.bind(E)}let f,m,x;if(t instanceof kn)m=at(t.firestore,qt),x=Pu(t._key.path),f={next:E=>{e[l]&&e[l](Vw(m,t,E))},error:e[l+1],complete:e[l+2]};else{const E=at(t,gr);m=at(E.firestore,qt),x=E._query;const A=new Va(m);f={next:N=>{e[l]&&e[l](new wu(m,A,E,N))},error:e[l+1],complete:e[l+2]},eR(t._query)}return function(A,N,U,D){const G=new wg(D),M=new xw(N,G,U);return A.asyncQueue.enqueueAndForget(async()=>mw(await yu(A),M)),()=>{G.Za(),A.asyncQueue.enqueueAndForget(async()=>pw(await yu(A),M))}}(pn(m),x,h,f)}function TB(t,e){return D9(pn(t=at(t,qt)),py(e)?e:{next:e})}function of(t,e){return function(r,i){const s=new rr;return r.asyncQueue.enqueueAndForget(async()=>o9(await Cw(r),i,s)),s.promise}(pn(t),e)}function Vw(t,e,n){const r=n.docs.get(e._key),i=new Va(t);return new xu(t,i,e._key,r,new ll(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(t){return Y9(t,{count:Q9()})}function Y9(t,e){const n=at(t.firestore,qt),r=pn(n),i=oS(e,(s,l)=>new LS(l,s.aggregateType,s._internalFieldPath));return P9(r,t._query,i).then(s=>function(h,f,m){const x=new Va(h);return new z9(f,x,m)}(n,t,s))}class Z9{constructor(e){this.kind="memory",this._onlineComponentProvider=Ca.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=Ta.provider}toJSON(){return{kind:this.kind}}}class J9{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=iL(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class eL{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Ta.provider}toJSON(){return{kind:this.kind}}}class tL{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new v9(e)}}toJSON(){return{kind:this.kind}}}function SB(){return new eL}function bB(t){return new tL(t==null?void 0:t.cacheSizeBytes)}function RB(t){return new Z9(t)}function NB(t){return new J9(t)}class nL{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ca.provider,this._offlineComponentProvider={build:n=>new Aw(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class rL{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Ca.provider,this._offlineComponentProvider={build:n=>new Lb(n,e==null?void 0:e.cacheSizeBytes)}}}function iL(t){return new nL(t==null?void 0:t.forceOwnership)}function PB(){return new rL}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Wl(e)}set(e,n,r){this._verifyNotCommitted();const i=Wo(e,this._firestore),s=Pg(i.converter,n,r),l=Ag(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(l.toMutation(i._key,an.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=Wo(e,this._firestore);let l;return l=typeof(n=mt(n))=="string"||n instanceof ql?Ow(this._dataReader,"WriteBatch.update",s._key,n,r,i):kw(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(l.toMutation(s._key,an.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Wo(e,this._firestore);return this._mutations=this._mutations.concat(new ku(n._key,an.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ge(ae.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Wo(t,e){if((t=mt(t)).firestore!==e)throw new ge(ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Wl(n)}get(n){const r=Wo(n,this._firestore),i=new $9(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Re();const l=s[0];if(l.isFoundDocument())return new Cd(this._firestore,i,l.key,l,r.converter);if(l.isNoDocument())return new Cd(this._firestore,i,r._key,null,r.converter);throw Re()})}set(n,r,i){const s=Wo(n,this._firestore),l=Pg(s.converter,r,i),h=Ag(this._dataReader,"Transaction.set",s._key,l,s.converter!==null,i);return this._transaction.set(s._key,h),this}update(n,r,i,...s){const l=Wo(n,this._firestore);let h;return h=typeof(r=mt(r))=="string"||r instanceof ql?Ow(this._dataReader,"Transaction.update",l._key,r,i,s):kw(this._dataReader,"Transaction.update",l._key,r),this._transaction.update(l._key,h),this}delete(n){const r=Wo(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Wo(e,this._firestore),r=new Va(this._firestore);return super.get(e).then(i=>new xu(this._firestore,r,n._key,i._document,new ll(!1,!1),n.converter))}}function kB(t,e,n){t=at(t,qt);const r=Object.assign(Object.assign({},sL),n);return function(s){if(s.maxAttempts<1)throw new ge(ae.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,l,h){const f=new rr;return s.asyncQueue.enqueueAndForget(async()=>{const m=await Bb(s);new T9(s.asyncQueue,m,h,l,f).au()}),f.promise}(pn(t),i=>e(new aL(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OB(){return new nf("deleteField")}function Ri(){return new Rw("serverTimestamp")}function MB(...t){return new Nw("arrayUnion",t)}function LB(...t){return new Pw("arrayRemove",t)}function FB(t){return new Dw("increment",t)}function VB(t){return new vg(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BB(t){return pn(t=at(t,qt)),new oL(t,e=>of(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UB(t,e){const n=pn(t=at(t,qt));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return bi("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(s){const l=typeof s=="string"?function(m){try{return JSON.parse(m)}catch(x){throw new ge(ae.INVALID_ARGUMENT,"Failed to parse JSON: "+(x==null?void 0:x.message))}}(s):s,h=[];if(Array.isArray(l.indexes))for(const f of l.indexes){const m=hv(f,"collectionGroup"),x=[];if(Array.isArray(f.fields))for(const E of f.fields){const A=Tg("setIndexConfiguration",hv(E,"fieldPath"));E.arrayConfig==="CONTAINS"?x.push(new wl(A,2)):E.order==="ASCENDING"?x.push(new wl(A,0)):E.order==="DESCENDING"&&x.push(new wl(A,1))}h.push(new su(su.UNKNOWN_ID,m,x,ou.empty()))}return h}(e);return M9(n,r)}function hv(t,e){if(typeof t[e]!="string")throw new ge(ae.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function jB(t){var e;t=at(t,qt);const n=dv.get(t);if(n)return n;if(((e=pn(t)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new lL(t);return dv.set(t,r),r}function zB(t){oR(t,!0)}function GB(t){oR(t,!1)}function qB(t){F9(pn(t._firestore)).then(e=>fe("deleting all persistent cache indexes succeeded")).catch(e=>bi("deleting all persistent cache indexes failed",e))}function oR(t,e){L9(pn(t._firestore),e).then(n=>fe(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>bi(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const dv=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HB(t){var e;const n=(e=pn(at(t.firestore,qt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return n===void 0?null:fg(n,br(t._query))._t}function WB(t,e){var n;const r=oS(e,(s,l)=>new LS(l,s.aggregateType,s._internalFieldPath)),i=(n=pn(at(t.firestore,qt))._onlineComponents)===null||n===void 0?void 0:n.datastore.serializer;return i===void 0?null:QS(i,_S(t._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return Bw.instance.onExistenceFilterMismatch(e)}}class Bw{constructor(){this.Uu=new Map}static get instance(){return Zf||(Zf=new Bw,function(n){if(f1)throw new Error("a TestingHooksSpi instance is already set");f1=n}(Zf)),Zf}et(e){this.Uu.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Uu;return r.set(n,e),()=>r.delete(n)}}let Zf=null;(function(e,n=!0){(function(i){Nu=i})(jl),wa(new uo("firestore",(r,{instanceIdentifier:i,options:s})=>{const l=r.getProvider("app").getImmediate(),h=new qt(new kO(r.getProvider("auth-internal")),new LO(r.getProvider("app-check-internal")),function(m,x){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ge(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bl(m.options.projectId,x)}(l,i),l);return s=Object.assign({useFetchStreams:n},s),h._setSettings(s),h},"PUBLIC").setMultipleInstances(!0)),Ti(tE,"4.7.3",e),Ti(tE,"4.7.3","esm2017")})();var cL="firebase",uL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ti(cL,uL,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR="firebasestorage.googleapis.com",hL="storageBucket",dL=2*60*1e3,fL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os extends Ds{constructor(e,n,r=0){super(Dm(e),`Firebase Storage: ${n} (${Dm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Os.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ps;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ps||(Ps={}));function Dm(t){return"storage/"+t}function gL(){const t="An unknown error occurred, please check the error payload for server response.";return new Os(Ps.UNKNOWN,t)}function mL(){return new Os(Ps.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function pL(){return new Os(Ps.CANCELED,"User canceled the upload/download.")}function yL(t){return new Os(Ps.INVALID_URL,"Invalid URL '"+t+"'.")}function xL(t){return new Os(Ps.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function fv(t){return new Os(Ps.INVALID_ARGUMENT,t)}function lR(){return new Os(Ps.APP_DELETED,"The Firebase app was deleted.")}function wL(t){return new Os(Ps.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Xi.makeFromUrl(e,n)}catch{return new Xi(e,"")}if(r.path==="")return r;throw xL(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const l="(/(.*))?$",h=new RegExp("^gs://"+i+l,"i"),f={bucket:1,path:3};function m(V){V.path_=decodeURIComponent(V.path)}const x="v[A-Za-z0-9_]+",E=n.replace(/[.]/g,"\\."),A="(/([^?#]*).*)?$",N=new RegExp(`^https?://${E}/${x}/b/${i}/o${A}`,"i"),U={bucket:1,path:3},D=n===aR?"(?:storage.googleapis.com|storage.cloud.google.com)":n,G="([^?#]*)",M=new RegExp(`^https?://${D}/${i}/${G}`,"i"),P=[{regex:h,indices:f,postModify:s},{regex:N,indices:U,postModify:m},{regex:M,indices:{bucket:1,path:2},postModify:m}];for(let V=0;V<P.length;V++){const $=P[V],J=$.regex.exec(e);if(J){const k=J[$.indices.bucket];let L=J[$.indices.path];L||(L=""),r=new Xi(k,L),$.postModify(r);break}}if(r==null)throw yL(e);return r}}class _L{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EL(t,e,n){let r=1,i=null,s=null,l=!1,h=0;function f(){return h===2}let m=!1;function x(...G){m||(m=!0,e.apply(null,G))}function E(G){i=setTimeout(()=>{i=null,t(N,f())},G)}function A(){s&&clearTimeout(s)}function N(G,...M){if(m){A();return}if(G){A(),x.call(null,G,...M);return}if(f()||l){A(),x.call(null,G,...M);return}r<64&&(r*=2);let P;h===1?(h=2,P=0):P=(r+Math.random())*1e3,E(P)}let U=!1;function D(G){U||(U=!0,A(),!m&&(i!==null?(G||(h=2),clearTimeout(i),E(0)):G||(h=1)))}return E(0),s=setTimeout(()=>{l=!0,D(!0)},n),D}function vL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t){return t!==void 0}function gv(t,e,n,r){if(r<e)throw fv(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw fv(`Invalid value for '${t}'. Expected ${n} or less.`)}function AL(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var I1;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(I1||(I1={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(e,n,r,i,s,l,h,f,m,x,E,A=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=f,this.timeout_=m,this.progressCallback_=x,this.connectionFactory_=E,this.retry=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,U)=>{this.resolve_=N,this.reject_=U,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Jf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const l=h=>{const f=h.loaded,m=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,m)};this.progressCallback_!==null&&s.addUploadProgressListener(l),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(l),this.pendingConnection_=null;const h=s.getErrorCode()===I1.NO_ERROR,f=s.getStatus();if(!h||TL(f,this.additionalRetryCodes_)&&this.retry){const x=s.getErrorCode()===I1.ABORT;r(!1,new Jf(!1,null,x));return}const m=this.successCodes_.indexOf(f)!==-1;r(!0,new Jf(m,s))})},n=(r,i)=>{const s=this.resolve_,l=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());IL(f)?s(f):s()}catch(f){l(f)}else if(h!==null){const f=gL();f.serverResponse=h.getErrorText(),this.errorCallback_?l(this.errorCallback_(h,f)):l(f)}else if(i.canceled){const f=this.appDelete_?lR():pL();l(f)}else{const f=mL();l(f)}};this.canceled_?n(!1,new Jf(!1,null,!0)):this.backoffId_=EL(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Jf{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function SL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function bL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function RL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function NL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function PL(t,e,n,r,i,s,l=!0){const h=AL(t.urlParams),f=t.url+h,m=Object.assign({},t.headers);return RL(m,e),SL(m,n),bL(m,s),NL(m,r),new CL(f,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function kL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,n){this._service=e,n instanceof Xi?this._location=n:this._location=Xi.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new A1(e,n)}get root(){const e=new Xi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kL(this._location.path)}get storage(){return this._service}get parent(){const e=DL(this._location.path);if(e===null)return null;const n=new Xi(this._location.bucket,e);return new A1(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw wL(e)}}function mv(t,e){const n=e==null?void 0:e[hL];return n==null?null:Xi.makeFromBucketSpec(n,t)}function OL(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:$T(i,t.app.options.projectId))}class ML{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=aR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=dL,this._maxUploadRetryTime=fL,this._requests=new Set,i!=null?this._bucket=Xi.makeFromBucketSpec(i,this._host):this._bucket=mv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xi.makeFromBucketSpec(this._url,e):this._bucket=mv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){gv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){gv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new A1(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new _L(lR());{const l=PL(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const pv="@firebase/storage",yv="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR="storage";function LL(t=rg(),e){t=mt(t);const r=Ul(t,cR).getImmediate({identifier:e}),i=Rx("storage");return i&&FL(r,...i),r}function FL(t,e,n,r={}){OL(t,e,n,r)}function VL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new ML(n,r,i,e,jl)}function BL(){wa(new uo(cR,VL,"PUBLIC").setMultipleInstances(!0)),Ti(pv,yv,""),Ti(pv,yv,"esm2017")}BL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UL{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yy="us-central1";class jL{constructor(e,n,r,i,s=yy,l){this.app=e,this.fetchImpl=l,this.emulatorOrigin=null,this.contextProvider=new UL(n,r,i),this.cancelAllRequests=new Promise(h=>{this.deleteService=()=>Promise.resolve(h())});try{const h=new URL(s);this.customDomain=h.origin+(h.pathname==="/"?"":h.pathname),this.region=yy}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function zL(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const xv="@firebase/functions",wv="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL="auth-internal",qL="app-check-internal",HL="messaging-internal";function WL(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),l=r.getProvider(GL),h=r.getProvider(HL),f=r.getProvider(qL);return new jL(s,l,h,f,i,t)};wa(new uo(uR,n,"PUBLIC").setMultipleInstances(!0)),Ti(xv,wv,e),Ti(xv,wv,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(t=rg(),e=yy){const r=Ul(mt(t),uR).getImmediate({identifier:e}),i=Rx("functions");return i&&$L(r,...i),r}function $L(t,e,n){zL(mt(t),e,n)}WL(fetch.bind(self));const QL={apiKey:"AIzaSyBhwyN85XAMKQmZqT6NqCBKeGq7c7niou8",authDomain:"eshaan-createch.firebaseapp.com",projectId:"eshaan-createch",storageBucket:"eshaan-createch.firebasestorage.app",messagingSenderId:"770507129209",appId:"1:770507129209:web:37a251e0b652911988afa8",measurementId:"G-Q837NJ8KC2"},af=JT(QL),Gt=RO(af),dn=j9(af),XL=LL(af),YL=KL(af);console.log(" Using production Firebase services");const ZL=Object.freeze(Object.defineProperty({__proto__:null,auth:Gt,db:dn,default:af,functions:YL,storage:XL},Symbol.toStringTag,{value:"Module"}));class JL{constructor(){Gg(this,"currentUser",null);Gg(this,"authStateListeners",[]);yk(Gt,async e=>{e?(console.log(" Auth state changed. Fetching user profile for:",e.email),this.currentUser=await this.getUserProfile(e.uid),console.log(" Auth state updated. Current user role:",this.currentUser.role)):this.currentUser=null,this.authStateListeners.forEach(n=>n(this.currentUser))})}async login(e){try{const n=await hk(Gt,e.email,e.password),r=await this.getUserProfile(n.user.uid),i=await n.user.getIdToken();return{user:r,token:i,expiresIn:"3600"}}catch(n){throw this.handleAuthError(n)}}async register(e){try{const n=await uk(Gt,e.email,e.password);await SC(n.user,{displayName:e.displayName||e.username});const r={id:n.user.uid,email:e.email,username:e.username,role:e.role,displayName:e.displayName,createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString(),isActive:!0};await Pm(Lr(dn,"users",r.id),r);const i=await n.user.getIdToken();return{user:r,token:i}}catch(n){throw this.handleAuthError(n)}}async logout(){try{await RC(Gt)}catch(e){throw this.handleAuthError(e)}}async getCurrentUser(){return this.currentUser}async getUserProfile(e){var n;try{const r=await Dg(Lr(dn,"users",e));if(!r.exists()){const s=Gt.currentUser;if(s){const l={id:s.uid,email:s.email||"",username:s.displayName||((n=s.email)==null?void 0:n.split("@")[0])||"user",role:"researcher",displayName:s.displayName||void 0,createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString(),isActive:!0};return console.log(" Creating new user profile for:",s.email,"with role:",l.role),await Pm(Lr(dn,"users",e),l),l}throw new Error("User profile not found and could not create one")}const i=r.data();return console.log(" Loaded user profile:",i.email,"with role:",i.role),i}catch(r){throw console.error(" Error in getUserProfile:",r),this.handleAuthError(r)}}async updateUserProfile(e,n){try{const r=Lr(dn,"users",e);await Pm(r,n,{merge:!0});const i=await this.getUserProfile(e);return this.currentUser=i,i}catch(r){throw this.handleAuthError(r)}}async refreshToken(){try{const e=Gt.currentUser;if(!e)throw new Error("No authenticated user");return await e.getIdToken(!0)}catch(e){throw this.handleAuthError(e)}}onAuthStateChange(e){return this.authStateListeners.push(e),()=>{const n=this.authStateListeners.indexOf(e);n>-1&&this.authStateListeners.splice(n,1)}}isAuthenticated(){return this.currentUser!==null}hasRole(e){var n;return((n=this.currentUser)==null?void 0:n.role)===e}hasAnyRole(e){return this.currentUser?e.includes(this.currentUser.role):!1}handleAuthError(e){let n="AUTHENTICATION_ERROR",r="An authentication error occurred";switch(e.code){case"auth/user-not-found":n="USER_NOT_FOUND",r="No user found with this email address";break;case"auth/wrong-password":n="INVALID_CREDENTIALS",r="Invalid email or password";break;case"auth/email-already-in-use":n="EMAIL_ALREADY_EXISTS",r="An account with this email already exists";break;case"auth/weak-password":n="WEAK_PASSWORD",r="Password should be at least 6 characters";break;case"auth/invalid-email":n="INVALID_EMAIL",r="Invalid email address";break;case"auth/too-many-requests":n="TOO_MANY_REQUESTS",r="Too many failed attempts. Please try again later";break;case"auth/network-request-failed":n="NETWORK_ERROR",r="Network error. Please check your connection";break;default:r=e.message||r}return{code:n,message:r,details:{originalError:e.code,timestamp:new Date().toISOString()}}}}const Oo=new JL,e7=t=>{switch(t){case"admin":return{canCreateArtifacts:!0,canEditArtifacts:!0,canDeleteArtifacts:!0,canUploadPhotos:!0,canDeletePhotos:!0,canManageUsers:!0};case"archaeologist":return{canCreateArtifacts:!0,canEditArtifacts:!0,canDeleteArtifacts:!1,canUploadPhotos:!0,canDeletePhotos:!1,canManageUsers:!1};case"researcher":return{canCreateArtifacts:!1,canEditArtifacts:!1,canDeleteArtifacts:!1,canUploadPhotos:!1,canDeletePhotos:!1,canManageUsers:!1};default:return{canCreateArtifacts:!1,canEditArtifacts:!1,canDeleteArtifacts:!1,canUploadPhotos:!1,canDeletePhotos:!1,canManageUsers:!1}}},ni=()=>{const[t,e]=ne.useState(null),[n,r]=ne.useState(!0),[i,s]=ne.useState(null),l=ne.useCallback(()=>{s(null)},[]),h=ne.useCallback(async U=>{try{r(!0),s(null);const D=await Oo.login(U);e(D.user)}catch(D){throw s(D),D}finally{r(!1)}},[]),f=ne.useCallback(async U=>{try{r(!0),s(null);const D=await Oo.register(U);e(D.user)}catch(D){throw s(D),D}finally{r(!1)}},[]),m=ne.useCallback(async()=>{try{r(!0),s(null),await Oo.logout(),e(null)}catch(U){throw s(U),U}finally{r(!1)}},[]),x=ne.useCallback(async U=>{if(!t)throw new Error("No authenticated user");try{r(!0),s(null);const D=await Oo.updateUserProfile(t.id,U);e(D)}catch(D){throw s(D),D}finally{r(!1)}},[t]),E=ne.useCallback(async()=>{try{return s(null),await Oo.refreshToken()}catch(U){throw s(U),U}},[]),A=t!==null,N=t?e7(t.role):null;return ne.useEffect(()=>{const U=Oo.onAuthStateChange(G=>{e(G),r(!1)});return(async()=>{try{const G=await Oo.getCurrentUser();e(G)}catch{e(null)}finally{r(!1)}})(),U},[]),{user:t,loading:n,error:i,login:h,register:f,logout:m,updateProfile:x,refreshToken:E,isAuthenticated:A,permissions:N,clearError:l}};var lf=t=>t.type==="checkbox",cl=t=>t instanceof Date,Or=t=>t==null;const hR=t=>typeof t=="object";var Bn=t=>!Or(t)&&!Array.isArray(t)&&hR(t)&&!cl(t),t7=t=>Bn(t)&&t.target?lf(t.target)?t.target.checked:t.target.value:t,n7=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,r7=(t,e)=>t.has(n7(e)),i7=t=>{const e=t.constructor&&t.constructor.prototype;return Bn(e)&&e.hasOwnProperty("isPrototypeOf")},Uw=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Yn(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(Uw&&(t instanceof Blob||r))&&(n||Bn(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!i7(t))e=t;else for(const i in t)t.hasOwnProperty(i)&&(e[i]=Yn(t[i]));else return t;return e}var kg=t=>/^\w*$/.test(t),Fn=t=>t===void 0,jw=t=>Array.isArray(t)?t.filter(Boolean):[],zw=t=>jw(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Le=(t,e,n)=>{if(!e||!Bn(t))return n;const r=(kg(e)?[e]:zw(e)).reduce((i,s)=>Or(i)?i:i[s],t);return Fn(r)||r===t?Fn(t[e])?n:t[e]:r},gs=t=>typeof t=="boolean",nn=(t,e,n)=>{let r=-1;const i=kg(e)?[e]:zw(e),s=i.length,l=s-1;for(;++r<s;){const h=i[r];let f=n;if(r!==l){const m=t[h];f=Bn(m)||Array.isArray(m)?m:isNaN(+i[r+1])?{}:[]}if(h==="__proto__"||h==="constructor"||h==="prototype")return;t[h]=f,t=t[h]}};const _v={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ki={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ws={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},s7=Ar.createContext(null);s7.displayName="HookFormContext";var o7=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const l=s;return e._proxyFormState[l]!==Ki.all&&(e._proxyFormState[l]=!r||Ki.all),n&&(n[l]=!0),t[l]}});return i};const a7=typeof window<"u"?Ar.useLayoutEffect:Ar.useEffect;var ui=t=>typeof t=="string",l7=(t,e,n,r,i)=>ui(t)?(r&&e.watch.add(t),Le(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),Le(n,s))):(r&&(e.watchAll=!0),n),xy=t=>Or(t)||!hR(t);function Ko(t,e,n=new WeakSet){if(xy(t)||xy(e))return t===e;if(cl(t)&&cl(e))return t.getTime()===e.getTime();const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const s of r){const l=t[s];if(!i.includes(s))return!1;if(s!=="ref"){const h=e[s];if(cl(l)&&cl(h)||Bn(l)&&Bn(h)||Array.isArray(l)&&Array.isArray(h)?!Ko(l,h,n):l!==h)return!1}}return!0}var c7=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},Gh=t=>Array.isArray(t)?t:[t],Ev=()=>{let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}};function dR(t,e){const n={};for(const r in t)if(t.hasOwnProperty(r)){const i=t[r],s=e[r];if(i&&Bn(i)&&s){const l=dR(i,s);Bn(l)&&(n[r]=l)}else t[r]&&(n[r]=s)}return n}var Kr=t=>Bn(t)&&!Object.keys(t).length,Gw=t=>t.type==="file",$i=t=>typeof t=="function",T1=t=>{if(!Uw)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},fR=t=>t.type==="select-multiple",qw=t=>t.type==="radio",u7=t=>qw(t)||lf(t),km=t=>T1(t)&&t.isConnected;function h7(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=Fn(t)?r++:t[e[r++]];return t}function d7(t){for(const e in t)if(t.hasOwnProperty(e)&&!Fn(t[e]))return!1;return!0}function Mn(t,e){const n=Array.isArray(e)?e:kg(e)?[e]:zw(e),r=n.length===1?t:h7(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(Bn(r)&&Kr(r)||Array.isArray(r)&&d7(r))&&Mn(t,n.slice(0,-1)),t}var f7=t=>{for(const e in t)if($i(t[e]))return!0;return!1};function gR(t){return Array.isArray(t)||Bn(t)&&!f7(t)}function wy(t,e={}){for(const n in t)gR(t[n])?(e[n]=Array.isArray(t[n])?[]:{},wy(t[n],e[n])):Or(t[n])||(e[n]=!0);return e}function pc(t,e,n){n||(n=wy(e));for(const r in t)gR(t[r])?Fn(e)||xy(n[r])?n[r]=wy(t[r],Array.isArray(t[r])?[]:{}):pc(t[r],Or(e)?{}:e[r],n[r]):n[r]=!Ko(t[r],e[r]);return n}const vv={value:!1,isValid:!1},Iv={value:!0,isValid:!0};var mR=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Fn(t[0].attributes.value)?Fn(t[0].value)||t[0].value===""?Iv:{value:t[0].value,isValid:!0}:Iv:vv}return vv},pR=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>Fn(t)?t:e?t===""?NaN:t&&+t:n&&ui(t)?new Date(t):r?r(t):t;const Av={isValid:!1,value:null};var yR=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,Av):Av;function Tv(t){const e=t.ref;return Gw(e)?e.files:qw(e)?yR(t.refs).value:fR(e)?[...e.selectedOptions].map(({value:n})=>n):lf(e)?mR(t.refs).value:pR(Fn(e.value)?t.ref.value:e.value,t)}var g7=(t,e,n,r)=>{const i={};for(const s of t){const l=Le(e,s);l&&nn(i,s,l._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},C1=t=>t instanceof RegExp,yh=t=>Fn(t)?t:C1(t)?t.source:Bn(t)?C1(t.value)?t.value.source:t.value:t,Cv=t=>({isOnSubmit:!t||t===Ki.onSubmit,isOnBlur:t===Ki.onBlur,isOnChange:t===Ki.onChange,isOnAll:t===Ki.all,isOnTouch:t===Ki.onTouched});const Sv="AsyncFunction";var m7=t=>!!t&&!!t.validate&&!!($i(t.validate)&&t.validate.constructor.name===Sv||Bn(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===Sv)),p7=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),bv=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const qh=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=Le(t,i);if(s){const{_f:l,...h}=s;if(l){if(l.refs&&l.refs[0]&&e(l.refs[0],i)&&!r)return!0;if(l.ref&&e(l.ref,l.name)&&!r)return!0;if(qh(h,e))break}else if(Bn(h)&&qh(h,e))break}}};function Rv(t,e,n){const r=Le(t,n);if(r||kg(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),l=Le(e,s),h=Le(t,s);if(l&&!Array.isArray(l)&&n!==s)return{name:n};if(h&&h.type)return{name:s,error:h};if(h&&h.root&&h.root.type)return{name:`${s}.root`,error:h.root};i.pop()}return{name:n}}var y7=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return Kr(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(l=>e[l]===(!r||Ki.all))},x7=(t,e,n)=>!t||!e||t===e||Gh(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),w7=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,_7=(t,e)=>!jw(Le(t,e)).length&&Mn(t,e),E7=(t,e,n)=>{const r=Gh(Le(t,n));return nn(r,"root",e[n]),nn(t,n,r),t};function Nv(t,e,n="validate"){if(ui(t)||Array.isArray(t)&&t.every(ui)||gs(t)&&!t)return{type:n,message:ui(t)?t:"",ref:e}}var hc=t=>Bn(t)&&!C1(t)?t:{value:t,message:""},Pv=async(t,e,n,r,i,s)=>{const{ref:l,refs:h,required:f,maxLength:m,minLength:x,min:E,max:A,pattern:N,validate:U,name:D,valueAsNumber:G,mount:M}=t._f,b=Le(n,D);if(!M||e.has(D))return{};const P=h?h[0]:l,V=W=>{i&&P.reportValidity&&(P.setCustomValidity(gs(W)?"":W||""),P.reportValidity())},$={},J=qw(l),k=lf(l),L=J||k,F=(G||Gw(l))&&Fn(l.value)&&Fn(b)||T1(l)&&l.value===""||b===""||Array.isArray(b)&&!b.length,H=c7.bind(null,D,r,$),K=(W,z,Ge,se=Ws.maxLength,rt=Ws.minLength)=>{const Oe=W?z:Ge;$[D]={type:W?se:rt,message:Oe,ref:l,...H(W?se:rt,Oe)}};if(s?!Array.isArray(b)||!b.length:f&&(!L&&(F||Or(b))||gs(b)&&!b||k&&!mR(h).isValid||J&&!yR(h).isValid)){const{value:W,message:z}=ui(f)?{value:!!f,message:f}:hc(f);if(W&&($[D]={type:Ws.required,message:z,ref:P,...H(Ws.required,z)},!r))return V(z),$}if(!F&&(!Or(E)||!Or(A))){let W,z;const Ge=hc(A),se=hc(E);if(!Or(b)&&!isNaN(b)){const rt=l.valueAsNumber||b&&+b;Or(Ge.value)||(W=rt>Ge.value),Or(se.value)||(z=rt<se.value)}else{const rt=l.valueAsDate||new Date(b),Oe=je=>new Date(new Date().toDateString()+" "+je),Ie=l.type=="time",Me=l.type=="week";ui(Ge.value)&&b&&(W=Ie?Oe(b)>Oe(Ge.value):Me?b>Ge.value:rt>new Date(Ge.value)),ui(se.value)&&b&&(z=Ie?Oe(b)<Oe(se.value):Me?b<se.value:rt<new Date(se.value))}if((W||z)&&(K(!!W,Ge.message,se.message,Ws.max,Ws.min),!r))return V($[D].message),$}if((m||x)&&!F&&(ui(b)||s&&Array.isArray(b))){const W=hc(m),z=hc(x),Ge=!Or(W.value)&&b.length>+W.value,se=!Or(z.value)&&b.length<+z.value;if((Ge||se)&&(K(Ge,W.message,z.message),!r))return V($[D].message),$}if(N&&!F&&ui(b)){const{value:W,message:z}=hc(N);if(C1(W)&&!b.match(W)&&($[D]={type:Ws.pattern,message:z,ref:l,...H(Ws.pattern,z)},!r))return V(z),$}if(U){if($i(U)){const W=await U(b,n),z=Nv(W,P);if(z&&($[D]={...z,...H(Ws.validate,z.message)},!r))return V(z.message),$}else if(Bn(U)){let W={};for(const z in U){if(!Kr(W)&&!r)break;const Ge=Nv(await U[z](b,n),P,z);Ge&&(W={...Ge,...H(z,Ge.message)},V(Ge.message),r&&($[D]=W))}if(!Kr(W)&&($[D]={ref:P,...W},!r))return $}}return V(!0),$};const v7={mode:Ki.onSubmit,reValidateMode:Ki.onChange,shouldFocusError:!0};function I7(t={}){let e={...v7,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:$i(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},i=Bn(e.defaultValues)||Bn(e.values)?Yn(e.defaultValues||e.values)||{}:{},s=e.shouldUnregister?{}:Yn(i),l={action:!1,mount:!1,watch:!1},h={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},f,m=0;const x={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let E={...x};const A={array:Ev(),state:Ev()},N=e.criteriaMode===Ki.all,U=Q=>X=>{clearTimeout(m),m=setTimeout(Q,X)},D=async Q=>{if(!e.disabled&&(x.isValid||E.isValid||Q)){const X=e.resolver?Kr((await k()).errors):await F(r,!0);X!==n.isValid&&A.state.next({isValid:X})}},G=(Q,X)=>{!e.disabled&&(x.isValidating||x.validatingFields||E.isValidating||E.validatingFields)&&((Q||Array.from(h.mount)).forEach(ue=>{ue&&(X?nn(n.validatingFields,ue,X):Mn(n.validatingFields,ue))}),A.state.next({validatingFields:n.validatingFields,isValidating:!Kr(n.validatingFields)}))},M=(Q,X=[],ue,Ce,xe=!0,pe=!0)=>{if(Ce&&ue&&!e.disabled){if(l.action=!0,pe&&Array.isArray(Le(r,Q))){const be=ue(Le(r,Q),Ce.argA,Ce.argB);xe&&nn(r,Q,be)}if(pe&&Array.isArray(Le(n.errors,Q))){const be=ue(Le(n.errors,Q),Ce.argA,Ce.argB);xe&&nn(n.errors,Q,be),_7(n.errors,Q)}if((x.touchedFields||E.touchedFields)&&pe&&Array.isArray(Le(n.touchedFields,Q))){const be=ue(Le(n.touchedFields,Q),Ce.argA,Ce.argB);xe&&nn(n.touchedFields,Q,be)}(x.dirtyFields||E.dirtyFields)&&(n.dirtyFields=pc(i,s)),A.state.next({name:Q,isDirty:K(Q,X),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else nn(s,Q,X)},b=(Q,X)=>{nn(n.errors,Q,X),A.state.next({errors:n.errors})},P=Q=>{n.errors=Q,A.state.next({errors:n.errors,isValid:!1})},V=(Q,X,ue,Ce)=>{const xe=Le(r,Q);if(xe){const pe=Le(s,Q,Fn(ue)?Le(i,Q):ue);Fn(pe)||Ce&&Ce.defaultChecked||X?nn(s,Q,X?pe:Tv(xe._f)):Ge(Q,pe),l.mount&&D()}},$=(Q,X,ue,Ce,xe)=>{let pe=!1,be=!1;const We={name:Q};if(!e.disabled){if(!ue||Ce){(x.isDirty||E.isDirty)&&(be=n.isDirty,n.isDirty=We.isDirty=K(),pe=be!==We.isDirty);const qe=Ko(Le(i,Q),X);be=!!Le(n.dirtyFields,Q),qe?Mn(n.dirtyFields,Q):nn(n.dirtyFields,Q,!0),We.dirtyFields=n.dirtyFields,pe=pe||(x.dirtyFields||E.dirtyFields)&&be!==!qe}if(ue){const qe=Le(n.touchedFields,Q);qe||(nn(n.touchedFields,Q,ue),We.touchedFields=n.touchedFields,pe=pe||(x.touchedFields||E.touchedFields)&&qe!==ue)}pe&&xe&&A.state.next(We)}return pe?We:{}},J=(Q,X,ue,Ce)=>{const xe=Le(n.errors,Q),pe=(x.isValid||E.isValid)&&gs(X)&&n.isValid!==X;if(e.delayError&&ue?(f=U(()=>b(Q,ue)),f(e.delayError)):(clearTimeout(m),f=null,ue?nn(n.errors,Q,ue):Mn(n.errors,Q)),(ue?!Ko(xe,ue):xe)||!Kr(Ce)||pe){const be={...Ce,...pe&&gs(X)?{isValid:X}:{},errors:n.errors,name:Q};n={...n,...be},A.state.next(be)}},k=async Q=>{G(Q,!0);const X=await e.resolver(s,e.context,g7(Q||h.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return G(Q),X},L=async Q=>{const{errors:X}=await k(Q);if(Q)for(const ue of Q){const Ce=Le(X,ue);Ce?nn(n.errors,ue,Ce):Mn(n.errors,ue)}else n.errors=X;return X},F=async(Q,X,ue={valid:!0})=>{for(const Ce in Q){const xe=Q[Ce];if(xe){const{_f:pe,...be}=xe;if(pe){const We=h.array.has(pe.name),qe=xe._f&&m7(xe._f);qe&&x.validatingFields&&G([pe.name],!0);const Et=await Pv(xe,h.disabled,s,N,e.shouldUseNativeValidation&&!X,We);if(qe&&x.validatingFields&&G([pe.name]),Et[pe.name]&&(ue.valid=!1,X))break;!X&&(Le(Et,pe.name)?We?E7(n.errors,Et,pe.name):nn(n.errors,pe.name,Et[pe.name]):Mn(n.errors,pe.name))}!Kr(be)&&await F(be,X,ue)}}return ue.valid},H=()=>{for(const Q of h.unMount){const X=Le(r,Q);X&&(X._f.refs?X._f.refs.every(ue=>!km(ue)):!km(X._f.ref))&&Xn(Q)}h.unMount=new Set},K=(Q,X)=>!e.disabled&&(Q&&X&&nn(s,Q,X),!Ko(je(),i)),W=(Q,X,ue)=>l7(Q,h,{...l.mount?s:Fn(X)?i:ui(Q)?{[Q]:X}:X},ue,X),z=Q=>jw(Le(l.mount?s:i,Q,e.shouldUnregister?Le(i,Q,[]):[])),Ge=(Q,X,ue={})=>{const Ce=Le(r,Q);let xe=X;if(Ce){const pe=Ce._f;pe&&(!pe.disabled&&nn(s,Q,pR(X,pe)),xe=T1(pe.ref)&&Or(X)?"":X,fR(pe.ref)?[...pe.ref.options].forEach(be=>be.selected=xe.includes(be.value)):pe.refs?lf(pe.ref)?pe.refs.forEach(be=>{(!be.defaultChecked||!be.disabled)&&(Array.isArray(xe)?be.checked=!!xe.find(We=>We===be.value):be.checked=xe===be.value||!!xe)}):pe.refs.forEach(be=>be.checked=be.value===xe):Gw(pe.ref)?pe.ref.value="":(pe.ref.value=xe,pe.ref.type||A.state.next({name:Q,values:Yn(s)})))}(ue.shouldDirty||ue.shouldTouch)&&$(Q,xe,ue.shouldTouch,ue.shouldDirty,!0),ue.shouldValidate&&Me(Q)},se=(Q,X,ue)=>{for(const Ce in X){if(!X.hasOwnProperty(Ce))return;const xe=X[Ce],pe=Q+"."+Ce,be=Le(r,pe);(h.array.has(Q)||Bn(xe)||be&&!be._f)&&!cl(xe)?se(pe,xe,ue):Ge(pe,xe,ue)}},rt=(Q,X,ue={})=>{const Ce=Le(r,Q),xe=h.array.has(Q),pe=Yn(X);nn(s,Q,pe),xe?(A.array.next({name:Q,values:Yn(s)}),(x.isDirty||x.dirtyFields||E.isDirty||E.dirtyFields)&&ue.shouldDirty&&A.state.next({name:Q,dirtyFields:pc(i,s),isDirty:K(Q,pe)})):Ce&&!Ce._f&&!Or(pe)?se(Q,pe,ue):Ge(Q,pe,ue),bv(Q,h)&&A.state.next({...n,name:Q}),A.state.next({name:l.mount?Q:void 0,values:Yn(s)})},Oe=async Q=>{l.mount=!0;const X=Q.target;let ue=X.name,Ce=!0;const xe=Le(r,ue),pe=qe=>{Ce=Number.isNaN(qe)||cl(qe)&&isNaN(qe.getTime())||Ko(qe,Le(s,ue,qe))},be=Cv(e.mode),We=Cv(e.reValidateMode);if(xe){let qe,Et;const ns=X.type?Tv(xe._f):t7(Q),pr=Q.type===_v.BLUR||Q.type===_v.FOCUS_OUT,Gu=!p7(xe._f)&&!e.resolver&&!Le(n.errors,ue)&&!xe._f.deps||w7(pr,Le(n.touchedFields,ue),n.isSubmitted,We,be),bt=bv(ue,h,pr);nn(s,ue,ns),pr?(!X||!X.readOnly)&&(xe._f.onBlur&&xe._f.onBlur(Q),f&&f(0)):xe._f.onChange&&xe._f.onChange(Q);const Ee=$(ue,ns,pr),tn=!Kr(Ee)||bt;if(!pr&&A.state.next({name:ue,type:Q.type,values:Yn(s)}),Gu)return(x.isValid||E.isValid)&&(e.mode==="onBlur"?pr&&D():pr||D()),tn&&A.state.next({name:ue,...bt?{}:Ee});if(!pr&&bt&&A.state.next({...n}),e.resolver){const{errors:pt}=await k([ue]);if(pe(ns),Ce){const Ht=Rv(n.errors,r,ue),rs=Rv(pt,r,Ht.name||ue);qe=rs.error,ue=rs.name,Et=Kr(pt)}}else G([ue],!0),qe=(await Pv(xe,h.disabled,s,N,e.shouldUseNativeValidation))[ue],G([ue]),pe(ns),Ce&&(qe?Et=!1:(x.isValid||E.isValid)&&(Et=await F(r,!0)));Ce&&(xe._f.deps&&(!Array.isArray(xe._f.deps)||xe._f.deps.length>0)&&Me(xe._f.deps),J(ue,Et,qe,Ee))}},Ie=(Q,X)=>{if(Le(n.errors,X)&&Q.focus)return Q.focus(),1},Me=async(Q,X={})=>{let ue,Ce;const xe=Gh(Q);if(e.resolver){const pe=await L(Fn(Q)?Q:xe);ue=Kr(pe),Ce=Q?!xe.some(be=>Le(pe,be)):ue}else Q?(Ce=(await Promise.all(xe.map(async pe=>{const be=Le(r,pe);return await F(be&&be._f?{[pe]:be}:be)}))).every(Boolean),!(!Ce&&!n.isValid)&&D()):Ce=ue=await F(r);return A.state.next({...!ui(Q)||(x.isValid||E.isValid)&&ue!==n.isValid?{}:{name:Q},...e.resolver||!Q?{isValid:ue}:{},errors:n.errors}),X.shouldFocus&&!Ce&&qh(r,Ie,Q?xe:h.mount),Ce},je=(Q,X)=>{let ue={...l.mount?s:i};return X&&(ue=dR(X.dirtyFields?n.dirtyFields:n.touchedFields,ue)),Fn(Q)?ue:ui(Q)?Le(ue,Q):Q.map(Ce=>Le(ue,Ce))},Rt=(Q,X)=>({invalid:!!Le((X||n).errors,Q),isDirty:!!Le((X||n).dirtyFields,Q),error:Le((X||n).errors,Q),isValidating:!!Le(n.validatingFields,Q),isTouched:!!Le((X||n).touchedFields,Q)}),Xe=Q=>{Q&&Gh(Q).forEach(X=>Mn(n.errors,X)),A.state.next({errors:Q?n.errors:{}})},Tt=(Q,X,ue)=>{const Ce=(Le(r,Q,{_f:{}})._f||{}).ref,xe=Le(n.errors,Q)||{},{ref:pe,message:be,type:We,...qe}=xe;nn(n.errors,Q,{...qe,...X,ref:Ce}),A.state.next({name:Q,errors:n.errors,isValid:!1}),ue&&ue.shouldFocus&&Ce&&Ce.focus&&Ce.focus()},Bt=(Q,X)=>$i(Q)?A.state.subscribe({next:ue=>"values"in ue&&Q(W(void 0,X),ue)}):W(Q,X,!0),mr=Q=>A.state.subscribe({next:X=>{x7(Q.name,X.name,Q.exact)&&y7(X,Q.formState||x,yn,Q.reRenderRoot)&&Q.callback({values:{...s},...n,...X,defaultValues:i})}}).unsubscribe,ke=Q=>(l.mount=!0,E={...E,...Q.formState},mr({...Q,formState:E})),Xn=(Q,X={})=>{for(const ue of Q?Gh(Q):h.mount)h.mount.delete(ue),h.array.delete(ue),X.keepValue||(Mn(r,ue),Mn(s,ue)),!X.keepError&&Mn(n.errors,ue),!X.keepDirty&&Mn(n.dirtyFields,ue),!X.keepTouched&&Mn(n.touchedFields,ue),!X.keepIsValidating&&Mn(n.validatingFields,ue),!e.shouldUnregister&&!X.keepDefaultValue&&Mn(i,ue);A.state.next({values:Yn(s)}),A.state.next({...n,...X.keepDirty?{isDirty:K()}:{}}),!X.keepIsValid&&D()},ln=({disabled:Q,name:X})=>{(gs(Q)&&l.mount||Q||h.disabled.has(X))&&(Q?h.disabled.add(X):h.disabled.delete(X))},Ni=(Q,X={})=>{let ue=Le(r,Q);const Ce=gs(X.disabled)||gs(e.disabled);return nn(r,Q,{...ue||{},_f:{...ue&&ue._f?ue._f:{ref:{name:Q}},name:Q,mount:!0,...X}}),h.mount.add(Q),ue?ln({disabled:gs(X.disabled)?X.disabled:e.disabled,name:Q}):V(Q,!0,X.value),{...Ce?{disabled:X.disabled||e.disabled}:{},...e.progressive?{required:!!X.required,min:yh(X.min),max:yh(X.max),minLength:yh(X.minLength),maxLength:yh(X.maxLength),pattern:yh(X.pattern)}:{},name:Q,onChange:Oe,onBlur:Oe,ref:xe=>{if(xe){Ni(Q,X),ue=Le(r,Q);const pe=Fn(xe.value)&&xe.querySelectorAll&&xe.querySelectorAll("input,select,textarea")[0]||xe,be=u7(pe),We=ue._f.refs||[];if(be?We.find(qe=>qe===pe):pe===ue._f.ref)return;nn(r,Q,{_f:{...ue._f,...be?{refs:[...We.filter(km),pe,...Array.isArray(Le(i,Q))?[{}]:[]],ref:{type:pe.type,name:Q}}:{ref:pe}}}),V(Q,!1,void 0,pe)}else ue=Le(r,Q,{}),ue._f&&(ue._f.mount=!1),(e.shouldUnregister||X.shouldUnregister)&&!(r7(h.array,Q)&&l.action)&&h.unMount.add(Q)}}},Ur=()=>e.shouldFocusError&&qh(r,Ie,h.mount),Tn=Q=>{gs(Q)&&(A.state.next({disabled:Q}),qh(r,(X,ue)=>{const Ce=Le(r,ue);Ce&&(X.disabled=Ce._f.disabled||Q,Array.isArray(Ce._f.refs)&&Ce._f.refs.forEach(xe=>{xe.disabled=Ce._f.disabled||Q}))},0,!1))},Pi=(Q,X)=>async ue=>{let Ce;ue&&(ue.preventDefault&&ue.preventDefault(),ue.persist&&ue.persist());let xe=Yn(s);if(A.state.next({isSubmitting:!0}),e.resolver){const{errors:pe,values:be}=await k();n.errors=pe,xe=Yn(be)}else await F(r);if(h.disabled.size)for(const pe of h.disabled)Mn(xe,pe);if(Mn(n.errors,"root"),Kr(n.errors)){A.state.next({errors:{}});try{await Q(xe,ue)}catch(pe){Ce=pe}}else X&&await X({...n.errors},ue),Ur(),setTimeout(Ur);if(A.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Kr(n.errors)&&!Ce,submitCount:n.submitCount+1,errors:n.errors}),Ce)throw Ce},ot=(Q,X={})=>{Le(r,Q)&&(Fn(X.defaultValue)?rt(Q,Yn(Le(i,Q))):(rt(Q,X.defaultValue),nn(i,Q,Yn(X.defaultValue))),X.keepTouched||Mn(n.touchedFields,Q),X.keepDirty||(Mn(n.dirtyFields,Q),n.isDirty=X.defaultValue?K(Q,Yn(Le(i,Q))):K()),X.keepError||(Mn(n.errors,Q),x.isValid&&D()),A.state.next({...n}))},ri=(Q,X={})=>{const ue=Q?Yn(Q):i,Ce=Yn(ue),xe=Kr(Q),pe=xe?i:Ce;if(X.keepDefaultValues||(i=ue),!X.keepValues){if(X.keepDirtyValues){const be=new Set([...h.mount,...Object.keys(pc(i,s))]);for(const We of Array.from(be))Le(n.dirtyFields,We)?nn(pe,We,Le(s,We)):rt(We,Le(pe,We))}else{if(Uw&&Fn(Q))for(const be of h.mount){const We=Le(r,be);if(We&&We._f){const qe=Array.isArray(We._f.refs)?We._f.refs[0]:We._f.ref;if(T1(qe)){const Et=qe.closest("form");if(Et){Et.reset();break}}}}if(X.keepFieldsRef)for(const be of h.mount)rt(be,Le(pe,be));else r={}}s=e.shouldUnregister?X.keepDefaultValues?Yn(i):{}:Yn(pe),A.array.next({values:{...pe}}),A.state.next({values:{...pe}})}h={mount:X.keepDirtyValues?h.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!x.isValid||!!X.keepIsValid||!!X.keepDirtyValues,l.watch=!!e.shouldUnregister,A.state.next({submitCount:X.keepSubmitCount?n.submitCount:0,isDirty:xe?!1:X.keepDirty?n.isDirty:!!(X.keepDefaultValues&&!Ko(Q,i)),isSubmitted:X.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:xe?{}:X.keepDirtyValues?X.keepDefaultValues&&s?pc(i,s):n.dirtyFields:X.keepDefaultValues&&Q?pc(i,Q):X.keepDirty?n.dirtyFields:{},touchedFields:X.keepTouched?n.touchedFields:{},errors:X.keepErrors?n.errors:{},isSubmitSuccessful:X.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},sr=(Q,X)=>ri($i(Q)?Q(s):Q,X),ts=(Q,X={})=>{const ue=Le(r,Q),Ce=ue&&ue._f;if(Ce){const xe=Ce.refs?Ce.refs[0]:Ce.ref;xe.focus&&(xe.focus(),X.shouldSelect&&$i(xe.select)&&xe.select())}},yn=Q=>{n={...n,...Q}},it={control:{register:Ni,unregister:Xn,getFieldState:Rt,handleSubmit:Pi,setError:Tt,_subscribe:mr,_runSchema:k,_focusError:Ur,_getWatch:W,_getDirty:K,_setValid:D,_setFieldArray:M,_setDisabledField:ln,_setErrors:P,_getFieldArray:z,_reset:ri,_resetDefaultValues:()=>$i(e.defaultValues)&&e.defaultValues().then(Q=>{sr(Q,e.resetOptions),A.state.next({isLoading:!1})}),_removeUnmounted:H,_disableForm:Tn,_subjects:A,_proxyFormState:x,get _fields(){return r},get _formValues(){return s},get _state(){return l},set _state(Q){l=Q},get _defaultValues(){return i},get _names(){return h},set _names(Q){h=Q},get _formState(){return n},get _options(){return e},set _options(Q){e={...e,...Q}}},subscribe:ke,trigger:Me,register:Ni,handleSubmit:Pi,watch:Bt,setValue:rt,getValues:je,reset:sr,resetField:ot,clearErrors:Xe,unregister:Xn,setError:Tt,setFocus:ts,getFieldState:Rt};return{...it,formControl:it}}function cf(t={}){const e=Ar.useRef(void 0),n=Ar.useRef(void 0),[r,i]=Ar.useState({isDirty:!1,isValidating:!1,isLoading:$i(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:$i(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!$i(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:l,...h}=I7(t);e.current={...h,formState:r}}const s=e.current.control;return s._options=t,a7(()=>{const l=s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0});return i(h=>({...h,isReady:!0})),s._formState.isReady=!0,l},[s]),Ar.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),Ar.useEffect(()=>{t.mode&&(s._options.mode=t.mode),t.reValidateMode&&(s._options.reValidateMode=t.reValidateMode)},[s,t.mode,t.reValidateMode]),Ar.useEffect(()=>{t.errors&&(s._setErrors(t.errors),s._focusError())},[s,t.errors]),Ar.useEffect(()=>{t.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,t.shouldUnregister]),Ar.useEffect(()=>{if(s._proxyFormState.isDirty){const l=s._getDirty();l!==r.isDirty&&s._subjects.state.next({isDirty:l})}},[s,r.isDirty]),Ar.useEffect(()=>{t.values&&!Ko(t.values,n.current)?(s._reset(t.values,{keepFieldsRef:!0,...s._options.resetOptions}),n.current=t.values,i(l=>({...l}))):s._resetDefaultValues()},[s,t.values]),Ar.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=o7(r,s),e.current}const A7=({onSuccess:t,onSwitchToRegister:e})=>{const{login:n,loading:r,error:i,clearError:s}=ni(),l=ir(),[h,f]=ne.useState(!1),{register:m,handleSubmit:x,formState:{errors:E},watch:A}=cf(),N=async U=>{try{f(!0),s(),await n(U),Fe.success("Login successful!"),setTimeout(()=>{l("/dashboard",{replace:!0})},100),t==null||t()}catch(D){Fe.error(D.message||"Login failed")}finally{f(!1)}};return _.jsx("div",{className:"w-full max-w-md mx-auto",children:_.jsxs("div",{className:"card",children:[_.jsxs("div",{className:"card-header",children:[_.jsx("h2",{className:"text-2xl font-bold text-center",children:"Sign In"}),_.jsx("p",{className:"text-center text-secondary-600 mt-2",children:"Sign in to your archaeological artifacts account"})]}),_.jsxs("form",{onSubmit:x(N),className:"card-content space-y-4",children:[i&&_.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:_.jsx("p",{className:"text-red-800 text-sm",children:i.message})}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Email Address"}),_.jsx("input",{...m("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),type:"email",id:"email",className:"input",placeholder:"archaeologist@university.edu"}),E.email&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E.email.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Password"}),_.jsx("input",{...m("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",id:"password",className:"input",placeholder:"Enter your password"}),E.password&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E.password.message})]}),_.jsx("button",{type:"submit",disabled:h||r,className:"btn btn-primary btn-md w-full",children:h?"Signing In...":"Sign In"})]}),_.jsx("div",{className:"card-footer",children:_.jsxs("p",{className:"text-center text-sm text-secondary-600",children:["Don't have an account?"," ",_.jsx("button",{type:"button",onClick:e,className:"text-primary-600 hover:text-primary-700 font-medium",children:"Register here"})]})})]})})},T7=({onSuccess:t,onSwitchToLogin:e})=>{const{register:n,loading:r,error:i,clearError:s}=ni(),l=ir(),[h,f]=ne.useState(!1),{register:m,handleSubmit:x,formState:{errors:E},watch:A}=cf(),N=A("password"),U=async D=>{try{f(!0),s();const{confirmPassword:G,...M}=D;M.role="researcher",await n(M),Fe.success("Registration successful! Your account has been created with Researcher access."),setTimeout(()=>{l("/dashboard",{replace:!0})},100),t==null||t()}catch(G){Fe.error(G.message||"Registration failed")}finally{f(!1)}};return _.jsx("div",{className:"w-full max-w-md mx-auto",children:_.jsxs("div",{className:"card",children:[_.jsxs("div",{className:"card-header",children:[_.jsx("h2",{className:"text-2xl font-bold text-center",children:"Create Account"}),_.jsx("p",{className:"text-center text-secondary-600 mt-2",children:"Join the archaeological artifacts management system"})]}),_.jsxs("form",{onSubmit:x(U),className:"card-content space-y-4",children:[i&&_.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:_.jsx("p",{className:"text-red-800 text-sm",children:i.message})}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Email Address"}),_.jsx("input",{...m("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),type:"email",id:"email",className:"input",placeholder:"archaeologist@university.edu"}),E.email&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E.email.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Username"}),_.jsx("input",{...m("username",{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"},maxLength:{value:50,message:"Username must be less than 50 characters"},pattern:{value:/^[a-zA-Z0-9_]+$/,message:"Username can only contain letters, numbers, and underscores"}}),type:"text",id:"username",className:"input",placeholder:"archaeologist_jane"}),E.username&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E.username.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Display Name (Optional)"}),_.jsx("input",{...m("displayName",{maxLength:{value:100,message:"Display name must be less than 100 characters"}}),type:"text",id:"displayName",className:"input",placeholder:"Dr. Jane Smith"}),E.displayName&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E.displayName.message})]}),_.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:_.jsxs("p",{className:"text-blue-800 text-sm",children:[_.jsx("strong",{children:" Account Type:"})," Your account will be created with ",_.jsx("strong",{children:"Researcher"})," access (read-only). After registration, you can request an upgrade to Archaeologist or Admin roles from your profile settings."]})}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Password"}),_.jsx("input",{...m("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",id:"password",className:"input",placeholder:"Enter your password"}),E.password&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E.password.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Confirm Password"}),_.jsx("input",{...m("confirmPassword",{required:"Please confirm your password",validate:D=>D===N||"Passwords do not match"}),type:"password",id:"confirmPassword",className:"input",placeholder:"Confirm your password"}),E.confirmPassword&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:E.confirmPassword.message})]}),_.jsx("button",{type:"submit",disabled:h||r,className:"btn btn-primary btn-md w-full",children:h?"Creating Account...":"Create Account"})]}),_.jsx("div",{className:"card-footer",children:_.jsxs("p",{className:"text-center text-sm text-secondary-600",children:["Already have an account?"," ",_.jsx("button",{type:"button",onClick:e,className:"text-primary-600 hover:text-primary-700 font-medium",children:"Sign in here"})]})})]})})},C7=()=>{const{isAuthenticated:t}=ni(),[e,n]=ne.useState(!0);return t?_.jsx(vr,{to:"/dashboard",replace:!0}):_.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:_.jsxs("div",{className:"max-w-md w-full space-y-8",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-primary-100",children:_.jsx("svg",{className:"h-8 w-8 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),_.jsx("h1",{className:"mt-6 text-3xl font-extrabold text-secondary-900",children:"Archaeological Artifacts Scanner"}),_.jsx("p",{className:"mt-2 text-sm text-secondary-600",children:"Manage and scan archaeological artifacts with QR codes"})]}),e?_.jsx(A7,{onSwitchToRegister:()=>n(!1)}):_.jsx(T7,{onSwitchToLogin:()=>n(!0)}),_.jsx("div",{className:"mt-8 text-center",children:_.jsxs("div",{className:"text-xs text-secondary-500",children:[_.jsx("p",{children:"Demo Credentials:"}),_.jsxs("p",{className:"mt-1",children:[_.jsx("strong",{children:"Admin:"})," admin@university.edu / admin123"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Archaeologist:"})," archaeologist@university.edu / archaeologist123"]}),_.jsxs("p",{children:[_.jsx("strong",{children:"Researcher:"})," researcher@university.edu / researcher123"]})]})})]})})},uf=({size:t="md",className:e="",text:n})=>{const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return _.jsxs("div",{className:`flex flex-col items-center justify-center ${e}`,children:[_.jsx("div",{className:`animate-spin rounded-full border-2 border-primary-200 border-t-primary-600 ${r[t]}`}),n&&_.jsx("p",{className:"mt-2 text-sm text-secondary-600",children:n})]})},S7=()=>{const{user:t,loading:e}=ni(),n=ir();return e?_.jsx(uf,{text:"Loading dashboard..."}):_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("div",{className:"mb-8",children:[_.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",(t==null?void 0:t.displayName)||(t==null?void 0:t.username),"!"]}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your archaeological artifacts and discoveries"})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Total Artifacts"}),_.jsx("p",{className:"text-3xl font-bold text-primary-600",children:"0"}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Artifacts in your collection"})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Recent Discoveries"}),_.jsx("p",{className:"text-3xl font-bold text-green-600",children:"0"}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This month"})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Photos Uploaded"}),_.jsx("p",{className:"text-3xl font-bold text-blue-600",children:"0"}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Total photos"})]})})]}),_.jsxs("div",{className:"mt-8",children:[_.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[_.jsx("button",{onClick:()=>n("/artifacts/new"),className:"btn btn-primary btn-lg",children:"Add New Artifact"}),_.jsx("button",{onClick:()=>n("/scanner"),className:"btn btn-outline btn-lg",children:"Scan QR Code"}),_.jsx("button",{onClick:()=>n("/artifacts"),className:"btn btn-outline btn-lg",children:"View All Artifacts"}),_.jsx("button",{onClick:()=>alert("Photo upload will be available soon!"),className:"btn btn-outline btn-lg",children:"Upload Photos"})]})]})]})})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var b7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R7=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ot=(t,e)=>{const n=ne.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:h="",children:f,...m},x)=>ne.createElement("svg",{ref:x,...b7,width:i,height:i,stroke:r,strokeWidth:l?Number(s)*24/Number(i):s,className:["lucide",`lucide-${R7(t)}`,h].join(" "),...m},[...e.map(([E,A])=>ne.createElement(E,A)),...Array.isArray(f)?f:[f]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=Ot("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N7=Ot("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=Ot("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=Ot("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=Ot("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=Ot("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P7=Ot("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S1=Ot("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D7=Ot("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=Ot("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k7=Ot("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=Ot("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=Ot("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=Ot("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O7=Ot("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M7=Ot("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=Ot("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L7=Ot("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F7=Ot("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V7=Ot("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b1=Ot("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B7=Ot("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U7=Ot("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zc=Ot("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=Ot("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R1=Ot("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hh=Ot("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=Ot("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j7=Ot("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Fl={},z7=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},ER={},yi={};let Kw;const G7=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];yi.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};yi.getSymbolTotalCodewords=function(e){return G7[e]};yi.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};yi.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Kw=e};yi.isKanjiModeEnabled=function(){return typeof Kw<"u"};yi.toSJIS=function(e){return Kw(e)};var Og={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,i){if(t.isValid(r))return r;try{return e(r)}catch{return i}}})(Og);function vR(){this.buffer=[],this.length=0}vR.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let n=0;n<e;n++)this.putBit((t>>>e-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var q7=vR;function hf(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}hf.prototype.set=function(t,e,n,r){const i=t*this.size+e;this.data[i]=n,r&&(this.reservedBit[i]=!0)};hf.prototype.get=function(t,e){return this.data[t*this.size+e]};hf.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n};hf.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var H7=hf,IR={};(function(t){const e=yi.getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,s=e(r),l=s===145?26:Math.ceil((s-13)/(2*i-2))*2,h=[s-7];for(let f=1;f<i-1;f++)h[f]=h[f-1]-l;return h.push(6),h.reverse()},t.getPositions=function(r){const i=[],s=t.getRowColCoords(r),l=s.length;for(let h=0;h<l;h++)for(let f=0;f<l;f++)h===0&&f===0||h===0&&f===l-1||h===l-1&&f===0||i.push([s[h],s[f]]);return i}})(IR);var AR={};const W7=yi.getSymbolSize,Mv=7;AR.getPositions=function(e){const n=W7(e);return[[0,0],[n-Mv,0],[0,n-Mv]]};var TR={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},t.from=function(i){return t.isValid(i)?parseInt(i,10):void 0},t.getPenaltyN1=function(i){const s=i.size;let l=0,h=0,f=0,m=null,x=null;for(let E=0;E<s;E++){h=f=0,m=x=null;for(let A=0;A<s;A++){let N=i.get(E,A);N===m?h++:(h>=5&&(l+=e.N1+(h-5)),m=N,h=1),N=i.get(A,E),N===x?f++:(f>=5&&(l+=e.N1+(f-5)),x=N,f=1)}h>=5&&(l+=e.N1+(h-5)),f>=5&&(l+=e.N1+(f-5))}return l},t.getPenaltyN2=function(i){const s=i.size;let l=0;for(let h=0;h<s-1;h++)for(let f=0;f<s-1;f++){const m=i.get(h,f)+i.get(h,f+1)+i.get(h+1,f)+i.get(h+1,f+1);(m===4||m===0)&&l++}return l*e.N2},t.getPenaltyN3=function(i){const s=i.size;let l=0,h=0,f=0;for(let m=0;m<s;m++){h=f=0;for(let x=0;x<s;x++)h=h<<1&2047|i.get(m,x),x>=10&&(h===1488||h===93)&&l++,f=f<<1&2047|i.get(x,m),x>=10&&(f===1488||f===93)&&l++}return l*e.N3},t.getPenaltyN4=function(i){let s=0;const l=i.data.length;for(let f=0;f<l;f++)s+=i.data[f];return Math.abs(Math.ceil(s*100/l/5)-10)*e.N4};function n(r,i,s){switch(r){case t.Patterns.PATTERN000:return(i+s)%2===0;case t.Patterns.PATTERN001:return i%2===0;case t.Patterns.PATTERN010:return s%3===0;case t.Patterns.PATTERN011:return(i+s)%3===0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case t.Patterns.PATTERN101:return i*s%2+i*s%3===0;case t.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case t.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(i,s){const l=s.size;for(let h=0;h<l;h++)for(let f=0;f<l;f++)s.isReserved(f,h)||s.xor(f,h,n(i,f,h))},t.getBestMask=function(i,s){const l=Object.keys(t.Patterns).length;let h=0,f=1/0;for(let m=0;m<l;m++){s(m),t.applyMask(m,i);const x=t.getPenaltyN1(i)+t.getPenaltyN2(i)+t.getPenaltyN3(i)+t.getPenaltyN4(i);t.applyMask(m,i),x<f&&(f=x,h=m)}return h}})(TR);var Mg={};const ia=Og,e0=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],t0=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Mg.getBlocksCount=function(e,n){switch(n){case ia.L:return e0[(e-1)*4+0];case ia.M:return e0[(e-1)*4+1];case ia.Q:return e0[(e-1)*4+2];case ia.H:return e0[(e-1)*4+3];default:return}};Mg.getTotalCodewordsCount=function(e,n){switch(n){case ia.L:return t0[(e-1)*4+0];case ia.M:return t0[(e-1)*4+1];case ia.Q:return t0[(e-1)*4+2];case ia.H:return t0[(e-1)*4+3];default:return}};var CR={},Lg={};const Wh=new Uint8Array(512),N1=new Uint8Array(256);(function(){let e=1;for(let n=0;n<255;n++)Wh[n]=e,N1[e]=n,e<<=1,e&256&&(e^=285);for(let n=255;n<512;n++)Wh[n]=Wh[n-255]})();Lg.log=function(e){if(e<1)throw new Error("log("+e+")");return N1[e]};Lg.exp=function(e){return Wh[e]};Lg.mul=function(e,n){return e===0||n===0?0:Wh[N1[e]+N1[n]]};(function(t){const e=Lg;t.mul=function(r,i){const s=new Uint8Array(r.length+i.length-1);for(let l=0;l<r.length;l++)for(let h=0;h<i.length;h++)s[l+h]^=e.mul(r[l],i[h]);return s},t.mod=function(r,i){let s=new Uint8Array(r);for(;s.length-i.length>=0;){const l=s[0];for(let f=0;f<i.length;f++)s[f]^=e.mul(i[f],l);let h=0;for(;h<s.length&&s[h]===0;)h++;s=s.slice(h)}return s},t.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let s=0;s<r;s++)i=t.mul(i,new Uint8Array([1,e.exp(s)]));return i}})(CR);const SR=CR;function $w(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}$w.prototype.initialize=function(e){this.degree=e,this.genPoly=SR.generateECPolynomial(this.degree)};$w.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const n=new Uint8Array(e.length+this.degree);n.set(e);const r=SR.mod(n,this.genPoly),i=this.degree-r.length;if(i>0){const s=new Uint8Array(this.degree);return s.set(r,i),s}return r};var K7=$w,bR={},Ba={},Qw={};Qw.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var Ls={};const RR="[0-9]+",$7="[A-Z $%*+\\-./:]+";let Rd="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Rd=Rd.replace(/u/g,"\\u");const Q7="(?:(?![A-Z0-9 $%*+\\-./:]|"+Rd+`)(?:.|[\r
]))+`;Ls.KANJI=new RegExp(Rd,"g");Ls.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Ls.BYTE=new RegExp(Q7,"g");Ls.NUMERIC=new RegExp(RR,"g");Ls.ALPHANUMERIC=new RegExp($7,"g");const X7=new RegExp("^"+Rd+"$"),Y7=new RegExp("^"+RR+"$"),Z7=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Ls.testKanji=function(e){return X7.test(e)};Ls.testNumeric=function(e){return Y7.test(e)};Ls.testAlphanumeric=function(e){return Z7.test(e)};(function(t){const e=Qw,n=Ls;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(s,l){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?s.ccBits[0]:l<27?s.ccBits[1]:s.ccBits[2]},t.getBestModeForData=function(s){return n.testNumeric(s)?t.NUMERIC:n.testAlphanumeric(s)?t.ALPHANUMERIC:n.testKanji(s)?t.KANJI:t.BYTE},t.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},t.isValid=function(s){return s&&s.bit&&s.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+i)}}t.from=function(s,l){if(t.isValid(s))return s;try{return r(s)}catch{return l}}})(Ba);(function(t){const e=yi,n=Mg,r=Og,i=Ba,s=Qw,l=7973,h=e.getBCHDigit(l);function f(A,N,U){for(let D=1;D<=40;D++)if(N<=t.getCapacity(D,U,A))return D}function m(A,N){return i.getCharCountIndicator(A,N)+4}function x(A,N){let U=0;return A.forEach(function(D){const G=m(D.mode,N);U+=G+D.getBitsLength()}),U}function E(A,N){for(let U=1;U<=40;U++)if(x(A,U)<=t.getCapacity(U,N,i.MIXED))return U}t.from=function(N,U){return s.isValid(N)?parseInt(N,10):U},t.getCapacity=function(N,U,D){if(!s.isValid(N))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=i.BYTE);const G=e.getSymbolTotalCodewords(N),M=n.getTotalCodewordsCount(N,U),b=(G-M)*8;if(D===i.MIXED)return b;const P=b-m(D,N);switch(D){case i.NUMERIC:return Math.floor(P/10*3);case i.ALPHANUMERIC:return Math.floor(P/11*2);case i.KANJI:return Math.floor(P/13);case i.BYTE:default:return Math.floor(P/8)}},t.getBestVersionForData=function(N,U){let D;const G=r.from(U,r.M);if(Array.isArray(N)){if(N.length>1)return E(N,G);if(N.length===0)return 1;D=N[0]}else D=N;return f(D.mode,D.getLength(),G)},t.getEncodedBits=function(N){if(!s.isValid(N)||N<7)throw new Error("Invalid QR Code version");let U=N<<12;for(;e.getBCHDigit(U)-h>=0;)U^=l<<e.getBCHDigit(U)-h;return N<<12|U}})(bR);var NR={};const Ey=yi,PR=1335,J7=21522,Lv=Ey.getBCHDigit(PR);NR.getEncodedBits=function(e,n){const r=e.bit<<3|n;let i=r<<10;for(;Ey.getBCHDigit(i)-Lv>=0;)i^=PR<<Ey.getBCHDigit(i)-Lv;return(r<<10|i)^J7};var DR={};const eF=Ba;function _u(t){this.mode=eF.NUMERIC,this.data=t.toString()}_u.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};_u.prototype.getLength=function(){return this.data.length};_u.prototype.getBitsLength=function(){return _u.getBitsLength(this.data.length)};_u.prototype.write=function(e){let n,r,i;for(n=0;n+3<=this.data.length;n+=3)r=this.data.substr(n,3),i=parseInt(r,10),e.put(i,10);const s=this.data.length-n;s>0&&(r=this.data.substr(n),i=parseInt(r,10),e.put(i,s*3+1))};var tF=_u;const nF=Ba,Mm=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Eu(t){this.mode=nF.ALPHANUMERIC,this.data=t}Eu.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};Eu.prototype.getLength=function(){return this.data.length};Eu.prototype.getBitsLength=function(){return Eu.getBitsLength(this.data.length)};Eu.prototype.write=function(e){let n;for(n=0;n+2<=this.data.length;n+=2){let r=Mm.indexOf(this.data[n])*45;r+=Mm.indexOf(this.data[n+1]),e.put(r,11)}this.data.length%2&&e.put(Mm.indexOf(this.data[n]),6)};var rF=Eu;const iF=Ba;function vu(t){this.mode=iF.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}vu.getBitsLength=function(e){return e*8};vu.prototype.getLength=function(){return this.data.length};vu.prototype.getBitsLength=function(){return vu.getBitsLength(this.data.length)};vu.prototype.write=function(t){for(let e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)};var sF=vu;const oF=Ba,aF=yi;function Iu(t){this.mode=oF.KANJI,this.data=t}Iu.getBitsLength=function(e){return e*13};Iu.prototype.getLength=function(){return this.data.length};Iu.prototype.getBitsLength=function(){return Iu.getBitsLength(this.data.length)};Iu.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=aF.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),t.put(n,13)}};var lF=Iu,kR={exports:{}};(function(t){var e={single_source_shortest_paths:function(n,r,i){var s={},l={};l[r]=0;var h=e.PriorityQueue.make();h.push(r,0);for(var f,m,x,E,A,N,U,D,G;!h.empty();){f=h.pop(),m=f.value,E=f.cost,A=n[m]||{};for(x in A)A.hasOwnProperty(x)&&(N=A[x],U=E+N,D=l[x],G=typeof l[x]>"u",(G||D>U)&&(l[x]=U,h.push(x,U),s[x]=m))}if(typeof i<"u"&&typeof l[i]>"u"){var M=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(M)}return s},extract_shortest_path_from_predecessor_list:function(n,r){for(var i=[],s=r;s;)i.push(s),n[s],s=n[s];return i.reverse(),i},find_path:function(n,r,i){var s=e.single_source_shortest_paths(n,r,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(n){var r=e.PriorityQueue,i={},s;n=n||{};for(s in r)r.hasOwnProperty(s)&&(i[s]=r[s]);return i.queue=[],i.sorter=n.sorter||r.default_sorter,i},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var i={value:n,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(kR);var cF=kR.exports;(function(t){const e=Ba,n=tF,r=rF,i=sF,s=lF,l=Ls,h=yi,f=cF;function m(M){return unescape(encodeURIComponent(M)).length}function x(M,b,P){const V=[];let $;for(;($=M.exec(P))!==null;)V.push({data:$[0],index:$.index,mode:b,length:$[0].length});return V}function E(M){const b=x(l.NUMERIC,e.NUMERIC,M),P=x(l.ALPHANUMERIC,e.ALPHANUMERIC,M);let V,$;return h.isKanjiModeEnabled()?(V=x(l.BYTE,e.BYTE,M),$=x(l.KANJI,e.KANJI,M)):(V=x(l.BYTE_KANJI,e.BYTE,M),$=[]),b.concat(P,V,$).sort(function(k,L){return k.index-L.index}).map(function(k){return{data:k.data,mode:k.mode,length:k.length}})}function A(M,b){switch(b){case e.NUMERIC:return n.getBitsLength(M);case e.ALPHANUMERIC:return r.getBitsLength(M);case e.KANJI:return s.getBitsLength(M);case e.BYTE:return i.getBitsLength(M)}}function N(M){return M.reduce(function(b,P){const V=b.length-1>=0?b[b.length-1]:null;return V&&V.mode===P.mode?(b[b.length-1].data+=P.data,b):(b.push(P),b)},[])}function U(M){const b=[];for(let P=0;P<M.length;P++){const V=M[P];switch(V.mode){case e.NUMERIC:b.push([V,{data:V.data,mode:e.ALPHANUMERIC,length:V.length},{data:V.data,mode:e.BYTE,length:V.length}]);break;case e.ALPHANUMERIC:b.push([V,{data:V.data,mode:e.BYTE,length:V.length}]);break;case e.KANJI:b.push([V,{data:V.data,mode:e.BYTE,length:m(V.data)}]);break;case e.BYTE:b.push([{data:V.data,mode:e.BYTE,length:m(V.data)}])}}return b}function D(M,b){const P={},V={start:{}};let $=["start"];for(let J=0;J<M.length;J++){const k=M[J],L=[];for(let F=0;F<k.length;F++){const H=k[F],K=""+J+F;L.push(K),P[K]={node:H,lastCount:0},V[K]={};for(let W=0;W<$.length;W++){const z=$[W];P[z]&&P[z].node.mode===H.mode?(V[z][K]=A(P[z].lastCount+H.length,H.mode)-A(P[z].lastCount,H.mode),P[z].lastCount+=H.length):(P[z]&&(P[z].lastCount=H.length),V[z][K]=A(H.length,H.mode)+4+e.getCharCountIndicator(H.mode,b))}}$=L}for(let J=0;J<$.length;J++)V[$[J]].end=0;return{map:V,table:P}}function G(M,b){let P;const V=e.getBestModeForData(M);if(P=e.from(b,V),P!==e.BYTE&&P.bit<V.bit)throw new Error('"'+M+'" cannot be encoded with mode '+e.toString(P)+`.
 Suggested mode is: `+e.toString(V));switch(P===e.KANJI&&!h.isKanjiModeEnabled()&&(P=e.BYTE),P){case e.NUMERIC:return new n(M);case e.ALPHANUMERIC:return new r(M);case e.KANJI:return new s(M);case e.BYTE:return new i(M)}}t.fromArray=function(b){return b.reduce(function(P,V){return typeof V=="string"?P.push(G(V,null)):V.data&&P.push(G(V.data,V.mode)),P},[])},t.fromString=function(b,P){const V=E(b,h.isKanjiModeEnabled()),$=U(V),J=D($,P),k=f.find_path(J.map,"start","end"),L=[];for(let F=1;F<k.length-1;F++)L.push(J.table[k[F]].node);return t.fromArray(N(L))},t.rawSplit=function(b){return t.fromArray(E(b,h.isKanjiModeEnabled()))}})(DR);const Fg=yi,Lm=Og,uF=q7,hF=H7,dF=IR,fF=AR,vy=TR,Iy=Mg,gF=K7,P1=bR,mF=NR,pF=Ba,Fm=DR;function yF(t,e){const n=t.size,r=fF.getPositions(e);for(let i=0;i<r.length;i++){const s=r[i][0],l=r[i][1];for(let h=-1;h<=7;h++)if(!(s+h<=-1||n<=s+h))for(let f=-1;f<=7;f++)l+f<=-1||n<=l+f||(h>=0&&h<=6&&(f===0||f===6)||f>=0&&f<=6&&(h===0||h===6)||h>=2&&h<=4&&f>=2&&f<=4?t.set(s+h,l+f,!0,!0):t.set(s+h,l+f,!1,!0))}}function xF(t){const e=t.size;for(let n=8;n<e-8;n++){const r=n%2===0;t.set(n,6,r,!0),t.set(6,n,r,!0)}}function wF(t,e){const n=dF.getPositions(e);for(let r=0;r<n.length;r++){const i=n[r][0],s=n[r][1];for(let l=-2;l<=2;l++)for(let h=-2;h<=2;h++)l===-2||l===2||h===-2||h===2||l===0&&h===0?t.set(i+l,s+h,!0,!0):t.set(i+l,s+h,!1,!0)}}function _F(t,e){const n=t.size,r=P1.getEncodedBits(e);let i,s,l;for(let h=0;h<18;h++)i=Math.floor(h/3),s=h%3+n-8-3,l=(r>>h&1)===1,t.set(i,s,l,!0),t.set(s,i,l,!0)}function Vm(t,e,n){const r=t.size,i=mF.getEncodedBits(e,n);let s,l;for(s=0;s<15;s++)l=(i>>s&1)===1,s<6?t.set(s,8,l,!0):s<8?t.set(s+1,8,l,!0):t.set(r-15+s,8,l,!0),s<8?t.set(8,r-s-1,l,!0):s<9?t.set(8,15-s-1+1,l,!0):t.set(8,15-s-1,l,!0);t.set(r-8,8,1,!0)}function EF(t,e){const n=t.size;let r=-1,i=n-1,s=7,l=0;for(let h=n-1;h>0;h-=2)for(h===6&&h--;;){for(let f=0;f<2;f++)if(!t.isReserved(i,h-f)){let m=!1;l<e.length&&(m=(e[l]>>>s&1)===1),t.set(i,h-f,m),s--,s===-1&&(l++,s=7)}if(i+=r,i<0||n<=i){i-=r,r=-r;break}}}function vF(t,e,n){const r=new uF;n.forEach(function(f){r.put(f.mode.bit,4),r.put(f.getLength(),pF.getCharCountIndicator(f.mode,t)),f.write(r)});const i=Fg.getSymbolTotalCodewords(t),s=Iy.getTotalCodewordsCount(t,e),l=(i-s)*8;for(r.getLengthInBits()+4<=l&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const h=(l-r.getLengthInBits())/8;for(let f=0;f<h;f++)r.put(f%2?17:236,8);return IF(r,t,e)}function IF(t,e,n){const r=Fg.getSymbolTotalCodewords(e),i=Iy.getTotalCodewordsCount(e,n),s=r-i,l=Iy.getBlocksCount(e,n),h=r%l,f=l-h,m=Math.floor(r/l),x=Math.floor(s/l),E=x+1,A=m-x,N=new gF(A);let U=0;const D=new Array(l),G=new Array(l);let M=0;const b=new Uint8Array(t.buffer);for(let k=0;k<l;k++){const L=k<f?x:E;D[k]=b.slice(U,U+L),G[k]=N.encode(D[k]),U+=L,M=Math.max(M,L)}const P=new Uint8Array(r);let V=0,$,J;for($=0;$<M;$++)for(J=0;J<l;J++)$<D[J].length&&(P[V++]=D[J][$]);for($=0;$<A;$++)for(J=0;J<l;J++)P[V++]=G[J][$];return P}function AF(t,e,n,r){let i;if(Array.isArray(t))i=Fm.fromArray(t);else if(typeof t=="string"){let m=e;if(!m){const x=Fm.rawSplit(t);m=P1.getBestVersionForData(x,n)}i=Fm.fromString(t,m||40)}else throw new Error("Invalid data");const s=P1.getBestVersionForData(i,n);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=s;else if(e<s)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+s+`.
`);const l=vF(e,n,i),h=Fg.getSymbolSize(e),f=new hF(h);return yF(f,e),xF(f),wF(f,e),Vm(f,n,0),e>=7&&_F(f,e),EF(f,l),isNaN(r)&&(r=vy.getBestMask(f,Vm.bind(null,f,n))),vy.applyMask(r,f),Vm(f,n,r),{modules:f,version:e,errorCorrectionLevel:n,maskPattern:r,segments:i}}ER.create=function(e,n){if(typeof e>"u"||e==="")throw new Error("No input text");let r=Lm.M,i,s;return typeof n<"u"&&(r=Lm.from(n.errorCorrectionLevel,Lm.M),i=P1.from(n.version),s=vy.from(n.maskPattern),n.toSJISFunc&&Fg.setToSJISFunction(n.toSJISFunc)),AF(e,i,r,s)};var OR={},Xw={};(function(t){function e(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(s){return[s,s]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,s=r.width&&r.width>=21?r.width:void 0,l=r.scale||4;return{width:s,scale:s?4:l,margin:i,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},t.getImageWidth=function(r,i){const s=t.getScale(r,i);return Math.floor((r+i.margin*2)*s)},t.qrToImageData=function(r,i,s){const l=i.modules.size,h=i.modules.data,f=t.getScale(l,s),m=Math.floor((l+s.margin*2)*f),x=s.margin*f,E=[s.color.light,s.color.dark];for(let A=0;A<m;A++)for(let N=0;N<m;N++){let U=(A*m+N)*4,D=s.color.light;if(A>=x&&N>=x&&A<m-x&&N<m-x){const G=Math.floor((A-x)/f),M=Math.floor((N-x)/f);D=E[h[G*l+M]?1:0]}r[U++]=D.r,r[U++]=D.g,r[U++]=D.b,r[U]=D.a}}})(Xw);(function(t){const e=Xw;function n(i,s,l){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=l,s.width=l,s.style.height=l+"px",s.style.width=l+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(s,l,h){let f=h,m=l;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),l||(m=r()),f=e.getOptions(f);const x=e.getImageWidth(s.modules.size,f),E=m.getContext("2d"),A=E.createImageData(x,x);return e.qrToImageData(A.data,s,f),n(E,m,x),E.putImageData(A,0,0),m},t.renderToDataURL=function(s,l,h){let f=h;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),f||(f={});const m=t.render(s,l,f),x=f.type||"image/png",E=f.rendererOpts||{};return m.toDataURL(x,E.quality)}})(OR);var MR={};const TF=Xw;function Fv(t,e){const n=t.a/255,r=e+'="'+t.hex+'"';return n<1?r+" "+e+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function Bm(t,e,n){let r=t+e;return typeof n<"u"&&(r+=" "+n),r}function CF(t,e,n){let r="",i=0,s=!1,l=0;for(let h=0;h<t.length;h++){const f=Math.floor(h%e),m=Math.floor(h/e);!f&&!s&&(s=!0),t[h]?(l++,h>0&&f>0&&t[h-1]||(r+=s?Bm("M",f+n,.5+m+n):Bm("m",i,0),i=0,s=!1),f+1<e&&t[h+1]||(r+=Bm("h",l),l=0)):i++}return r}MR.render=function(e,n,r){const i=TF.getOptions(n),s=e.modules.size,l=e.modules.data,h=s+i.margin*2,f=i.color.light.a?"<path "+Fv(i.color.light,"fill")+' d="M0 0h'+h+"v"+h+'H0z"/>':"",m="<path "+Fv(i.color.dark,"stroke")+' d="'+CF(l,s,i.margin)+'"/>',x='viewBox="0 0 '+h+" "+h+'"',A='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+x+' shape-rendering="crispEdges">'+f+m+`</svg>
`;return typeof r=="function"&&r(null,A),A};const SF=z7,Ay=ER,LR=OR,bF=MR;function Yw(t,e,n,r,i){const s=[].slice.call(arguments,1),l=s.length,h=typeof s[l-1]=="function";if(!h&&!SF())throw new Error("Callback required as last argument");if(h){if(l<2)throw new Error("Too few arguments provided");l===2?(i=n,n=e,e=r=void 0):l===3&&(e.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=n,n=e,e=void 0))}else{if(l<1)throw new Error("Too few arguments provided");return l===1?(n=e,e=r=void 0):l===2&&!e.getContext&&(r=n,n=e,e=void 0),new Promise(function(f,m){try{const x=Ay.create(n,r);f(t(x,e,r))}catch(x){m(x)}})}try{const f=Ay.create(n,r);i(null,t(f,e,r))}catch(f){i(f)}}Fl.create=Ay.create;Fl.toCanvas=Yw.bind(null,LR.render);Fl.toDataURL=Yw.bind(null,LR.renderToDataURL);Fl.toString=Yw.bind(null,function(t,e,n){return bF.render(t,n)});const Au="artifacts",RF=async t=>{try{const e=`${window.location.origin}/artifacts/${t}`;return await Fl.toDataURL(e,{width:512,margin:2,color:{dark:"#1e293b",light:"#ffffff"}})}catch(e){return console.error("Error generating QR code:",e),""}},NF=async t=>{try{const e=Gt.currentUser;if(!e)throw new Error("User must be authenticated to create artifacts");const n={...t,createdBy:e.uid,createdAt:Ri(),updatedAt:Ri(),isDeleted:!1,version:1,qrCodeUrl:null,photoCount:0},r=await sR(Fa(dn,Au),n);console.log(" Artifact created successfully with ID:",r.id);try{const i=await RF(r.id);i&&(await po(Lr(dn,Au,r.id),{qrCodeUrl:i}),console.log(" QR code generated and stored"))}catch(i){console.warn(" QR code generation failed, but artifact was created:",i)}return r.id}catch(e){throw console.error(" Error creating artifact:",e),e}},FR=async t=>{var e,n,r,i;try{const s=Lr(dn,Au,t),l=await Dg(s);if(!l.exists())return null;const h=l.data();return{id:l.id,...h,createdAt:((n=(e=h.createdAt)==null?void 0:e.toDate)==null?void 0:n.call(e))||new Date,updatedAt:((i=(r=h.updatedAt)==null?void 0:r.toDate)==null?void 0:i.call(r))||new Date}}catch(s){throw console.error(" Error getting artifact:",s),s}},PF=async()=>{try{const t=Bu(Fa(dn,Au),Sd("isDeleted","==",!1)),e=await ju(t),n=[];return e.forEach(r=>{var s,l,h,f;const i=r.data();n.push({id:r.id,...i,createdAt:((l=(s=i.createdAt)==null?void 0:s.toDate)==null?void 0:l.call(s))||new Date,updatedAt:((f=(h=i.updatedAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date})}),n.sort((r,i)=>i.createdAt.getTime()-r.createdAt.getTime()),n}catch(t){throw console.error(" Error getting artifacts:",t),t}},DF=async(t,e)=>{try{const n=Gt.currentUser;if(!n)throw new Error("User must be authenticated to update artifacts");const r=Lr(dn,Au,t),i=await Dg(r);if(!i.exists())throw new Error("Artifact not found");const s=i.data().version||1,l=Object.fromEntries(Object.entries(e).filter(([h,f])=>f!==void 0));await po(r,{...l,updatedAt:Ri(),updatedBy:n.uid,version:s+1}),console.log(" Artifact updated successfully:",t)}catch(n){throw console.error(" Error updating artifact:",n),n}},kF=async t=>{try{const e=Gt.currentUser;if(!e)throw new Error("User must be authenticated to delete artifacts");const n=Lr(dn,Au,t);await po(n,{isDeleted:!0,deletedAt:Ri(),deletedBy:e.uid,updatedAt:Ri()}),console.log(" Artifact deleted successfully:",t)}catch(e){throw console.error(" Error deleting artifact:",e),e}},OF=()=>{const t=ir(),[e,n]=ne.useState([]),[r,i]=ne.useState(!0),[s,l]=ne.useState("");ne.useEffect(()=>{h()},[]);const h=async()=>{try{i(!0);const m=await PF();n(m),console.log(" Loaded artifacts:",m.length)}catch(m){console.error("Error loading artifacts:",m),Fe.error("Failed to load artifacts")}finally{i(!1)}},f=e.filter(m=>m.name.toLowerCase().includes(s.toLowerCase())||m.artifactType.toLowerCase().includes(s.toLowerCase())||m.discoverySite.toLowerCase().includes(s.toLowerCase()));return r?_.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:_.jsx(uf,{text:"Loading artifacts..."})}):_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("div",{className:"mb-8 flex justify-between items-start",children:[_.jsxs("div",{children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Artifacts"}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Browse and manage your archaeological artifacts"})]}),_.jsxs("button",{onClick:()=>t("/artifacts/new"),className:"btn btn-primary flex items-center gap-2",children:[_.jsx(Ov,{className:"w-4 h-4"}),"Add New Artifact"]})]}),_.jsx("div",{className:"mb-6",children:_.jsxs("div",{className:"relative",children:[_.jsx(b1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),_.jsx("input",{type:"text",placeholder:"Search artifacts by name, type, or site...",value:s,onChange:m=>l(m.target.value),className:"input pl-10 w-full"})]})}),f.length===0?_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content text-center py-12",children:[_.jsx(Hw,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s?"No artifacts found":"No artifacts yet"}),_.jsx("p",{className:"text-gray-600 mb-6",children:s?"Try adjusting your search criteria":"Get started by adding your first artifact"}),!s&&_.jsxs("button",{onClick:()=>t("/artifacts/new"),className:"btn btn-primary",children:[_.jsx(Ov,{className:"w-4 h-4 mr-2"}),"Add New Artifact"]})]})}):_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(m=>_.jsx("div",{onClick:()=>t(`/artifacts/${m.id}`),className:"card hover:shadow-lg transition-shadow cursor-pointer",children:_.jsxs("div",{className:"card-content",children:[_.jsx("div",{className:"flex justify-between items-start mb-3",children:_.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2",children:m.name})}),_.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800 mb-3",children:m.artifactType}),m.description&&_.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:m.description}),_.jsxs("div",{className:"space-y-1 text-sm text-gray-500",children:[_.jsxs("p",{children:[_.jsx("span",{className:"font-medium",children:"Site:"})," ",m.discoverySite]}),_.jsxs("p",{children:[_.jsx("span",{className:"font-medium",children:"Date:"})," ",m.discoveryDate]}),_.jsxs("p",{children:[_.jsx("span",{className:"font-medium",children:"Location:"})," ",m.location]})]}),_.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-400",children:["Added ",new Date(m.createdAt).toLocaleDateString()]})]})},m.id))}),f.length>0&&_.jsxs("div",{className:"mt-6 text-center text-sm text-gray-500",children:["Showing ",f.length," of ",e.length," artifact",e.length!==1?"s":""]})]})})},MF=[{id:"pottery",name:"Pottery",description:"Ceramic vessels and containers",icon:"",color:"#8B4513"},{id:"tool",name:"Tool",description:"Stone, metal, or bone tools",icon:"",color:"#696969"},{id:"jewelry",name:"Jewelry",description:"Personal ornaments and adornments",icon:"",color:"#FFD700"},{id:"weapon",name:"Weapon",description:"Swords, spears, arrows, and other weapons",icon:"",color:"#B22222"},{id:"coin",name:"Coin",description:"Ancient coins and currency",icon:"",color:"#CD7F32"},{id:"sculpture",name:"Sculpture",description:"Carved or molded figures",icon:"",color:"#D2B48C"},{id:"textile",name:"Textile",description:"Fabric, clothing, and woven materials",icon:"",color:"#DEB887"},{id:"other",name:"Other",description:"Miscellaneous artifacts",icon:"",color:"#808080"}],VR=({onSubmit:t,loading:e=!1,initialData:n})=>{const{register:r,handleSubmit:i,formState:{errors:s}}=cf({defaultValues:n});return _.jsxs("form",{onSubmit:i(t),className:"space-y-6",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Artifact Name *"}),_.jsx("input",{...r("name",{required:"Artifact name is required",maxLength:{value:200,message:"Name must be less than 200 characters"}}),type:"text",id:"name",className:"input",placeholder:"Enter artifact name"}),s.name&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.name.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),_.jsx("textarea",{...r("description",{maxLength:{value:2e3,message:"Description must be less than 2000 characters"}}),id:"description",rows:4,className:"input",placeholder:"Enter artifact description"}),s.description&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.description.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"artifactType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Artifact Type *"}),_.jsxs("select",{...r("artifactType",{required:"Artifact type is required"}),id:"artifactType",className:"input",children:[_.jsx("option",{value:"",children:"Select artifact type"}),MF.map(l=>_.jsxs("option",{value:l.id,children:[l.icon," ",l.name]},l.id))]}),s.artifactType&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.artifactType.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"discoveryDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discovery Date *"}),_.jsx("input",{...r("discoveryDate",{required:"Discovery date is required"}),type:"date",id:"discoveryDate",className:"input"}),s.discoveryDate&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.discoveryDate.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"discoverySite",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discovery Site *"}),_.jsx("input",{...r("discoverySite",{required:"Discovery site is required",maxLength:{value:200,message:"Discovery site must be less than 200 characters"}}),type:"text",id:"discoverySite",className:"input",placeholder:"Enter discovery site"}),s.discoverySite&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.discoverySite.message})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Location *"}),_.jsx("input",{...r("location",{required:"Current location is required",maxLength:{value:200,message:"Location must be less than 200 characters"}}),type:"text",id:"location",className:"input",placeholder:"Enter current location"}),s.location&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.location.message})]}),_.jsxs("div",{className:"flex justify-end space-x-4",children:[_.jsx("button",{type:"button",className:"btn btn-secondary btn-md",children:"Cancel"}),_.jsx("button",{type:"submit",disabled:e,className:"btn btn-primary btn-md",children:e?"Saving...":"Save Artifact"})]})]})},LF=()=>{const t=ir(),[e,n]=Ar.useState(!1),r=async i=>{n(!0);try{console.log("Creating artifact:",i);const s=await NF(i);Fe.success("Artifact created successfully!",{duration:3e3,icon:""}),t(`/artifacts/${s}`)}catch(s){console.error("Error creating artifact:",s),Fe.error(s.message||"Failed to create artifact. Please try again.",{duration:4e3,icon:""})}finally{n(!1)}};return _.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>t("/dashboard"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Dashboard"]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Add New Artifact"}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Record a new archaeological artifact in your collection"})]}),_.jsx("div",{className:"card",children:_.jsx("div",{className:"card-content",children:_.jsx(VR,{onSubmit:r,loading:e})})})]})})},FF=()=>{const{id:t}=PT(),e=ir(),[n,r]=ne.useState(!0),[i,s]=ne.useState(!1),[l,h]=ne.useState();ne.useEffect(()=>{(async()=>{if(!t){e("/artifacts");return}try{r(!0);const x=await FR(t);if(!x){Fe.error("Artifact not found"),e("/artifacts");return}h({name:x.name,description:x.description||"",artifactType:x.artifactType,discoveryDate:x.discoveryDate,discoverySite:x.discoverySite,location:x.location,gpsCoordinates:x.gpsCoordinates,dimensions:x.dimensions,material:x.material,condition:x.condition,notes:x.notes||""})}catch(x){console.error("Error loading artifact:",x),Fe.error("Failed to load artifact"),e("/artifacts")}finally{r(!1)}})()},[t,e]);const f=async m=>{if(t){s(!0);try{console.log("Updating artifact:",t,m),await DF(t,m),Fe.success("Artifact updated successfully!",{duration:3e3,icon:""}),e(`/artifacts/${t}`)}catch(x){console.error("Error updating artifact:",x),Fe.error(x.message||"Failed to update artifact. Please try again.",{duration:4e3,icon:""})}finally{s(!1)}}};return n?_.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:_.jsx(uf,{text:"Loading artifact..."})}):l?_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e(`/artifacts/${t}`),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Artifact"]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Artifact"}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Update the details of your archaeological artifact"})]}),_.jsx("div",{className:"card",children:_.jsx("div",{className:"card-content",children:_.jsx(VR,{onSubmit:f,loading:i,initialData:l})})})]})}):_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:_.jsx("p",{className:"text-gray-600",children:"Artifact not found"})})})},VF=({artifactId:t,artifactName:e,size:n=256})=>{const r=ne.useRef(null),[i,s]=ne.useState("");ne.useEffect(()=>{l()},[t]);const l=async()=>{if(r.current)try{const x=`${window.location.origin}/artifacts/${t}`;await Fl.toCanvas(r.current,x,{width:n,margin:2,color:{dark:"#1e293b",light:"#ffffff"}});const E=await Fl.toDataURL(x,{width:n,margin:2});s(E)}catch(x){console.error("Error generating QR code:",x),Fe.error("Failed to generate QR code")}},h=()=>{if(!i)return;const x=document.createElement("a");x.download=`${e.replace(/[^a-z0-9]/gi,"-").toLowerCase()}-qr-code.png`,x.href=i,document.body.appendChild(x),x.click(),document.body.removeChild(x),Fe.success("QR code downloaded!")},f=()=>{if(!i)return;const x=window.open("","_blank");if(!x){Fe.error("Please allow pop-ups to print");return}x.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Print QR Code - ${e}</title>
          <style>
            body {
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              min-height: 100vh;
              margin: 0;
              padding: 20px;
              font-family: Arial, sans-serif;
            }
            .qr-container {
              text-align: center;
              page-break-inside: avoid;
            }
            h1 {
              font-size: 24px;
              margin-bottom: 10px;
            }
            p {
              color: #666;
              margin-bottom: 20px;
            }
            img {
              border: 2px solid #ccc;
              padding: 10px;
              background: white;
            }
            .footer {
              margin-top: 20px;
              font-size: 12px;
              color: #999;
            }
            @media print {
              body {
                padding: 0;
              }
            }
          </style>
        </head>
        <body>
          <div class="qr-container">
            <h1>${e}</h1>
            <p>Scan to view artifact details</p>
            <img src="${i}" alt="QR Code" />
            <div class="footer">
              <p>Archaeological Artifacts Scanner</p>
              <p>Artifact ID: ${t}</p>
            </div>
          </div>
          <script>
            window.onload = function() {
              window.print();
              setTimeout(function() { window.close(); }, 100);
            }
          <\/script>
        </body>
      </html>
    `),x.document.close()},m=async()=>{const x=`${window.location.origin}/artifacts/${t}`;if(navigator.share)try{await navigator.share({title:e,text:`Check out this artifact: ${e}`,url:x}),Fe.success("Shared successfully!")}catch{}else try{await navigator.clipboard.writeText(x),Fe.success("Link copied to clipboard!")}catch{Fe.error("Failed to copy link")}};return _.jsxs("div",{className:"space-y-4",children:[_.jsx("div",{className:"flex justify-center",children:_.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-gray-200 inline-block",children:_.jsx("canvas",{ref:r})})}),_.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[_.jsxs("button",{onClick:h,className:"btn btn-outline btn-sm flex items-center gap-2",title:"Download QR Code",children:[_.jsx(D7,{className:"w-4 h-4"}),"Download"]}),_.jsxs("button",{onClick:f,className:"btn btn-outline btn-sm flex items-center gap-2",title:"Print QR Code",children:[_.jsx(L7,{className:"w-4 h-4"}),"Print"]}),_.jsxs("button",{onClick:m,className:"btn btn-outline btn-sm flex items-center gap-2",title:"Share Link",children:[_.jsx(U7,{className:"w-4 h-4"}),"Share"]})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("p",{className:"text-xs text-gray-500",children:"Scan this QR code to view artifact details"}),_.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["ID: ",t]})]})]})},BF=()=>{const{id:t}=PT(),e=ir(),{user:n}=ni(),[r,i]=ne.useState(null),[s,l]=ne.useState(!0),[h,f]=ne.useState(!1),[m,x]=ne.useState(!1);ne.useEffect(()=>{(async()=>{if(t)try{l(!0);const N=await FR(t);N?i(N):(Fe.error("Artifact not found"),e("/artifacts"))}catch(N){console.error("Error loading artifact:",N),Fe.error("Failed to load artifact")}finally{l(!1)}})()},[t,e]);const E=async()=>{if(!(!t||!r||!window.confirm(`Are you sure you want to delete "${r.name}"? This action cannot be undone.`)))try{f(!0),await kF(t),Fe.success("Artifact deleted successfully"),e("/artifacts")}catch(N){console.error("Error deleting artifact:",N),Fe.error(N.message||"Failed to delete artifact")}finally{f(!1)}};return s?_.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:_.jsx(uf,{text:"Loading artifact..."})}):r?_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e("/artifacts"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Artifacts"]}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsxs("div",{className:"flex justify-between items-start mb-6",children:[_.jsxs("div",{children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:r.name}),_.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-800",children:r.artifactType})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>x(!m),className:"btn btn-outline btn-sm",title:"Show QR Code",children:_.jsx(F7,{className:"w-4 h-4"})}),n&&(n.id===r.createdBy||n.role==="admin")&&_.jsxs(_.Fragment,{children:[_.jsx("button",{onClick:()=>e(`/artifacts/${t}/edit`),className:"btn btn-outline btn-sm",title:"Edit artifact",children:_.jsx(O7,{className:"w-4 h-4"})}),n.role==="admin"&&_.jsx("button",{onClick:E,disabled:h,className:"btn btn-danger btn-sm",title:"Delete artifact",children:h?_.jsx("span",{className:"animate-spin",children:""}):_.jsx(Ww,{className:"w-4 h-4"})})]})]})]}),m&&_.jsxs("div",{className:"mb-6 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 text-center",children:"QR Code"}),_.jsx(VF,{artifactId:t,artifactName:r.name})]}),r.description&&_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Description"}),_.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:r.description})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx(wR,{className:"w-5 h-5 text-gray-400 mt-1"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Discovery Date"}),_.jsx("p",{className:"text-gray-900",children:r.discoveryDate})]})]}),_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx(kv,{className:"w-5 h-5 text-gray-400 mt-1"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Discovery Site"}),_.jsx("p",{className:"text-gray-900",children:r.discoverySite})]})]}),_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx(Hw,{className:"w-5 h-5 text-gray-400 mt-1"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Current Location"}),_.jsx("p",{className:"text-gray-900",children:r.location})]})]}),r.gpsCoordinates&&_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx(kv,{className:"w-5 h-5 text-gray-400 mt-1"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"GPS Coordinates"}),_.jsxs("p",{className:"text-gray-900",children:[r.gpsCoordinates.latitude,", ",r.gpsCoordinates.longitude]})]})]})]}),r.notes&&_.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Notes"}),_.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:r.notes})]}),_.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 text-sm text-gray-500",children:[_.jsxs("p",{children:["Created: ",new Date(r.createdAt).toLocaleString()]}),_.jsxs("p",{children:["Last updated: ",new Date(r.updatedAt).toLocaleString()]})]})]})})]})}):_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:_.jsx("p",{className:"text-gray-600",children:"Artifact not found"})})})};var Ne;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ne||(Ne={}));var Vv=new Map([[Ne.QR_CODE,"QR_CODE"],[Ne.AZTEC,"AZTEC"],[Ne.CODABAR,"CODABAR"],[Ne.CODE_39,"CODE_39"],[Ne.CODE_93,"CODE_93"],[Ne.CODE_128,"CODE_128"],[Ne.DATA_MATRIX,"DATA_MATRIX"],[Ne.MAXICODE,"MAXICODE"],[Ne.ITF,"ITF"],[Ne.EAN_13,"EAN_13"],[Ne.EAN_8,"EAN_8"],[Ne.PDF_417,"PDF_417"],[Ne.RSS_14,"RSS_14"],[Ne.RSS_EXPANDED,"RSS_EXPANDED"],[Ne.UPC_A,"UPC_A"],[Ne.UPC_E,"UPC_E"],[Ne.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Bv;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(Bv||(Bv={}));function UF(t){return Object.values(Ne).includes(t)}var D1;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(D1||(D1={}));var jF=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[D1.SCAN_TYPE_CAMERA,D1.SCAN_TYPE_FILE],t}(),BR=function(){function t(e,n){this.format=e,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(e){if(!Vv.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new t(e,Vv.get(e))},t}(),Uv=function(){function t(){}return t.createFromText=function(e){var n={text:e};return{decodedText:e,result:n}},t.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},t}(),Ty;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Ty||(Ty={}));var zF=function(){function t(){}return t.createFrom=function(e){return{errorMessage:e,type:Ty.UNKWOWN_ERROR}},t}(),GF=function(){function t(e){this.verbose=e}return t.prototype.log=function(e){this.verbose&&console.log(e)},t.prototype.warn=function(e){this.verbose&&console.warn(e)},t.prototype.logError=function(e,n){(this.verbose||n===!0)&&console.error(e)},t.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},t}();function $s(t){return typeof t>"u"||t===null}var Nc=function(){function t(){}return t.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},t.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),UR=function(){function t(){}return t.isMediaStreamConstraintsValid=function(e,n){if(typeof e!="object"){var r=typeof e;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],s=new Set(i),l=Object.keys(e),h=0,f=l;h<f.length;h++){var m=f[h];if(s.has(m))return n.logError("".concat(m," is not supported videoConstaints."),!0),!1}return!0},t}(),Cy={exports:{}};(function(t,e){(function(n,r){r(e)})(rh,function(n){function r(S){return S==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,o){S.__proto__=o}||function(S,o){for(var a in o)o.hasOwnProperty(a)&&(S[a]=o[a])};function s(S,o){i(S,o);function a(){this.constructor=S}S.prototype=o===null?Object.create(o):(a.prototype=o.prototype,new a)}function l(S,o){var a=Object.setPrototypeOf;a?a(S,o):S.__proto__=o}function h(S,o){o===void 0&&(o=S.constructor);var a=Error.captureStackTrace;a&&a(S,o)}var f=function(S){s(o,S);function o(a){var c=this.constructor,u=S.call(this,a)||this;return Object.defineProperty(u,"name",{value:c.name,enumerable:!1}),l(u,c.prototype),h(u),u}return o}(Error);class m extends f{constructor(o=void 0){super(o),this.message=o}getKind(){return this.constructor.kind}}m.kind="Exception";class x extends m{}x.kind="ArgumentException";class E extends m{}E.kind="IllegalArgumentException";class A{constructor(o){if(this.binarizer=o,o===null)throw new E("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(o,a){return this.binarizer.getBlackRow(o,a)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(o,a,c,u){const d=this.binarizer.getLuminanceSource().crop(o,a,c,u);return new A(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const o=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new A(this.binarizer.createBinarizer(o))}rotateCounterClockwise45(){const o=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new A(this.binarizer.createBinarizer(o))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class N extends m{static getChecksumInstance(){return new N}}N.kind="ChecksumException";class U{constructor(o){this.source=o}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class D{static arraycopy(o,a,c,u,d){for(;d--;)c[u++]=o[a++]}static currentTimeMillis(){return Date.now()}}class G extends m{}G.kind="IndexOutOfBoundsException";class M extends G{constructor(o=void 0,a=void 0){super(a),this.index=o,this.message=a}}M.kind="ArrayIndexOutOfBoundsException";class b{static fill(o,a){for(let c=0,u=o.length;c<u;c++)o[c]=a}static fillWithin(o,a,c,u){b.rangeCheck(o.length,a,c);for(let d=a;d<c;d++)o[d]=u}static rangeCheck(o,a,c){if(a>c)throw new E("fromIndex("+a+") > toIndex("+c+")");if(a<0)throw new M(a);if(c>o)throw new M(c)}static asList(...o){return o}static create(o,a,c){return Array.from({length:o}).map(d=>Array.from({length:a}).fill(c))}static createInt32Array(o,a,c){return Array.from({length:o}).map(d=>Int32Array.from({length:a}).fill(c))}static equals(o,a){if(!o||!a||!o.length||!a.length||o.length!==a.length)return!1;for(let c=0,u=o.length;c<u;c++)if(o[c]!==a[c])return!1;return!0}static hashCode(o){if(o===null)return 0;let a=1;for(const c of o)a=31*a+c;return a}static fillUint8Array(o,a){for(let c=0;c!==o.length;c++)o[c]=a}static copyOf(o,a){return o.slice(0,a)}static copyOfUint8Array(o,a){if(o.length<=a){const c=new Uint8Array(a);return c.set(o),c}return o.slice(0,a)}static copyOfRange(o,a,c){const u=c-a,d=new Int32Array(u);return D.arraycopy(o,a,d,0,u),d}static binarySearch(o,a,c){c===void 0&&(c=b.numberComparator);let u=0,d=o.length-1;for(;u<=d;){const g=d+u>>1,y=c(a,o[g]);if(y>0)u=g+1;else if(y<0)d=g-1;else return g}return-u-1}static numberComparator(o,a){return o-a}}class P{static numberOfTrailingZeros(o){let a;if(o===0)return 32;let c=31;return a=o<<16,a!==0&&(c-=16,o=a),a=o<<8,a!==0&&(c-=8,o=a),a=o<<4,a!==0&&(c-=4,o=a),a=o<<2,a!==0&&(c-=2,o=a),c-(o<<1>>>31)}static numberOfLeadingZeros(o){if(o===0)return 32;let a=1;return o>>>16||(a+=16,o<<=16),o>>>24||(a+=8,o<<=8),o>>>28||(a+=4,o<<=4),o>>>30||(a+=2,o<<=2),a-=o>>>31,a}static toHexString(o){return o.toString(16)}static toBinaryString(o){return String(parseInt(String(o),2))}static bitCount(o){return o=o-(o>>>1&1431655765),o=(o&858993459)+(o>>>2&858993459),o=o+(o>>>4)&252645135,o=o+(o>>>8),o=o+(o>>>16),o&63}static truncDivision(o,a){return Math.trunc(o/a)}static parseInt(o,a=void 0){return parseInt(o,a)}}P.MIN_VALUE_32_BITS=-2147483648,P.MAX_VALUE=Number.MAX_SAFE_INTEGER;class V{constructor(o,a){o===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=o,a==null?this.bits=V.makeArray(o):this.bits=a)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(o){if(o>this.bits.length*32){const a=V.makeArray(o);D.arraycopy(this.bits,0,a,0,this.bits.length),this.bits=a}}get(o){return(this.bits[Math.floor(o/32)]&1<<(o&31))!==0}set(o){this.bits[Math.floor(o/32)]|=1<<(o&31)}flip(o){this.bits[Math.floor(o/32)]^=1<<(o&31)}getNextSet(o){const a=this.size;if(o>=a)return a;const c=this.bits;let u=Math.floor(o/32),d=c[u];d&=~((1<<(o&31))-1);const g=c.length;for(;d===0;){if(++u===g)return a;d=c[u]}const y=u*32+P.numberOfTrailingZeros(d);return y>a?a:y}getNextUnset(o){const a=this.size;if(o>=a)return a;const c=this.bits;let u=Math.floor(o/32),d=~c[u];d&=~((1<<(o&31))-1);const g=c.length;for(;d===0;){if(++u===g)return a;d=~c[u]}const y=u*32+P.numberOfTrailingZeros(d);return y>a?a:y}setBulk(o,a){this.bits[Math.floor(o/32)]=a}setRange(o,a){if(a<o||o<0||a>this.size)throw new E;if(a===o)return;a--;const c=Math.floor(o/32),u=Math.floor(a/32),d=this.bits;for(let g=c;g<=u;g++){const y=g>c?0:o&31,v=(2<<(g<u?31:a&31))-(1<<y);d[g]|=v}}clear(){const o=this.bits.length,a=this.bits;for(let c=0;c<o;c++)a[c]=0}isRange(o,a,c){if(a<o||o<0||a>this.size)throw new E;if(a===o)return!0;a--;const u=Math.floor(o/32),d=Math.floor(a/32),g=this.bits;for(let y=u;y<=d;y++){const w=y>u?0:o&31,T=(2<<(y<d?31:a&31))-(1<<w)&4294967295;if((g[y]&T)!==(c?T:0))return!1}return!0}appendBit(o){this.ensureCapacity(this.size+1),o&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(o,a){if(a<0||a>32)throw new E("Num bits must be between 0 and 32");this.ensureCapacity(this.size+a);for(let c=a;c>0;c--)this.appendBit((o>>c-1&1)===1)}appendBitArray(o){const a=o.size;this.ensureCapacity(this.size+a);for(let c=0;c<a;c++)this.appendBit(o.get(c))}xor(o){if(this.size!==o.size)throw new E("Sizes don't match");const a=this.bits;for(let c=0,u=a.length;c<u;c++)a[c]^=o.bits[c]}toBytes(o,a,c,u){for(let d=0;d<u;d++){let g=0;for(let y=0;y<8;y++)this.get(o)&&(g|=1<<7-y),o++;a[c+d]=g}}getBitArray(){return this.bits}reverse(){const o=new Int32Array(this.bits.length),a=Math.floor((this.size-1)/32),c=a+1,u=this.bits;for(let d=0;d<c;d++){let g=u[d];g=g>>1&1431655765|(g&1431655765)<<1,g=g>>2&858993459|(g&858993459)<<2,g=g>>4&252645135|(g&252645135)<<4,g=g>>8&16711935|(g&16711935)<<8,g=g>>16&65535|(g&65535)<<16,o[a-d]=g}if(this.size!==c*32){const d=c*32-this.size;let g=o[0]>>>d;for(let y=1;y<c;y++){const w=o[y];g|=w<<32-d,o[y-1]=g,g=w>>>d}o[c-1]=g}this.bits=o}static makeArray(o){return new Int32Array(Math.floor((o+31)/32))}equals(o){if(!(o instanceof V))return!1;const a=o;return this.size===a.size&&b.equals(this.bits,a.bits)}hashCode(){return 31*this.size+b.hashCode(this.bits)}toString(){let o="";for(let a=0,c=this.size;a<c;a++)a&7||(o+=" "),o+=this.get(a)?"X":".";return o}clone(){return new V(this.size,this.bits.slice())}}var $;(function(S){S[S.OTHER=0]="OTHER",S[S.PURE_BARCODE=1]="PURE_BARCODE",S[S.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",S[S.TRY_HARDER=3]="TRY_HARDER",S[S.CHARACTER_SET=4]="CHARACTER_SET",S[S.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",S[S.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",S[S.ASSUME_GS1=7]="ASSUME_GS1",S[S.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",S[S.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",S[S.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})($||($={}));var J=$;class k extends m{static getFormatInstance(){return new k}}k.kind="FormatException";var L;(function(S){S[S.Cp437=0]="Cp437",S[S.ISO8859_1=1]="ISO8859_1",S[S.ISO8859_2=2]="ISO8859_2",S[S.ISO8859_3=3]="ISO8859_3",S[S.ISO8859_4=4]="ISO8859_4",S[S.ISO8859_5=5]="ISO8859_5",S[S.ISO8859_6=6]="ISO8859_6",S[S.ISO8859_7=7]="ISO8859_7",S[S.ISO8859_8=8]="ISO8859_8",S[S.ISO8859_9=9]="ISO8859_9",S[S.ISO8859_10=10]="ISO8859_10",S[S.ISO8859_11=11]="ISO8859_11",S[S.ISO8859_13=12]="ISO8859_13",S[S.ISO8859_14=13]="ISO8859_14",S[S.ISO8859_15=14]="ISO8859_15",S[S.ISO8859_16=15]="ISO8859_16",S[S.SJIS=16]="SJIS",S[S.Cp1250=17]="Cp1250",S[S.Cp1251=18]="Cp1251",S[S.Cp1252=19]="Cp1252",S[S.Cp1256=20]="Cp1256",S[S.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",S[S.UTF8=22]="UTF8",S[S.ASCII=23]="ASCII",S[S.Big5=24]="Big5",S[S.GB18030=25]="GB18030",S[S.EUC_KR=26]="EUC_KR"})(L||(L={}));class F{constructor(o,a,c,...u){this.valueIdentifier=o,this.name=c,typeof a=="number"?this.values=Int32Array.from([a]):this.values=a,this.otherEncodingNames=u,F.VALUE_IDENTIFIER_TO_ECI.set(o,this),F.NAME_TO_ECI.set(c,this);const d=this.values;for(let g=0,y=d.length;g!==y;g++){const w=d[g];F.VALUES_TO_ECI.set(w,this)}for(const g of u)F.NAME_TO_ECI.set(g,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(o){if(o<0||o>=900)throw new k("incorect value");const a=F.VALUES_TO_ECI.get(o);if(a===void 0)throw new k("incorect value");return a}static getCharacterSetECIByName(o){const a=F.NAME_TO_ECI.get(o);if(a===void 0)throw new k("incorect value");return a}equals(o){if(!(o instanceof F))return!1;const a=o;return this.getName()===a.getName()}}F.VALUE_IDENTIFIER_TO_ECI=new Map,F.VALUES_TO_ECI=new Map,F.NAME_TO_ECI=new Map,F.Cp437=new F(L.Cp437,Int32Array.from([0,2]),"Cp437"),F.ISO8859_1=new F(L.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),F.ISO8859_2=new F(L.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),F.ISO8859_3=new F(L.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),F.ISO8859_4=new F(L.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),F.ISO8859_5=new F(L.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),F.ISO8859_6=new F(L.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),F.ISO8859_7=new F(L.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),F.ISO8859_8=new F(L.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),F.ISO8859_9=new F(L.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),F.ISO8859_10=new F(L.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),F.ISO8859_11=new F(L.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),F.ISO8859_13=new F(L.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),F.ISO8859_14=new F(L.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),F.ISO8859_15=new F(L.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),F.ISO8859_16=new F(L.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),F.SJIS=new F(L.SJIS,20,"SJIS","Shift_JIS"),F.Cp1250=new F(L.Cp1250,21,"Cp1250","windows-1250"),F.Cp1251=new F(L.Cp1251,22,"Cp1251","windows-1251"),F.Cp1252=new F(L.Cp1252,23,"Cp1252","windows-1252"),F.Cp1256=new F(L.Cp1256,24,"Cp1256","windows-1256"),F.UnicodeBigUnmarked=new F(L.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),F.UTF8=new F(L.UTF8,26,"UTF8","UTF-8"),F.ASCII=new F(L.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),F.Big5=new F(L.Big5,28,"Big5"),F.GB18030=new F(L.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),F.EUC_KR=new F(L.EUC_KR,30,"EUC_KR","EUC-KR");class H extends m{}H.kind="UnsupportedOperationException";class K{static decode(o,a){const c=this.encodingName(a);return this.customDecoder?this.customDecoder(o,c):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(c)?this.decodeFallback(o,c):new TextDecoder(c).decode(o)}static shouldDecodeOnFallback(o){return!K.isBrowser()&&o==="ISO-8859-1"}static encode(o,a){const c=this.encodingName(a);return this.customEncoder?this.customEncoder(o,c):typeof TextEncoder>"u"?this.encodeFallback(o):new TextEncoder().encode(o)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(o){return typeof o=="string"?o:o.getName()}static encodingCharacterSet(o){return o instanceof F?o:F.getCharacterSetECIByName(o)}static decodeFallback(o,a){const c=this.encodingCharacterSet(a);if(K.isDecodeFallbackSupported(c)){let u="";for(let d=0,g=o.length;d<g;d++){let y=o[d].toString(16);y.length<2&&(y="0"+y),u+="%"+y}return decodeURIComponent(u)}if(c.equals(F.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(o.buffer));throw new H(`Encoding ${this.encodingName(a)} not supported by fallback.`)}static isDecodeFallbackSupported(o){return o.equals(F.UTF8)||o.equals(F.ISO8859_1)||o.equals(F.ASCII)}static encodeFallback(o){const c=btoa(unescape(encodeURIComponent(o))).split(""),u=[];for(let d=0;d<c.length;d++)u.push(c[d].charCodeAt(0));return new Uint8Array(u)}}class W{static castAsNonUtf8Char(o,a=null){const c=a?a.getName():this.ISO88591;return K.decode(new Uint8Array([o]),c)}static guessEncoding(o,a){if(a!=null&&a.get(J.CHARACTER_SET)!==void 0)return a.get(J.CHARACTER_SET).toString();const c=o.length;let u=!0,d=!0,g=!0,y=0,w=0,v=0,T=0,R=0,O=0,q=0,Y=0,Z=0,ie=0,ce=0;const we=o.length>3&&o[0]===239&&o[1]===187&&o[2]===191;for(let _e=0;_e<c&&(u||d||g);_e++){const me=o[_e]&255;g&&(y>0?me&128?y--:g=!1:me&128&&(me&64?(y++,me&32?(y++,me&16?(y++,me&8?g=!1:T++):v++):w++):g=!1)),u&&(me>127&&me<160?u=!1:me>159&&(me<192||me===215||me===247)&&ce++),d&&(R>0?me<64||me===127||me>252?d=!1:R--:me===128||me===160||me>239?d=!1:me>160&&me<224?(O++,Y=0,q++,q>Z&&(Z=q)):me>127?(R++,q=0,Y++,Y>ie&&(ie=Y)):(q=0,Y=0))}return g&&y>0&&(g=!1),d&&R>0&&(d=!1),g&&(we||w+v+T>0)?W.UTF8:d&&(W.ASSUME_SHIFT_JIS||Z>=3||ie>=3)?W.SHIFT_JIS:u&&d?Z===2&&O===2||ce*10>=c?W.SHIFT_JIS:W.ISO88591:u?W.ISO88591:d?W.SHIFT_JIS:g?W.UTF8:W.PLATFORM_DEFAULT_ENCODING}static format(o,...a){let c=-1;function u(g,y,w,v,T,R){if(g==="%%")return"%";if(a[++c]===void 0)return;g=v?parseInt(v.substr(1)):void 0;let O=T?parseInt(T.substr(1)):void 0,q;switch(R){case"s":q=a[c];break;case"c":q=a[c][0];break;case"f":q=parseFloat(a[c]).toFixed(g);break;case"p":q=parseFloat(a[c]).toPrecision(g);break;case"e":q=parseFloat(a[c]).toExponential(g);break;case"x":q=parseInt(a[c]).toString(O||16);break;case"d":q=parseFloat(parseInt(a[c],O||10).toPrecision(g)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(O);let Y=parseInt(w),Z=w&&w[0]+""=="0"?"0":" ";for(;q.length<Y;)q=y!==void 0?q+Z:Z+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return o.replace(d,u)}static getBytes(o,a){return K.encode(o,a)}static getCharCode(o,a=0){return o.charCodeAt(a)}static getCharAt(o){return String.fromCharCode(o)}}W.SHIFT_JIS=F.SJIS.getName(),W.GB2312="GB2312",W.ISO88591=F.ISO8859_1.getName(),W.EUC_JP="EUC_JP",W.UTF8=F.UTF8.getName(),W.PLATFORM_DEFAULT_ENCODING=W.UTF8,W.ASSUME_SHIFT_JIS=!1;class z{constructor(o=""){this.value=o}enableDecoding(o){return this.encoding=o,this}append(o){return typeof o=="string"?this.value+=o.toString():this.encoding?this.value+=W.castAsNonUtf8Char(o,this.encoding):this.value+=String.fromCharCode(o),this}appendChars(o,a,c){for(let u=a;a<a+c;u++)this.append(o[u]);return this}length(){return this.value.length}charAt(o){return this.value.charAt(o)}deleteCharAt(o){this.value=this.value.substr(0,o)+this.value.substring(o+1)}setCharAt(o,a){this.value=this.value.substr(0,o)+a+this.value.substr(o+1)}substring(o,a){return this.value.substring(o,a)}setLengthToZero(){this.value=""}toString(){return this.value}insert(o,a){this.value=this.value.substr(0,o)+a+this.value.substr(o+a.length)}}class Ge{constructor(o,a,c,u){if(this.width=o,this.height=a,this.rowSize=c,this.bits=u,a==null&&(a=o),this.height=a,o<1||a<1)throw new E("Both dimensions must be greater than 0");c==null&&(c=Math.floor((o+31)/32)),this.rowSize=c,u==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(o){const a=o.length,c=o[0].length,u=new Ge(c,a);for(let d=0;d<a;d++){const g=o[d];for(let y=0;y<c;y++)g[y]&&u.set(y,d)}return u}static parseFromString(o,a,c){if(o===null)throw new E("stringRepresentation cannot be null");const u=new Array(o.length);let d=0,g=0,y=-1,w=0,v=0;for(;v<o.length;)if(o.charAt(v)===`
`||o.charAt(v)==="\r"){if(d>g){if(y===-1)y=d-g;else if(d-g!==y)throw new E("row lengths do not match");g=d,w++}v++}else if(o.substring(v,v+a.length)===a)v+=a.length,u[d]=!0,d++;else if(o.substring(v,v+c.length)===c)v+=c.length,u[d]=!1,d++;else throw new E("illegal character encountered: "+o.substring(v));if(d>g){if(y===-1)y=d-g;else if(d-g!==y)throw new E("row lengths do not match");w++}const T=new Ge(y,w);for(let R=0;R<d;R++)u[R]&&T.set(Math.floor(R%y),Math.floor(R/y));return T}get(o,a){const c=a*this.rowSize+Math.floor(o/32);return(this.bits[c]>>>(o&31)&1)!==0}set(o,a){const c=a*this.rowSize+Math.floor(o/32);this.bits[c]|=1<<(o&31)&4294967295}unset(o,a){const c=a*this.rowSize+Math.floor(o/32);this.bits[c]&=~(1<<(o&31)&4294967295)}flip(o,a){const c=a*this.rowSize+Math.floor(o/32);this.bits[c]^=1<<(o&31)&4294967295}xor(o){if(this.width!==o.getWidth()||this.height!==o.getHeight()||this.rowSize!==o.getRowSize())throw new E("input matrix dimensions do not match");const a=new V(Math.floor(this.width/32)+1),c=this.rowSize,u=this.bits;for(let d=0,g=this.height;d<g;d++){const y=d*c,w=o.getRow(d,a).getBitArray();for(let v=0;v<c;v++)u[y+v]^=w[v]}}clear(){const o=this.bits,a=o.length;for(let c=0;c<a;c++)o[c]=0}setRegion(o,a,c,u){if(a<0||o<0)throw new E("Left and top must be nonnegative");if(u<1||c<1)throw new E("Height and width must be at least 1");const d=o+c,g=a+u;if(g>this.height||d>this.width)throw new E("The region must fit inside the matrix");const y=this.rowSize,w=this.bits;for(let v=a;v<g;v++){const T=v*y;for(let R=o;R<d;R++)w[T+Math.floor(R/32)]|=1<<(R&31)&4294967295}}getRow(o,a){a==null||a.getSize()<this.width?a=new V(this.width):a.clear();const c=this.rowSize,u=this.bits,d=o*c;for(let g=0;g<c;g++)a.setBulk(g*32,u[d+g]);return a}setRow(o,a){D.arraycopy(a.getBitArray(),0,this.bits,o*this.rowSize,this.rowSize)}rotate180(){const o=this.getWidth(),a=this.getHeight();let c=new V(o),u=new V(o);for(let d=0,g=Math.floor((a+1)/2);d<g;d++)c=this.getRow(d,c),u=this.getRow(a-1-d,u),c.reverse(),u.reverse(),this.setRow(d,u),this.setRow(a-1-d,c)}getEnclosingRectangle(){const o=this.width,a=this.height,c=this.rowSize,u=this.bits;let d=o,g=a,y=-1,w=-1;for(let v=0;v<a;v++)for(let T=0;T<c;T++){const R=u[v*c+T];if(R!==0){if(v<g&&(g=v),v>w&&(w=v),T*32<d){let O=0;for(;!(R<<31-O&4294967295);)O++;T*32+O<d&&(d=T*32+O)}if(T*32+31>y){let O=31;for(;!(R>>>O);)O--;T*32+O>y&&(y=T*32+O)}}}return y<d||w<g?null:Int32Array.from([d,g,y-d+1,w-g+1])}getTopLeftOnBit(){const o=this.rowSize,a=this.bits;let c=0;for(;c<a.length&&a[c]===0;)c++;if(c===a.length)return null;const u=c/o;let d=c%o*32;const g=a[c];let y=0;for(;!(g<<31-y&4294967295);)y++;return d+=y,Int32Array.from([d,u])}getBottomRightOnBit(){const o=this.rowSize,a=this.bits;let c=a.length-1;for(;c>=0&&a[c]===0;)c--;if(c<0)return null;const u=Math.floor(c/o);let d=Math.floor(c%o)*32;const g=a[c];let y=31;for(;!(g>>>y);)y--;return d+=y,Int32Array.from([d,u])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(o){if(!(o instanceof Ge))return!1;const a=o;return this.width===a.width&&this.height===a.height&&this.rowSize===a.rowSize&&b.equals(this.bits,a.bits)}hashCode(){let o=this.width;return o=31*o+this.width,o=31*o+this.height,o=31*o+this.rowSize,o=31*o+b.hashCode(this.bits),o}toString(o="X ",a="  ",c=`
`){return this.buildToString(o,a,c)}buildToString(o,a,c){let u=new z;for(let d=0,g=this.height;d<g;d++){for(let y=0,w=this.width;y<w;y++)u.append(this.get(y,d)?o:a);u.append(c)}return u.toString()}clone(){return new Ge(this.width,this.height,this.rowSize,this.bits.slice())}}class se extends m{static getNotFoundInstance(){return new se}}se.kind="NotFoundException";class rt extends U{constructor(o){super(o),this.luminances=rt.EMPTY,this.buckets=new Int32Array(rt.LUMINANCE_BUCKETS)}getBlackRow(o,a){const c=this.getLuminanceSource(),u=c.getWidth();a==null||a.getSize()<u?a=new V(u):a.clear(),this.initArrays(u);const d=c.getRow(o,this.luminances),g=this.buckets;for(let w=0;w<u;w++)g[(d[w]&255)>>rt.LUMINANCE_SHIFT]++;const y=rt.estimateBlackPoint(g);if(u<3)for(let w=0;w<u;w++)(d[w]&255)<y&&a.set(w);else{let w=d[0]&255,v=d[1]&255;for(let T=1;T<u-1;T++){const R=d[T+1]&255;(v*4-w-R)/2<y&&a.set(T),w=v,v=R}}return a}getBlackMatrix(){const o=this.getLuminanceSource(),a=o.getWidth(),c=o.getHeight(),u=new Ge(a,c);this.initArrays(a);const d=this.buckets;for(let w=1;w<5;w++){const v=Math.floor(c*w/5),T=o.getRow(v,this.luminances),R=Math.floor(a*4/5);for(let O=Math.floor(a/5);O<R;O++){const q=T[O]&255;d[q>>rt.LUMINANCE_SHIFT]++}}const g=rt.estimateBlackPoint(d),y=o.getMatrix();for(let w=0;w<c;w++){const v=w*a;for(let T=0;T<a;T++)(y[v+T]&255)<g&&u.set(T,w)}return u}createBinarizer(o){return new rt(o)}initArrays(o){this.luminances.length<o&&(this.luminances=new Uint8ClampedArray(o));const a=this.buckets;for(let c=0;c<rt.LUMINANCE_BUCKETS;c++)a[c]=0}static estimateBlackPoint(o){const a=o.length;let c=0,u=0,d=0;for(let T=0;T<a;T++)o[T]>d&&(u=T,d=o[T]),o[T]>c&&(c=o[T]);let g=0,y=0;for(let T=0;T<a;T++){const R=T-u,O=o[T]*R*R;O>y&&(g=T,y=O)}if(u>g){const T=u;u=g,g=T}if(g-u<=a/16)throw new se;let w=g-1,v=-1;for(let T=g-1;T>u;T--){const R=T-u,O=R*R*(g-T)*(c-o[T]);O>v&&(w=T,v=O)}return w<<rt.LUMINANCE_SHIFT}}rt.LUMINANCE_BITS=5,rt.LUMINANCE_SHIFT=8-rt.LUMINANCE_BITS,rt.LUMINANCE_BUCKETS=1<<rt.LUMINANCE_BITS,rt.EMPTY=Uint8ClampedArray.from([0]);class Oe extends rt{constructor(o){super(o),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const o=this.getLuminanceSource(),a=o.getWidth(),c=o.getHeight();if(a>=Oe.MINIMUM_DIMENSION&&c>=Oe.MINIMUM_DIMENSION){const u=o.getMatrix();let d=a>>Oe.BLOCK_SIZE_POWER;a&Oe.BLOCK_SIZE_MASK&&d++;let g=c>>Oe.BLOCK_SIZE_POWER;c&Oe.BLOCK_SIZE_MASK&&g++;const y=Oe.calculateBlackPoints(u,d,g,a,c),w=new Ge(a,c);Oe.calculateThresholdForBlock(u,d,g,a,c,y,w),this.matrix=w}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(o){return new Oe(o)}static calculateThresholdForBlock(o,a,c,u,d,g,y){const w=d-Oe.BLOCK_SIZE,v=u-Oe.BLOCK_SIZE;for(let T=0;T<c;T++){let R=T<<Oe.BLOCK_SIZE_POWER;R>w&&(R=w);const O=Oe.cap(T,2,c-3);for(let q=0;q<a;q++){let Y=q<<Oe.BLOCK_SIZE_POWER;Y>v&&(Y=v);const Z=Oe.cap(q,2,a-3);let ie=0;for(let we=-2;we<=2;we++){const _e=g[O+we];ie+=_e[Z-2]+_e[Z-1]+_e[Z]+_e[Z+1]+_e[Z+2]}const ce=ie/25;Oe.thresholdBlock(o,Y,R,ce,u,y)}}}static cap(o,a,c){return o<a?a:o>c?c:o}static thresholdBlock(o,a,c,u,d,g){for(let y=0,w=c*d+a;y<Oe.BLOCK_SIZE;y++,w+=d)for(let v=0;v<Oe.BLOCK_SIZE;v++)(o[w+v]&255)<=u&&g.set(a+v,c+y)}static calculateBlackPoints(o,a,c,u,d){const g=d-Oe.BLOCK_SIZE,y=u-Oe.BLOCK_SIZE,w=new Array(c);for(let v=0;v<c;v++){w[v]=new Int32Array(a);let T=v<<Oe.BLOCK_SIZE_POWER;T>g&&(T=g);for(let R=0;R<a;R++){let O=R<<Oe.BLOCK_SIZE_POWER;O>y&&(O=y);let q=0,Y=255,Z=0;for(let ce=0,we=T*u+O;ce<Oe.BLOCK_SIZE;ce++,we+=u){for(let _e=0;_e<Oe.BLOCK_SIZE;_e++){const me=o[we+_e]&255;q+=me,me<Y&&(Y=me),me>Z&&(Z=me)}if(Z-Y>Oe.MIN_DYNAMIC_RANGE)for(ce++,we+=u;ce<Oe.BLOCK_SIZE;ce++,we+=u)for(let _e=0;_e<Oe.BLOCK_SIZE;_e++)q+=o[we+_e]&255}let ie=q>>Oe.BLOCK_SIZE_POWER*2;if(Z-Y<=Oe.MIN_DYNAMIC_RANGE&&(ie=Y/2,v>0&&R>0)){const ce=(w[v-1][R]+2*w[v][R-1]+w[v-1][R-1])/4;Y<ce&&(ie=ce)}w[v][R]=ie}}return w}}Oe.BLOCK_SIZE_POWER=3,Oe.BLOCK_SIZE=1<<Oe.BLOCK_SIZE_POWER,Oe.BLOCK_SIZE_MASK=Oe.BLOCK_SIZE-1,Oe.MINIMUM_DIMENSION=Oe.BLOCK_SIZE*5,Oe.MIN_DYNAMIC_RANGE=24;class Ie{constructor(o,a){this.width=o,this.height=a}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(o,a,c,u){throw new H("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new H("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new H("This luminance source does not support rotation by 45 degrees.")}toString(){const o=new Uint8ClampedArray(this.width);let a=new z;for(let c=0;c<this.height;c++){const u=this.getRow(c,o);for(let d=0;d<this.width;d++){const g=u[d]&255;let y;g<64?y="#":g<128?y="+":g<192?y=".":y=" ",a.append(y)}a.append(`
`)}return a.toString()}}class Me extends Ie{constructor(o){super(o.getWidth(),o.getHeight()),this.delegate=o}getRow(o,a){const c=this.delegate.getRow(o,a),u=this.getWidth();for(let d=0;d<u;d++)c[d]=255-(c[d]&255);return c}getMatrix(){const o=this.delegate.getMatrix(),a=this.getWidth()*this.getHeight(),c=new Uint8ClampedArray(a);for(let u=0;u<a;u++)c[u]=255-(o[u]&255);return c}isCropSupported(){return this.delegate.isCropSupported()}crop(o,a,c,u){return new Me(this.delegate.crop(o,a,c,u))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Me(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Me(this.delegate.rotateCounterClockwise45())}}class je extends Ie{constructor(o){super(o.width,o.height),this.canvas=o,this.tempCanvasElement=null,this.buffer=je.makeBufferFromCanvasImageData(o)}static makeBufferFromCanvasImageData(o){const a=o.getContext("2d").getImageData(0,0,o.width,o.height);return je.toGrayscaleBuffer(a.data,o.width,o.height)}static toGrayscaleBuffer(o,a,c){const u=new Uint8ClampedArray(a*c);for(let d=0,g=0,y=o.length;d<y;d+=4,g++){let w;if(o[d+3]===0)w=255;else{const T=o[d],R=o[d+1],O=o[d+2];w=306*T+601*R+117*O+512>>10}u[g]=w}return u}getRow(o,a){if(o<0||o>=this.getHeight())throw new E("Requested row is outside the image: "+o);const c=this.getWidth(),u=o*c;return a===null?a=this.buffer.slice(u,u+c):(a.length<c&&(a=new Uint8ClampedArray(c)),a.set(this.buffer.slice(u,u+c))),a}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(o,a,c,u){return super.crop(o,a,c,u),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const o=this.canvas.ownerDocument.createElement("canvas");o.width=this.canvas.width,o.height=this.canvas.height,this.tempCanvasElement=o}return this.tempCanvasElement}rotate(o){const a=this.getTempCanvasElement(),c=a.getContext("2d"),u=o*je.DEGREE_TO_RADIANS,d=this.canvas.width,g=this.canvas.height,y=Math.ceil(Math.abs(Math.cos(u))*d+Math.abs(Math.sin(u))*g),w=Math.ceil(Math.abs(Math.sin(u))*d+Math.abs(Math.cos(u))*g);return a.width=y,a.height=w,c.translate(y/2,w/2),c.rotate(u),c.drawImage(this.canvas,d/-2,g/-2),this.buffer=je.makeBufferFromCanvasImageData(a),this}invert(){return new Me(this)}}je.DEGREE_TO_RADIANS=Math.PI/180;class Rt{constructor(o,a,c){this.deviceId=o,this.label=a,this.kind="videoinput",this.groupId=c||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Xe=(globalThis||rh||self||window||void 0)&&(globalThis||rh||self||window||void 0).__awaiter||function(S,o,a,c){function u(d){return d instanceof a?d:new a(function(g){g(d)})}return new(a||(a=Promise))(function(d,g){function y(T){try{v(c.next(T))}catch(R){g(R)}}function w(T){try{v(c.throw(T))}catch(R){g(R)}}function v(T){T.done?d(T.value):u(T.value).then(y,w)}v((c=c.apply(S,o||[])).next())})};class Tt{constructor(o,a=500,c){this.reader=o,this.timeBetweenScansMillis=a,this._hints=c,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(o){this._timeBetweenDecodingAttempts=o<0?0:o}set hints(o){this._hints=o||null}get hints(){return this._hints}listVideoInputDevices(){return Xe(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const o=yield navigator.mediaDevices.enumerateDevices(),a=[];for(const c of o){const u=c.kind==="video"?"videoinput":c.kind;if(u!=="videoinput")continue;const d=c.deviceId||c.id,g=c.label||`Video device ${a.length+1}`,y=c.groupId,w={deviceId:d,label:g,kind:u,groupId:y};a.push(w)}return a})}getVideoInputDevices(){return Xe(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(a=>new Rt(a.deviceId,a.label))})}findDeviceById(o){return Xe(this,void 0,void 0,function*(){const a=yield this.listVideoInputDevices();return a?a.find(c=>c.deviceId===o):null})}decodeFromInputVideoDevice(o,a){return Xe(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(o,a)})}decodeOnceFromVideoDevice(o,a){return Xe(this,void 0,void 0,function*(){this.reset();let c;o?c={deviceId:{exact:o}}:c={facingMode:"environment"};const u={video:c};return yield this.decodeOnceFromConstraints(u,a)})}decodeOnceFromConstraints(o,a){return Xe(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(o);return yield this.decodeOnceFromStream(c,a)})}decodeOnceFromStream(o,a){return Xe(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(o,a);return yield this.decodeOnce(c)})}decodeFromInputVideoDeviceContinuously(o,a,c){return Xe(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(o,a,c)})}decodeFromVideoDevice(o,a,c){return Xe(this,void 0,void 0,function*(){let u;o?u={deviceId:{exact:o}}:u={facingMode:"environment"};const d={video:u};return yield this.decodeFromConstraints(d,a,c)})}decodeFromConstraints(o,a,c){return Xe(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(o);return yield this.decodeFromStream(u,a,c)})}decodeFromStream(o,a,c){return Xe(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(o,a);return yield this.decodeContinuously(u,c)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(o,a){return Xe(this,void 0,void 0,function*(){const c=this.prepareVideoElement(a);return this.addVideoSource(c,o),this.videoElement=c,this.stream=o,yield this.playVideoOnLoadAsync(c),c})}playVideoOnLoadAsync(o){return new Promise((a,c)=>this.playVideoOnLoad(o,()=>a()))}playVideoOnLoad(o,a){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(o),o.addEventListener("ended",this.videoEndedListener),o.addEventListener("canplay",this.videoCanPlayListener),o.addEventListener("playing",a),this.tryPlayVideo(o)}isVideoPlaying(o){return o.currentTime>0&&!o.paused&&!o.ended&&o.readyState>2}tryPlayVideo(o){return Xe(this,void 0,void 0,function*(){if(this.isVideoPlaying(o)){console.warn("Trying to play video that is already playing.");return}try{yield o.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(o,a){const c=document.getElementById(o);if(!c)throw new x(`element with id '${o}' not found`);if(c.nodeName.toLowerCase()!==a.toLowerCase())throw new x(`element with id '${o}' must be an ${a} element`);return c}decodeFromImage(o,a){if(!o&&!a)throw new x("either imageElement with a src set or an url must be provided");return a&&!o?this.decodeFromImageUrl(a):this.decodeFromImageElement(o)}decodeFromVideo(o,a){if(!o&&!a)throw new x("Either an element with a src set or an URL must be provided");return a&&!o?this.decodeFromVideoUrl(a):this.decodeFromVideoElement(o)}decodeFromVideoContinuously(o,a,c){if(o===void 0&&a===void 0)throw new x("Either an element with a src set or an URL must be provided");return a&&!o?this.decodeFromVideoUrlContinuously(a,c):this.decodeFromVideoElementContinuously(o,c)}decodeFromImageElement(o){if(!o)throw new x("An image element must be provided.");this.reset();const a=this.prepareImageElement(o);this.imageElement=a;let c;return this.isImageLoaded(a)?c=this.decodeOnce(a,!1,!0):c=this._decodeOnLoadImage(a),c}decodeFromVideoElement(o){const a=this._decodeFromVideoElementSetup(o);return this._decodeOnLoadVideo(a)}decodeFromVideoElementContinuously(o,a){const c=this._decodeFromVideoElementSetup(o);return this._decodeOnLoadVideoContinuously(c,a)}_decodeFromVideoElementSetup(o){if(!o)throw new x("A video element must be provided.");this.reset();const a=this.prepareVideoElement(o);return this.videoElement=a,a}decodeFromImageUrl(o){if(!o)throw new x("An URL must be provided.");this.reset();const a=this.prepareImageElement();this.imageElement=a;const c=this._decodeOnLoadImage(a);return a.src=o,c}decodeFromVideoUrl(o){if(!o)throw new x("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),c=this.decodeFromVideoElement(a);return a.src=o,c}decodeFromVideoUrlContinuously(o,a){if(!o)throw new x("An URL must be provided.");this.reset();const c=this.prepareVideoElement(),u=this.decodeFromVideoElementContinuously(c,a);return c.src=o,u}_decodeOnLoadImage(o){return new Promise((a,c)=>{this.imageLoadedListener=()=>this.decodeOnce(o,!1,!0).then(a,c),o.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(o){return Xe(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(o),yield this.decodeOnce(o)})}_decodeOnLoadVideoContinuously(o,a){return Xe(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(o),this.decodeContinuously(o,a)})}isImageLoaded(o){return!(!o.complete||o.naturalWidth===0)}prepareImageElement(o){let a;return typeof o>"u"&&(a=document.createElement("img"),a.width=200,a.height=200),typeof o=="string"&&(a=this.getMediaElement(o,"img")),o instanceof HTMLImageElement&&(a=o),a}prepareVideoElement(o){let a;return!o&&typeof document<"u"&&(a=document.createElement("video"),a.width=200,a.height=200),typeof o=="string"&&(a=this.getMediaElement(o,"video")),o instanceof HTMLVideoElement&&(a=o),a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),a.setAttribute("playsinline","true"),a}decodeOnce(o,a=!0,c=!0){this._stopAsyncDecode=!1;const u=(d,g)=>{if(this._stopAsyncDecode){g(new se("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const y=this.decode(o);d(y)}catch(y){const w=a&&y instanceof se,T=(y instanceof N||y instanceof k)&&c;if(w||T)return setTimeout(u,this._timeBetweenDecodingAttempts,d,g);g(y)}};return new Promise((d,g)=>u(d,g))}decodeContinuously(o,a){this._stopContinuousDecode=!1;const c=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const u=this.decode(o);a(u,null),setTimeout(c,this.timeBetweenScansMillis)}catch(u){a(null,u);const d=u instanceof N||u instanceof k,g=u instanceof se;(d||g)&&setTimeout(c,this._timeBetweenDecodingAttempts)}};c()}decode(o){const a=this.createBinaryBitmap(o);return this.decodeBitmap(a)}_isHTMLVideoElement(o){return o.videoWidth!==0}drawFrameOnCanvas(o,a,c){a||(a={sx:0,sy:0,sWidth:o.videoWidth,sHeight:o.videoHeight,dx:0,dy:0,dWidth:o.videoWidth,dHeight:o.videoHeight}),c||(c=this.captureCanvasContext),c.drawImage(o,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}drawImageOnCanvas(o,a,c=this.captureCanvasContext){a||(a={sx:0,sy:0,sWidth:o.naturalWidth,sHeight:o.naturalHeight,dx:0,dy:0,dWidth:o.naturalWidth,dHeight:o.naturalHeight}),c||(c=this.captureCanvasContext),c.drawImage(o,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}createBinaryBitmap(o){this.getCaptureCanvasContext(o),this._isHTMLVideoElement(o)?this.drawFrameOnCanvas(o):this.drawImageOnCanvas(o);const a=this.getCaptureCanvas(o),c=new je(a),u=new Oe(c);return new A(u)}getCaptureCanvasContext(o){if(!this.captureCanvasContext){const c=this.getCaptureCanvas(o).getContext("2d");this.captureCanvasContext=c}return this.captureCanvasContext}getCaptureCanvas(o){if(!this.captureCanvas){const a=this.createCaptureCanvas(o);this.captureCanvas=a}return this.captureCanvas}decodeBitmap(o){return this.reader.decode(o,this._hints)}createCaptureCanvas(o){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const a=document.createElement("canvas");let c,u;return typeof o<"u"&&(o instanceof HTMLVideoElement?(c=o.videoWidth,u=o.videoHeight):o instanceof HTMLImageElement&&(c=o.naturalWidth||o.width,u=o.naturalHeight||o.height)),a.style.width=c+"px",a.style.height=u+"px",a.width=c,a.height=u,a}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(o=>o.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(o,a){try{o.srcObject=a}catch{o.src=URL.createObjectURL(a)}}cleanVideoSource(o){try{o.srcObject=null}catch{o.src=""}this.videoElement.removeAttribute("src")}}class Bt{constructor(o,a,c=a==null?0:8*a.length,u,d,g=D.currentTimeMillis()){this.text=o,this.rawBytes=a,this.numBits=c,this.resultPoints=u,this.format=d,this.timestamp=g,this.text=o,this.rawBytes=a,c==null?this.numBits=a==null?0:8*a.length:this.numBits=c,this.resultPoints=u,this.format=d,this.resultMetadata=null,g==null?this.timestamp=D.currentTimeMillis():this.timestamp=g}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(o,a){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(o,a)}putAllMetadata(o){o!==null&&(this.resultMetadata===null?this.resultMetadata=o:this.resultMetadata=new Map(o))}addResultPoints(o){const a=this.resultPoints;if(a===null)this.resultPoints=o;else if(o!==null&&o.length>0){const c=new Array(a.length+o.length);D.arraycopy(a,0,c,0,a.length),D.arraycopy(o,0,c,a.length,o.length),this.resultPoints=c}}getTimestamp(){return this.timestamp}toString(){return this.text}}var mr;(function(S){S[S.AZTEC=0]="AZTEC",S[S.CODABAR=1]="CODABAR",S[S.CODE_39=2]="CODE_39",S[S.CODE_93=3]="CODE_93",S[S.CODE_128=4]="CODE_128",S[S.DATA_MATRIX=5]="DATA_MATRIX",S[S.EAN_8=6]="EAN_8",S[S.EAN_13=7]="EAN_13",S[S.ITF=8]="ITF",S[S.MAXICODE=9]="MAXICODE",S[S.PDF_417=10]="PDF_417",S[S.QR_CODE=11]="QR_CODE",S[S.RSS_14=12]="RSS_14",S[S.RSS_EXPANDED=13]="RSS_EXPANDED",S[S.UPC_A=14]="UPC_A",S[S.UPC_E=15]="UPC_E",S[S.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(mr||(mr={}));var ke=mr,Xn;(function(S){S[S.OTHER=0]="OTHER",S[S.ORIENTATION=1]="ORIENTATION",S[S.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",S[S.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",S[S.ISSUE_NUMBER=4]="ISSUE_NUMBER",S[S.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",S[S.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",S[S.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",S[S.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",S[S.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",S[S.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Xn||(Xn={}));var ln=Xn;class Ni{constructor(o,a,c,u,d=-1,g=-1){this.rawBytes=o,this.text=a,this.byteSegments=c,this.ecLevel=u,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=g,this.numBits=o==null?0:8*o.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(o){this.numBits=o}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(o){this.errorsCorrected=o}getErasures(){return this.erasures}setErasures(o){this.erasures=o}getOther(){return this.other}setOther(o){this.other=o}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Ur{exp(o){return this.expTable[o]}log(o){if(o===0)throw new E;return this.logTable[o]}static addOrSubtract(o,a){return o^a}}class Tn{constructor(o,a){if(a.length===0)throw new E;this.field=o;const c=a.length;if(c>1&&a[0]===0){let u=1;for(;u<c&&a[u]===0;)u++;u===c?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(c-u),D.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(o){return this.coefficients[this.coefficients.length-1-o]}evaluateAt(o){if(o===0)return this.getCoefficient(0);const a=this.coefficients;let c;if(o===1){c=0;for(let g=0,y=a.length;g!==y;g++){const w=a[g];c=Ur.addOrSubtract(c,w)}return c}c=a[0];const u=a.length,d=this.field;for(let g=1;g<u;g++)c=Ur.addOrSubtract(d.multiply(o,c),a[g]);return c}addOrSubtract(o){if(!this.field.equals(o.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero())return o;if(o.isZero())return this;let a=this.coefficients,c=o.coefficients;if(a.length>c.length){const g=a;a=c,c=g}let u=new Int32Array(c.length);const d=c.length-a.length;D.arraycopy(c,0,u,0,d);for(let g=d;g<c.length;g++)u[g]=Ur.addOrSubtract(a[g-d],c[g]);return new Tn(this.field,u)}multiply(o){if(!this.field.equals(o.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero()||o.isZero())return this.field.getZero();const a=this.coefficients,c=a.length,u=o.coefficients,d=u.length,g=new Int32Array(c+d-1),y=this.field;for(let w=0;w<c;w++){const v=a[w];for(let T=0;T<d;T++)g[w+T]=Ur.addOrSubtract(g[w+T],y.multiply(v,u[T]))}return new Tn(y,g)}multiplyScalar(o){if(o===0)return this.field.getZero();if(o===1)return this;const a=this.coefficients.length,c=this.field,u=new Int32Array(a),d=this.coefficients;for(let g=0;g<a;g++)u[g]=c.multiply(d[g],o);return new Tn(c,u)}multiplyByMonomial(o,a){if(o<0)throw new E;if(a===0)return this.field.getZero();const c=this.coefficients,u=c.length,d=new Int32Array(u+o),g=this.field;for(let y=0;y<u;y++)d[y]=g.multiply(c[y],a);return new Tn(g,d)}divide(o){if(!this.field.equals(o.field))throw new E("GenericGFPolys do not have same GenericGF field");if(o.isZero())throw new E("Divide by 0");const a=this.field;let c=a.getZero(),u=this;const d=o.getCoefficient(o.getDegree()),g=a.inverse(d);for(;u.getDegree()>=o.getDegree()&&!u.isZero();){const y=u.getDegree()-o.getDegree(),w=a.multiply(u.getCoefficient(u.getDegree()),g),v=o.multiplyByMonomial(y,w),T=a.buildMonomial(y,w);c=c.addOrSubtract(T),u=u.addOrSubtract(v)}return[c,u]}toString(){let o="";for(let a=this.getDegree();a>=0;a--){let c=this.getCoefficient(a);if(c!==0){if(c<0?(o+=" - ",c=-c):o.length>0&&(o+=" + "),a===0||c!==1){const u=this.field.log(c);u===0?o+="1":u===1?o+="a":(o+="a^",o+=u)}a!==0&&(a===1?o+="x":(o+="x^",o+=a))}}return o}}class Pi extends m{}Pi.kind="ArithmeticException";class ot extends Ur{constructor(o,a,c){super(),this.primitive=o,this.size=a,this.generatorBase=c;const u=new Int32Array(a);let d=1;for(let y=0;y<a;y++)u[y]=d,d*=2,d>=a&&(d^=o,d&=a-1);this.expTable=u;const g=new Int32Array(a);for(let y=0;y<a-1;y++)g[u[y]]=y;this.logTable=g,this.zero=new Tn(this,Int32Array.from([0])),this.one=new Tn(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(o,a){if(o<0)throw new E;if(a===0)return this.zero;const c=new Int32Array(o+1);return c[0]=a,new Tn(this,c)}inverse(o){if(o===0)throw new Pi;return this.expTable[this.size-this.logTable[o]-1]}multiply(o,a){return o===0||a===0?0:this.expTable[(this.logTable[o]+this.logTable[a])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+P.toHexString(this.primitive)+","+this.size+")"}equals(o){return o===this}}ot.AZTEC_DATA_12=new ot(4201,4096,1),ot.AZTEC_DATA_10=new ot(1033,1024,1),ot.AZTEC_DATA_6=new ot(67,64,1),ot.AZTEC_PARAM=new ot(19,16,1),ot.QR_CODE_FIELD_256=new ot(285,256,0),ot.DATA_MATRIX_FIELD_256=new ot(301,256,1),ot.AZTEC_DATA_8=ot.DATA_MATRIX_FIELD_256,ot.MAXICODE_FIELD_64=ot.AZTEC_DATA_6;class ri extends m{}ri.kind="ReedSolomonException";class sr extends m{}sr.kind="IllegalStateException";class ts{constructor(o){this.field=o}decode(o,a){const c=this.field,u=new Tn(c,o),d=new Int32Array(a);let g=!0;for(let q=0;q<a;q++){const Y=u.evaluateAt(c.exp(q+c.getGeneratorBase()));d[d.length-1-q]=Y,Y!==0&&(g=!1)}if(g)return;const y=new Tn(c,d),w=this.runEuclideanAlgorithm(c.buildMonomial(a,1),y,a),v=w[0],T=w[1],R=this.findErrorLocations(v),O=this.findErrorMagnitudes(T,R);for(let q=0;q<R.length;q++){const Y=o.length-1-c.log(R[q]);if(Y<0)throw new ri("Bad error location");o[Y]=ot.addOrSubtract(o[Y],O[q])}}runEuclideanAlgorithm(o,a,c){if(o.getDegree()<a.getDegree()){const q=o;o=a,a=q}const u=this.field;let d=o,g=a,y=u.getZero(),w=u.getOne();for(;g.getDegree()>=(c/2|0);){let q=d,Y=y;if(d=g,y=w,d.isZero())throw new ri("r_{i-1} was zero");g=q;let Z=u.getZero();const ie=d.getCoefficient(d.getDegree()),ce=u.inverse(ie);for(;g.getDegree()>=d.getDegree()&&!g.isZero();){const we=g.getDegree()-d.getDegree(),_e=u.multiply(g.getCoefficient(g.getDegree()),ce);Z=Z.addOrSubtract(u.buildMonomial(we,_e)),g=g.addOrSubtract(d.multiplyByMonomial(we,_e))}if(w=Z.multiply(y).addOrSubtract(Y),g.getDegree()>=d.getDegree())throw new sr("Division algorithm failed to reduce polynomial?")}const v=w.getCoefficient(0);if(v===0)throw new ri("sigmaTilde(0) was zero");const T=u.inverse(v),R=w.multiplyScalar(T),O=g.multiplyScalar(T);return[R,O]}findErrorLocations(o){const a=o.getDegree();if(a===1)return Int32Array.from([o.getCoefficient(1)]);const c=new Int32Array(a);let u=0;const d=this.field;for(let g=1;g<d.getSize()&&u<a;g++)o.evaluateAt(g)===0&&(c[u]=d.inverse(g),u++);if(u!==a)throw new ri("Error locator degree does not match number of roots");return c}findErrorMagnitudes(o,a){const c=a.length,u=new Int32Array(c),d=this.field;for(let g=0;g<c;g++){const y=d.inverse(a[g]);let w=1;for(let v=0;v<c;v++)if(g!==v){const T=d.multiply(a[v],y),R=T&1?T&-2:T|1;w=d.multiply(w,R)}u[g]=d.multiply(o.evaluateAt(y),d.inverse(w)),d.getGeneratorBase()!==0&&(u[g]=d.multiply(u[g],y))}return u}}var yn;(function(S){S[S.UPPER=0]="UPPER",S[S.LOWER=1]="LOWER",S[S.MIXED=2]="MIXED",S[S.DIGIT=3]="DIGIT",S[S.PUNCT=4]="PUNCT",S[S.BINARY=5]="BINARY"})(yn||(yn={}));class Nt{decode(o){this.ddata=o;let a=o.getBits(),c=this.extractBits(a),u=this.correctBits(c),d=Nt.convertBoolArrayToByteArray(u),g=Nt.getEncodedData(u),y=new Ni(d,g,null,null);return y.setNumBits(u.length),y}static highLevelDecode(o){return this.getEncodedData(o)}static getEncodedData(o){let a=o.length,c=yn.UPPER,u=yn.UPPER,d="",g=0;for(;g<a;)if(u===yn.BINARY){if(a-g<5)break;let y=Nt.readCode(o,g,5);if(g+=5,y===0){if(a-g<11)break;y=Nt.readCode(o,g,11)+31,g+=11}for(let w=0;w<y;w++){if(a-g<8){g=a;break}const v=Nt.readCode(o,g,8);d+=W.castAsNonUtf8Char(v),g+=8}u=c}else{let y=u===yn.DIGIT?4:5;if(a-g<y)break;let w=Nt.readCode(o,g,y);g+=y;let v=Nt.getCharacter(u,w);v.startsWith("CTRL_")?(c=u,u=Nt.getTable(v.charAt(5)),v.charAt(6)==="L"&&(c=u)):(d+=v,u=c)}return d}static getTable(o){switch(o){case"L":return yn.LOWER;case"P":return yn.PUNCT;case"M":return yn.MIXED;case"D":return yn.DIGIT;case"B":return yn.BINARY;case"U":default:return yn.UPPER}}static getCharacter(o,a){switch(o){case yn.UPPER:return Nt.UPPER_TABLE[a];case yn.LOWER:return Nt.LOWER_TABLE[a];case yn.MIXED:return Nt.MIXED_TABLE[a];case yn.PUNCT:return Nt.PUNCT_TABLE[a];case yn.DIGIT:return Nt.DIGIT_TABLE[a];default:throw new sr("Bad table")}}correctBits(o){let a,c;this.ddata.getNbLayers()<=2?(c=6,a=ot.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(c=8,a=ot.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(c=10,a=ot.AZTEC_DATA_10):(c=12,a=ot.AZTEC_DATA_12);let u=this.ddata.getNbDatablocks(),d=o.length/c;if(d<u)throw new k;let g=o.length%c,y=new Int32Array(d);for(let O=0;O<d;O++,g+=c)y[O]=Nt.readCode(o,g,c);try{new ts(a).decode(y,d-u)}catch(O){throw new k(O)}let w=(1<<c)-1,v=0;for(let O=0;O<u;O++){let q=y[O];if(q===0||q===w)throw new k;(q===1||q===w-1)&&v++}let T=new Array(u*c-v),R=0;for(let O=0;O<u;O++){let q=y[O];if(q===1||q===w-1)T.fill(q>1,R,R+c-1),R+=c-1;else for(let Y=c-1;Y>=0;--Y)T[R++]=(q&1<<Y)!==0}return T}extractBits(o){let a=this.ddata.isCompact(),c=this.ddata.getNbLayers(),u=(a?11:14)+c*4,d=new Int32Array(u),g=new Array(this.totalBitsInLayer(c,a));if(a)for(let y=0;y<d.length;y++)d[y]=y;else{let y=u+1+2*P.truncDivision(P.truncDivision(u,2)-1,15),w=u/2,v=P.truncDivision(y,2);for(let T=0;T<w;T++){let R=T+P.truncDivision(T,15);d[w-T-1]=v-R-1,d[w+T]=v+R+1}}for(let y=0,w=0;y<c;y++){let v=(c-y)*4+(a?9:12),T=y*2,R=u-1-T;for(let O=0;O<v;O++){let q=O*2;for(let Y=0;Y<2;Y++)g[w+q+Y]=o.get(d[T+Y],d[T+O]),g[w+2*v+q+Y]=o.get(d[T+O],d[R-Y]),g[w+4*v+q+Y]=o.get(d[R-Y],d[R-O]),g[w+6*v+q+Y]=o.get(d[R-O],d[T+Y])}w+=v*8}return g}static readCode(o,a,c){let u=0;for(let d=a;d<a+c;d++)u<<=1,o[d]&&(u|=1);return u}static readByte(o,a){let c=o.length-a;return c>=8?Nt.readCode(o,a,8):Nt.readCode(o,a,c)<<8-c}static convertBoolArrayToByteArray(o){let a=new Uint8Array((o.length+7)/8);for(let c=0;c<a.length;c++)a[c]=Nt.readByte(o,8*c);return a}totalBitsInLayer(o,a){return((a?88:112)+16*o)*o}}Nt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Nt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Nt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class it{constructor(){}static round(o){return o===NaN?0:o<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:o>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:o+(o<0?-.5:.5)|0}static distance(o,a,c,u){const d=o-c,g=a-u;return Math.sqrt(d*d+g*g)}static sum(o){let a=0;for(let c=0,u=o.length;c!==u;c++){const d=o[c];a+=d}return a}}class Q{static floatToIntBits(o){return o}}Q.MAX_VALUE=Number.MAX_SAFE_INTEGER;class X{constructor(o,a){this.x=o,this.y=a}getX(){return this.x}getY(){return this.y}equals(o){if(o instanceof X){const a=o;return this.x===a.x&&this.y===a.y}return!1}hashCode(){return 31*Q.floatToIntBits(this.x)+Q.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(o){const a=this.distance(o[0],o[1]),c=this.distance(o[1],o[2]),u=this.distance(o[0],o[2]);let d,g,y;if(c>=a&&c>=u?(g=o[0],d=o[1],y=o[2]):u>=c&&u>=a?(g=o[1],d=o[0],y=o[2]):(g=o[2],d=o[0],y=o[1]),this.crossProductZ(d,g,y)<0){const w=d;d=y,y=w}o[0]=d,o[1]=g,o[2]=y}static distance(o,a){return it.distance(o.x,o.y,a.x,a.y)}static crossProductZ(o,a,c){const u=a.x,d=a.y;return(c.x-u)*(o.y-d)-(c.y-d)*(o.x-u)}}class ue{constructor(o,a){this.bits=o,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class Ce extends ue{constructor(o,a,c,u,d){super(o,a),this.compact=c,this.nbDatablocks=u,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class xe{constructor(o,a,c,u){this.image=o,this.height=o.getHeight(),this.width=o.getWidth(),a==null&&(a=xe.INIT_SIZE),c==null&&(c=o.getWidth()/2|0),u==null&&(u=o.getHeight()/2|0);const d=a/2|0;if(this.leftInit=c-d,this.rightInit=c+d,this.upInit=u-d,this.downInit=u+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new se}detect(){let o=this.leftInit,a=this.rightInit,c=this.upInit,u=this.downInit,d=!1,g=!0,y=!1,w=!1,v=!1,T=!1,R=!1;const O=this.width,q=this.height;for(;g;){g=!1;let Y=!0;for(;(Y||!w)&&a<O;)Y=this.containsBlackPoint(c,u,a,!1),Y?(a++,g=!0,w=!0):w||a++;if(a>=O){d=!0;break}let Z=!0;for(;(Z||!v)&&u<q;)Z=this.containsBlackPoint(o,a,u,!0),Z?(u++,g=!0,v=!0):v||u++;if(u>=q){d=!0;break}let ie=!0;for(;(ie||!T)&&o>=0;)ie=this.containsBlackPoint(c,u,o,!1),ie?(o--,g=!0,T=!0):T||o--;if(o<0){d=!0;break}let ce=!0;for(;(ce||!R)&&c>=0;)ce=this.containsBlackPoint(o,a,c,!0),ce?(c--,g=!0,R=!0):R||c--;if(c<0){d=!0;break}g&&(y=!0)}if(!d&&y){const Y=a-o;let Z=null;for(let _e=1;Z===null&&_e<Y;_e++)Z=this.getBlackPointOnSegment(o,u-_e,o+_e,u);if(Z==null)throw new se;let ie=null;for(let _e=1;ie===null&&_e<Y;_e++)ie=this.getBlackPointOnSegment(o,c+_e,o+_e,c);if(ie==null)throw new se;let ce=null;for(let _e=1;ce===null&&_e<Y;_e++)ce=this.getBlackPointOnSegment(a,c+_e,a-_e,c);if(ce==null)throw new se;let we=null;for(let _e=1;we===null&&_e<Y;_e++)we=this.getBlackPointOnSegment(a,u-_e,a-_e,u);if(we==null)throw new se;return this.centerEdges(we,Z,ce,ie)}else throw new se}getBlackPointOnSegment(o,a,c,u){const d=it.round(it.distance(o,a,c,u)),g=(c-o)/d,y=(u-a)/d,w=this.image;for(let v=0;v<d;v++){const T=it.round(o+v*g),R=it.round(a+v*y);if(w.get(T,R))return new X(T,R)}return null}centerEdges(o,a,c,u){const d=o.getX(),g=o.getY(),y=a.getX(),w=a.getY(),v=c.getX(),T=c.getY(),R=u.getX(),O=u.getY(),q=xe.CORR;return d<this.width/2?[new X(R-q,O+q),new X(y+q,w+q),new X(v-q,T-q),new X(d+q,g-q)]:[new X(R+q,O+q),new X(y+q,w-q),new X(v-q,T+q),new X(d-q,g-q)]}containsBlackPoint(o,a,c,u){const d=this.image;if(u){for(let g=o;g<=a;g++)if(d.get(g,c))return!0}else for(let g=o;g<=a;g++)if(d.get(c,g))return!0;return!1}}xe.INIT_SIZE=10,xe.CORR=1;class pe{static checkAndNudgePoints(o,a){const c=o.getWidth(),u=o.getHeight();let d=!0;for(let g=0;g<a.length&&d;g+=2){const y=Math.floor(a[g]),w=Math.floor(a[g+1]);if(y<-1||y>c||w<-1||w>u)throw new se;d=!1,y===-1?(a[g]=0,d=!0):y===c&&(a[g]=c-1,d=!0),w===-1?(a[g+1]=0,d=!0):w===u&&(a[g+1]=u-1,d=!0)}d=!0;for(let g=a.length-2;g>=0&&d;g-=2){const y=Math.floor(a[g]),w=Math.floor(a[g+1]);if(y<-1||y>c||w<-1||w>u)throw new se;d=!1,y===-1?(a[g]=0,d=!0):y===c&&(a[g]=c-1,d=!0),w===-1?(a[g+1]=0,d=!0):w===u&&(a[g+1]=u-1,d=!0)}}}class be{constructor(o,a,c,u,d,g,y,w,v){this.a11=o,this.a21=a,this.a31=c,this.a12=u,this.a22=d,this.a32=g,this.a13=y,this.a23=w,this.a33=v}static quadrilateralToQuadrilateral(o,a,c,u,d,g,y,w,v,T,R,O,q,Y,Z,ie){const ce=be.quadrilateralToSquare(o,a,c,u,d,g,y,w);return be.squareToQuadrilateral(v,T,R,O,q,Y,Z,ie).times(ce)}transformPoints(o){const a=o.length,c=this.a11,u=this.a12,d=this.a13,g=this.a21,y=this.a22,w=this.a23,v=this.a31,T=this.a32,R=this.a33;for(let O=0;O<a;O+=2){const q=o[O],Y=o[O+1],Z=d*q+w*Y+R;o[O]=(c*q+g*Y+v)/Z,o[O+1]=(u*q+y*Y+T)/Z}}transformPointsWithValues(o,a){const c=this.a11,u=this.a12,d=this.a13,g=this.a21,y=this.a22,w=this.a23,v=this.a31,T=this.a32,R=this.a33,O=o.length;for(let q=0;q<O;q++){const Y=o[q],Z=a[q],ie=d*Y+w*Z+R;o[q]=(c*Y+g*Z+v)/ie,a[q]=(u*Y+y*Z+T)/ie}}static squareToQuadrilateral(o,a,c,u,d,g,y,w){const v=o-c+d-y,T=a-u+g-w;if(v===0&&T===0)return new be(c-o,d-c,o,u-a,g-u,a,0,0,1);{const R=c-d,O=y-d,q=u-g,Y=w-g,Z=R*Y-O*q,ie=(v*Y-O*T)/Z,ce=(R*T-v*q)/Z;return new be(c-o+ie*c,y-o+ce*y,o,u-a+ie*u,w-a+ce*w,a,ie,ce,1)}}static quadrilateralToSquare(o,a,c,u,d,g,y,w){return be.squareToQuadrilateral(o,a,c,u,d,g,y,w).buildAdjoint()}buildAdjoint(){return new be(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(o){return new be(this.a11*o.a11+this.a21*o.a12+this.a31*o.a13,this.a11*o.a21+this.a21*o.a22+this.a31*o.a23,this.a11*o.a31+this.a21*o.a32+this.a31*o.a33,this.a12*o.a11+this.a22*o.a12+this.a32*o.a13,this.a12*o.a21+this.a22*o.a22+this.a32*o.a23,this.a12*o.a31+this.a22*o.a32+this.a32*o.a33,this.a13*o.a11+this.a23*o.a12+this.a33*o.a13,this.a13*o.a21+this.a23*o.a22+this.a33*o.a23,this.a13*o.a31+this.a23*o.a32+this.a33*o.a33)}}class We extends pe{sampleGrid(o,a,c,u,d,g,y,w,v,T,R,O,q,Y,Z,ie,ce,we,_e){const me=be.quadrilateralToQuadrilateral(u,d,g,y,w,v,T,R,O,q,Y,Z,ie,ce,we,_e);return this.sampleGridWithTransform(o,a,c,me)}sampleGridWithTransform(o,a,c,u){if(a<=0||c<=0)throw new se;const d=new Ge(a,c),g=new Float32Array(2*a);for(let y=0;y<c;y++){const w=g.length,v=y+.5;for(let T=0;T<w;T+=2)g[T]=T/2+.5,g[T+1]=v;u.transformPoints(g),pe.checkAndNudgePoints(o,g);try{for(let T=0;T<w;T+=2)o.get(Math.floor(g[T]),Math.floor(g[T+1]))&&d.set(T/2,y)}catch{throw new se}}return d}}class qe{static setGridSampler(o){qe.gridSampler=o}static getInstance(){return qe.gridSampler}}qe.gridSampler=new We;class Et{constructor(o,a){this.x=o,this.y=a}toResultPoint(){return new X(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ns{constructor(o){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=o}detect(){return this.detectMirror(!1)}detectMirror(o){let a=this.getMatrixCenter(),c=this.getBullsEyeCorners(a);if(o){let g=c[0];c[0]=c[2],c[2]=g}this.extractParameters(c);let u=this.sampleGrid(this.image,c[this.shift%4],c[(this.shift+1)%4],c[(this.shift+2)%4],c[(this.shift+3)%4]),d=this.getMatrixCornerPoints(c);return new Ce(u,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(o){if(!this.isValidPoint(o[0])||!this.isValidPoint(o[1])||!this.isValidPoint(o[2])||!this.isValidPoint(o[3]))throw new se;let a=2*this.nbCenterLayers,c=new Int32Array([this.sampleLine(o[0],o[1],a),this.sampleLine(o[1],o[2],a),this.sampleLine(o[2],o[3],a),this.sampleLine(o[3],o[0],a)]);this.shift=this.getRotation(c,a);let u=0;for(let g=0;g<4;g++){let y=c[(this.shift+g)%4];this.compact?(u<<=7,u+=y>>1&127):(u<<=10,u+=(y>>2&992)+(y>>1&31))}let d=this.getCorrectedParameterData(u,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(o,a){let c=0;o.forEach((u,d,g)=>{let y=(u>>a-2<<1)+(u&1);c=(c<<3)+y}),c=((c&1)<<11)+(c>>1);for(let u=0;u<4;u++)if(P.bitCount(c^this.EXPECTED_CORNER_BITS[u])<=2)return u;throw new se}getCorrectedParameterData(o,a){let c,u;a?(c=7,u=2):(c=10,u=4);let d=c-u,g=new Int32Array(c);for(let w=c-1;w>=0;--w)g[w]=o&15,o>>=4;try{new ts(ot.AZTEC_PARAM).decode(g,d)}catch{throw new se}let y=0;for(let w=0;w<u;w++)y=(y<<4)+g[w];return y}getBullsEyeCorners(o){let a=o,c=o,u=o,d=o,g=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let R=this.getFirstDifferent(a,g,1,-1),O=this.getFirstDifferent(c,g,1,1),q=this.getFirstDifferent(u,g,-1,1),Y=this.getFirstDifferent(d,g,-1,-1);if(this.nbCenterLayers>2){let Z=this.distancePoint(Y,R)*this.nbCenterLayers/(this.distancePoint(d,a)*(this.nbCenterLayers+2));if(Z<.75||Z>1.25||!this.isWhiteOrBlackRectangle(R,O,q,Y))break}a=R,c=O,u=q,d=Y,g=!g}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new se;this.compact=this.nbCenterLayers===5;let y=new X(a.getX()+.5,a.getY()-.5),w=new X(c.getX()+.5,c.getY()+.5),v=new X(u.getX()-.5,u.getY()+.5),T=new X(d.getX()-.5,d.getY()-.5);return this.expandSquare([y,w,v,T],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let o,a,c,u;try{let y=new xe(this.image).detect();o=y[0],a=y[1],c=y[2],u=y[3]}catch{let w=this.image.getWidth()/2,v=this.image.getHeight()/2;o=this.getFirstDifferent(new Et(w+7,v-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new Et(w+7,v+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Et(w-7,v+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Et(w-7,v-7),!1,-1,-1).toResultPoint()}let d=it.round((o.getX()+u.getX()+a.getX()+c.getX())/4),g=it.round((o.getY()+u.getY()+a.getY()+c.getY())/4);try{let y=new xe(this.image,15,d,g).detect();o=y[0],a=y[1],c=y[2],u=y[3]}catch{o=this.getFirstDifferent(new Et(d+7,g-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new Et(d+7,g+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Et(d-7,g+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Et(d-7,g-7),!1,-1,-1).toResultPoint()}return d=it.round((o.getX()+u.getX()+a.getX()+c.getX())/4),g=it.round((o.getY()+u.getY()+a.getY()+c.getY())/4),new Et(d,g)}getMatrixCornerPoints(o){return this.expandSquare(o,2*this.nbCenterLayers,this.getDimension())}sampleGrid(o,a,c,u,d){let g=qe.getInstance(),y=this.getDimension(),w=y/2-this.nbCenterLayers,v=y/2+this.nbCenterLayers;return g.sampleGrid(o,y,y,w,w,v,w,v,v,w,v,a.getX(),a.getY(),c.getX(),c.getY(),u.getX(),u.getY(),d.getX(),d.getY())}sampleLine(o,a,c){let u=0,d=this.distanceResultPoint(o,a),g=d/c,y=o.getX(),w=o.getY(),v=g*(a.getX()-o.getX())/d,T=g*(a.getY()-o.getY())/d;for(let R=0;R<c;R++)this.image.get(it.round(y+R*v),it.round(w+R*T))&&(u|=1<<c-R-1);return u}isWhiteOrBlackRectangle(o,a,c,u){let d=3;o=new Et(o.getX()-d,o.getY()+d),a=new Et(a.getX()-d,a.getY()-d),c=new Et(c.getX()+d,c.getY()-d),u=new Et(u.getX()+d,u.getY()+d);let g=this.getColor(u,o);if(g===0)return!1;let y=this.getColor(o,a);return y!==g||(y=this.getColor(a,c),y!==g)?!1:(y=this.getColor(c,u),y===g)}getColor(o,a){let c=this.distancePoint(o,a),u=(a.getX()-o.getX())/c,d=(a.getY()-o.getY())/c,g=0,y=o.getX(),w=o.getY(),v=this.image.get(o.getX(),o.getY()),T=Math.ceil(c);for(let O=0;O<T;O++)y+=u,w+=d,this.image.get(it.round(y),it.round(w))!==v&&g++;let R=g/c;return R>.1&&R<.9?0:R<=.1===v?1:-1}getFirstDifferent(o,a,c,u){let d=o.getX()+c,g=o.getY()+u;for(;this.isValid(d,g)&&this.image.get(d,g)===a;)d+=c,g+=u;for(d-=c,g-=u;this.isValid(d,g)&&this.image.get(d,g)===a;)d+=c;for(d-=c;this.isValid(d,g)&&this.image.get(d,g)===a;)g+=u;return g-=u,new Et(d,g)}expandSquare(o,a,c){let u=c/(2*a),d=o[0].getX()-o[2].getX(),g=o[0].getY()-o[2].getY(),y=(o[0].getX()+o[2].getX())/2,w=(o[0].getY()+o[2].getY())/2,v=new X(y+u*d,w+u*g),T=new X(y-u*d,w-u*g);d=o[1].getX()-o[3].getX(),g=o[1].getY()-o[3].getY(),y=(o[1].getX()+o[3].getX())/2,w=(o[1].getY()+o[3].getY())/2;let R=new X(y+u*d,w+u*g),O=new X(y-u*d,w-u*g);return[v,R,T,O]}isValid(o,a){return o>=0&&o<this.image.getWidth()&&a>0&&a<this.image.getHeight()}isValidPoint(o){let a=it.round(o.getX()),c=it.round(o.getY());return this.isValid(a,c)}distancePoint(o,a){return it.distance(o.getX(),o.getY(),a.getX(),a.getY())}distanceResultPoint(o,a){return it.distance(o.getX(),o.getY(),a.getX(),a.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(P.truncDivision(this.nbLayers-4,8)+1)+15}}class pr{decode(o,a=null){let c=null,u=new ns(o.getBlackMatrix()),d=null,g=null;try{let T=u.detectMirror(!1);d=T.getPoints(),this.reportFoundResultPoints(a,d),g=new Nt().decode(T)}catch(T){c=T}if(g==null)try{let T=u.detectMirror(!0);d=T.getPoints(),this.reportFoundResultPoints(a,d),g=new Nt().decode(T)}catch(T){throw c??T}let y=new Bt(g.getText(),g.getRawBytes(),g.getNumBits(),d,ke.AZTEC,D.currentTimeMillis()),w=g.getByteSegments();w!=null&&y.putMetadata(ln.BYTE_SEGMENTS,w);let v=g.getECLevel();return v!=null&&y.putMetadata(ln.ERROR_CORRECTION_LEVEL,v),y}reportFoundResultPoints(o,a){if(o!=null){let c=o.get(J.NEED_RESULT_POINT_CALLBACK);c!=null&&a.forEach((u,d,g)=>{c.foundPossibleResultPoint(u)})}}reset(){}}class Gu extends Tt{constructor(o=500){super(new pr,o)}}class bt{decode(o,a){try{return this.doDecode(o,a)}catch{if(a&&a.get(J.TRY_HARDER)===!0&&o.isRotateSupported()){const d=o.rotateCounterClockwise(),g=this.doDecode(d,a),y=g.getResultMetadata();let w=270;y!==null&&y.get(ln.ORIENTATION)===!0&&(w=w+y.get(ln.ORIENTATION)%360),g.putMetadata(ln.ORIENTATION,w);const v=g.getResultPoints();if(v!==null){const T=d.getHeight();for(let R=0;R<v.length;R++)v[R]=new X(T-v[R].getY()-1,v[R].getX())}return g}else throw new se}}reset(){}doDecode(o,a){const c=o.getWidth(),u=o.getHeight();let d=new V(c);const g=a&&a.get(J.TRY_HARDER)===!0,y=Math.max(1,u>>(g?8:5));let w;g?w=u:w=15;const v=Math.trunc(u/2);for(let T=0;T<w;T++){const R=Math.trunc((T+1)/2),O=(T&1)===0,q=v+y*(O?R:-R);if(q<0||q>=u)break;try{d=o.getBlackRow(q,d)}catch{continue}for(let Y=0;Y<2;Y++){if(Y===1&&(d.reverse(),a&&a.get(J.NEED_RESULT_POINT_CALLBACK)===!0)){const Z=new Map;a.forEach((ie,ce)=>Z.set(ce,ie)),Z.delete(J.NEED_RESULT_POINT_CALLBACK),a=Z}try{const Z=this.decodeRow(q,d,a);if(Y===1){Z.putMetadata(ln.ORIENTATION,180);const ie=Z.getResultPoints();ie!==null&&(ie[0]=new X(c-ie[0].getX()-1,ie[0].getY()),ie[1]=new X(c-ie[1].getX()-1,ie[1].getY()))}return Z}catch{}}}throw new se}static recordPattern(o,a,c){const u=c.length;for(let v=0;v<u;v++)c[v]=0;const d=o.getSize();if(a>=d)throw new se;let g=!o.get(a),y=0,w=a;for(;w<d;){if(o.get(w)!==g)c[y]++;else{if(++y===u)break;c[y]=1,g=!g}w++}if(!(y===u||y===u-1&&w===d))throw new se}static recordPatternInReverse(o,a,c){let u=c.length,d=o.get(a);for(;a>0&&u>=0;)o.get(--a)!==d&&(u--,d=!d);if(u>=0)throw new se;bt.recordPattern(o,a+1,c)}static patternMatchVariance(o,a,c){const u=o.length;let d=0,g=0;for(let v=0;v<u;v++)d+=o[v],g+=a[v];if(d<g)return Number.POSITIVE_INFINITY;const y=d/g;c*=y;let w=0;for(let v=0;v<u;v++){const T=o[v],R=a[v]*y,O=T>R?T-R:R-T;if(O>c)return Number.POSITIVE_INFINITY;w+=O}return w/d}}class Ee extends bt{static findStartPattern(o){const a=o.getSize(),c=o.getNextSet(0);let u=0,d=Int32Array.from([0,0,0,0,0,0]),g=c,y=!1;const w=6;for(let v=c;v<a;v++)if(o.get(v)!==y)d[u]++;else{if(u===w-1){let T=Ee.MAX_AVG_VARIANCE,R=-1;for(let O=Ee.CODE_START_A;O<=Ee.CODE_START_C;O++){const q=bt.patternMatchVariance(d,Ee.CODE_PATTERNS[O],Ee.MAX_INDIVIDUAL_VARIANCE);q<T&&(T=q,R=O)}if(R>=0&&o.isRange(Math.max(0,g-(v-g)/2),g,!1))return Int32Array.from([g,v,R]);g+=d[0]+d[1],d=d.slice(2,d.length-1),d[u-1]=0,d[u]=0,u--}else u++;d[u]=1,y=!y}throw new se}static decodeCode(o,a,c){bt.recordPattern(o,c,a);let u=Ee.MAX_AVG_VARIANCE,d=-1;for(let g=0;g<Ee.CODE_PATTERNS.length;g++){const y=Ee.CODE_PATTERNS[g],w=this.patternMatchVariance(a,y,Ee.MAX_INDIVIDUAL_VARIANCE);w<u&&(u=w,d=g)}if(d>=0)return d;throw new se}decodeRow(o,a,c){const u=c&&c.get(J.ASSUME_GS1)===!0,d=Ee.findStartPattern(a),g=d[2];let y=0;const w=new Uint8Array(20);w[y++]=g;let v;switch(g){case Ee.CODE_START_A:v=Ee.CODE_CODE_A;break;case Ee.CODE_START_B:v=Ee.CODE_CODE_B;break;case Ee.CODE_START_C:v=Ee.CODE_CODE_C;break;default:throw new k}let T=!1,R=!1,O="",q=d[0],Y=d[1];const Z=Int32Array.from([0,0,0,0,0,0]);let ie=0,ce=0,we=g,_e=0,me=!0,ct=!1,et=!1;for(;!T;){const sc=R;switch(R=!1,ie=ce,ce=Ee.decodeCode(a,Z,Y),w[y++]=ce,ce!==Ee.CODE_STOP&&(me=!0),ce!==Ee.CODE_STOP&&(_e++,we+=_e*ce),q=Y,Y+=Z.reduce((HR,WR)=>HR+WR,0),ce){case Ee.CODE_START_A:case Ee.CODE_START_B:case Ee.CODE_START_C:throw new k}switch(v){case Ee.CODE_CODE_A:if(ce<64)et===ct?O+=String.fromCharCode(" ".charCodeAt(0)+ce):O+=String.fromCharCode(" ".charCodeAt(0)+ce+128),et=!1;else if(ce<96)et===ct?O+=String.fromCharCode(ce-64):O+=String.fromCharCode(ce+64),et=!1;else switch(ce!==Ee.CODE_STOP&&(me=!1),ce){case Ee.CODE_FNC_1:u&&(O.length===0?O+="]C1":O+=String.fromCharCode(29));break;case Ee.CODE_FNC_2:case Ee.CODE_FNC_3:break;case Ee.CODE_FNC_4_A:!ct&&et?(ct=!0,et=!1):ct&&et?(ct=!1,et=!1):et=!0;break;case Ee.CODE_SHIFT:R=!0,v=Ee.CODE_CODE_B;break;case Ee.CODE_CODE_B:v=Ee.CODE_CODE_B;break;case Ee.CODE_CODE_C:v=Ee.CODE_CODE_C;break;case Ee.CODE_STOP:T=!0;break}break;case Ee.CODE_CODE_B:if(ce<96)et===ct?O+=String.fromCharCode(" ".charCodeAt(0)+ce):O+=String.fromCharCode(" ".charCodeAt(0)+ce+128),et=!1;else switch(ce!==Ee.CODE_STOP&&(me=!1),ce){case Ee.CODE_FNC_1:u&&(O.length===0?O+="]C1":O+=String.fromCharCode(29));break;case Ee.CODE_FNC_2:case Ee.CODE_FNC_3:break;case Ee.CODE_FNC_4_B:!ct&&et?(ct=!0,et=!1):ct&&et?(ct=!1,et=!1):et=!0;break;case Ee.CODE_SHIFT:R=!0,v=Ee.CODE_CODE_A;break;case Ee.CODE_CODE_A:v=Ee.CODE_CODE_A;break;case Ee.CODE_CODE_C:v=Ee.CODE_CODE_C;break;case Ee.CODE_STOP:T=!0;break}break;case Ee.CODE_CODE_C:if(ce<100)ce<10&&(O+="0"),O+=ce;else switch(ce!==Ee.CODE_STOP&&(me=!1),ce){case Ee.CODE_FNC_1:u&&(O.length===0?O+="]C1":O+=String.fromCharCode(29));break;case Ee.CODE_CODE_A:v=Ee.CODE_CODE_A;break;case Ee.CODE_CODE_B:v=Ee.CODE_CODE_B;break;case Ee.CODE_STOP:T=!0;break}break}sc&&(v=v===Ee.CODE_CODE_A?Ee.CODE_CODE_B:Ee.CODE_CODE_A)}const Hr=Y-q;if(Y=a.getNextUnset(Y),!a.isRange(Y,Math.min(a.getSize(),Y+(Y-q)/2),!1))throw new se;if(we-=_e*ie,we%103!==ie)throw new N;const Bi=O.length;if(Bi===0)throw new se;Bi>0&&me&&(v===Ee.CODE_CODE_C?O=O.substring(0,Bi-2):O=O.substring(0,Bi-1));const Wr=(d[1]+d[0])/2,zt=q+Hr/2,lr=w.length,ai=new Uint8Array(lr);for(let sc=0;sc<lr;sc++)ai[sc]=w[sc];const ic=[new X(Wr,o),new X(zt,o)];return new Bt(O,ai,0,ic,ke.CODE_128,new Date().getTime())}}Ee.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ee.MAX_AVG_VARIANCE=.25,Ee.MAX_INDIVIDUAL_VARIANCE=.7,Ee.CODE_SHIFT=98,Ee.CODE_CODE_C=99,Ee.CODE_CODE_B=100,Ee.CODE_CODE_A=101,Ee.CODE_FNC_1=102,Ee.CODE_FNC_2=97,Ee.CODE_FNC_3=96,Ee.CODE_FNC_4_A=101,Ee.CODE_FNC_4_B=100,Ee.CODE_START_A=103,Ee.CODE_START_B=104,Ee.CODE_START_C=105,Ee.CODE_STOP=106;class tn extends bt{constructor(o=!1,a=!1){super(),this.usingCheckDigit=o,this.extendedMode=a,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(o,a,c){let u=this.counters;u.fill(0),this.decodeRowResult="";let d=tn.findAsteriskPattern(a,u),g=a.getNextSet(d[1]),y=a.getSize(),w,v;do{tn.recordPattern(a,g,u);let Z=tn.toNarrowWidePattern(u);if(Z<0)throw new se;w=tn.patternToChar(Z),this.decodeRowResult+=w,v=g;for(let ie of u)g+=ie;g=a.getNextSet(g)}while(w!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let T=0;for(let Z of u)T+=Z;let R=g-v-T;if(g!==y&&R*2<T)throw new se;if(this.usingCheckDigit){let Z=this.decodeRowResult.length-1,ie=0;for(let ce=0;ce<Z;ce++)ie+=tn.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ce));if(this.decodeRowResult.charAt(Z)!==tn.ALPHABET_STRING.charAt(ie%43))throw new N;this.decodeRowResult=this.decodeRowResult.substring(0,Z)}if(this.decodeRowResult.length===0)throw new se;let O;this.extendedMode?O=tn.decodeExtended(this.decodeRowResult):O=this.decodeRowResult;let q=(d[1]+d[0])/2,Y=v+T/2;return new Bt(O,null,0,[new X(q,o),new X(Y,o)],ke.CODE_39,new Date().getTime())}static findAsteriskPattern(o,a){let c=o.getSize(),u=o.getNextSet(0),d=0,g=u,y=!1,w=a.length;for(let v=u;v<c;v++)if(o.get(v)!==y)a[d]++;else{if(d===w-1){if(this.toNarrowWidePattern(a)===tn.ASTERISK_ENCODING&&o.isRange(Math.max(0,g-Math.floor((v-g)/2)),g,!1))return[g,v];g+=a[0]+a[1],a.copyWithin(0,2,2+d-1),a[d-1]=0,a[d]=0,d--}else d++;a[d]=1,y=!y}throw new se}static toNarrowWidePattern(o){let a=o.length,c=0,u;do{let d=2147483647;for(let w of o)w<d&&w>c&&(d=w);c=d,u=0;let g=0,y=0;for(let w=0;w<a;w++){let v=o[w];v>c&&(y|=1<<a-1-w,u++,g+=v)}if(u===3){for(let w=0;w<a&&u>0;w++){let v=o[w];if(v>c&&(u--,v*2>=g))return-1}return y}}while(u>3);return-1}static patternToChar(o){for(let a=0;a<tn.CHARACTER_ENCODINGS.length;a++)if(tn.CHARACTER_ENCODINGS[a]===o)return tn.ALPHABET_STRING.charAt(a);if(o===tn.ASTERISK_ENCODING)return"*";throw new se}static decodeExtended(o){let a=o.length,c="";for(let u=0;u<a;u++){let d=o.charAt(u);if(d==="+"||d==="$"||d==="%"||d==="/"){let g=o.charAt(u+1),y="\0";switch(d){case"+":if(g>="A"&&g<="Z")y=String.fromCharCode(g.charCodeAt(0)+32);else throw new k;break;case"$":if(g>="A"&&g<="Z")y=String.fromCharCode(g.charCodeAt(0)-64);else throw new k;break;case"%":if(g>="A"&&g<="E")y=String.fromCharCode(g.charCodeAt(0)-38);else if(g>="F"&&g<="J")y=String.fromCharCode(g.charCodeAt(0)-11);else if(g>="K"&&g<="O")y=String.fromCharCode(g.charCodeAt(0)+16);else if(g>="P"&&g<="T")y=String.fromCharCode(g.charCodeAt(0)+43);else if(g==="U")y="\0";else if(g==="V")y="@";else if(g==="W")y="`";else if(g==="X"||g==="Y"||g==="Z")y="";else throw new k;break;case"/":if(g>="A"&&g<="O")y=String.fromCharCode(g.charCodeAt(0)-32);else if(g==="Z")y=":";else throw new k;break}c+=y,u++}else c+=d}return c}}tn.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",tn.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],tn.ASTERISK_ENCODING=148;class pt extends bt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(o,a,c){let u=this.decodeStart(a),d=this.decodeEnd(a),g=new z;pt.decodeMiddle(a,u[1],d[0],g);let y=g.toString(),w=null;c!=null&&(w=c.get(J.ALLOWED_LENGTHS)),w==null&&(w=pt.DEFAULT_ALLOWED_LENGTHS);let v=y.length,T=!1,R=0;for(let Y of w){if(v===Y){T=!0;break}Y>R&&(R=Y)}if(!T&&v>R&&(T=!0),!T)throw new k;const O=[new X(u[1],o),new X(d[0],o)];return new Bt(y,null,0,O,ke.ITF,new Date().getTime())}static decodeMiddle(o,a,c,u){let d=new Int32Array(10),g=new Int32Array(5),y=new Int32Array(5);for(d.fill(0),g.fill(0),y.fill(0);a<c;){bt.recordPattern(o,a,d);for(let v=0;v<5;v++){let T=2*v;g[v]=d[T],y[v]=d[T+1]}let w=pt.decodeDigit(g);u.append(w.toString()),w=this.decodeDigit(y),u.append(w.toString()),d.forEach(function(v){a+=v})}}decodeStart(o){let a=pt.skipWhiteSpace(o),c=pt.findGuardPattern(o,a,pt.START_PATTERN);return this.narrowLineWidth=(c[1]-c[0])/4,this.validateQuietZone(o,c[0]),c}validateQuietZone(o,a){let c=this.narrowLineWidth*10;c=c<a?c:a;for(let u=a-1;c>0&&u>=0&&!o.get(u);u--)c--;if(c!==0)throw new se}static skipWhiteSpace(o){const a=o.getSize(),c=o.getNextSet(0);if(c===a)throw new se;return c}decodeEnd(o){o.reverse();try{let a=pt.skipWhiteSpace(o),c;try{c=pt.findGuardPattern(o,a,pt.END_PATTERN_REVERSED[0])}catch(d){d instanceof se&&(c=pt.findGuardPattern(o,a,pt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(o,c[0]);let u=c[0];return c[0]=o.getSize()-c[1],c[1]=o.getSize()-u,c}finally{o.reverse()}}static findGuardPattern(o,a,c){let u=c.length,d=new Int32Array(u),g=o.getSize(),y=!1,w=0,v=a;d.fill(0);for(let T=a;T<g;T++)if(o.get(T)!==y)d[w]++;else{if(w===u-1){if(bt.patternMatchVariance(d,c,pt.MAX_INDIVIDUAL_VARIANCE)<pt.MAX_AVG_VARIANCE)return[v,T];v+=d[0]+d[1],D.arraycopy(d,2,d,0,w-1),d[w-1]=0,d[w]=0,w--}else w++;d[w]=1,y=!y}throw new se}static decodeDigit(o){let a=pt.MAX_AVG_VARIANCE,c=-1,u=pt.PATTERNS.length;for(let d=0;d<u;d++){let g=pt.PATTERNS[d],y=bt.patternMatchVariance(o,g,pt.MAX_INDIVIDUAL_VARIANCE);y<a?(a=y,c=d):y===a&&(c=-1)}if(c>=0)return c%10;throw new se}}pt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],pt.MAX_AVG_VARIANCE=.38,pt.MAX_INDIVIDUAL_VARIANCE=.5,pt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],pt.START_PATTERN=Int32Array.from([1,1,1,1]),pt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ht extends bt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(o){let a=!1,c,u=0,d=Int32Array.from([0,0,0]);for(;!a;){d=Int32Array.from([0,0,0]),c=Ht.findGuardPattern(o,u,!1,this.START_END_PATTERN,d);let g=c[0];u=c[1];let y=g-(u-g);y>=0&&(a=o.isRange(y,g,!1))}return c}static checkChecksum(o){return Ht.checkStandardUPCEANChecksum(o)}static checkStandardUPCEANChecksum(o){let a=o.length;if(a===0)return!1;let c=parseInt(o.charAt(a-1),10);return Ht.getStandardUPCEANChecksum(o.substring(0,a-1))===c}static getStandardUPCEANChecksum(o){let a=o.length,c=0;for(let u=a-1;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}c*=3;for(let u=a-2;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}return(1e3-c)%10}static decodeEnd(o,a){return Ht.findGuardPattern(o,a,!1,Ht.START_END_PATTERN,new Int32Array(Ht.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(o,a,c,u){return this.findGuardPattern(o,a,c,u,new Int32Array(u.length))}static findGuardPattern(o,a,c,u,d){let g=o.getSize();a=c?o.getNextUnset(a):o.getNextSet(a);let y=0,w=a,v=u.length,T=c;for(let R=a;R<g;R++)if(o.get(R)!==T)d[y]++;else{if(y===v-1){if(bt.patternMatchVariance(d,u,Ht.MAX_INDIVIDUAL_VARIANCE)<Ht.MAX_AVG_VARIANCE)return Int32Array.from([w,R]);w+=d[0]+d[1];let O=d.slice(2,d.length-1);for(let q=0;q<y-1;q++)d[q]=O[q];d[y-1]=0,d[y]=0,y--}else y++;d[y]=1,T=!T}throw new se}static decodeDigit(o,a,c,u){this.recordPattern(o,c,a);let d=this.MAX_AVG_VARIANCE,g=-1,y=u.length;for(let w=0;w<y;w++){let v=u[w],T=bt.patternMatchVariance(a,v,Ht.MAX_INDIVIDUAL_VARIANCE);T<d&&(d=T,g=w)}if(g>=0)return g;throw new se}}Ht.MAX_AVG_VARIANCE=.48,Ht.MAX_INDIVIDUAL_VARIANCE=.7,Ht.START_END_PATTERN=Int32Array.from([1,1,1]),Ht.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ht.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ht.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class rs{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(o,a,c){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(a,c,u),g=u.toString(),y=rs.parseExtensionString(g),w=[new X((c[0]+c[1])/2,o),new X(d,o)],v=new Bt(g,null,0,w,ke.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&v.putAllMetadata(y),v}decodeMiddle(o,a,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1],y=0;for(let v=0;v<5&&g<d;v++){let T=Ht.decodeDigit(o,u,g,Ht.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let R of u)g+=R;T>=10&&(y|=1<<4-v),v!==4&&(g=o.getNextSet(g),g=o.getNextUnset(g))}if(c.length!==5)throw new se;let w=this.determineCheckDigit(y);if(rs.extensionChecksum(c.toString())!==w)throw new se;return g}static extensionChecksum(o){let a=o.length,c=0;for(let u=a-2;u>=0;u-=2)c+=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);c*=3;for(let u=a-1;u>=0;u-=2)c+=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);return c*=3,c%10}determineCheckDigit(o){for(let a=0;a<10;a++)if(o===this.CHECK_DIGIT_ENCODINGS[a])return a;throw new se}static parseExtensionString(o){if(o.length!==5)return null;let a=rs.parseExtension5String(o);return a==null?null:new Map([[ln.SUGGESTED_PRICE,a]])}static parseExtension5String(o){let a;switch(o.charAt(0)){case"0":a="";break;case"5":a="$";break;case"9":switch(o){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}a="";break;default:a="";break}let c=parseInt(o.substring(1)),u=(c/100).toString(),d=c%100,g=d<10?"0"+d:d.toString();return a+u+"."+g}}class Ua{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(o,a,c){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(a,c,u),g=u.toString(),y=Ua.parseExtensionString(g),w=[new X((c[0]+c[1])/2,o),new X(d,o)],v=new Bt(g,null,0,w,ke.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&v.putAllMetadata(y),v}decodeMiddle(o,a,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1],y=0;for(let w=0;w<2&&g<d;w++){let v=Ht.decodeDigit(o,u,g,Ht.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+v%10);for(let T of u)g+=T;v>=10&&(y|=1<<1-w),w!==1&&(g=o.getNextSet(g),g=o.getNextUnset(g))}if(c.length!==2)throw new se;if(parseInt(c.toString())%4!==y)throw new se;return g}static parseExtensionString(o){return o.length!==2?null:new Map([[ln.ISSUE_NUMBER,parseInt(o)]])}}class qu{static decodeRow(o,a,c){let u=Ht.findGuardPattern(a,c,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new rs().decodeRow(o,a,u)}catch{return new Ua().decodeRow(o,a,u)}}}qu.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class yt extends Ht{constructor(){super(),this.decodeRowStringBuffer="",yt.L_AND_G_PATTERNS=yt.L_PATTERNS.map(o=>Int32Array.from(o));for(let o=10;o<20;o++){let a=yt.L_PATTERNS[o-10],c=new Int32Array(a.length);for(let u=0;u<a.length;u++)c[u]=a[a.length-u-1];yt.L_AND_G_PATTERNS[o]=c}}decodeRow(o,a,c){let u=yt.findStartGuardPattern(a),d=c==null?null:c.get(J.NEED_RESULT_POINT_CALLBACK);if(d!=null){const me=new X((u[0]+u[1])/2,o);d.foundPossibleResultPoint(me)}let g=this.decodeMiddle(a,u,this.decodeRowStringBuffer),y=g.rowOffset,w=g.resultString;if(d!=null){const me=new X(y,o);d.foundPossibleResultPoint(me)}let v=this.decodeEnd(a,y);if(d!=null){const me=new X((v[0]+v[1])/2,o);d.foundPossibleResultPoint(me)}let T=v[1],R=T+(T-v[0]);if(R>=a.getSize()||!a.isRange(T,R,!1))throw new se;let O=w.toString();if(O.length<8)throw new k;if(!yt.checkChecksum(O))throw new N;let q=(u[1]+u[0])/2,Y=(v[1]+v[0])/2,Z=this.getBarcodeFormat(),ie=[new X(q,o),new X(Y,o)],ce=new Bt(O,null,0,ie,Z,new Date().getTime()),we=0;try{let me=qu.decodeRow(o,a,v[1]);ce.putMetadata(ln.UPC_EAN_EXTENSION,me.getText()),ce.putAllMetadata(me.getResultMetadata()),ce.addResultPoints(me.getResultPoints()),we=me.getText().length}catch{}let _e=c==null?null:c.get(J.ALLOWED_EAN_EXTENSIONS);if(_e!=null){let me=!1;for(let ct in _e)if(we.toString()===ct){me=!0;break}if(!me)throw new se}return ce}decodeEnd(o,a){return yt.findGuardPattern(o,a,!1,yt.START_END_PATTERN,new Int32Array(yt.START_END_PATTERN.length).fill(0))}static checkChecksum(o){return yt.checkStandardUPCEANChecksum(o)}static checkStandardUPCEANChecksum(o){let a=o.length;if(a===0)return!1;let c=parseInt(o.charAt(a-1),10);return yt.getStandardUPCEANChecksum(o.substring(0,a-1))===c}static getStandardUPCEANChecksum(o){let a=o.length,c=0;for(let u=a-1;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}c*=3;for(let u=a-2;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}return(1e3-c)%10}}class ii extends yt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(o,a,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1],y=0;for(let v=0;v<6&&g<d;v++){let T=yt.decodeDigit(o,u,g,yt.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let R of u)g+=R;T>=10&&(y|=1<<5-v)}c=ii.determineFirstDigit(c,y),g=yt.findGuardPattern(o,g,!0,yt.MIDDLE_PATTERN,new Int32Array(yt.MIDDLE_PATTERN.length).fill(0))[1];for(let v=0;v<6&&g<d;v++){let T=yt.decodeDigit(o,u,g,yt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T);for(let R of u)g+=R}return{rowOffset:g,resultString:c}}getBarcodeFormat(){return ke.EAN_13}static determineFirstDigit(o,a){for(let c=0;c<10;c++)if(a===this.FIRST_DIGIT_ENCODINGS[c])return o=String.fromCharCode("0".charCodeAt(0)+c)+o,o;throw new se}}ii.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class $l extends yt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(o,a,c){const u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1];for(let w=0;w<4&&g<d;w++){let v=yt.decodeDigit(o,u,g,yt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+v);for(let T of u)g+=T}g=yt.findGuardPattern(o,g,!0,yt.MIDDLE_PATTERN,new Int32Array(yt.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<4&&g<d;w++){let v=yt.decodeDigit(o,u,g,yt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+v);for(let T of u)g+=T}return{rowOffset:g,resultString:c}}getBarcodeFormat(){return ke.EAN_8}}class Ql extends yt{constructor(){super(...arguments),this.ean13Reader=new ii}getBarcodeFormat(){return ke.UPC_A}decode(o,a){return this.maybeReturnResult(this.ean13Reader.decode(o))}decodeRow(o,a,c){return this.maybeReturnResult(this.ean13Reader.decodeRow(o,a,c))}decodeMiddle(o,a,c){return this.ean13Reader.decodeMiddle(o,a,c)}maybeReturnResult(o){let a=o.getText();if(a.charAt(0)==="0"){let c=new Bt(a.substring(1),null,null,o.getResultPoints(),ke.UPC_A);return o.getResultMetadata()!=null&&c.putAllMetadata(o.getResultMetadata()),c}else throw new se}reset(){this.ean13Reader.reset()}}class Un extends yt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(o,a,c){const u=this.decodeMiddleCounters.map(v=>v);u[0]=0,u[1]=0,u[2]=0,u[3]=0;const d=o.getSize();let g=a[1],y=0;for(let v=0;v<6&&g<d;v++){const T=Un.decodeDigit(o,u,g,Un.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let R of u)g+=R;T>=10&&(y|=1<<5-v)}let w=Un.determineNumSysAndCheckDigit(c,y);return{rowOffset:g,resultString:w}}decodeEnd(o,a){return Un.findGuardPatternWithoutCounters(o,a,!0,Un.MIDDLE_END_PATTERN)}checkChecksum(o){return yt.checkChecksum(Un.convertUPCEtoUPCA(o))}static determineNumSysAndCheckDigit(o,a){for(let c=0;c<=1;c++)for(let u=0;u<10;u++)if(a===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[c][u]){let d=String.fromCharCode("0".charCodeAt(0)+c),g=String.fromCharCode("0".charCodeAt(0)+u);return d+o+g}throw se.getNotFoundInstance()}getBarcodeFormat(){return ke.UPC_E}static convertUPCEtoUPCA(o){const a=o.slice(1,7).split("").map(d=>d.charCodeAt(0)),c=new z;c.append(o.charAt(0));let u=a[5];switch(u){case 0:case 1:case 2:c.appendChars(a,0,2),c.append(u),c.append("0000"),c.appendChars(a,2,3);break;case 3:c.appendChars(a,0,3),c.append("00000"),c.appendChars(a,3,2);break;case 4:c.appendChars(a,0,4),c.append("00000"),c.append(a[4]);break;default:c.appendChars(a,0,5),c.append("0000"),c.append(u);break}return o.length>=8&&c.append(o.charAt(7)),c.toString()}}Un.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Un.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Xl extends bt{constructor(o){super();let a=o==null?null:o.get(J.POSSIBLE_FORMATS),c=[];r(a)?(c.push(new ii),c.push(new Ql),c.push(new $l),c.push(new Un)):(a.indexOf(ke.EAN_13)>-1&&c.push(new ii),a.indexOf(ke.UPC_A)>-1&&c.push(new Ql),a.indexOf(ke.EAN_8)>-1&&c.push(new $l),a.indexOf(ke.UPC_E)>-1&&c.push(new Un)),this.readers=c}decodeRow(o,a,c){for(let u of this.readers)try{const d=u.decodeRow(o,a,c),g=d.getBarcodeFormat()===ke.EAN_13&&d.getText().charAt(0)==="0",y=c==null?null:c.get(J.POSSIBLE_FORMATS),w=y==null||y.includes(ke.UPC_A);if(g&&w){const v=d.getRawBytes(),T=new Bt(d.getText().substring(1),v,v?v.length:null,d.getResultPoints(),ke.UPC_A);return T.putAllMetadata(d.getResultMetadata()),T}return d}catch{}throw new se}reset(){for(let o of this.readers)o.reset()}}class Cn extends bt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(o,a){for(let c=0;c<a.length;c++)if(bt.patternMatchVariance(o,a[c],Cn.MAX_INDIVIDUAL_VARIANCE)<Cn.MAX_AVG_VARIANCE)return c;throw new se}static count(o){return it.sum(new Int32Array(o))}static increment(o,a){let c=0,u=a[0];for(let d=1;d<o.length;d++)a[d]>u&&(u=a[d],c=d);o[c]++}static decrement(o,a){let c=0,u=a[0];for(let d=1;d<o.length;d++)a[d]<u&&(u=a[d],c=d);o[c]--}static isFinderPattern(o){let a=o[0]+o[1],c=a+o[2]+o[3],u=a/c;if(u>=Cn.MIN_FINDER_PATTERN_RATIO&&u<=Cn.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;for(let y of o)y>g&&(g=y),y<d&&(d=y);return g<10*d}return!1}}Cn.MAX_AVG_VARIANCE=.2,Cn.MAX_INDIVIDUAL_VARIANCE=.45,Cn.MIN_FINDER_PATTERN_RATIO=9.5/12,Cn.MAX_FINDER_PATTERN_RATIO=12.5/14;class Fs{constructor(o,a){this.value=o,this.checksumPortion=a}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(o){if(!(o instanceof Fs))return!1;const a=o;return this.value===a.value&&this.checksumPortion===a.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class is{constructor(o,a,c,u,d){this.value=o,this.startEnd=a,this.value=o,this.startEnd=a,this.resultPoints=new Array,this.resultPoints.push(new X(c,d)),this.resultPoints.push(new X(u,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(o){if(!(o instanceof is))return!1;const a=o;return this.value===a.value}hashCode(){return this.value}}class si{constructor(){}static getRSSvalue(o,a,c){let u=0;for(let w of o)u+=w;let d=0,g=0,y=o.length;for(let w=0;w<y-1;w++){let v;for(v=1,g|=1<<w;v<o[w];v++,g&=~(1<<w)){let T=si.combins(u-v-1,y-w-2);if(c&&g===0&&u-v-(y-w-1)>=y-w-1&&(T-=si.combins(u-v-(y-w),y-w-2)),y-w-1>1){let R=0;for(let O=u-v-(y-w-2);O>a;O--)R+=si.combins(u-v-O-1,y-w-3);T-=R*(y-1-w)}else u-v>a&&T--;d+=T}u-=v}return d}static combins(o,a){let c,u;o-a>a?(u=a,c=o-a):(u=o-a,c=a);let d=1,g=1;for(let y=o;y>c;y--)d*=y,g<=u&&(d/=g,g++);for(;g<=u;)d/=g,g++;return d}}class or{static buildBitArray(o){let a=o.length*2-1;o[o.length-1].getRightChar()==null&&(a-=1);let c=12*a,u=new V(c),d=0,y=o[0].getRightChar().getValue();for(let w=11;w>=0;--w)y&1<<w&&u.set(d),d++;for(let w=1;w<o.length;++w){let v=o[w],T=v.getLeftChar().getValue();for(let R=11;R>=0;--R)T&1<<R&&u.set(d),d++;if(v.getRightChar()!=null){let R=v.getRightChar().getValue();for(let O=11;O>=0;--O)R&1<<O&&u.set(d),d++}}return u}}class ss{constructor(o,a){a?this.decodedInformation=null:(this.finished=o,this.decodedInformation=a)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Vs{constructor(o){this.newPosition=o}getNewPosition(){return this.newPosition}}class On extends Vs{constructor(o,a){super(o),this.value=a}getValue(){return this.value}isFNC1(){return this.value===On.FNC1}}On.FNC1="$";class Bs extends Vs{constructor(o,a,c){super(o),c?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=a}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class jr extends Vs{constructor(o,a,c){if(super(o),a<0||a>10||c<0||c>10)throw new k;this.firstDigit=a,this.secondDigit=c}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===jr.FNC1}isSecondDigitFNC1(){return this.secondDigit===jr.FNC1}isAnyFNC1(){return this.firstDigit===jr.FNC1||this.secondDigit===jr.FNC1}}jr.FNC1=10;class Se{constructor(){}static parseFieldsInGeneralPurpose(o){if(!o)return null;if(o.length<2)throw new se;let a=o.substring(0,2);for(let d of Se.TWO_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(2,d[2],o):Se.processFixedAI(2,d[1],o);if(o.length<3)throw new se;let c=o.substring(0,3);for(let d of Se.THREE_DIGIT_DATA_LENGTH)if(d[0]===c)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(3,d[2],o):Se.processFixedAI(3,d[1],o);for(let d of Se.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===c)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(4,d[2],o):Se.processFixedAI(4,d[1],o);if(o.length<4)throw new se;let u=o.substring(0,4);for(let d of Se.FOUR_DIGIT_DATA_LENGTH)if(d[0]===u)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(4,d[2],o):Se.processFixedAI(4,d[1],o);throw new se}static processFixedAI(o,a,c){if(c.length<o)throw new se;let u=c.substring(0,o);if(c.length<o+a)throw new se;let d=c.substring(o,o+a),g=c.substring(o+a),y="("+u+")"+d,w=Se.parseFieldsInGeneralPurpose(g);return w==null?y:y+w}static processVariableAI(o,a,c){let u=c.substring(0,o),d;c.length<o+a?d=c.length:d=o+a;let g=c.substring(o,d),y=c.substring(d),w="("+u+")"+g,v=Se.parseFieldsInGeneralPurpose(y);return v==null?w:w+v}}Se.VARIABLE_LENGTH=[],Se.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Se.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Se.VARIABLE_LENGTH,20],["22",Se.VARIABLE_LENGTH,29],["30",Se.VARIABLE_LENGTH,8],["37",Se.VARIABLE_LENGTH,8],["90",Se.VARIABLE_LENGTH,30],["91",Se.VARIABLE_LENGTH,30],["92",Se.VARIABLE_LENGTH,30],["93",Se.VARIABLE_LENGTH,30],["94",Se.VARIABLE_LENGTH,30],["95",Se.VARIABLE_LENGTH,30],["96",Se.VARIABLE_LENGTH,30],["97",Se.VARIABLE_LENGTH,3],["98",Se.VARIABLE_LENGTH,30],["99",Se.VARIABLE_LENGTH,30]],Se.THREE_DIGIT_DATA_LENGTH=[["240",Se.VARIABLE_LENGTH,30],["241",Se.VARIABLE_LENGTH,30],["242",Se.VARIABLE_LENGTH,6],["250",Se.VARIABLE_LENGTH,30],["251",Se.VARIABLE_LENGTH,30],["253",Se.VARIABLE_LENGTH,17],["254",Se.VARIABLE_LENGTH,20],["400",Se.VARIABLE_LENGTH,30],["401",Se.VARIABLE_LENGTH,30],["402",17],["403",Se.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Se.VARIABLE_LENGTH,20],["421",Se.VARIABLE_LENGTH,15],["422",3],["423",Se.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Se.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Se.VARIABLE_LENGTH,15],["391",Se.VARIABLE_LENGTH,18],["392",Se.VARIABLE_LENGTH,15],["393",Se.VARIABLE_LENGTH,18],["703",Se.VARIABLE_LENGTH,30]],Se.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Se.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Se.VARIABLE_LENGTH,20],["8003",Se.VARIABLE_LENGTH,30],["8004",Se.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Se.VARIABLE_LENGTH,30],["8008",Se.VARIABLE_LENGTH,12],["8018",18],["8020",Se.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Se.VARIABLE_LENGTH,70],["8200",Se.VARIABLE_LENGTH,70]];class Io{constructor(o){this.buffer=new z,this.information=o}decodeAllCodes(o,a){let c=a,u=null;do{let d=this.decodeGeneralPurposeField(c,u),g=Se.parseFieldsInGeneralPurpose(d.getNewString());if(g!=null&&o.append(g),d.isRemaining()?u=""+d.getRemainingValue():u=null,c===d.getNewPosition())break;c=d.getNewPosition()}while(!0);return o.toString()}isStillNumeric(o){if(o+7>this.information.getSize())return o+4<=this.information.getSize();for(let a=o;a<o+3;++a)if(this.information.get(a))return!0;return this.information.get(o+3)}decodeNumeric(o){if(o+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(o,4);return d===0?new jr(this.information.getSize(),jr.FNC1,jr.FNC1):new jr(this.information.getSize(),d-1,jr.FNC1)}let a=this.extractNumericValueFromBitArray(o,7),c=(a-8)/11,u=(a-8)%11;return new jr(o+7,c,u)}extractNumericValueFromBitArray(o,a){return Io.extractNumericValueFromBitArray(this.information,o,a)}static extractNumericValueFromBitArray(o,a,c){let u=0;for(let d=0;d<c;++d)o.get(a+d)&&(u|=1<<c-d-1);return u}decodeGeneralPurposeField(o,a){this.buffer.setLengthToZero(),a!=null&&this.buffer.append(a),this.current.setPosition(o);let c=this.parseBlocks();return c!=null&&c.isRemaining()?new Bs(this.current.getPosition(),this.buffer.toString(),c.getRemainingValue()):new Bs(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let o,a;do{let c=this.current.getPosition();if(this.current.isAlpha()?(a=this.parseAlphaBlock(),o=a.isFinished()):this.current.isIsoIec646()?(a=this.parseIsoIec646Block(),o=a.isFinished()):(a=this.parseNumericBlock(),o=a.isFinished()),!(c!==this.current.getPosition())&&!o)break}while(!o);return a.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let o=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFirstDigitFNC1()){let a;return o.isSecondDigitFNC1()?a=new Bs(this.current.getPosition(),this.buffer.toString()):a=new Bs(this.current.getPosition(),this.buffer.toString(),o.getSecondDigit()),new ss(!0,a)}if(this.buffer.append(o.getFirstDigit()),o.isSecondDigitFNC1()){let a=new Bs(this.current.getPosition(),this.buffer.toString());return new ss(!0,a)}this.buffer.append(o.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ss(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let o=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFNC1()){let a=new Bs(this.current.getPosition(),this.buffer.toString());return new ss(!0,a)}this.buffer.append(o.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ss(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let o=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFNC1()){let a=new Bs(this.current.getPosition(),this.buffer.toString());return new ss(!0,a)}this.buffer.append(o.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ss(!1)}isStillIsoIec646(o){if(o+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(o,5);if(a>=5&&a<16)return!0;if(o+7>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(o,7);if(c>=64&&c<116)return!0;if(o+8>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(o,8);return u>=232&&u<253}decodeIsoIec646(o){let a=this.extractNumericValueFromBitArray(o,5);if(a===15)return new On(o+5,On.FNC1);if(a>=5&&a<15)return new On(o+5,"0"+(a-5));let c=this.extractNumericValueFromBitArray(o,7);if(c>=64&&c<90)return new On(o+7,""+(c+1));if(c>=90&&c<116)return new On(o+7,""+(c+7));let u=this.extractNumericValueFromBitArray(o,8),d;switch(u){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new k}return new On(o+8,d)}isStillAlpha(o){if(o+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(o,5);if(a>=5&&a<16)return!0;if(o+6>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(o,6);return c>=16&&c<63}decodeAlphanumeric(o){let a=this.extractNumericValueFromBitArray(o,5);if(a===15)return new On(o+5,On.FNC1);if(a>=5&&a<15)return new On(o+5,"0"+(a-5));let c=this.extractNumericValueFromBitArray(o,6);if(c>=32&&c<58)return new On(o+6,""+(c+33));let u;switch(c){case 58:u="*";break;case 59:u=",";break;case 60:u="-";break;case 61:u=".";break;case 62:u="/";break;default:throw new sr("Decoding invalid alphanumeric value: "+c)}return new On(o+6,u)}isAlphaTo646ToAlphaLatch(o){if(o+1>this.information.getSize())return!1;for(let a=0;a<5&&a+o<this.information.getSize();++a)if(a===2){if(!this.information.get(o+2))return!1}else if(this.information.get(o+a))return!1;return!0}isAlphaOr646ToNumericLatch(o){if(o+3>this.information.getSize())return!1;for(let a=o;a<o+3;++a)if(this.information.get(a))return!1;return!0}isNumericToAlphaNumericLatch(o){if(o+1>this.information.getSize())return!1;for(let a=0;a<4&&a+o<this.information.getSize();++a)if(this.information.get(o+a))return!1;return!0}}class Hu{constructor(o){this.information=o,this.generalDecoder=new Io(o)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class jn extends Hu{constructor(o){super(o)}encodeCompressedGtin(o,a){o.append("(01)");let c=o.length();o.append("9"),this.encodeCompressedGtinWithoutAI(o,a,c)}encodeCompressedGtinWithoutAI(o,a,c){for(let u=0;u<4;++u){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(a+10*u,10);d/100===0&&o.append("0"),d/10===0&&o.append("0"),o.append(d)}jn.appendCheckDigit(o,c)}static appendCheckDigit(o,a){let c=0;for(let u=0;u<13;u++){let d=o.charAt(u+a).charCodeAt(0)-"0".charCodeAt(0);c+=u&1?d:3*d}c=10-c%10,c===10&&(c=0),o.append(c)}}jn.GTIN_SIZE=40;class Us extends jn{constructor(o){super(o)}parseInformation(){let o=new z;o.append("(01)");let a=o.length(),c=this.getGeneralDecoder().extractNumericValueFromBitArray(Us.HEADER_SIZE,4);return o.append(c),this.encodeCompressedGtinWithoutAI(o,Us.HEADER_SIZE+4,a),this.getGeneralDecoder().decodeAllCodes(o,Us.HEADER_SIZE+44)}}Us.HEADER_SIZE=1+1+2;class Ao extends Hu{constructor(o){super(o)}parseInformation(){let o=new z;return this.getGeneralDecoder().decodeAllCodes(o,Ao.HEADER_SIZE)}}Ao.HEADER_SIZE=2+1+2;class js extends jn{constructor(o){super(o)}encodeCompressedWeight(o,a,c){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(a,c);this.addWeightCode(o,u);let d=this.checkWeight(u),g=1e5;for(let y=0;y<5;++y)d/g===0&&o.append("0"),g/=10;o.append(d)}}class zn extends js{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()!=zn.HEADER_SIZE+js.GTIN_SIZE+zn.WEIGHT_SIZE)throw new se;let o=new z;return this.encodeCompressedGtin(o,zn.HEADER_SIZE),this.encodeCompressedWeight(o,zn.HEADER_SIZE+js.GTIN_SIZE,zn.WEIGHT_SIZE),o.toString()}}zn.HEADER_SIZE=4+1,zn.WEIGHT_SIZE=15;class df extends zn{constructor(o){super(o)}addWeightCode(o,a){o.append("(3103)")}checkWeight(o){return o}}class ff extends zn{constructor(o){super(o)}addWeightCode(o,a){a<1e4?o.append("(3202)"):o.append("(3203)")}checkWeight(o){return o<1e4?o:o-1e4}}class zr extends jn{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()<zr.HEADER_SIZE+jn.GTIN_SIZE)throw new se;let o=new z;this.encodeCompressedGtin(o,zr.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(zr.HEADER_SIZE+jn.GTIN_SIZE,zr.LAST_DIGIT_SIZE);o.append("(392"),o.append(a),o.append(")");let c=this.getGeneralDecoder().decodeGeneralPurposeField(zr.HEADER_SIZE+jn.GTIN_SIZE+zr.LAST_DIGIT_SIZE,null);return o.append(c.getNewString()),o.toString()}}zr.HEADER_SIZE=5+1+2,zr.LAST_DIGIT_SIZE=2;class Gn extends jn{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()<Gn.HEADER_SIZE+jn.GTIN_SIZE)throw new se;let o=new z;this.encodeCompressedGtin(o,Gn.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Gn.HEADER_SIZE+jn.GTIN_SIZE,Gn.LAST_DIGIT_SIZE);o.append("(393"),o.append(a),o.append(")");let c=this.getGeneralDecoder().extractNumericValueFromBitArray(Gn.HEADER_SIZE+jn.GTIN_SIZE+Gn.LAST_DIGIT_SIZE,Gn.FIRST_THREE_DIGITS_SIZE);c/100==0&&o.append("0"),c/10==0&&o.append("0"),o.append(c);let u=this.getGeneralDecoder().decodeGeneralPurposeField(Gn.HEADER_SIZE+jn.GTIN_SIZE+Gn.LAST_DIGIT_SIZE+Gn.FIRST_THREE_DIGITS_SIZE,null);return o.append(u.getNewString()),o.toString()}}Gn.HEADER_SIZE=5+1+2,Gn.LAST_DIGIT_SIZE=2,Gn.FIRST_THREE_DIGITS_SIZE=10;class Ut extends js{constructor(o,a,c){super(o),this.dateCode=c,this.firstAIdigits=a}parseInformation(){if(this.getInformation().getSize()!=Ut.HEADER_SIZE+Ut.GTIN_SIZE+Ut.WEIGHT_SIZE+Ut.DATE_SIZE)throw new se;let o=new z;return this.encodeCompressedGtin(o,Ut.HEADER_SIZE),this.encodeCompressedWeight(o,Ut.HEADER_SIZE+Ut.GTIN_SIZE,Ut.WEIGHT_SIZE),this.encodeCompressedDate(o,Ut.HEADER_SIZE+Ut.GTIN_SIZE+Ut.WEIGHT_SIZE),o.toString()}encodeCompressedDate(o,a){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(a,Ut.DATE_SIZE);if(c==38400)return;o.append("("),o.append(this.dateCode),o.append(")");let u=c%32;c/=32;let d=c%12+1;c/=12;let g=c;g/10==0&&o.append("0"),o.append(g),d/10==0&&o.append("0"),o.append(d),u/10==0&&o.append("0"),o.append(u)}addWeightCode(o,a){o.append("("),o.append(this.firstAIdigits),o.append(a/1e5),o.append(")")}checkWeight(o){return o%1e5}}Ut.HEADER_SIZE=7+1,Ut.WEIGHT_SIZE=20,Ut.DATE_SIZE=16;function Wu(S){try{if(S.get(1))return new Us(S);if(!S.get(2))return new Ao(S);switch(Io.extractNumericValueFromBitArray(S,1,4)){case 4:return new df(S);case 5:return new ff(S)}switch(Io.extractNumericValueFromBitArray(S,1,5)){case 12:return new zr(S);case 13:return new Gn(S)}switch(Io.extractNumericValueFromBitArray(S,1,7)){case 56:return new Ut(S,"310","11");case 57:return new Ut(S,"320","11");case 58:return new Ut(S,"310","13");case 59:return new Ut(S,"320","13");case 60:return new Ut(S,"310","15");case 61:return new Ut(S,"320","15");case 62:return new Ut(S,"310","17");case 63:return new Ut(S,"320","17")}}catch(o){throw console.log(o),new sr("unknown decoder: "+S)}}class os{constructor(o,a,c,u){this.leftchar=o,this.rightchar=a,this.finderpattern=c,this.maybeLast=u}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(o,a){return o instanceof os?os.equalsOrNull(o.leftchar,a.leftchar)&&os.equalsOrNull(o.rightchar,a.rightchar)&&os.equalsOrNull(o.finderpattern,a.finderpattern):!1}static equalsOrNull(o,a){return o===null?a===null:os.equals(o,a)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class To{constructor(o,a,c){this.pairs=o,this.rowNumber=a,this.wasReversed=c}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(o){return this.checkEqualitity(this,o)}toString(){return"{ "+this.pairs+" }"}equals(o,a){return o instanceof To?this.checkEqualitity(o,a)&&o.wasReversed===a.wasReversed:!1}checkEqualitity(o,a){if(!o||!a)return;let c;return o.forEach((u,d)=>{a.forEach(g=>{u.getLeftChar().getValue()===g.getLeftChar().getValue()&&u.getRightChar().getValue()===g.getRightChar().getValue()&&u.getFinderPatter().getValue()===g.getFinderPatter().getValue()&&(c=!0)})}),c}}class de extends Cn{constructor(o){super(...arguments),this.pairs=new Array(de.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=o===!0}decodeRow(o,a,c){this.pairs.length=0,this.startFromEven=!1;try{return de.constructResult(this.decodeRow2pairs(o,a))}catch(u){this.verbose&&console.log(u)}return this.pairs.length=0,this.startFromEven=!0,de.constructResult(this.decodeRow2pairs(o,a))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(o,a){let c=!1;for(;!c;)try{this.pairs.push(this.retrieveNextPair(a,this.pairs,o))}catch(d){if(d instanceof se){if(!this.pairs.length)throw new se;c=!0}}if(this.checkChecksum())return this.pairs;let u;if(this.rows.length?u=!0:u=!1,this.storeRow(o,!1),u){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new se}checkRowsBoolean(o){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,o&&(this.rows=this.rows.reverse());let a=null;try{a=this.checkRows(new Array,0)}catch(c){this.verbose&&console.log(c)}return o&&(this.rows=this.rows.reverse()),a}checkRows(o,a){for(let c=a;c<this.rows.length;c++){let u=this.rows[c];this.pairs.length=0;for(let g of o)this.pairs.push(g.getPairs());if(this.pairs.push(u.getPairs()),!de.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(o);d.push(u);try{return this.checkRows(d,c+1)}catch(g){this.verbose&&console.log(g)}}throw new se}static isValidSequence(o){for(let a of de.FINDER_PATTERN_SEQUENCES){if(o.length>a.length)continue;let c=!0;for(let u=0;u<o.length;u++)if(o[u].getFinderPattern().getValue()!=a[u]){c=!1;break}if(c)return!0}return!1}storeRow(o,a){let c=0,u=!1,d=!1;for(;c<this.rows.length;){let g=this.rows[c];if(g.getRowNumber()>o){d=g.isEquivalent(this.pairs);break}u=g.isEquivalent(this.pairs),c++}d||u||de.isPartialRow(this.pairs,this.rows)||(this.rows.push(c,new To(this.pairs,o,a)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(o,a){for(let c of a)if(c.getPairs().length!==o.length){for(let u of c.getPairs())for(let d of o)if(os.equals(u,d))break}}static isPartialRow(o,a){for(let c of a){let u=!0;for(let d of o){let g=!1;for(let y of c.getPairs())if(d.equals(y)){g=!0;break}if(!g){u=!1;break}}if(u)return!0}return!1}getRows(){return this.rows}static constructResult(o){let a=or.buildBitArray(o),u=Wu(a).parseInformation(),d=o[0].getFinderPattern().getResultPoints(),g=o[o.length-1].getFinderPattern().getResultPoints(),y=[d[0],d[1],g[0],g[1]];return new Bt(u,null,null,y,ke.RSS_EXPANDED,null)}checkChecksum(){let o=this.pairs.get(0),a=o.getLeftChar(),c=o.getRightChar();if(c==null)return!1;let u=c.getChecksumPortion(),d=2;for(let y=1;y<this.pairs.size();++y){let w=this.pairs.get(y);u+=w.getLeftChar().getChecksumPortion(),d++;let v=w.getRightChar();v!=null&&(u+=v.getChecksumPortion(),d++)}return u%=211,211*(d-4)+u==a.getValue()}static getNextSecondBar(o,a){let c;return o.get(a)?(c=o.getNextUnset(a),c=o.getNextSet(c)):(c=o.getNextSet(a),c=o.getNextUnset(c)),c}retrieveNextPair(o,a,c){let u=a.length%2==0;this.startFromEven&&(u=!u);let d,g=!0,y=-1;do this.findNextPair(o,a,y),d=this.parseFoundFinderPattern(o,c,u),d==null?y=de.getNextSecondBar(o,this.startEnd[0]):g=!1;while(g);let w=this.decodeDataCharacter(o,d,u,!0);if(!this.isEmptyPair(a)&&a[a.length-1].mustBeLast())throw new se;let v;try{v=this.decodeDataCharacter(o,d,u,!1)}catch(T){v=null,this.verbose&&console.log(T)}return new os(w,v,d,!0)}isEmptyPair(o){return o.length===0}findNextPair(o,a,c){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g;c>=0?g=c:this.isEmptyPair(a)?g=0:g=a[a.length-1].getFinderPattern().getStartEnd()[1];let y=a.length%2!=0;this.startFromEven&&(y=!y);let w=!1;for(;g<d&&(w=!o.get(g),!!w);)g++;let v=0,T=g;for(let R=g;R<d;R++)if(o.get(R)!=w)u[v]++;else{if(v==3){if(y&&de.reverseCounters(u),de.isFinderPattern(u)){this.startEnd[0]=T,this.startEnd[1]=R;return}y&&de.reverseCounters(u),T+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,v--}else v++;u[v]=1,w=!w}throw new se}static reverseCounters(o){let a=o.length;for(let c=0;c<a/2;++c){let u=o[c];o[c]=o[a-c-1],o[a-c-1]=u}}parseFoundFinderPattern(o,a,c){let u,d,g;if(c){let v=this.startEnd[0]-1;for(;v>=0&&!o.get(v);)v--;v++,u=this.startEnd[0]-v,d=v,g=this.startEnd[1]}else d=this.startEnd[0],g=o.getNextUnset(this.startEnd[1]+1),u=g-this.startEnd[1];let y=this.getDecodeFinderCounters();D.arraycopy(y,0,y,1,y.length-1),y[0]=u;let w;try{w=this.parseFinderValue(y,de.FINDER_PATTERNS)}catch{return null}return new is(w,[d,g],d,g,a)}decodeDataCharacter(o,a,c,u){let d=this.getDataCharacterCounters();for(let zt=0;zt<d.length;zt++)d[zt]=0;if(u)de.recordPatternInReverse(o,a.getStartEnd()[0],d);else{de.recordPattern(o,a.getStartEnd()[1],d);for(let zt=0,lr=d.length-1;zt<lr;zt++,lr--){let ai=d[zt];d[zt]=d[lr],d[lr]=ai}}let g=17,y=it.sum(new Int32Array(d))/g,w=(a.getStartEnd()[1]-a.getStartEnd()[0])/15;if(Math.abs(y-w)/w>.3)throw new se;let v=this.getOddCounts(),T=this.getEvenCounts(),R=this.getOddRoundingErrors(),O=this.getEvenRoundingErrors();for(let zt=0;zt<d.length;zt++){let lr=1*d[zt]/y,ai=lr+.5;if(ai<1){if(lr<.3)throw new se;ai=1}else if(ai>8){if(lr>8.7)throw new se;ai=8}let ic=zt/2;zt&1?(T[ic]=ai,O[ic]=lr-ai):(v[ic]=ai,R[ic]=lr-ai)}this.adjustOddEvenCounts(g);let q=4*a.getValue()+(c?0:2)+(u?0:1)-1,Y=0,Z=0;for(let zt=v.length-1;zt>=0;zt--){if(de.isNotA1left(a,c,u)){let lr=de.WEIGHTS[q][2*zt];Z+=v[zt]*lr}Y+=v[zt]}let ie=0;for(let zt=T.length-1;zt>=0;zt--)if(de.isNotA1left(a,c,u)){let lr=de.WEIGHTS[q][2*zt+1];ie+=T[zt]*lr}let ce=Z+ie;if(Y&1||Y>13||Y<4)throw new se;let we=(13-Y)/2,_e=de.SYMBOL_WIDEST[we],me=9-_e,ct=si.getRSSvalue(v,_e,!0),et=si.getRSSvalue(T,me,!1),Hr=de.EVEN_TOTAL_SUBSET[we],Bi=de.GSUM[we],Wr=ct*Hr+et+Bi;return new Fs(Wr,ce)}static isNotA1left(o,a,c){return!(o.getValue()==0&&a&&c)}adjustOddEvenCounts(o){let a=it.sum(new Int32Array(this.getOddCounts())),c=it.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1;a>13?d=!0:a<4&&(u=!0);let g=!1,y=!1;c>13?y=!0:c<4&&(g=!0);let w=a+c-o,v=(a&1)==1,T=(c&1)==0;if(w==1)if(v){if(T)throw new se;d=!0}else{if(!T)throw new se;y=!0}else if(w==-1)if(v){if(T)throw new se;u=!0}else{if(!T)throw new se;g=!0}else if(w==0){if(v){if(!T)throw new se;a<c?(u=!0,y=!0):(d=!0,g=!0)}else if(T)throw new se}else throw new se;if(u){if(d)throw new se;de.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&de.decrement(this.getOddCounts(),this.getOddRoundingErrors()),g){if(y)throw new se;de.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&de.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}de.SYMBOL_WIDEST=[7,5,4,3,1],de.EVEN_TOTAL_SUBSET=[4,20,52,104,204],de.GSUM=[0,348,1388,2948,3988],de.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],de.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],de.FINDER_PAT_A=0,de.FINDER_PAT_B=1,de.FINDER_PAT_C=2,de.FINDER_PAT_D=3,de.FINDER_PAT_E=4,de.FINDER_PAT_F=5,de.FINDER_PATTERN_SEQUENCES=[[de.FINDER_PAT_A,de.FINDER_PAT_A],[de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B],[de.FINDER_PAT_A,de.FINDER_PAT_C,de.FINDER_PAT_B,de.FINDER_PAT_D],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_C],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_D,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_D],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_E],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F]],de.MAX_PAIRS=11;class Ku extends Fs{constructor(o,a,c){super(o,a),this.count=0,this.finderPattern=c}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Mt extends Cn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(o,a,c){const u=this.decodePair(a,!1,o,c);Mt.addOrTally(this.possibleLeftPairs,u),a.reverse();let d=this.decodePair(a,!0,o,c);Mt.addOrTally(this.possibleRightPairs,d),a.reverse();for(let g of this.possibleLeftPairs)if(g.getCount()>1){for(let y of this.possibleRightPairs)if(y.getCount()>1&&Mt.checkChecksum(g,y))return Mt.constructResult(g,y)}throw new se}static addOrTally(o,a){if(a==null)return;let c=!1;for(let u of o)if(u.getValue()===a.getValue()){u.incrementCount(),c=!0;break}c||o.push(a)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(o,a){let c=4537077*o.getValue()+a.getValue(),u=new String(c).toString(),d=new z;for(let v=13-u.length;v>0;v--)d.append("0");d.append(u);let g=0;for(let v=0;v<13;v++){let T=d.charAt(v).charCodeAt(0)-"0".charCodeAt(0);g+=v&1?T:3*T}g=10-g%10,g===10&&(g=0),d.append(g.toString());let y=o.getFinderPattern().getResultPoints(),w=a.getFinderPattern().getResultPoints();return new Bt(d.toString(),null,0,[y[0],y[1],w[0],w[1]],ke.RSS_14,new Date().getTime())}static checkChecksum(o,a){let c=(o.getChecksumPortion()+16*a.getChecksumPortion())%79,u=9*o.getFinderPattern().getValue()+a.getFinderPattern().getValue();return u>72&&u--,u>8&&u--,c===u}decodePair(o,a,c,u){try{let d=this.findFinderPattern(o,a),g=this.parseFoundFinderPattern(o,c,a,d),y=u==null?null:u.get(J.NEED_RESULT_POINT_CALLBACK);if(y!=null){let T=(d[0]+d[1])/2;a&&(T=o.getSize()-1-T),y.foundPossibleResultPoint(new X(T,c))}let w=this.decodeDataCharacter(o,g,!0),v=this.decodeDataCharacter(o,g,!1);return new Ku(1597*w.getValue()+v.getValue(),w.getChecksumPortion()+4*v.getChecksumPortion(),g)}catch{return null}}decodeDataCharacter(o,a,c){let u=this.getDataCharacterCounters();for(let ie=0;ie<u.length;ie++)u[ie]=0;if(c)bt.recordPatternInReverse(o,a.getStartEnd()[0],u);else{bt.recordPattern(o,a.getStartEnd()[1]+1,u);for(let ie=0,ce=u.length-1;ie<ce;ie++,ce--){let we=u[ie];u[ie]=u[ce],u[ce]=we}}let d=c?16:15,g=it.sum(new Int32Array(u))/d,y=this.getOddCounts(),w=this.getEvenCounts(),v=this.getOddRoundingErrors(),T=this.getEvenRoundingErrors();for(let ie=0;ie<u.length;ie++){let ce=u[ie]/g,we=Math.floor(ce+.5);we<1?we=1:we>8&&(we=8);let _e=Math.floor(ie/2);ie&1?(w[_e]=we,T[_e]=ce-we):(y[_e]=we,v[_e]=ce-we)}this.adjustOddEvenCounts(c,d);let R=0,O=0;for(let ie=y.length-1;ie>=0;ie--)O*=9,O+=y[ie],R+=y[ie];let q=0,Y=0;for(let ie=w.length-1;ie>=0;ie--)q*=9,q+=w[ie],Y+=w[ie];let Z=O+3*q;if(c){if(R&1||R>12||R<4)throw new se;let ie=(12-R)/2,ce=Mt.OUTSIDE_ODD_WIDEST[ie],we=9-ce,_e=si.getRSSvalue(y,ce,!1),me=si.getRSSvalue(w,we,!0),ct=Mt.OUTSIDE_EVEN_TOTAL_SUBSET[ie],et=Mt.OUTSIDE_GSUM[ie];return new Fs(_e*ct+me+et,Z)}else{if(Y&1||Y>10||Y<4)throw new se;let ie=(10-Y)/2,ce=Mt.INSIDE_ODD_WIDEST[ie],we=9-ce,_e=si.getRSSvalue(y,ce,!0),me=si.getRSSvalue(w,we,!1),ct=Mt.INSIDE_ODD_TOTAL_SUBSET[ie],et=Mt.INSIDE_GSUM[ie];return new Fs(me*ct+_e+et,Z)}}findFinderPattern(o,a){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=o.getSize(),d=!1,g=0;for(;g<u&&(d=!o.get(g),a!==d);)g++;let y=0,w=g;for(let v=g;v<u;v++)if(o.get(v)!==d)c[y]++;else{if(y===3){if(Cn.isFinderPattern(c))return[w,v];w+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,y--}else y++;c[y]=1,d=!d}throw new se}parseFoundFinderPattern(o,a,c,u){let d=o.get(u[0]),g=u[0]-1;for(;g>=0&&d!==o.get(g);)g--;g++;const y=u[0]-g,w=this.getDecodeFinderCounters(),v=new Int32Array(w.length);D.arraycopy(w,0,v,1,w.length-1),v[0]=y;const T=this.parseFinderValue(v,Mt.FINDER_PATTERNS);let R=g,O=u[1];return c&&(R=o.getSize()-1-R,O=o.getSize()-1-O),new is(T,[g,u[1]],R,O,a)}adjustOddEvenCounts(o,a){let c=it.sum(new Int32Array(this.getOddCounts())),u=it.sum(new Int32Array(this.getEvenCounts())),d=!1,g=!1,y=!1,w=!1;o?(c>12?g=!0:c<4&&(d=!0),u>12?w=!0:u<4&&(y=!0)):(c>11?g=!0:c<5&&(d=!0),u>10?w=!0:u<4&&(y=!0));let v=c+u-a,T=(c&1)===(o?1:0),R=(u&1)===1;if(v===1)if(T){if(R)throw new se;g=!0}else{if(!R)throw new se;w=!0}else if(v===-1)if(T){if(R)throw new se;d=!0}else{if(!R)throw new se;y=!0}else if(v===0){if(T){if(!R)throw new se;c<u?(d=!0,w=!0):(g=!0,y=!0)}else if(R)throw new se}else throw new se;if(d){if(g)throw new se;Cn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&Cn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),y){if(w)throw new se;Cn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&Cn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Mt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Mt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Mt.OUTSIDE_GSUM=[0,161,961,2015,2715],Mt.INSIDE_GSUM=[0,336,1036,1516],Mt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Mt.INSIDE_ODD_WIDEST=[2,4,6,8],Mt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Gr extends bt{constructor(o,a){super(),this.readers=[],this.verbose=a===!0;const c=o?o.get(J.POSSIBLE_FORMATS):null,u=o&&o.get(J.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;c?((c.includes(ke.EAN_13)||c.includes(ke.UPC_A)||c.includes(ke.EAN_8)||c.includes(ke.UPC_E))&&this.readers.push(new Xl(o)),c.includes(ke.CODE_39)&&this.readers.push(new tn(u)),c.includes(ke.CODE_128)&&this.readers.push(new Ee),c.includes(ke.ITF)&&this.readers.push(new pt),c.includes(ke.RSS_14)&&this.readers.push(new Mt),c.includes(ke.RSS_EXPANDED)&&this.readers.push(new de(this.verbose))):(this.readers.push(new Xl(o)),this.readers.push(new tn),this.readers.push(new Xl(o)),this.readers.push(new Ee),this.readers.push(new pt),this.readers.push(new Mt),this.readers.push(new de(this.verbose)))}decodeRow(o,a,c){for(let u=0;u<this.readers.length;u++)try{return this.readers[u].decodeRow(o,a,c)}catch{}throw new se}reset(){this.readers.forEach(o=>o.reset())}}class $u extends Tt{constructor(o=500,a){super(new Gr(a),o,a)}}class Ct{constructor(o,a,c){this.ecCodewords=o,this.ecBlocks=[a],c&&this.ecBlocks.push(c)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class xt{constructor(o,a){this.count=o,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class st{constructor(o,a,c,u,d,g){this.versionNumber=o,this.symbolSizeRows=a,this.symbolSizeColumns=c,this.dataRegionSizeRows=u,this.dataRegionSizeColumns=d,this.ecBlocks=g;let y=0;const w=g.getECCodewords(),v=g.getECBlocks();for(let T of v)y+=T.getCount()*(T.getDataCodewords()+w);this.totalCodewords=y}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(o,a){if(o&1||a&1)throw new k;for(let c of st.VERSIONS)if(c.symbolSizeRows===o&&c.symbolSizeColumns===a)return c;throw new k}toString(){return""+this.versionNumber}static buildVersions(){return[new st(1,10,10,8,8,new Ct(5,new xt(1,3))),new st(2,12,12,10,10,new Ct(7,new xt(1,5))),new st(3,14,14,12,12,new Ct(10,new xt(1,8))),new st(4,16,16,14,14,new Ct(12,new xt(1,12))),new st(5,18,18,16,16,new Ct(14,new xt(1,18))),new st(6,20,20,18,18,new Ct(18,new xt(1,22))),new st(7,22,22,20,20,new Ct(20,new xt(1,30))),new st(8,24,24,22,22,new Ct(24,new xt(1,36))),new st(9,26,26,24,24,new Ct(28,new xt(1,44))),new st(10,32,32,14,14,new Ct(36,new xt(1,62))),new st(11,36,36,16,16,new Ct(42,new xt(1,86))),new st(12,40,40,18,18,new Ct(48,new xt(1,114))),new st(13,44,44,20,20,new Ct(56,new xt(1,144))),new st(14,48,48,22,22,new Ct(68,new xt(1,174))),new st(15,52,52,24,24,new Ct(42,new xt(2,102))),new st(16,64,64,14,14,new Ct(56,new xt(2,140))),new st(17,72,72,16,16,new Ct(36,new xt(4,92))),new st(18,80,80,18,18,new Ct(48,new xt(4,114))),new st(19,88,88,20,20,new Ct(56,new xt(4,144))),new st(20,96,96,22,22,new Ct(68,new xt(4,174))),new st(21,104,104,24,24,new Ct(56,new xt(6,136))),new st(22,120,120,18,18,new Ct(68,new xt(6,175))),new st(23,132,132,20,20,new Ct(62,new xt(8,163))),new st(24,144,144,22,22,new Ct(62,new xt(8,156),new xt(2,155))),new st(25,8,18,6,16,new Ct(7,new xt(1,5))),new st(26,8,32,6,14,new Ct(11,new xt(1,10))),new st(27,12,26,10,24,new Ct(14,new xt(1,16))),new st(28,12,36,10,16,new Ct(18,new xt(1,22))),new st(29,16,36,14,16,new Ct(24,new xt(1,32))),new st(30,16,48,14,22,new Ct(28,new xt(1,49)))]}}st.VERSIONS=st.buildVersions();class Yl{constructor(o){const a=o.getHeight();if(a<8||a>144||a&1)throw new k;this.version=Yl.readVersion(o),this.mappingBitMatrix=this.extractDataRegion(o),this.readMappingMatrix=new Ge(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(o){const a=o.getHeight(),c=o.getWidth();return st.getVersionForDimensions(a,c)}readCodewords(){const o=new Int8Array(this.version.getTotalCodewords());let a=0,c=4,u=0;const d=this.mappingBitMatrix.getHeight(),g=this.mappingBitMatrix.getWidth();let y=!1,w=!1,v=!1,T=!1;do if(c===d&&u===0&&!y)o[a++]=this.readCorner1(d,g)&255,c-=2,u+=2,y=!0;else if(c===d-2&&u===0&&g&3&&!w)o[a++]=this.readCorner2(d,g)&255,c-=2,u+=2,w=!0;else if(c===d+4&&u===2&&!(g&7)&&!v)o[a++]=this.readCorner3(d,g)&255,c-=2,u+=2,v=!0;else if(c===d-2&&u===0&&(g&7)===4&&!T)o[a++]=this.readCorner4(d,g)&255,c-=2,u+=2,T=!0;else{do c<d&&u>=0&&!this.readMappingMatrix.get(u,c)&&(o[a++]=this.readUtah(c,u,d,g)&255),c-=2,u+=2;while(c>=0&&u<g);c+=1,u+=3;do c>=0&&u<g&&!this.readMappingMatrix.get(u,c)&&(o[a++]=this.readUtah(c,u,d,g)&255),c+=2,u-=2;while(c<d&&u>=0);c+=3,u+=1}while(c<d||u<g);if(a!==this.version.getTotalCodewords())throw new k;return o}readModule(o,a,c,u){return o<0&&(o+=c,a+=4-(c+4&7)),a<0&&(a+=u,o+=4-(u+4&7)),this.readMappingMatrix.set(a,o),this.mappingBitMatrix.get(a,o)}readUtah(o,a,c,u){let d=0;return this.readModule(o-2,a-2,c,u)&&(d|=1),d<<=1,this.readModule(o-2,a-1,c,u)&&(d|=1),d<<=1,this.readModule(o-1,a-2,c,u)&&(d|=1),d<<=1,this.readModule(o-1,a-1,c,u)&&(d|=1),d<<=1,this.readModule(o-1,a,c,u)&&(d|=1),d<<=1,this.readModule(o,a-2,c,u)&&(d|=1),d<<=1,this.readModule(o,a-1,c,u)&&(d|=1),d<<=1,this.readModule(o,a,c,u)&&(d|=1),d}readCorner1(o,a){let c=0;return this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,1,o,a)&&(c|=1),c<<=1,this.readModule(o-1,2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c<<=1,this.readModule(2,a-1,o,a)&&(c|=1),c<<=1,this.readModule(3,a-1,o,a)&&(c|=1),c}readCorner2(o,a){let c=0;return this.readModule(o-3,0,o,a)&&(c|=1),c<<=1,this.readModule(o-2,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(0,a-4,o,a)&&(c|=1),c<<=1,this.readModule(0,a-3,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c}readCorner3(o,a){let c=0;return this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,a-1,o,a)&&(c|=1),c<<=1,this.readModule(0,a-3,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-3,o,a)&&(c|=1),c<<=1,this.readModule(1,a-2,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c}readCorner4(o,a){let c=0;return this.readModule(o-3,0,o,a)&&(c|=1),c<<=1,this.readModule(o-2,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c<<=1,this.readModule(2,a-1,o,a)&&(c|=1),c<<=1,this.readModule(3,a-1,o,a)&&(c|=1),c}extractDataRegion(o){const a=this.version.getSymbolSizeRows(),c=this.version.getSymbolSizeColumns();if(o.getHeight()!==a)throw new E("Dimension of bitMatrix must match the version size");const u=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),g=a/u|0,y=c/d|0,w=g*u,v=y*d,T=new Ge(v,w);for(let R=0;R<g;++R){const O=R*u;for(let q=0;q<y;++q){const Y=q*d;for(let Z=0;Z<u;++Z){const ie=R*(u+2)+1+Z,ce=O+Z;for(let we=0;we<d;++we){const _e=q*(d+2)+1+we;if(o.get(_e,ie)){const me=Y+we;T.set(me,ce)}}}}}return T}}class ja{constructor(o,a){this.numDataCodewords=o,this.codewords=a}static getDataBlocks(o,a){const c=a.getECBlocks();let u=0;const d=c.getECBlocks();for(let Z of d)u+=Z.getCount();const g=new Array(u);let y=0;for(let Z of d)for(let ie=0;ie<Z.getCount();ie++){const ce=Z.getDataCodewords(),we=c.getECCodewords()+ce;g[y++]=new ja(ce,new Uint8Array(we))}const v=g[0].codewords.length-c.getECCodewords(),T=v-1;let R=0;for(let Z=0;Z<T;Z++)for(let ie=0;ie<y;ie++)g[ie].codewords[Z]=o[R++];const O=a.getVersionNumber()===24,q=O?8:y;for(let Z=0;Z<q;Z++)g[Z].codewords[v-1]=o[R++];const Y=g[0].codewords.length;for(let Z=v;Z<Y;Z++)for(let ie=0;ie<y;ie++){const ce=O?(ie+8)%y:ie,we=O&&ce>7?Z-1:Z;g[ce].codewords[we]=o[R++]}if(R!==o.length)throw new E;return g}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class za{constructor(o){this.bytes=o,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(o){if(o<1||o>32||o>this.available())throw new E(""+o);let a=0,c=this.bitOffset,u=this.byteOffset;const d=this.bytes;if(c>0){const g=8-c,y=o<g?o:g,w=g-y,v=255>>8-y<<w;a=(d[u]&v)>>w,o-=y,c+=y,c===8&&(c=0,u++)}if(o>0){for(;o>=8;)a=a<<8|d[u]&255,u++,o-=8;if(o>0){const g=8-o,y=255>>g<<g;a=a<<o|(d[u]&y)>>g,c+=o}}return this.bitOffset=c,this.byteOffset=u,a}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var xn;(function(S){S[S.PAD_ENCODE=0]="PAD_ENCODE",S[S.ASCII_ENCODE=1]="ASCII_ENCODE",S[S.C40_ENCODE=2]="C40_ENCODE",S[S.TEXT_ENCODE=3]="TEXT_ENCODE",S[S.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",S[S.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",S[S.BASE256_ENCODE=6]="BASE256_ENCODE"})(xn||(xn={}));class Di{static decode(o){const a=new za(o),c=new z,u=new z,d=new Array;let g=xn.ASCII_ENCODE;do if(g===xn.ASCII_ENCODE)g=this.decodeAsciiSegment(a,c,u);else{switch(g){case xn.C40_ENCODE:this.decodeC40Segment(a,c);break;case xn.TEXT_ENCODE:this.decodeTextSegment(a,c);break;case xn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(a,c);break;case xn.EDIFACT_ENCODE:this.decodeEdifactSegment(a,c);break;case xn.BASE256_ENCODE:this.decodeBase256Segment(a,c,d);break;default:throw new k}g=xn.ASCII_ENCODE}while(g!==xn.PAD_ENCODE&&a.available()>0);return u.length()>0&&c.append(u.toString()),new Ni(o,c.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(o,a,c){let u=!1;do{let d=o.readBits(8);if(d===0)throw new k;if(d<=128)return u&&(d+=128),a.append(String.fromCharCode(d-1)),xn.ASCII_ENCODE;if(d===129)return xn.PAD_ENCODE;if(d<=229){const g=d-130;g<10&&a.append("0"),a.append(""+g)}else switch(d){case 230:return xn.C40_ENCODE;case 231:return xn.BASE256_ENCODE;case 232:a.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:u=!0;break;case 236:a.append("[)>05"),c.insert(0,"");break;case 237:a.append("[)>06"),c.insert(0,"");break;case 238:return xn.ANSIX12_ENCODE;case 239:return xn.TEXT_ENCODE;case 240:return xn.EDIFACT_ENCODE;case 241:break;default:if(d!==254||o.available()!==0)throw new k;break}}while(o.available()>0);return xn.ASCII_ENCODE}static decodeC40Segment(o,a){let c=!1;const u=[];let d=0;do{if(o.available()===8)return;const g=o.readBits(8);if(g===254)return;this.parseTwoBytes(g,o.readBits(8),u);for(let y=0;y<3;y++){const w=u[y];switch(d){case 0:if(w<3)d=w+1;else if(w<this.C40_BASIC_SET_CHARS.length){const v=this.C40_BASIC_SET_CHARS[w];c?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),c=!1):a.append(v)}else throw new k;break;case 1:c?(a.append(String.fromCharCode(w+128)),c=!1):a.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.C40_SHIFT2_SET_CHARS.length){const v=this.C40_SHIFT2_SET_CHARS[w];c?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),c=!1):a.append(v)}else switch(w){case 27:a.append(String.fromCharCode(29));break;case 30:c=!0;break;default:throw new k}d=0;break;case 3:c?(a.append(String.fromCharCode(w+224)),c=!1):a.append(String.fromCharCode(w+96)),d=0;break;default:throw new k}}}while(o.available()>0)}static decodeTextSegment(o,a){let c=!1,u=[],d=0;do{if(o.available()===8)return;const g=o.readBits(8);if(g===254)return;this.parseTwoBytes(g,o.readBits(8),u);for(let y=0;y<3;y++){const w=u[y];switch(d){case 0:if(w<3)d=w+1;else if(w<this.TEXT_BASIC_SET_CHARS.length){const v=this.TEXT_BASIC_SET_CHARS[w];c?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),c=!1):a.append(v)}else throw new k;break;case 1:c?(a.append(String.fromCharCode(w+128)),c=!1):a.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.TEXT_SHIFT2_SET_CHARS.length){const v=this.TEXT_SHIFT2_SET_CHARS[w];c?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),c=!1):a.append(v)}else switch(w){case 27:a.append(String.fromCharCode(29));break;case 30:c=!0;break;default:throw new k}d=0;break;case 3:if(w<this.TEXT_SHIFT3_SET_CHARS.length){const v=this.TEXT_SHIFT3_SET_CHARS[w];c?(a.append(String.fromCharCode(v.charCodeAt(0)+128)),c=!1):a.append(v),d=0}else throw new k;break;default:throw new k}}}while(o.available()>0)}static decodeAnsiX12Segment(o,a){const c=[];do{if(o.available()===8)return;const u=o.readBits(8);if(u===254)return;this.parseTwoBytes(u,o.readBits(8),c);for(let d=0;d<3;d++){const g=c[d];switch(g){case 0:a.append("\r");break;case 1:a.append("*");break;case 2:a.append(">");break;case 3:a.append(" ");break;default:if(g<14)a.append(String.fromCharCode(g+44));else if(g<40)a.append(String.fromCharCode(g+51));else throw new k;break}}}while(o.available()>0)}static parseTwoBytes(o,a,c){let u=(o<<8)+a-1,d=Math.floor(u/1600);c[0]=d,u-=d*1600,d=Math.floor(u/40),c[1]=d,c[2]=u-d*40}static decodeEdifactSegment(o,a){do{if(o.available()<=16)return;for(let c=0;c<4;c++){let u=o.readBits(6);if(u===31){const d=8-o.getBitOffset();d!==8&&o.readBits(d);return}u&32||(u|=64),a.append(String.fromCharCode(u))}}while(o.available()>0)}static decodeBase256Segment(o,a,c){let u=1+o.getByteOffset();const d=this.unrandomize255State(o.readBits(8),u++);let g;if(d===0?g=o.available()/8|0:d<250?g=d:g=250*(d-249)+this.unrandomize255State(o.readBits(8),u++),g<0)throw new k;const y=new Uint8Array(g);for(let w=0;w<g;w++){if(o.available()<8)throw new k;y[w]=this.unrandomize255State(o.readBits(8),u++)}c.push(y);try{a.append(K.decode(y,W.ISO88591))}catch(w){throw new sr("Platform does not support required encoding: "+w.message)}}static unrandomize255State(o,a){const c=149*a%255+1,u=o-c;return u>=0?u:u+256}}Di.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Di.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Di.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Di.TEXT_SHIFT2_SET_CHARS=Di.C40_SHIFT2_SET_CHARS,Di.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class Vg{constructor(){this.rsDecoder=new ts(ot.DATA_MATRIX_FIELD_256)}decode(o){const a=new Yl(o),c=a.getVersion(),u=a.readCodewords(),d=ja.getDataBlocks(u,c);let g=0;for(let v of d)g+=v.getNumDataCodewords();const y=new Uint8Array(g),w=d.length;for(let v=0;v<w;v++){const T=d[v],R=T.getCodewords(),O=T.getNumDataCodewords();this.correctErrors(R,O);for(let q=0;q<O;q++)y[q*w+v]=R[q]}return Di.decode(y)}correctErrors(o,a){const c=new Int32Array(o);try{this.rsDecoder.decode(c,o.length-a)}catch{throw new N}for(let u=0;u<a;u++)o[u]=c[u]}}class cn{constructor(o){this.image=o,this.rectangleDetector=new xe(this.image)}detect(){const o=this.rectangleDetector.detect();let a=this.detectSolid1(o);if(a=this.detectSolid2(a),a[3]=this.correctTopRight(a),!a[3])throw new se;a=this.shiftToModuleCenter(a);const c=a[0],u=a[1],d=a[2],g=a[3];let y=this.transitionsBetween(c,g)+1,w=this.transitionsBetween(d,g)+1;(y&1)===1&&(y+=1),(w&1)===1&&(w+=1),4*y<7*w&&4*w<7*y&&(y=w=Math.max(y,w));let v=cn.sampleGrid(this.image,c,u,d,g,y,w);return new ue(v,[c,u,d,g])}static shiftPoint(o,a,c){let u=(a.getX()-o.getX())/(c+1),d=(a.getY()-o.getY())/(c+1);return new X(o.getX()+u,o.getY()+d)}static moveAway(o,a,c){let u=o.getX(),d=o.getY();return u<a?u-=1:u+=1,d<c?d-=1:d+=1,new X(u,d)}detectSolid1(o){let a=o[0],c=o[1],u=o[3],d=o[2],g=this.transitionsBetween(a,c),y=this.transitionsBetween(c,u),w=this.transitionsBetween(u,d),v=this.transitionsBetween(d,a),T=g,R=[d,a,c,u];return T>y&&(T=y,R[0]=a,R[1]=c,R[2]=u,R[3]=d),T>w&&(T=w,R[0]=c,R[1]=u,R[2]=d,R[3]=a),T>v&&(R[0]=u,R[1]=d,R[2]=a,R[3]=c),R}detectSolid2(o){let a=o[0],c=o[1],u=o[2],d=o[3],g=this.transitionsBetween(a,d),y=cn.shiftPoint(c,u,(g+1)*4),w=cn.shiftPoint(u,c,(g+1)*4),v=this.transitionsBetween(y,a),T=this.transitionsBetween(w,d);return v<T?(o[0]=a,o[1]=c,o[2]=u,o[3]=d):(o[0]=c,o[1]=u,o[2]=d,o[3]=a),o}correctTopRight(o){let a=o[0],c=o[1],u=o[2],d=o[3],g=this.transitionsBetween(a,d),y=this.transitionsBetween(c,d),w=cn.shiftPoint(a,c,(y+1)*4),v=cn.shiftPoint(u,c,(g+1)*4);g=this.transitionsBetween(w,d),y=this.transitionsBetween(v,d);let T=new X(d.getX()+(u.getX()-c.getX())/(g+1),d.getY()+(u.getY()-c.getY())/(g+1)),R=new X(d.getX()+(a.getX()-c.getX())/(y+1),d.getY()+(a.getY()-c.getY())/(y+1));if(!this.isValid(T))return this.isValid(R)?R:null;if(!this.isValid(R))return T;let O=this.transitionsBetween(w,T)+this.transitionsBetween(v,T),q=this.transitionsBetween(w,R)+this.transitionsBetween(v,R);return O>q?T:R}shiftToModuleCenter(o){let a=o[0],c=o[1],u=o[2],d=o[3],g=this.transitionsBetween(a,d)+1,y=this.transitionsBetween(u,d)+1,w=cn.shiftPoint(a,c,y*4),v=cn.shiftPoint(u,c,g*4);g=this.transitionsBetween(w,d)+1,y=this.transitionsBetween(v,d)+1,(g&1)===1&&(g+=1),(y&1)===1&&(y+=1);let T=(a.getX()+c.getX()+u.getX()+d.getX())/4,R=(a.getY()+c.getY()+u.getY()+d.getY())/4;a=cn.moveAway(a,T,R),c=cn.moveAway(c,T,R),u=cn.moveAway(u,T,R),d=cn.moveAway(d,T,R);let O,q;return w=cn.shiftPoint(a,c,y*4),w=cn.shiftPoint(w,d,g*4),O=cn.shiftPoint(c,a,y*4),O=cn.shiftPoint(O,u,g*4),v=cn.shiftPoint(u,d,y*4),v=cn.shiftPoint(v,c,g*4),q=cn.shiftPoint(d,u,y*4),q=cn.shiftPoint(q,a,g*4),[w,O,v,q]}isValid(o){return o.getX()>=0&&o.getX()<this.image.getWidth()&&o.getY()>0&&o.getY()<this.image.getHeight()}static sampleGrid(o,a,c,u,d,g,y){return qe.getInstance().sampleGrid(o,g,y,.5,.5,g-.5,.5,g-.5,y-.5,.5,y-.5,a.getX(),a.getY(),d.getX(),d.getY(),u.getX(),u.getY(),c.getX(),c.getY())}transitionsBetween(o,a){let c=Math.trunc(o.getX()),u=Math.trunc(o.getY()),d=Math.trunc(a.getX()),g=Math.trunc(a.getY()),y=Math.abs(g-u)>Math.abs(d-c);if(y){let Z=c;c=u,u=Z,Z=d,d=g,g=Z}let w=Math.abs(d-c),v=Math.abs(g-u),T=-w/2,R=u<g?1:-1,O=c<d?1:-1,q=0,Y=this.image.get(y?u:c,y?c:u);for(let Z=c,ie=u;Z!==d;Z+=O){let ce=this.image.get(y?ie:Z,y?Z:ie);if(ce!==Y&&(q++,Y=ce),T+=v,T>0){if(ie===g)break;ie+=R,T-=w}}return q}}class ki{constructor(){this.decoder=new Vg}decode(o,a=null){let c,u;if(a!=null&&a.has(J.PURE_BARCODE)){const v=ki.extractPureBits(o.getBlackMatrix());c=this.decoder.decode(v),u=ki.NO_POINTS}else{const v=new cn(o.getBlackMatrix()).detect();c=this.decoder.decode(v.getBits()),u=v.getPoints()}const d=c.getRawBytes(),g=new Bt(c.getText(),d,8*d.length,u,ke.DATA_MATRIX,D.currentTimeMillis()),y=c.getByteSegments();y!=null&&g.putMetadata(ln.BYTE_SEGMENTS,y);const w=c.getECLevel();return w!=null&&g.putMetadata(ln.ERROR_CORRECTION_LEVEL,w),g}reset(){}static extractPureBits(o){const a=o.getTopLeftOnBit(),c=o.getBottomRightOnBit();if(a==null||c==null)throw new se;const u=this.moduleSize(a,o);let d=a[1];const g=c[1];let y=a[0];const v=(c[0]-y+1)/u,T=(g-d+1)/u;if(v<=0||T<=0)throw new se;const R=u/2;d+=R,y+=R;const O=new Ge(v,T);for(let q=0;q<T;q++){const Y=d+q*u;for(let Z=0;Z<v;Z++)o.get(y+Z*u,Y)&&O.set(Z,q)}return O}static moduleSize(o,a){const c=a.getWidth();let u=o[0];const d=o[1];for(;u<c&&a.get(u,d);)u++;if(u===c)throw new se;const g=u-o[0];if(g===0)throw new se;return g}}ki.NO_POINTS=[];class gf extends Tt{constructor(o=500){super(new ki,o)}}var Co;(function(S){S[S.L=0]="L",S[S.M=1]="M",S[S.Q=2]="Q",S[S.H=3]="H"})(Co||(Co={}));class wt{constructor(o,a,c){this.value=o,this.stringValue=a,this.bits=c,wt.FOR_BITS.set(c,this),wt.FOR_VALUE.set(o,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(o){switch(o){case"L":return wt.L;case"M":return wt.M;case"Q":return wt.Q;case"H":return wt.H;default:throw new x(o+"not available")}}toString(){return this.stringValue}equals(o){if(!(o instanceof wt))return!1;const a=o;return this.value===a.value}static forBits(o){if(o<0||o>=wt.FOR_BITS.size)throw new E;return wt.FOR_BITS.get(o)}}wt.FOR_BITS=new Map,wt.FOR_VALUE=new Map,wt.L=new wt(Co.L,"L",1),wt.M=new wt(Co.M,"M",0),wt.Q=new wt(Co.Q,"Q",3),wt.H=new wt(Co.H,"H",2);class Wt{constructor(o){this.errorCorrectionLevel=wt.forBits(o>>3&3),this.dataMask=o&7}static numBitsDiffering(o,a){return P.bitCount(o^a)}static decodeFormatInformation(o,a){const c=Wt.doDecodeFormatInformation(o,a);return c!==null?c:Wt.doDecodeFormatInformation(o^Wt.FORMAT_INFO_MASK_QR,a^Wt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(o,a){let c=Number.MAX_SAFE_INTEGER,u=0;for(const d of Wt.FORMAT_INFO_DECODE_LOOKUP){const g=d[0];if(g===o||g===a)return new Wt(d[1]);let y=Wt.numBitsDiffering(o,g);y<c&&(u=d[1],c=y),o!==a&&(y=Wt.numBitsDiffering(a,g),y<c&&(u=d[1],c=y))}return c<=3?new Wt(u):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(o){if(!(o instanceof Wt))return!1;const a=o;return this.errorCorrectionLevel===a.errorCorrectionLevel&&this.dataMask===a.dataMask}}Wt.FORMAT_INFO_MASK_QR=21522,Wt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class re{constructor(o,...a){this.ecCodewordsPerBlock=o,this.ecBlocks=a}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let o=0;const a=this.ecBlocks;for(const c of a)o+=c.getCount();return o}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class j{constructor(o,a){this.count=o,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ve{constructor(o,a,...c){this.versionNumber=o,this.alignmentPatternCenters=a,this.ecBlocks=c;let u=0;const d=c[0].getECCodewordsPerBlock(),g=c[0].getECBlocks();for(const y of g)u+=y.getCount()*(y.getDataCodewords()+d);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(o){return this.ecBlocks[o.getValue()]}static getProvisionalVersionForDimension(o){if(o%4!==1)throw new k;try{return this.getVersionForNumber((o-17)/4)}catch{throw new k}}static getVersionForNumber(o){if(o<1||o>40)throw new E;return Ve.VERSIONS[o-1]}static decodeVersionInformation(o){let a=Number.MAX_SAFE_INTEGER,c=0;for(let u=0;u<Ve.VERSION_DECODE_INFO.length;u++){const d=Ve.VERSION_DECODE_INFO[u];if(d===o)return Ve.getVersionForNumber(u+7);const g=Wt.numBitsDiffering(o,d);g<a&&(c=u+7,a=g)}return a<=3?Ve.getVersionForNumber(c):null}buildFunctionPattern(){const o=this.getDimensionForVersion(),a=new Ge(o);a.setRegion(0,0,9,9),a.setRegion(o-8,0,8,9),a.setRegion(0,o-8,9,8);const c=this.alignmentPatternCenters.length;for(let u=0;u<c;u++){const d=this.alignmentPatternCenters[u]-2;for(let g=0;g<c;g++)u===0&&(g===0||g===c-1)||u===c-1&&g===0||a.setRegion(this.alignmentPatternCenters[g]-2,d,5,5)}return a.setRegion(6,9,1,o-17),a.setRegion(9,6,o-17,1),this.versionNumber>6&&(a.setRegion(o-11,0,3,6),a.setRegion(0,o-11,6,3)),a}toString(){return""+this.versionNumber}}Ve.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ve.VERSIONS=[new Ve(1,new Int32Array(0),new re(7,new j(1,19)),new re(10,new j(1,16)),new re(13,new j(1,13)),new re(17,new j(1,9))),new Ve(2,Int32Array.from([6,18]),new re(10,new j(1,34)),new re(16,new j(1,28)),new re(22,new j(1,22)),new re(28,new j(1,16))),new Ve(3,Int32Array.from([6,22]),new re(15,new j(1,55)),new re(26,new j(1,44)),new re(18,new j(2,17)),new re(22,new j(2,13))),new Ve(4,Int32Array.from([6,26]),new re(20,new j(1,80)),new re(18,new j(2,32)),new re(26,new j(2,24)),new re(16,new j(4,9))),new Ve(5,Int32Array.from([6,30]),new re(26,new j(1,108)),new re(24,new j(2,43)),new re(18,new j(2,15),new j(2,16)),new re(22,new j(2,11),new j(2,12))),new Ve(6,Int32Array.from([6,34]),new re(18,new j(2,68)),new re(16,new j(4,27)),new re(24,new j(4,19)),new re(28,new j(4,15))),new Ve(7,Int32Array.from([6,22,38]),new re(20,new j(2,78)),new re(18,new j(4,31)),new re(18,new j(2,14),new j(4,15)),new re(26,new j(4,13),new j(1,14))),new Ve(8,Int32Array.from([6,24,42]),new re(24,new j(2,97)),new re(22,new j(2,38),new j(2,39)),new re(22,new j(4,18),new j(2,19)),new re(26,new j(4,14),new j(2,15))),new Ve(9,Int32Array.from([6,26,46]),new re(30,new j(2,116)),new re(22,new j(3,36),new j(2,37)),new re(20,new j(4,16),new j(4,17)),new re(24,new j(4,12),new j(4,13))),new Ve(10,Int32Array.from([6,28,50]),new re(18,new j(2,68),new j(2,69)),new re(26,new j(4,43),new j(1,44)),new re(24,new j(6,19),new j(2,20)),new re(28,new j(6,15),new j(2,16))),new Ve(11,Int32Array.from([6,30,54]),new re(20,new j(4,81)),new re(30,new j(1,50),new j(4,51)),new re(28,new j(4,22),new j(4,23)),new re(24,new j(3,12),new j(8,13))),new Ve(12,Int32Array.from([6,32,58]),new re(24,new j(2,92),new j(2,93)),new re(22,new j(6,36),new j(2,37)),new re(26,new j(4,20),new j(6,21)),new re(28,new j(7,14),new j(4,15))),new Ve(13,Int32Array.from([6,34,62]),new re(26,new j(4,107)),new re(22,new j(8,37),new j(1,38)),new re(24,new j(8,20),new j(4,21)),new re(22,new j(12,11),new j(4,12))),new Ve(14,Int32Array.from([6,26,46,66]),new re(30,new j(3,115),new j(1,116)),new re(24,new j(4,40),new j(5,41)),new re(20,new j(11,16),new j(5,17)),new re(24,new j(11,12),new j(5,13))),new Ve(15,Int32Array.from([6,26,48,70]),new re(22,new j(5,87),new j(1,88)),new re(24,new j(5,41),new j(5,42)),new re(30,new j(5,24),new j(7,25)),new re(24,new j(11,12),new j(7,13))),new Ve(16,Int32Array.from([6,26,50,74]),new re(24,new j(5,98),new j(1,99)),new re(28,new j(7,45),new j(3,46)),new re(24,new j(15,19),new j(2,20)),new re(30,new j(3,15),new j(13,16))),new Ve(17,Int32Array.from([6,30,54,78]),new re(28,new j(1,107),new j(5,108)),new re(28,new j(10,46),new j(1,47)),new re(28,new j(1,22),new j(15,23)),new re(28,new j(2,14),new j(17,15))),new Ve(18,Int32Array.from([6,30,56,82]),new re(30,new j(5,120),new j(1,121)),new re(26,new j(9,43),new j(4,44)),new re(28,new j(17,22),new j(1,23)),new re(28,new j(2,14),new j(19,15))),new Ve(19,Int32Array.from([6,30,58,86]),new re(28,new j(3,113),new j(4,114)),new re(26,new j(3,44),new j(11,45)),new re(26,new j(17,21),new j(4,22)),new re(26,new j(9,13),new j(16,14))),new Ve(20,Int32Array.from([6,34,62,90]),new re(28,new j(3,107),new j(5,108)),new re(26,new j(3,41),new j(13,42)),new re(30,new j(15,24),new j(5,25)),new re(28,new j(15,15),new j(10,16))),new Ve(21,Int32Array.from([6,28,50,72,94]),new re(28,new j(4,116),new j(4,117)),new re(26,new j(17,42)),new re(28,new j(17,22),new j(6,23)),new re(30,new j(19,16),new j(6,17))),new Ve(22,Int32Array.from([6,26,50,74,98]),new re(28,new j(2,111),new j(7,112)),new re(28,new j(17,46)),new re(30,new j(7,24),new j(16,25)),new re(24,new j(34,13))),new Ve(23,Int32Array.from([6,30,54,78,102]),new re(30,new j(4,121),new j(5,122)),new re(28,new j(4,47),new j(14,48)),new re(30,new j(11,24),new j(14,25)),new re(30,new j(16,15),new j(14,16))),new Ve(24,Int32Array.from([6,28,54,80,106]),new re(30,new j(6,117),new j(4,118)),new re(28,new j(6,45),new j(14,46)),new re(30,new j(11,24),new j(16,25)),new re(30,new j(30,16),new j(2,17))),new Ve(25,Int32Array.from([6,32,58,84,110]),new re(26,new j(8,106),new j(4,107)),new re(28,new j(8,47),new j(13,48)),new re(30,new j(7,24),new j(22,25)),new re(30,new j(22,15),new j(13,16))),new Ve(26,Int32Array.from([6,30,58,86,114]),new re(28,new j(10,114),new j(2,115)),new re(28,new j(19,46),new j(4,47)),new re(28,new j(28,22),new j(6,23)),new re(30,new j(33,16),new j(4,17))),new Ve(27,Int32Array.from([6,34,62,90,118]),new re(30,new j(8,122),new j(4,123)),new re(28,new j(22,45),new j(3,46)),new re(30,new j(8,23),new j(26,24)),new re(30,new j(12,15),new j(28,16))),new Ve(28,Int32Array.from([6,26,50,74,98,122]),new re(30,new j(3,117),new j(10,118)),new re(28,new j(3,45),new j(23,46)),new re(30,new j(4,24),new j(31,25)),new re(30,new j(11,15),new j(31,16))),new Ve(29,Int32Array.from([6,30,54,78,102,126]),new re(30,new j(7,116),new j(7,117)),new re(28,new j(21,45),new j(7,46)),new re(30,new j(1,23),new j(37,24)),new re(30,new j(19,15),new j(26,16))),new Ve(30,Int32Array.from([6,26,52,78,104,130]),new re(30,new j(5,115),new j(10,116)),new re(28,new j(19,47),new j(10,48)),new re(30,new j(15,24),new j(25,25)),new re(30,new j(23,15),new j(25,16))),new Ve(31,Int32Array.from([6,30,56,82,108,134]),new re(30,new j(13,115),new j(3,116)),new re(28,new j(2,46),new j(29,47)),new re(30,new j(42,24),new j(1,25)),new re(30,new j(23,15),new j(28,16))),new Ve(32,Int32Array.from([6,34,60,86,112,138]),new re(30,new j(17,115)),new re(28,new j(10,46),new j(23,47)),new re(30,new j(10,24),new j(35,25)),new re(30,new j(19,15),new j(35,16))),new Ve(33,Int32Array.from([6,30,58,86,114,142]),new re(30,new j(17,115),new j(1,116)),new re(28,new j(14,46),new j(21,47)),new re(30,new j(29,24),new j(19,25)),new re(30,new j(11,15),new j(46,16))),new Ve(34,Int32Array.from([6,34,62,90,118,146]),new re(30,new j(13,115),new j(6,116)),new re(28,new j(14,46),new j(23,47)),new re(30,new j(44,24),new j(7,25)),new re(30,new j(59,16),new j(1,17))),new Ve(35,Int32Array.from([6,30,54,78,102,126,150]),new re(30,new j(12,121),new j(7,122)),new re(28,new j(12,47),new j(26,48)),new re(30,new j(39,24),new j(14,25)),new re(30,new j(22,15),new j(41,16))),new Ve(36,Int32Array.from([6,24,50,76,102,128,154]),new re(30,new j(6,121),new j(14,122)),new re(28,new j(6,47),new j(34,48)),new re(30,new j(46,24),new j(10,25)),new re(30,new j(2,15),new j(64,16))),new Ve(37,Int32Array.from([6,28,54,80,106,132,158]),new re(30,new j(17,122),new j(4,123)),new re(28,new j(29,46),new j(14,47)),new re(30,new j(49,24),new j(10,25)),new re(30,new j(24,15),new j(46,16))),new Ve(38,Int32Array.from([6,32,58,84,110,136,162]),new re(30,new j(4,122),new j(18,123)),new re(28,new j(13,46),new j(32,47)),new re(30,new j(48,24),new j(14,25)),new re(30,new j(42,15),new j(32,16))),new Ve(39,Int32Array.from([6,26,54,82,110,138,166]),new re(30,new j(20,117),new j(4,118)),new re(28,new j(40,47),new j(7,48)),new re(30,new j(43,24),new j(22,25)),new re(30,new j(10,15),new j(67,16))),new Ve(40,Int32Array.from([6,30,58,86,114,142,170]),new re(30,new j(19,118),new j(6,119)),new re(28,new j(18,47),new j(31,48)),new re(30,new j(34,24),new j(34,25)),new re(30,new j(20,15),new j(61,16)))];var Ye;(function(S){S[S.DATA_MASK_000=0]="DATA_MASK_000",S[S.DATA_MASK_001=1]="DATA_MASK_001",S[S.DATA_MASK_010=2]="DATA_MASK_010",S[S.DATA_MASK_011=3]="DATA_MASK_011",S[S.DATA_MASK_100=4]="DATA_MASK_100",S[S.DATA_MASK_101=5]="DATA_MASK_101",S[S.DATA_MASK_110=6]="DATA_MASK_110",S[S.DATA_MASK_111=7]="DATA_MASK_111"})(Ye||(Ye={}));class ar{constructor(o,a){this.value=o,this.isMasked=a}unmaskBitMatrix(o,a){for(let c=0;c<a;c++)for(let u=0;u<a;u++)this.isMasked(c,u)&&o.flip(u,c)}}ar.values=new Map([[Ye.DATA_MASK_000,new ar(Ye.DATA_MASK_000,(S,o)=>(S+o&1)===0)],[Ye.DATA_MASK_001,new ar(Ye.DATA_MASK_001,(S,o)=>(S&1)===0)],[Ye.DATA_MASK_010,new ar(Ye.DATA_MASK_010,(S,o)=>o%3===0)],[Ye.DATA_MASK_011,new ar(Ye.DATA_MASK_011,(S,o)=>(S+o)%3===0)],[Ye.DATA_MASK_100,new ar(Ye.DATA_MASK_100,(S,o)=>(Math.floor(S/2)+Math.floor(o/3)&1)===0)],[Ye.DATA_MASK_101,new ar(Ye.DATA_MASK_101,(S,o)=>S*o%6===0)],[Ye.DATA_MASK_110,new ar(Ye.DATA_MASK_110,(S,o)=>S*o%6<3)],[Ye.DATA_MASK_111,new ar(Ye.DATA_MASK_111,(S,o)=>(S+o+S*o%3&1)===0)]]);class Ga{constructor(o){const a=o.getHeight();if(a<21||(a&3)!==1)throw new k;this.bitMatrix=o}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let o=0;for(let d=0;d<6;d++)o=this.copyBit(d,8,o);o=this.copyBit(7,8,o),o=this.copyBit(8,8,o),o=this.copyBit(8,7,o);for(let d=5;d>=0;d--)o=this.copyBit(8,d,o);const a=this.bitMatrix.getHeight();let c=0;const u=a-7;for(let d=a-1;d>=u;d--)c=this.copyBit(8,d,c);for(let d=a-8;d<a;d++)c=this.copyBit(d,8,c);if(this.parsedFormatInfo=Wt.decodeFormatInformation(o,c),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new k}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const o=this.bitMatrix.getHeight(),a=Math.floor((o-17)/4);if(a<=6)return Ve.getVersionForNumber(a);let c=0;const u=o-11;for(let g=5;g>=0;g--)for(let y=o-9;y>=u;y--)c=this.copyBit(y,g,c);let d=Ve.decodeVersionInformation(c);if(d!==null&&d.getDimensionForVersion()===o)return this.parsedVersion=d,d;c=0;for(let g=5;g>=0;g--)for(let y=o-9;y>=u;y--)c=this.copyBit(g,y,c);if(d=Ve.decodeVersionInformation(c),d!==null&&d.getDimensionForVersion()===o)return this.parsedVersion=d,d;throw new k}copyBit(o,a,c){return(this.isMirror?this.bitMatrix.get(a,o):this.bitMatrix.get(o,a))?c<<1|1:c<<1}readCodewords(){const o=this.readFormatInformation(),a=this.readVersion(),c=ar.values.get(o.getDataMask()),u=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,u);const d=a.buildFunctionPattern();let g=!0;const y=new Uint8Array(a.getTotalCodewords());let w=0,v=0,T=0;for(let R=u-1;R>0;R-=2){R===6&&R--;for(let O=0;O<u;O++){const q=g?u-1-O:O;for(let Y=0;Y<2;Y++)d.get(R-Y,q)||(T++,v<<=1,this.bitMatrix.get(R-Y,q)&&(v|=1),T===8&&(y[w++]=v,T=0,v=0))}g=!g}if(w!==a.getTotalCodewords())throw new k;return y}remask(){if(this.parsedFormatInfo===null)return;const o=ar.values[this.parsedFormatInfo.getDataMask()],a=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,a)}setMirror(o){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=o}mirror(){const o=this.bitMatrix;for(let a=0,c=o.getWidth();a<c;a++)for(let u=a+1,d=o.getHeight();u<d;u++)o.get(a,u)!==o.get(u,a)&&(o.flip(u,a),o.flip(a,u))}}class zs{constructor(o,a){this.numDataCodewords=o,this.codewords=a}static getDataBlocks(o,a,c){if(o.length!==a.getTotalCodewords())throw new E;const u=a.getECBlocksForLevel(c);let d=0;const g=u.getECBlocks();for(const Y of g)d+=Y.getCount();const y=new Array(d);let w=0;for(const Y of g)for(let Z=0;Z<Y.getCount();Z++){const ie=Y.getDataCodewords(),ce=u.getECCodewordsPerBlock()+ie;y[w++]=new zs(ie,new Uint8Array(ce))}const v=y[0].codewords.length;let T=y.length-1;for(;T>=0&&y[T].codewords.length!==v;)T--;T++;const R=v-u.getECCodewordsPerBlock();let O=0;for(let Y=0;Y<R;Y++)for(let Z=0;Z<w;Z++)y[Z].codewords[Y]=o[O++];for(let Y=T;Y<w;Y++)y[Y].codewords[R]=o[O++];const q=y[0].codewords.length;for(let Y=R;Y<q;Y++)for(let Z=0;Z<w;Z++){const ie=Z<T?Y:Y+1;y[Z].codewords[ie]=o[O++]}return y}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var qr;(function(S){S[S.TERMINATOR=0]="TERMINATOR",S[S.NUMERIC=1]="NUMERIC",S[S.ALPHANUMERIC=2]="ALPHANUMERIC",S[S.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",S[S.BYTE=4]="BYTE",S[S.ECI=5]="ECI",S[S.KANJI=6]="KANJI",S[S.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",S[S.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",S[S.HANZI=9]="HANZI"})(qr||(qr={}));class Ue{constructor(o,a,c,u){this.value=o,this.stringValue=a,this.characterCountBitsForVersions=c,this.bits=u,Ue.FOR_BITS.set(u,this),Ue.FOR_VALUE.set(o,this)}static forBits(o){const a=Ue.FOR_BITS.get(o);if(a===void 0)throw new E;return a}getCharacterCountBits(o){const a=o.getVersionNumber();let c;return a<=9?c=0:a<=26?c=1:c=2,this.characterCountBitsForVersions[c]}getValue(){return this.value}getBits(){return this.bits}equals(o){if(!(o instanceof Ue))return!1;const a=o;return this.value===a.value}toString(){return this.stringValue}}Ue.FOR_BITS=new Map,Ue.FOR_VALUE=new Map,Ue.TERMINATOR=new Ue(qr.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Ue.NUMERIC=new Ue(qr.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Ue.ALPHANUMERIC=new Ue(qr.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Ue.STRUCTURED_APPEND=new Ue(qr.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Ue.BYTE=new Ue(qr.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Ue.ECI=new Ue(qr.ECI,"ECI",Int32Array.from([0,0,0]),7),Ue.KANJI=new Ue(qr.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Ue.FNC1_FIRST_POSITION=new Ue(qr.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Ue.FNC1_SECOND_POSITION=new Ue(qr.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Ue.HANZI=new Ue(qr.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Xt{static decode(o,a,c,u){const d=new za(o);let g=new z;const y=new Array;let w=-1,v=-1;try{let T=null,R=!1,O;do{if(d.available()<4)O=Ue.TERMINATOR;else{const q=d.readBits(4);O=Ue.forBits(q)}switch(O){case Ue.TERMINATOR:break;case Ue.FNC1_FIRST_POSITION:case Ue.FNC1_SECOND_POSITION:R=!0;break;case Ue.STRUCTURED_APPEND:if(d.available()<16)throw new k;w=d.readBits(8),v=d.readBits(8);break;case Ue.ECI:const q=Xt.parseECIValue(d);if(T=F.getCharacterSetECIByValue(q),T===null)throw new k;break;case Ue.HANZI:const Y=d.readBits(4),Z=d.readBits(O.getCharacterCountBits(a));Y===Xt.GB2312_SUBSET&&Xt.decodeHanziSegment(d,g,Z);break;default:const ie=d.readBits(O.getCharacterCountBits(a));switch(O){case Ue.NUMERIC:Xt.decodeNumericSegment(d,g,ie);break;case Ue.ALPHANUMERIC:Xt.decodeAlphanumericSegment(d,g,ie,R);break;case Ue.BYTE:Xt.decodeByteSegment(d,g,ie,T,y,u);break;case Ue.KANJI:Xt.decodeKanjiSegment(d,g,ie);break;default:throw new k}break}}while(O!==Ue.TERMINATOR)}catch{throw new k}return new Ni(o,g.toString(),y.length===0?null:y,c===null?null:c.toString(),w,v)}static decodeHanziSegment(o,a,c){if(c*13>o.available())throw new k;const u=new Uint8Array(2*c);let d=0;for(;c>0;){const g=o.readBits(13);let y=g/96<<8&4294967295|g%96;y<959?y+=41377:y+=42657,u[d]=y>>8&255,u[d+1]=y&255,d+=2,c--}try{a.append(K.decode(u,W.GB2312))}catch(g){throw new k(g)}}static decodeKanjiSegment(o,a,c){if(c*13>o.available())throw new k;const u=new Uint8Array(2*c);let d=0;for(;c>0;){const g=o.readBits(13);let y=g/192<<8&4294967295|g%192;y<7936?y+=33088:y+=49472,u[d]=y>>8,u[d+1]=y,d+=2,c--}try{a.append(K.decode(u,W.SHIFT_JIS))}catch(g){throw new k(g)}}static decodeByteSegment(o,a,c,u,d,g){if(8*c>o.available())throw new k;const y=new Uint8Array(c);for(let v=0;v<c;v++)y[v]=o.readBits(8);let w;u===null?w=W.guessEncoding(y,g):w=u.getName();try{a.append(K.decode(y,w))}catch(v){throw new k(v)}d.push(y)}static toAlphaNumericChar(o){if(o>=Xt.ALPHANUMERIC_CHARS.length)throw new k;return Xt.ALPHANUMERIC_CHARS[o]}static decodeAlphanumericSegment(o,a,c,u){const d=a.length();for(;c>1;){if(o.available()<11)throw new k;const g=o.readBits(11);a.append(Xt.toAlphaNumericChar(Math.floor(g/45))),a.append(Xt.toAlphaNumericChar(g%45)),c-=2}if(c===1){if(o.available()<6)throw new k;a.append(Xt.toAlphaNumericChar(o.readBits(6)))}if(u)for(let g=d;g<a.length();g++)a.charAt(g)==="%"&&(g<a.length()-1&&a.charAt(g+1)==="%"?a.deleteCharAt(g+1):a.setCharAt(g,String.fromCharCode(29)))}static decodeNumericSegment(o,a,c){for(;c>=3;){if(o.available()<10)throw new k;const u=o.readBits(10);if(u>=1e3)throw new k;a.append(Xt.toAlphaNumericChar(Math.floor(u/100))),a.append(Xt.toAlphaNumericChar(Math.floor(u/10)%10)),a.append(Xt.toAlphaNumericChar(u%10)),c-=3}if(c===2){if(o.available()<7)throw new k;const u=o.readBits(7);if(u>=100)throw new k;a.append(Xt.toAlphaNumericChar(Math.floor(u/10))),a.append(Xt.toAlphaNumericChar(u%10))}else if(c===1){if(o.available()<4)throw new k;const u=o.readBits(4);if(u>=10)throw new k;a.append(Xt.toAlphaNumericChar(u))}}static parseECIValue(o){const a=o.readBits(8);if(!(a&128))return a&127;if((a&192)===128){const c=o.readBits(8);return(a&63)<<8&4294967295|c}if((a&224)===192){const c=o.readBits(16);return(a&31)<<16&4294967295|c}throw new k}}Xt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Xt.GB2312_SUBSET=1;class mf{constructor(o){this.mirrored=o}isMirrored(){return this.mirrored}applyMirroredCorrection(o){if(!this.mirrored||o===null||o.length<3)return;const a=o[0];o[0]=o[2],o[2]=a}}class Bg{constructor(){this.rsDecoder=new ts(ot.QR_CODE_FIELD_256)}decodeBooleanArray(o,a){return this.decodeBitMatrix(Ge.parseFromBooleanArray(o),a)}decodeBitMatrix(o,a){const c=new Ga(o);let u=null;try{return this.decodeBitMatrixParser(c,a)}catch(d){u=d}try{c.remask(),c.setMirror(!0),c.readVersion(),c.readFormatInformation(),c.mirror();const d=this.decodeBitMatrixParser(c,a);return d.setOther(new mf(!0)),d}catch(d){throw u!==null?u:d}}decodeBitMatrixParser(o,a){const c=o.readVersion(),u=o.readFormatInformation().getErrorCorrectionLevel(),d=o.readCodewords(),g=zs.getDataBlocks(d,c,u);let y=0;for(const T of g)y+=T.getNumDataCodewords();const w=new Uint8Array(y);let v=0;for(const T of g){const R=T.getCodewords(),O=T.getNumDataCodewords();this.correctErrors(R,O);for(let q=0;q<O;q++)w[v++]=R[q]}return Xt.decode(w,c,u,a)}correctErrors(o,a){const c=new Int32Array(o);try{this.rsDecoder.decode(c,o.length-a)}catch{throw new N}for(let u=0;u<a;u++)o[u]=c[u]}}class Qu extends X{constructor(o,a,c){super(o,a),this.estimatedModuleSize=c}aboutEquals(o,a,c){if(Math.abs(a-this.getY())<=o&&Math.abs(c-this.getX())<=o){const u=Math.abs(o-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(o,a,c){const u=(this.getX()+a)/2,d=(this.getY()+o)/2,g=(this.estimatedModuleSize+c)/2;return new Qu(u,d,g)}}class as{constructor(o,a,c,u,d,g,y){this.image=o,this.startX=a,this.startY=c,this.width=u,this.height=d,this.moduleSize=g,this.resultPointCallback=y,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const o=this.startX,a=this.height,c=this.width,u=o+c,d=this.startY+a/2,g=new Int32Array(3),y=this.image;for(let w=0;w<a;w++){const v=d+(w&1?-Math.floor((w+1)/2):Math.floor((w+1)/2));g[0]=0,g[1]=0,g[2]=0;let T=o;for(;T<u&&!y.get(T,v);)T++;let R=0;for(;T<u;){if(y.get(T,v))if(R===1)g[1]++;else if(R===2){if(this.foundPatternCross(g)){const O=this.handlePossibleCenter(g,v,T);if(O!==null)return O}g[0]=g[2],g[1]=1,g[2]=0,R=1}else g[++R]++;else R===1&&R++,g[R]++;T++}if(this.foundPatternCross(g)){const O=this.handlePossibleCenter(g,v,u);if(O!==null)return O}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new se}static centerFromEnd(o,a){return a-o[2]-o[1]/2}foundPatternCross(o){const a=this.moduleSize,c=a/2;for(let u=0;u<3;u++)if(Math.abs(a-o[u])>=c)return!1;return!0}crossCheckVertical(o,a,c,u){const d=this.image,g=d.getHeight(),y=this.crossCheckStateCount;y[0]=0,y[1]=0,y[2]=0;let w=o;for(;w>=0&&d.get(a,w)&&y[1]<=c;)y[1]++,w--;if(w<0||y[1]>c)return NaN;for(;w>=0&&!d.get(a,w)&&y[0]<=c;)y[0]++,w--;if(y[0]>c)return NaN;for(w=o+1;w<g&&d.get(a,w)&&y[1]<=c;)y[1]++,w++;if(w===g||y[1]>c)return NaN;for(;w<g&&!d.get(a,w)&&y[2]<=c;)y[2]++,w++;if(y[2]>c)return NaN;const v=y[0]+y[1]+y[2];return 5*Math.abs(v-u)>=2*u?NaN:this.foundPatternCross(y)?as.centerFromEnd(y,w):NaN}handlePossibleCenter(o,a,c){const u=o[0]+o[1]+o[2],d=as.centerFromEnd(o,c),g=this.crossCheckVertical(a,d,2*o[1],u);if(!isNaN(g)){const y=(o[0]+o[1]+o[2])/3;for(const v of this.possibleCenters)if(v.aboutEquals(y,g,d))return v.combineEstimate(g,d,y);const w=new Qu(d,g,y);this.possibleCenters.push(w),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(w)}return null}}class xi extends X{constructor(o,a,c,u){super(o,a),this.estimatedModuleSize=c,this.count=u,u===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(o,a,c){if(Math.abs(a-this.getY())<=o&&Math.abs(c-this.getX())<=o){const u=Math.abs(o-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(o,a,c){const u=this.count+1,d=(this.count*this.getX()+a)/u,g=(this.count*this.getY()+o)/u,y=(this.count*this.estimatedModuleSize+c)/u;return new xi(d,g,y,u)}}class pf{constructor(o){this.bottomLeft=o[0],this.topLeft=o[1],this.topRight=o[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Sn{constructor(o,a){this.image=o,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=a}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(o){const a=o!=null&&o.get(J.TRY_HARDER)!==void 0,c=o!=null&&o.get(J.PURE_BARCODE)!==void 0,u=this.image,d=u.getHeight(),g=u.getWidth();let y=Math.floor(3*d/(4*Sn.MAX_MODULES));(y<Sn.MIN_SKIP||a)&&(y=Sn.MIN_SKIP);let w=!1;const v=new Int32Array(5);for(let R=y-1;R<d&&!w;R+=y){v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0;let O=0;for(let q=0;q<g;q++)if(u.get(q,R))(O&1)===1&&O++,v[O]++;else if(O&1)v[O]++;else if(O===4)if(Sn.foundPatternCross(v)){if(this.handlePossibleCenter(v,R,q,c)===!0)if(y=2,this.hasSkipped===!0)w=this.haveMultiplyConfirmedCenters();else{const Z=this.findRowSkip();Z>v[2]&&(R+=Z-v[2]-y,q=g-1)}else{v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,O=3;continue}O=0,v[0]=0,v[1]=0,v[2]=0,v[3]=0,v[4]=0}else v[0]=v[2],v[1]=v[3],v[2]=v[4],v[3]=1,v[4]=0,O=3;else v[++O]++;Sn.foundPatternCross(v)&&this.handlePossibleCenter(v,R,g,c)===!0&&(y=v[0],this.hasSkipped&&(w=this.haveMultiplyConfirmedCenters()))}const T=this.selectBestPatterns();return X.orderBestPatterns(T),new pf(T)}static centerFromEnd(o,a){return a-o[4]-o[3]-o[2]/2}static foundPatternCross(o){let a=0;for(let d=0;d<5;d++){const g=o[d];if(g===0)return!1;a+=g}if(a<7)return!1;const c=a/7,u=c/2;return Math.abs(c-o[0])<u&&Math.abs(c-o[1])<u&&Math.abs(3*c-o[2])<3*u&&Math.abs(c-o[3])<u&&Math.abs(c-o[4])<u}getCrossCheckStateCount(){const o=this.crossCheckStateCount;return o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o}crossCheckDiagonal(o,a,c,u){const d=this.getCrossCheckStateCount();let g=0;const y=this.image;for(;o>=g&&a>=g&&y.get(a-g,o-g);)d[2]++,g++;if(o<g||a<g)return!1;for(;o>=g&&a>=g&&!y.get(a-g,o-g)&&d[1]<=c;)d[1]++,g++;if(o<g||a<g||d[1]>c)return!1;for(;o>=g&&a>=g&&y.get(a-g,o-g)&&d[0]<=c;)d[0]++,g++;if(d[0]>c)return!1;const w=y.getHeight(),v=y.getWidth();for(g=1;o+g<w&&a+g<v&&y.get(a+g,o+g);)d[2]++,g++;if(o+g>=w||a+g>=v)return!1;for(;o+g<w&&a+g<v&&!y.get(a+g,o+g)&&d[3]<c;)d[3]++,g++;if(o+g>=w||a+g>=v||d[3]>=c)return!1;for(;o+g<w&&a+g<v&&y.get(a+g,o+g)&&d[4]<c;)d[4]++,g++;if(d[4]>=c)return!1;const T=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(T-u)<2*u&&Sn.foundPatternCross(d)}crossCheckVertical(o,a,c,u){const d=this.image,g=d.getHeight(),y=this.getCrossCheckStateCount();let w=o;for(;w>=0&&d.get(a,w);)y[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(a,w)&&y[1]<=c;)y[1]++,w--;if(w<0||y[1]>c)return NaN;for(;w>=0&&d.get(a,w)&&y[0]<=c;)y[0]++,w--;if(y[0]>c)return NaN;for(w=o+1;w<g&&d.get(a,w);)y[2]++,w++;if(w===g)return NaN;for(;w<g&&!d.get(a,w)&&y[3]<c;)y[3]++,w++;if(w===g||y[3]>=c)return NaN;for(;w<g&&d.get(a,w)&&y[4]<c;)y[4]++,w++;if(y[4]>=c)return NaN;const v=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(v-u)>=2*u?NaN:Sn.foundPatternCross(y)?Sn.centerFromEnd(y,w):NaN}crossCheckHorizontal(o,a,c,u){const d=this.image,g=d.getWidth(),y=this.getCrossCheckStateCount();let w=o;for(;w>=0&&d.get(w,a);)y[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(w,a)&&y[1]<=c;)y[1]++,w--;if(w<0||y[1]>c)return NaN;for(;w>=0&&d.get(w,a)&&y[0]<=c;)y[0]++,w--;if(y[0]>c)return NaN;for(w=o+1;w<g&&d.get(w,a);)y[2]++,w++;if(w===g)return NaN;for(;w<g&&!d.get(w,a)&&y[3]<c;)y[3]++,w++;if(w===g||y[3]>=c)return NaN;for(;w<g&&d.get(w,a)&&y[4]<c;)y[4]++,w++;if(y[4]>=c)return NaN;const v=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(v-u)>=u?NaN:Sn.foundPatternCross(y)?Sn.centerFromEnd(y,w):NaN}handlePossibleCenter(o,a,c,u){const d=o[0]+o[1]+o[2]+o[3]+o[4];let g=Sn.centerFromEnd(o,c),y=this.crossCheckVertical(a,Math.floor(g),o[2],d);if(!isNaN(y)&&(g=this.crossCheckHorizontal(Math.floor(g),Math.floor(y),o[2],d),!isNaN(g)&&(!u||this.crossCheckDiagonal(Math.floor(y),Math.floor(g),o[2],d)))){const w=d/7;let v=!1;const T=this.possibleCenters;for(let R=0,O=T.length;R<O;R++){const q=T[R];if(q.aboutEquals(w,y,g)){T[R]=q.combineEstimate(y,g,w),v=!0;break}}if(!v){const R=new xi(g,y,w);T.push(R),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(R)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let a=null;for(const c of this.possibleCenters)if(c.getCount()>=Sn.CENTER_QUORUM)if(a==null)a=c;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-c.getX())-Math.abs(a.getY()-c.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let o=0,a=0;const c=this.possibleCenters.length;for(const g of this.possibleCenters)g.getCount()>=Sn.CENTER_QUORUM&&(o++,a+=g.getEstimatedModuleSize());if(o<3)return!1;const u=a/c;let d=0;for(const g of this.possibleCenters)d+=Math.abs(g.getEstimatedModuleSize()-u);return d<=.05*a}selectBestPatterns(){const o=this.possibleCenters.length;if(o<3)throw new se;const a=this.possibleCenters;let c;if(o>3){let u=0,d=0;for(const w of this.possibleCenters){const v=w.getEstimatedModuleSize();u+=v,d+=v*v}c=u/o;let g=Math.sqrt(d/o-c*c);a.sort((w,v)=>{const T=Math.abs(v.getEstimatedModuleSize()-c),R=Math.abs(w.getEstimatedModuleSize()-c);return T<R?-1:T>R?1:0});const y=Math.max(.2*c,g);for(let w=0;w<a.length&&a.length>3;w++){const v=a[w];Math.abs(v.getEstimatedModuleSize()-c)>y&&(a.splice(w,1),w--)}}if(a.length>3){let u=0;for(const d of a)u+=d.getEstimatedModuleSize();c=u/a.length,a.sort((d,g)=>{if(g.getCount()===d.getCount()){const y=Math.abs(g.getEstimatedModuleSize()-c),w=Math.abs(d.getEstimatedModuleSize()-c);return y<w?1:y>w?-1:0}else return g.getCount()-d.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]}}Sn.CENTER_QUORUM=2,Sn.MIN_SKIP=3,Sn.MAX_MODULES=57;class So{constructor(o){this.image=o}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(o){this.resultPointCallback=o==null?null:o.get(J.NEED_RESULT_POINT_CALLBACK);const c=new Sn(this.image,this.resultPointCallback).find(o);return this.processFinderPatternInfo(c)}processFinderPatternInfo(o){const a=o.getTopLeft(),c=o.getTopRight(),u=o.getBottomLeft(),d=this.calculateModuleSize(a,c,u);if(d<1)throw new se("No pattern found in proccess finder.");const g=So.computeDimension(a,c,u,d),y=Ve.getProvisionalVersionForDimension(g),w=y.getDimensionForVersion()-7;let v=null;if(y.getAlignmentPatternCenters().length>0){const q=c.getX()-a.getX()+u.getX(),Y=c.getY()-a.getY()+u.getY(),Z=1-3/w,ie=Math.floor(a.getX()+Z*(q-a.getX())),ce=Math.floor(a.getY()+Z*(Y-a.getY()));for(let we=4;we<=16;we<<=1)try{v=this.findAlignmentInRegion(d,ie,ce,we);break}catch(_e){if(!(_e instanceof se))throw _e}}const T=So.createTransform(a,c,u,v,g),R=So.sampleGrid(this.image,T,g);let O;return v===null?O=[u,a,c]:O=[u,a,c,v],new ue(R,O)}static createTransform(o,a,c,u,d){const g=d-3.5;let y,w,v,T;return u!==null?(y=u.getX(),w=u.getY(),v=g-3,T=v):(y=a.getX()-o.getX()+c.getX(),w=a.getY()-o.getY()+c.getY(),v=g,T=g),be.quadrilateralToQuadrilateral(3.5,3.5,g,3.5,v,T,3.5,g,o.getX(),o.getY(),a.getX(),a.getY(),y,w,c.getX(),c.getY())}static sampleGrid(o,a,c){return qe.getInstance().sampleGridWithTransform(o,c,c,a)}static computeDimension(o,a,c,u){const d=it.round(X.distance(o,a)/u),g=it.round(X.distance(o,c)/u);let y=Math.floor((d+g)/2)+7;switch(y&3){case 0:y++;break;case 2:y--;break;case 3:throw new se("Dimensions could be not found.")}return y}calculateModuleSize(o,a,c){return(this.calculateModuleSizeOneWay(o,a)+this.calculateModuleSizeOneWay(o,c))/2}calculateModuleSizeOneWay(o,a){const c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(o.getX()),Math.floor(o.getY()),Math.floor(a.getX()),Math.floor(a.getY())),u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(o.getX()),Math.floor(o.getY()));return isNaN(c)?u/7:isNaN(u)?c/7:(c+u)/14}sizeOfBlackWhiteBlackRunBothWays(o,a,c,u){let d=this.sizeOfBlackWhiteBlackRun(o,a,c,u),g=1,y=o-(c-o);y<0?(g=o/(o-y),y=0):y>=this.image.getWidth()&&(g=(this.image.getWidth()-1-o)/(y-o),y=this.image.getWidth()-1);let w=Math.floor(a-(u-a)*g);return g=1,w<0?(g=a/(a-w),w=0):w>=this.image.getHeight()&&(g=(this.image.getHeight()-1-a)/(w-a),w=this.image.getHeight()-1),y=Math.floor(o+(y-o)*g),d+=this.sizeOfBlackWhiteBlackRun(o,a,y,w),d-1}sizeOfBlackWhiteBlackRun(o,a,c,u){const d=Math.abs(u-a)>Math.abs(c-o);if(d){let q=o;o=a,a=q,q=c,c=u,u=q}const g=Math.abs(c-o),y=Math.abs(u-a);let w=-g/2;const v=o<c?1:-1,T=a<u?1:-1;let R=0;const O=c+v;for(let q=o,Y=a;q!==O;q+=v){const Z=d?Y:q,ie=d?q:Y;if(R===1===this.image.get(Z,ie)){if(R===2)return it.distance(q,Y,o,a);R++}if(w+=y,w>0){if(Y===u)break;Y+=T,w-=g}}return R===2?it.distance(c+v,u,o,a):NaN}findAlignmentInRegion(o,a,c,u){const d=Math.floor(u*o),g=Math.max(0,a-d),y=Math.min(this.image.getWidth()-1,a+d);if(y-g<o*3)throw new se("Alignment top exceeds estimated module size.");const w=Math.max(0,c-d),v=Math.min(this.image.getHeight()-1,c+d);if(v-w<o*3)throw new se("Alignment bottom exceeds estimated module size.");return new as(this.image,g,w,y-g,v-w,o,this.resultPointCallback).find()}}class Nr{constructor(){this.decoder=new Bg}getDecoder(){return this.decoder}decode(o,a){let c,u;if(a!=null&&a.get(J.PURE_BARCODE)!==void 0){const w=Nr.extractPureBits(o.getBlackMatrix());c=this.decoder.decodeBitMatrix(w,a),u=Nr.NO_POINTS}else{const w=new So(o.getBlackMatrix()).detect(a);c=this.decoder.decodeBitMatrix(w.getBits(),a),u=w.getPoints()}c.getOther()instanceof mf&&c.getOther().applyMirroredCorrection(u);const d=new Bt(c.getText(),c.getRawBytes(),void 0,u,ke.QR_CODE,void 0),g=c.getByteSegments();g!==null&&d.putMetadata(ln.BYTE_SEGMENTS,g);const y=c.getECLevel();return y!==null&&d.putMetadata(ln.ERROR_CORRECTION_LEVEL,y),c.hasStructuredAppend()&&(d.putMetadata(ln.STRUCTURED_APPEND_SEQUENCE,c.getStructuredAppendSequenceNumber()),d.putMetadata(ln.STRUCTURED_APPEND_PARITY,c.getStructuredAppendParity())),d}reset(){}static extractPureBits(o){const a=o.getTopLeftOnBit(),c=o.getBottomRightOnBit();if(a===null||c===null)throw new se;const u=this.moduleSize(a,o);let d=a[1],g=c[1],y=a[0],w=c[0];if(y>=w||d>=g)throw new se;if(g-d!==w-y&&(w=y+(g-d),w>=o.getWidth()))throw new se;const v=Math.round((w-y+1)/u),T=Math.round((g-d+1)/u);if(v<=0||T<=0)throw new se;if(T!==v)throw new se;const R=Math.floor(u/2);d+=R,y+=R;const O=y+Math.floor((v-1)*u)-w;if(O>0){if(O>R)throw new se;y-=O}const q=d+Math.floor((T-1)*u)-g;if(q>0){if(q>R)throw new se;d-=q}const Y=new Ge(v,T);for(let Z=0;Z<T;Z++){const ie=d+Math.floor(Z*u);for(let ce=0;ce<v;ce++)o.get(y+Math.floor(ce*u),ie)&&Y.set(ce,Z)}return Y}static moduleSize(o,a){const c=a.getHeight(),u=a.getWidth();let d=o[0],g=o[1],y=!0,w=0;for(;d<u&&g<c;){if(y!==a.get(d,g)){if(++w===5)break;y=!y}d++,g++}if(d===u||g===c)throw new se;return(d-o[0])/7}}Nr.NO_POINTS=new Array;class He{PDF417Common(){}static getBitCountSum(o){return it.sum(o)}static toIntArray(o){if(o==null||!o.length)return He.EMPTY_INT_ARRAY;const a=new Int32Array(o.length);let c=0;for(const u of o)a[c++]=u;return a}static getCodeword(o){const a=b.binarySearch(He.SYMBOL_TABLE,o&262143);return a<0?-1:(He.CODEWORD_TABLE[a]-1)%He.NUMBER_OF_CODEWORDS}}He.NUMBER_OF_CODEWORDS=929,He.MAX_CODEWORDS_IN_BARCODE=He.NUMBER_OF_CODEWORDS-1,He.MIN_ROWS_IN_BARCODE=3,He.MAX_ROWS_IN_BARCODE=90,He.MODULES_IN_CODEWORD=17,He.MODULES_IN_STOP_PATTERN=18,He.BARS_IN_MODULE=8,He.EMPTY_INT_ARRAY=new Int32Array([]),He.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),He.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Ug{constructor(o,a){this.bits=o,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class Ze{static detectMultiple(o,a,c){let u=o.getBlackMatrix(),d=Ze.detect(c,u);return d.length||(u=u.clone(),u.rotate180(),d=Ze.detect(c,u)),new Ug(u,d)}static detect(o,a){const c=new Array;let u=0,d=0,g=!1;for(;u<a.getHeight();){const y=Ze.findVertices(a,u,d);if(y[0]==null&&y[3]==null){if(!g)break;g=!1,d=0;for(const w of c)w[1]!=null&&(u=Math.trunc(Math.max(u,w[1].getY()))),w[3]!=null&&(u=Math.max(u,Math.trunc(w[3].getY())));u+=Ze.ROW_STEP;continue}if(g=!0,c.push(y),!o)break;y[2]!=null?(d=Math.trunc(y[2].getX()),u=Math.trunc(y[2].getY())):(d=Math.trunc(y[4].getX()),u=Math.trunc(y[4].getY()))}return c}static findVertices(o,a,c){const u=o.getHeight(),d=o.getWidth(),g=new Array(8);return Ze.copyToResult(g,Ze.findRowsWithPattern(o,u,d,a,c,Ze.START_PATTERN),Ze.INDEXES_START_PATTERN),g[4]!=null&&(c=Math.trunc(g[4].getX()),a=Math.trunc(g[4].getY())),Ze.copyToResult(g,Ze.findRowsWithPattern(o,u,d,a,c,Ze.STOP_PATTERN),Ze.INDEXES_STOP_PATTERN),g}static copyToResult(o,a,c){for(let u=0;u<c.length;u++)o[c[u]]=a[u]}static findRowsWithPattern(o,a,c,u,d,g){const y=new Array(4);let w=!1;const v=new Int32Array(g.length);for(;u<a;u+=Ze.ROW_STEP){let R=Ze.findGuardPattern(o,d,u,c,!1,g,v);if(R!=null){for(;u>0;){const O=Ze.findGuardPattern(o,d,--u,c,!1,g,v);if(O!=null)R=O;else{u++;break}}y[0]=new X(R[0],u),y[1]=new X(R[1],u),w=!0;break}}let T=u+1;if(w){let R=0,O=Int32Array.from([Math.trunc(y[0].getX()),Math.trunc(y[1].getX())]);for(;T<a;T++){const q=Ze.findGuardPattern(o,O[0],T,c,!1,g,v);if(q!=null&&Math.abs(O[0]-q[0])<Ze.MAX_PATTERN_DRIFT&&Math.abs(O[1]-q[1])<Ze.MAX_PATTERN_DRIFT)O=q,R=0;else{if(R>Ze.SKIPPED_ROW_COUNT_MAX)break;R++}}T-=R+1,y[2]=new X(O[0],T),y[3]=new X(O[1],T)}return T-u<Ze.BARCODE_MIN_HEIGHT&&b.fill(y,null),y}static findGuardPattern(o,a,c,u,d,g,y){b.fillWithin(y,0,y.length,0);let w=a,v=0;for(;o.get(w,c)&&w>0&&v++<Ze.MAX_PIXEL_DRIFT;)w--;let T=w,R=0,O=g.length;for(let q=d;T<u;T++)if(o.get(T,c)!==q)y[R]++;else{if(R===O-1){if(Ze.patternMatchVariance(y,g,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE)return new Int32Array([w,T]);w+=y[0]+y[1],D.arraycopy(y,2,y,0,R-1),y[R-1]=0,y[R]=0,R--}else R++;y[R]=1,q=!q}return R===O-1&&Ze.patternMatchVariance(y,g,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE?new Int32Array([w,T-1]):null}static patternMatchVariance(o,a,c){let u=o.length,d=0,g=0;for(let v=0;v<u;v++)d+=o[v],g+=a[v];if(d<g)return 1/0;let y=d/g;c*=y;let w=0;for(let v=0;v<u;v++){let T=o[v],R=a[v]*y,O=T>R?T-R:R-T;if(O>c)return 1/0;w+=O}return w/d}}Ze.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ze.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ze.MAX_AVG_VARIANCE=.42,Ze.MAX_INDIVIDUAL_VARIANCE=.8,Ze.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ze.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ze.MAX_PIXEL_DRIFT=3,Ze.MAX_PATTERN_DRIFT=5,Ze.SKIPPED_ROW_COUNT_MAX=25,Ze.ROW_STEP=5,Ze.BARCODE_MIN_HEIGHT=10;class Kt{constructor(o,a){if(a.length===0)throw new E;this.field=o;let c=a.length;if(c>1&&a[0]===0){let u=1;for(;u<c&&a[u]===0;)u++;u===c?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(c-u),D.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(o){return this.coefficients[this.coefficients.length-1-o]}evaluateAt(o){if(o===0)return this.getCoefficient(0);if(o===1){let u=0;for(let d of this.coefficients)u=this.field.add(u,d);return u}let a=this.coefficients[0],c=this.coefficients.length;for(let u=1;u<c;u++)a=this.field.add(this.field.multiply(o,a),this.coefficients[u]);return a}add(o){if(!this.field.equals(o.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero())return o;if(o.isZero())return this;let a=this.coefficients,c=o.coefficients;if(a.length>c.length){let g=a;a=c,c=g}let u=new Int32Array(c.length),d=c.length-a.length;D.arraycopy(c,0,u,0,d);for(let g=d;g<c.length;g++)u[g]=this.field.add(a[g-d],c[g]);return new Kt(this.field,u)}subtract(o){if(!this.field.equals(o.field))throw new E("ModulusPolys do not have same ModulusGF field");return o.isZero()?this:this.add(o.negative())}multiply(o){return o instanceof Kt?this.multiplyOther(o):this.multiplyScalar(o)}multiplyOther(o){if(!this.field.equals(o.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero()||o.isZero())return new Kt(this.field,new Int32Array([0]));let a=this.coefficients,c=a.length,u=o.coefficients,d=u.length,g=new Int32Array(c+d-1);for(let y=0;y<c;y++){let w=a[y];for(let v=0;v<d;v++)g[y+v]=this.field.add(g[y+v],this.field.multiply(w,u[v]))}return new Kt(this.field,g)}negative(){let o=this.coefficients.length,a=new Int32Array(o);for(let c=0;c<o;c++)a[c]=this.field.subtract(0,this.coefficients[c]);return new Kt(this.field,a)}multiplyScalar(o){if(o===0)return new Kt(this.field,new Int32Array([0]));if(o===1)return this;let a=this.coefficients.length,c=new Int32Array(a);for(let u=0;u<a;u++)c[u]=this.field.multiply(this.coefficients[u],o);return new Kt(this.field,c)}multiplyByMonomial(o,a){if(o<0)throw new E;if(a===0)return new Kt(this.field,new Int32Array([0]));let c=this.coefficients.length,u=new Int32Array(c+o);for(let d=0;d<c;d++)u[d]=this.field.multiply(this.coefficients[d],a);return new Kt(this.field,u)}toString(){let o=new z;for(let a=this.getDegree();a>=0;a--){let c=this.getCoefficient(a);c!==0&&(c<0?(o.append(" - "),c=-c):o.length()>0&&o.append(" + "),(a===0||c!==1)&&o.append(c),a!==0&&(a===1?o.append("x"):(o.append("x^"),o.append(a))))}return o.toString()}}class jg{add(o,a){return(o+a)%this.modulus}subtract(o,a){return(this.modulus+o-a)%this.modulus}exp(o){return this.expTable[o]}log(o){if(o===0)throw new E;return this.logTable[o]}inverse(o){if(o===0)throw new Pi;return this.expTable[this.modulus-this.logTable[o]-1]}multiply(o,a){return o===0||a===0?0:this.expTable[(this.logTable[o]+this.logTable[a])%(this.modulus-1)]}getSize(){return this.modulus}equals(o){return o===this}}class Xu extends jg{constructor(o,a){super(),this.modulus=o,this.expTable=new Int32Array(o),this.logTable=new Int32Array(o);let c=1;for(let u=0;u<o;u++)this.expTable[u]=c,c=c*a%o;for(let u=0;u<o-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new Kt(this,new Int32Array([0])),this.one=new Kt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(o,a){if(o<0)throw new E;if(a===0)return this.zero;let c=new Int32Array(o+1);return c[0]=a,new Kt(this,c)}}Xu.PDF417_GF=new Xu(He.NUMBER_OF_CODEWORDS,3);class qa{constructor(){this.field=Xu.PDF417_GF}decode(o,a,c){let u=new Kt(this.field,o),d=new Int32Array(a),g=!1;for(let Y=a;Y>0;Y--){let Z=u.evaluateAt(this.field.exp(Y));d[a-Y]=Z,Z!==0&&(g=!0)}if(!g)return 0;let y=this.field.getOne();if(c!=null)for(const Y of c){let Z=this.field.exp(o.length-1-Y),ie=new Kt(this.field,new Int32Array([this.field.subtract(0,Z),1]));y=y.multiply(ie)}let w=new Kt(this.field,d),v=this.runEuclideanAlgorithm(this.field.buildMonomial(a,1),w,a),T=v[0],R=v[1],O=this.findErrorLocations(T),q=this.findErrorMagnitudes(R,T,O);for(let Y=0;Y<O.length;Y++){let Z=o.length-1-this.field.log(O[Y]);if(Z<0)throw N.getChecksumInstance();o[Z]=this.field.subtract(o[Z],q[Y])}return O.length}runEuclideanAlgorithm(o,a,c){if(o.getDegree()<a.getDegree()){let O=o;o=a,a=O}let u=o,d=a,g=this.field.getZero(),y=this.field.getOne();for(;d.getDegree()>=Math.round(c/2);){let O=u,q=g;if(u=d,g=y,u.isZero())throw N.getChecksumInstance();d=O;let Y=this.field.getZero(),Z=u.getCoefficient(u.getDegree()),ie=this.field.inverse(Z);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){let ce=d.getDegree()-u.getDegree(),we=this.field.multiply(d.getCoefficient(d.getDegree()),ie);Y=Y.add(this.field.buildMonomial(ce,we)),d=d.subtract(u.multiplyByMonomial(ce,we))}y=Y.multiply(g).subtract(q).negative()}let w=y.getCoefficient(0);if(w===0)throw N.getChecksumInstance();let v=this.field.inverse(w),T=y.multiply(v),R=d.multiply(v);return[T,R]}findErrorLocations(o){let a=o.getDegree(),c=new Int32Array(a),u=0;for(let d=1;d<this.field.getSize()&&u<a;d++)o.evaluateAt(d)===0&&(c[u]=this.field.inverse(d),u++);if(u!==a)throw N.getChecksumInstance();return c}findErrorMagnitudes(o,a,c){let u=a.getDegree(),d=new Int32Array(u);for(let v=1;v<=u;v++)d[u-v]=this.field.multiply(v,a.getCoefficient(v));let g=new Kt(this.field,d),y=c.length,w=new Int32Array(y);for(let v=0;v<y;v++){let T=this.field.inverse(c[v]),R=this.field.subtract(0,o.evaluateAt(T)),O=this.field.inverse(g.evaluateAt(T));w[v]=this.field.multiply(R,O)}return w}}class wi{constructor(o,a,c,u,d){o instanceof wi?this.constructor_2(o):this.constructor_1(o,a,c,u,d)}constructor_1(o,a,c,u,d){const g=a==null||c==null,y=u==null||d==null;if(g&&y)throw new se;g?(a=new X(0,u.getY()),c=new X(0,d.getY())):y&&(u=new X(o.getWidth()-1,a.getY()),d=new X(o.getWidth()-1,c.getY())),this.image=o,this.topLeft=a,this.bottomLeft=c,this.topRight=u,this.bottomRight=d,this.minX=Math.trunc(Math.min(a.getX(),c.getX())),this.maxX=Math.trunc(Math.max(u.getX(),d.getX())),this.minY=Math.trunc(Math.min(a.getY(),u.getY())),this.maxY=Math.trunc(Math.max(c.getY(),d.getY()))}constructor_2(o){this.image=o.image,this.topLeft=o.getTopLeft(),this.bottomLeft=o.getBottomLeft(),this.topRight=o.getTopRight(),this.bottomRight=o.getBottomRight(),this.minX=o.getMinX(),this.maxX=o.getMaxX(),this.minY=o.getMinY(),this.maxY=o.getMaxY()}static merge(o,a){return o==null?a:a==null?o:new wi(o.image,o.topLeft,o.bottomLeft,a.topRight,a.bottomRight)}addMissingRows(o,a,c){let u=this.topLeft,d=this.bottomLeft,g=this.topRight,y=this.bottomRight;if(o>0){let w=c?this.topLeft:this.topRight,v=Math.trunc(w.getY()-o);v<0&&(v=0);let T=new X(w.getX(),v);c?u=T:g=T}if(a>0){let w=c?this.bottomLeft:this.bottomRight,v=Math.trunc(w.getY()+a);v>=this.image.getHeight()&&(v=this.image.getHeight()-1);let T=new X(w.getX(),v);c?d=T:y=T}return new wi(this.image,u,d,g,y)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class yf{constructor(o,a,c,u){this.columnCount=o,this.errorCorrectionLevel=u,this.rowCountUpperPart=a,this.rowCountLowerPart=c,this.rowCount=a+c}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Oi{constructor(){this.buffer=""}static form(o,a){let c=-1;function u(g,y,w,v,T,R){if(g==="%%")return"%";if(a[++c]===void 0)return;g=v?parseInt(v.substr(1)):void 0;let O=T?parseInt(T.substr(1)):void 0,q;switch(R){case"s":q=a[c];break;case"c":q=a[c][0];break;case"f":q=parseFloat(a[c]).toFixed(g);break;case"p":q=parseFloat(a[c]).toPrecision(g);break;case"e":q=parseFloat(a[c]).toExponential(g);break;case"x":q=parseInt(a[c]).toString(O||16);break;case"d":q=parseFloat(parseInt(a[c],O||10).toPrecision(g)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(O);let Y=parseInt(w),Z=w&&w[0]+""=="0"?"0":" ";for(;q.length<Y;)q=y!==void 0?q+Z:Z+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return o.replace(d,u)}format(o,...a){this.buffer+=Oi.form(o,a)}toString(){return this.buffer}}class Mi{constructor(o){this.boundingBox=new wi(o),this.codewords=new Array(o.getMaxY()-o.getMinY()+1)}getCodewordNearby(o){let a=this.getCodeword(o);if(a!=null)return a;for(let c=1;c<Mi.MAX_NEARBY_DISTANCE;c++){let u=this.imageRowToCodewordIndex(o)-c;if(u>=0&&(a=this.codewords[u],a!=null)||(u=this.imageRowToCodewordIndex(o)+c,u<this.codewords.length&&(a=this.codewords[u],a!=null)))return a}return null}imageRowToCodewordIndex(o){return o-this.boundingBox.getMinY()}setCodeword(o,a){this.codewords[this.imageRowToCodewordIndex(o)]=a}getCodeword(o){return this.codewords[this.imageRowToCodewordIndex(o)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const o=new Oi;let a=0;for(const c of this.codewords){if(c==null){o.format("%3d:    |   %n",a++);continue}o.format("%3d: %3d|%3d%n",a++,c.getRowNumber(),c.getValue())}return o.toString()}}Mi.MAX_NEARBY_DISTANCE=5;class bo{constructor(){this.values=new Map}setValue(o){o=Math.trunc(o);let a=this.values.get(o);a==null&&(a=0),a++,this.values.set(o,a)}getValue(){let o=-1,a=new Array;for(const[c,u]of this.values.entries()){const d={getKey:()=>c,getValue:()=>u};d.getValue()>o?(o=d.getValue(),a=[],a.push(d.getKey())):d.getValue()===o&&a.push(d.getKey())}return He.toIntArray(a)}getConfidence(o){return this.values.get(o)}}class Zl extends Mi{constructor(o,a){super(o),this._isLeft=a}setRowNumbers(){for(let o of this.getCodewords())o!=null&&o.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(o){let a=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(a,o);let c=this.getBoundingBox(),u=this._isLeft?c.getTopLeft():c.getTopRight(),d=this._isLeft?c.getBottomLeft():c.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=-1,v=1,T=0;for(let R=g;R<y;R++){if(a[R]==null)continue;let O=a[R],q=O.getRowNumber()-w;if(q===0)T++;else if(q===1)v=Math.max(v,T),T=1,w=O.getRowNumber();else if(q<0||O.getRowNumber()>=o.getRowCount()||q>R)a[R]=null;else{let Y;v>2?Y=(v-2)*q:Y=q;let Z=Y>=R;for(let ie=1;ie<=Y&&!Z;ie++)Z=a[R-ie]!=null;Z?a[R]=null:(w=O.getRowNumber(),T=1)}}}getRowHeights(){let o=this.getBarcodeMetadata();if(o==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(o);let a=new Int32Array(o.getRowCount());for(let c of this.getCodewords())if(c!=null){let u=c.getRowNumber();if(u>=a.length)continue;a[u]++}return a}adjustIncompleteIndicatorColumnRowNumbers(o){let a=this.getBoundingBox(),c=this._isLeft?a.getTopLeft():a.getTopRight(),u=this._isLeft?a.getBottomLeft():a.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),g=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.getCodewords(),w=-1;for(let v=d;v<g;v++){if(y[v]==null)continue;let T=y[v];T.setRowNumberAsRowIndicatorColumn();let R=T.getRowNumber()-w;R===0||(R===1?w=T.getRowNumber():T.getRowNumber()>=o.getRowCount()?y[v]=null:w=T.getRowNumber())}}getBarcodeMetadata(){let o=this.getCodewords(),a=new bo,c=new bo,u=new bo,d=new bo;for(let y of o){if(y==null)continue;y.setRowNumberAsRowIndicatorColumn();let w=y.getValue()%30,v=y.getRowNumber();switch(this._isLeft||(v+=2),v%3){case 0:c.setValue(w*3+1);break;case 1:d.setValue(w/3),u.setValue(w%3);break;case 2:a.setValue(w+1);break}}if(a.getValue().length===0||c.getValue().length===0||u.getValue().length===0||d.getValue().length===0||a.getValue()[0]<1||c.getValue()[0]+u.getValue()[0]<He.MIN_ROWS_IN_BARCODE||c.getValue()[0]+u.getValue()[0]>He.MAX_ROWS_IN_BARCODE)return null;let g=new yf(a.getValue()[0],c.getValue()[0],u.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(o,g),g}removeIncorrectCodewords(o,a){for(let c=0;c<o.length;c++){let u=o[c];if(o[c]==null)continue;let d=u.getValue()%30,g=u.getRowNumber();if(g>a.getRowCount()){o[c]=null;continue}switch(this._isLeft||(g+=2),g%3){case 0:d*3+1!==a.getRowCountUpperPart()&&(o[c]=null);break;case 1:(Math.trunc(d/3)!==a.getErrorCorrectionLevel()||d%3!==a.getRowCountLowerPart())&&(o[c]=null);break;case 2:d+1!==a.getColumnCount()&&(o[c]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Lt{constructor(o,a){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=o,this.barcodeColumnCount=o.getColumnCount(),this.boundingBox=a,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let o=He.MAX_CODEWORDS_IN_BARCODE,a;do a=o,o=this.adjustRowNumbersAndGetCount();while(o>0&&o<a);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(o){o!=null&&o.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let o=this.adjustRowNumbersByRow();if(o===0)return 0;for(let a=1;a<this.barcodeColumnCount+1;a++){let c=this.detectionResultColumns[a].getCodewords();for(let u=0;u<c.length;u++)c[u]!=null&&(c[u].hasValidRowNumber()||this.adjustRowNumbers(a,u,c))}return o}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let o=this.detectionResultColumns[0].getCodewords(),a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<o.length;c++)if(o[c]!=null&&a[c]!=null&&o[c].getRowNumber()===a[c].getRowNumber())for(let u=1;u<=this.barcodeColumnCount;u++){let d=this.detectionResultColumns[u].getCodewords()[c];d!=null&&(d.setRowNumber(o[c].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[u].getCodewords()[c]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let o=0,a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<a.length;c++){if(a[c]==null)continue;let u=a[c].getRowNumber(),d=0;for(let g=this.barcodeColumnCount+1;g>0&&d<this.ADJUST_ROW_NUMBER_SKIP;g--){let y=this.detectionResultColumns[g].getCodewords()[c];y!=null&&(d=Lt.adjustRowNumberIfValid(u,d,y),y.hasValidRowNumber()||o++)}}return o}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let o=0,a=this.detectionResultColumns[0].getCodewords();for(let c=0;c<a.length;c++){if(a[c]==null)continue;let u=a[c].getRowNumber(),d=0;for(let g=1;g<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;g++){let y=this.detectionResultColumns[g].getCodewords()[c];y!=null&&(d=Lt.adjustRowNumberIfValid(u,d,y),y.hasValidRowNumber()||o++)}}return o}static adjustRowNumberIfValid(o,a,c){return c==null||c.hasValidRowNumber()||(c.isValidRowNumber(o)?(c.setRowNumber(o),a=0):++a),a}adjustRowNumbers(o,a,c){if(!this.detectionResultColumns[o-1])return;let u=c[a],d=this.detectionResultColumns[o-1].getCodewords(),g=d;this.detectionResultColumns[o+1]!=null&&(g=this.detectionResultColumns[o+1].getCodewords());let y=new Array(14);y[2]=d[a],y[3]=g[a],a>0&&(y[0]=c[a-1],y[4]=d[a-1],y[5]=g[a-1]),a>1&&(y[8]=c[a-2],y[10]=d[a-2],y[11]=g[a-2]),a<c.length-1&&(y[1]=c[a+1],y[6]=d[a+1],y[7]=g[a+1]),a<c.length-2&&(y[9]=c[a+2],y[12]=d[a+2],y[13]=g[a+2]);for(let w of y)if(Lt.adjustRowNumber(u,w))return}static adjustRowNumber(o,a){return a==null?!1:a.hasValidRowNumber()&&a.getBucket()===o.getBucket()?(o.setRowNumber(a.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(o){this.boundingBox=o}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(o,a){this.detectionResultColumns[o]=a}getDetectionResultColumn(o){return this.detectionResultColumns[o]}toString(){let o=this.detectionResultColumns[0];o==null&&(o=this.detectionResultColumns[this.barcodeColumnCount+1]);let a=new Oi;for(let c=0;c<o.getCodewords().length;c++){a.format("CW %3d:",c);for(let u=0;u<this.barcodeColumnCount+2;u++){if(this.detectionResultColumns[u]==null){a.format("    |   ");continue}let d=this.detectionResultColumns[u].getCodewords()[c];if(d==null){a.format("    |   ");continue}a.format(" %3d|%3d",d.getRowNumber(),d.getValue())}a.format("%n")}return a.toString()}}class Ha{constructor(o,a,c,u){this.rowNumber=Ha.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(o),this.endX=Math.trunc(a),this.bucket=Math.trunc(c),this.value=Math.trunc(u)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(o){return o!==Ha.BARCODE_ROW_UNKNOWN&&this.bucket===o%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(o){this.rowNumber=o}toString(){return this.rowNumber+"|"+this.value}}Ha.BARCODE_ROW_UNKNOWN=-1;class yr{static initialize(){for(let o=0;o<He.SYMBOL_TABLE.length;o++){let a=He.SYMBOL_TABLE[o],c=a&1;for(let u=0;u<He.BARS_IN_MODULE;u++){let d=0;for(;(a&1)===c;)d+=1,a>>=1;c=a&1,yr.RATIOS_TABLE[o]||(yr.RATIOS_TABLE[o]=new Array(He.BARS_IN_MODULE)),yr.RATIOS_TABLE[o][He.BARS_IN_MODULE-u-1]=Math.fround(d/He.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(o){let a=yr.getDecodedCodewordValue(yr.sampleBitCounts(o));return a!==-1?a:yr.getClosestDecodedValue(o)}static sampleBitCounts(o){let a=it.sum(o),c=new Int32Array(He.BARS_IN_MODULE),u=0,d=0;for(let g=0;g<He.MODULES_IN_CODEWORD;g++){let y=a/(2*He.MODULES_IN_CODEWORD)+g*a/He.MODULES_IN_CODEWORD;d+o[u]<=y&&(d+=o[u],u++),c[u]++}return c}static getDecodedCodewordValue(o){let a=yr.getBitValue(o);return He.getCodeword(a)===-1?-1:a}static getBitValue(o){let a=0;for(let c=0;c<o.length;c++)for(let u=0;u<o[c];u++)a=a<<1|(c%2===0?1:0);return Math.trunc(a)}static getClosestDecodedValue(o){let a=it.sum(o),c=new Array(He.BARS_IN_MODULE);if(a>1)for(let g=0;g<c.length;g++)c[g]=Math.fround(o[g]/a);let u=Q.MAX_VALUE,d=-1;this.bSymbolTableReady||yr.initialize();for(let g=0;g<yr.RATIOS_TABLE.length;g++){let y=0,w=yr.RATIOS_TABLE[g];for(let v=0;v<He.BARS_IN_MODULE;v++){let T=Math.fround(w[v]-c[v]);if(y+=Math.fround(T*T),y>=u)break}y<u&&(u=y,d=He.SYMBOL_TABLE[g])}return d}}yr.bSymbolTableReady=!1,yr.RATIOS_TABLE=new Array(He.SYMBOL_TABLE.length).map(S=>new Array(He.BARS_IN_MODULE));class Yu{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(o){this.segmentIndex=o}getFileId(){return this.fileId}setFileId(o){this.fileId=o}getOptionalData(){return this.optionalData}setOptionalData(o){this.optionalData=o}isLastSegment(){return this.lastSegment}setLastSegment(o){this.lastSegment=o}getSegmentCount(){return this.segmentCount}setSegmentCount(o){this.segmentCount=o}getSender(){return this.sender||null}setSender(o){this.sender=o}getAddressee(){return this.addressee||null}setAddressee(o){this.addressee=o}getFileName(){return this.fileName}setFileName(o){this.fileName=o}getFileSize(){return this.fileSize}setFileSize(o){this.fileSize=o}getChecksum(){return this.checksum}setChecksum(o){this.checksum=o}getTimestamp(){return this.timestamp}setTimestamp(o){this.timestamp=o}}class Zu{static parseLong(o,a=void 0){return parseInt(o,a)}}class Ju extends m{}Ju.kind="NullPointerException";class Jl{writeBytes(o){this.writeBytesOffset(o,0,o.length)}writeBytesOffset(o,a,c){if(o==null)throw new Ju;if(a<0||a>o.length||c<0||a+c>o.length||a+c<0)throw new G;if(c===0)return;for(let u=0;u<c;u++)this.write(o[a+u])}flush(){}close(){}}class xf extends m{}class Li extends Jl{constructor(o=32){if(super(),this.count=0,o<0)throw new E("Negative initial size: "+o);this.buf=new Uint8Array(o)}ensureCapacity(o){o-this.buf.length>0&&this.grow(o)}grow(o){let c=this.buf.length<<1;if(c-o<0&&(c=o),c<0){if(o<0)throw new xf;c=P.MAX_VALUE}this.buf=b.copyOfUint8Array(this.buf,c)}write(o){this.ensureCapacity(this.count+1),this.buf[this.count]=o,this.count+=1}writeBytesOffset(o,a,c){if(a<0||a>o.length||c<0||a+c-o.length>0)throw new G;this.ensureCapacity(this.count+c),D.arraycopy(o,a,this.buf,this.count,c),this.count+=c}writeTo(o){o.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return b.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(o){return o?typeof o=="string"?this.toString_string(o):this.toString_number(o):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(o){return new String(this.buf).toString()}toString_number(o){return new String(this.buf).toString()}close(){}}var St;(function(S){S[S.ALPHA=0]="ALPHA",S[S.LOWER=1]="LOWER",S[S.MIXED=2]="MIXED",S[S.PUNCT=3]="PUNCT",S[S.ALPHA_SHIFT=4]="ALPHA_SHIFT",S[S.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(St||(St={}));function wf(){if(typeof window<"u")return window.BigInt||null;if(typeof rh<"u")return rh.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let ls;function Fi(S){if(typeof ls>"u"&&(ls=wf()),ls===null)throw new Error("BigInt is not supported!");return ls(S)}function eh(){let S=[];S[0]=Fi(1);let o=Fi(900);S[1]=o;for(let a=2;a<16;a++)S[a]=S[a-1]*o;return S}class oe{static decode(o,a){let c=new z(""),u=F.ISO8859_1;c.enableDecoding(u);let d=1,g=o[d++],y=new Yu;for(;d<o[0];){switch(g){case oe.TEXT_COMPACTION_MODE_LATCH:d=oe.textCompaction(o,d,c);break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:d=oe.byteCompaction(g,o,u,d,c);break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(o[d++]);break;case oe.NUMERIC_COMPACTION_MODE_LATCH:d=oe.numericCompaction(o,d,c);break;case oe.ECI_CHARSET:F.getCharacterSetECIByValue(o[d++]);break;case oe.ECI_GENERAL_PURPOSE:d+=2;break;case oe.ECI_USER_DEFINED:d++;break;case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=oe.decodeMacroBlock(o,d,y);break;case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:throw new k;default:d--,d=oe.textCompaction(o,d,c);break}if(d<o.length)g=o[d++];else throw k.getFormatInstance()}if(c.length()===0)throw k.getFormatInstance();let w=new Ni(null,c.toString(),null,a);return w.setOther(y),w}static decodeMacroBlock(o,a,c){if(a+oe.NUMBER_OF_SEQUENCE_CODEWORDS>o[0])throw k.getFormatInstance();let u=new Int32Array(oe.NUMBER_OF_SEQUENCE_CODEWORDS);for(let y=0;y<oe.NUMBER_OF_SEQUENCE_CODEWORDS;y++,a++)u[y]=o[a];c.setSegmentIndex(P.parseInt(oe.decodeBase900toBase10(u,oe.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new z;a=oe.textCompaction(o,a,d),c.setFileId(d.toString());let g=-1;for(o[a]===oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(g=a+1);a<o[0];)switch(o[a]){case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(a++,o[a]){case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let y=new z;a=oe.textCompaction(o,a+1,y),c.setFileName(y.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let w=new z;a=oe.textCompaction(o,a+1,w),c.setSender(w.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let v=new z;a=oe.textCompaction(o,a+1,v),c.setAddressee(v.toString());break;case oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let T=new z;a=oe.numericCompaction(o,a+1,T),c.setSegmentCount(P.parseInt(T.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let R=new z;a=oe.numericCompaction(o,a+1,R),c.setTimestamp(Zu.parseLong(R.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let O=new z;a=oe.numericCompaction(o,a+1,O),c.setChecksum(P.parseInt(O.toString()));break;case oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let q=new z;a=oe.numericCompaction(o,a+1,q),c.setFileSize(Zu.parseLong(q.toString()));break;default:throw k.getFormatInstance()}break;case oe.MACRO_PDF417_TERMINATOR:a++,c.setLastSegment(!0);break;default:throw k.getFormatInstance()}if(g!==-1){let y=a-g;c.isLastSegment()&&y--,c.setOptionalData(b.copyOfRange(o,g,g+y))}return a}static textCompaction(o,a,c){let u=new Int32Array((o[0]-a)*2),d=new Int32Array((o[0]-a)*2),g=0,y=!1;for(;a<o[0]&&!y;){let w=o[a++];if(w<oe.TEXT_COMPACTION_MODE_LATCH)u[g]=w/30,u[g+1]=w%30,g+=2;else switch(w){case oe.TEXT_COMPACTION_MODE_LATCH:u[g++]=oe.TEXT_COMPACTION_MODE_LATCH;break;case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:a--,y=!0;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u[g]=oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,w=o[a++],d[g]=w,g++;break}}return oe.decodeTextCompaction(u,d,g,c),a}static decodeTextCompaction(o,a,c,u){let d=St.ALPHA,g=St.ALPHA,y=0;for(;y<c;){let w=o[y],v="";switch(d){case St.ALPHA:if(w<26)v=String.fromCharCode(65+w);else switch(w){case 26:v=" ";break;case oe.LL:d=St.LOWER;break;case oe.ML:d=St.MIXED;break;case oe.PS:g=d,d=St.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.LOWER:if(w<26)v=String.fromCharCode(97+w);else switch(w){case 26:v=" ";break;case oe.AS:g=d,d=St.ALPHA_SHIFT;break;case oe.ML:d=St.MIXED;break;case oe.PS:g=d,d=St.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.MIXED:if(w<oe.PL)v=oe.MIXED_CHARS[w];else switch(w){case oe.PL:d=St.PUNCT;break;case 26:v=" ";break;case oe.LL:d=St.LOWER;break;case oe.AL:d=St.ALPHA;break;case oe.PS:g=d,d=St.PUNCT_SHIFT;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.PUNCT:if(w<oe.PAL)v=oe.PUNCT_CHARS[w];else switch(w){case oe.PAL:d=St.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.ALPHA_SHIFT:if(d=g,w<26)v=String.fromCharCode(65+w);else switch(w){case 26:v=" ";break;case oe.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.PUNCT_SHIFT:if(d=g,w<oe.PAL)v=oe.PUNCT_CHARS[w];else switch(w){case oe.PAL:d=St.ALPHA;break;case oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case oe.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break}v!==""&&u.append(v),y++}}static byteCompaction(o,a,c,u,d){let g=new Li,y=0,w=0,v=!1;switch(o){case oe.BYTE_COMPACTION_MODE_LATCH:let T=new Int32Array(6),R=a[u++];for(;u<a[0]&&!v;)switch(T[y++]=R,w=900*w+R,R=a[u++],R){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:u--,v=!0;break;default:if(y%5===0&&y>0){for(let O=0;O<6;++O)g.write(Number(Fi(w)>>Fi(8*(5-O))));w=0,y=0}break}u===a[0]&&R<oe.TEXT_COMPACTION_MODE_LATCH&&(T[y++]=R);for(let O=0;O<y;O++)g.write(T[O]);break;case oe.BYTE_COMPACTION_MODE_LATCH_6:for(;u<a[0]&&!v;){let O=a[u++];if(O<oe.TEXT_COMPACTION_MODE_LATCH)y++,w=900*w+O;else switch(O){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.NUMERIC_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:u--,v=!0;break}if(y%5===0&&y>0){for(let q=0;q<6;++q)g.write(Number(Fi(w)>>Fi(8*(5-q))));w=0,y=0}}break}return d.append(K.decode(g.toByteArray(),c)),u}static numericCompaction(o,a,c){let u=0,d=!1,g=new Int32Array(oe.MAX_NUMERIC_CODEWORDS);for(;a<o[0]&&!d;){let y=o[a++];if(a===o[0]&&(d=!0),y<oe.TEXT_COMPACTION_MODE_LATCH)g[u]=y,u++;else switch(y){case oe.TEXT_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH:case oe.BYTE_COMPACTION_MODE_LATCH_6:case oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case oe.MACRO_PDF417_TERMINATOR:a--,d=!0;break}(u%oe.MAX_NUMERIC_CODEWORDS===0||y===oe.NUMERIC_COMPACTION_MODE_LATCH||d)&&u>0&&(c.append(oe.decodeBase900toBase10(g,u)),u=0)}return a}static decodeBase900toBase10(o,a){let c=Fi(0);for(let d=0;d<a;d++)c+=oe.EXP900[a-d-1]*Fi(o[d]);let u=c.toString();if(u.charAt(0)!=="1")throw new k;return u.substring(1)}}oe.TEXT_COMPACTION_MODE_LATCH=900,oe.BYTE_COMPACTION_MODE_LATCH=901,oe.NUMERIC_COMPACTION_MODE_LATCH=902,oe.BYTE_COMPACTION_MODE_LATCH_6=924,oe.ECI_USER_DEFINED=925,oe.ECI_GENERAL_PURPOSE=926,oe.ECI_CHARSET=927,oe.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,oe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,oe.MACRO_PDF417_TERMINATOR=922,oe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,oe.MAX_NUMERIC_CODEWORDS=15,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,oe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,oe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,oe.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,oe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,oe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,oe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,oe.PL=25,oe.LL=27,oe.AS=27,oe.ML=28,oe.AL=28,oe.PS=29,oe.PAL=29,oe.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,oe.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",oe.EXP900=wf()?eh():[],oe.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Je{constructor(){}static decode(o,a,c,u,d,g,y){let w=new wi(o,a,c,u,d),v=null,T=null,R;for(let Y=!0;;Y=!1){if(a!=null&&(v=Je.getRowIndicatorColumn(o,w,a,!0,g,y)),u!=null&&(T=Je.getRowIndicatorColumn(o,w,u,!1,g,y)),R=Je.merge(v,T),R==null)throw se.getNotFoundInstance();let Z=R.getBoundingBox();if(Y&&Z!=null&&(Z.getMinY()<w.getMinY()||Z.getMaxY()>w.getMaxY()))w=Z;else break}R.setBoundingBox(w);let O=R.getBarcodeColumnCount()+1;R.setDetectionResultColumn(0,v),R.setDetectionResultColumn(O,T);let q=v!=null;for(let Y=1;Y<=O;Y++){let Z=q?Y:O-Y;if(R.getDetectionResultColumn(Z)!==void 0)continue;let ie;Z===0||Z===O?ie=new Zl(w,Z===0):ie=new Mi(w),R.setDetectionResultColumn(Z,ie);let ce=-1,we=ce;for(let _e=w.getMinY();_e<=w.getMaxY();_e++){if(ce=Je.getStartColumn(R,Z,_e,q),ce<0||ce>w.getMaxX()){if(we===-1)continue;ce=we}let me=Je.detectCodeword(o,w.getMinX(),w.getMaxX(),q,ce,_e,g,y);me!=null&&(ie.setCodeword(_e,me),we=ce,g=Math.min(g,me.getWidth()),y=Math.max(y,me.getWidth()))}}return Je.createDecoderResult(R)}static merge(o,a){if(o==null&&a==null)return null;let c=Je.getBarcodeMetadata(o,a);if(c==null)return null;let u=wi.merge(Je.adjustBoundingBox(o),Je.adjustBoundingBox(a));return new Lt(c,u)}static adjustBoundingBox(o){if(o==null)return null;let a=o.getRowHeights();if(a==null)return null;let c=Je.getMax(a),u=0;for(let y of a)if(u+=c-y,y>0)break;let d=o.getCodewords();for(let y=0;u>0&&d[y]==null;y++)u--;let g=0;for(let y=a.length-1;y>=0&&(g+=c-a[y],!(a[y]>0));y--);for(let y=d.length-1;g>0&&d[y]==null;y--)g--;return o.getBoundingBox().addMissingRows(u,g,o.isLeft())}static getMax(o){let a=-1;for(let c of o)a=Math.max(a,c);return a}static getBarcodeMetadata(o,a){let c;if(o==null||(c=o.getBarcodeMetadata())==null)return a==null?null:a.getBarcodeMetadata();let u;return a==null||(u=a.getBarcodeMetadata())==null?c:c.getColumnCount()!==u.getColumnCount()&&c.getErrorCorrectionLevel()!==u.getErrorCorrectionLevel()&&c.getRowCount()!==u.getRowCount()?null:c}static getRowIndicatorColumn(o,a,c,u,d,g){let y=new Zl(a,u);for(let w=0;w<2;w++){let v=w===0?1:-1,T=Math.trunc(Math.trunc(c.getX()));for(let R=Math.trunc(Math.trunc(c.getY()));R<=a.getMaxY()&&R>=a.getMinY();R+=v){let O=Je.detectCodeword(o,0,o.getWidth(),u,T,R,d,g);O!=null&&(y.setCodeword(R,O),u?T=O.getStartX():T=O.getEndX())}}return y}static adjustCodewordCount(o,a){let c=a[0][1],u=c.getValue(),d=o.getBarcodeColumnCount()*o.getBarcodeRowCount()-Je.getNumberOfECCodeWords(o.getBarcodeECLevel());if(u.length===0){if(d<1||d>He.MAX_CODEWORDS_IN_BARCODE)throw se.getNotFoundInstance();c.setValue(d)}else u[0]!==d&&c.setValue(d)}static createDecoderResult(o){let a=Je.createBarcodeMatrix(o);Je.adjustCodewordCount(o,a);let c=new Array,u=new Int32Array(o.getBarcodeRowCount()*o.getBarcodeColumnCount()),d=[],g=new Array;for(let w=0;w<o.getBarcodeRowCount();w++)for(let v=0;v<o.getBarcodeColumnCount();v++){let T=a[w][v+1].getValue(),R=w*o.getBarcodeColumnCount()+v;T.length===0?c.push(R):T.length===1?u[R]=T[0]:(g.push(R),d.push(T))}let y=new Array(d.length);for(let w=0;w<y.length;w++)y[w]=d[w];return Je.createDecoderResultFromAmbiguousValues(o.getBarcodeECLevel(),u,He.toIntArray(c),He.toIntArray(g),y)}static createDecoderResultFromAmbiguousValues(o,a,c,u,d){let g=new Int32Array(u.length),y=100;for(;y-- >0;){for(let w=0;w<g.length;w++)a[u[w]]=d[w][g[w]];try{return Je.decodeCodewords(a,o,c)}catch(w){if(!(w instanceof N))throw w}if(g.length===0)throw N.getChecksumInstance();for(let w=0;w<g.length;w++)if(g[w]<d[w].length-1){g[w]++;break}else if(g[w]=0,w===g.length-1)throw N.getChecksumInstance()}throw N.getChecksumInstance()}static createBarcodeMatrix(o){let a=Array.from({length:o.getBarcodeRowCount()},()=>new Array(o.getBarcodeColumnCount()+2));for(let u=0;u<a.length;u++)for(let d=0;d<a[u].length;d++)a[u][d]=new bo;let c=0;for(let u of o.getDetectionResultColumns()){if(u!=null){for(let d of u.getCodewords())if(d!=null){let g=d.getRowNumber();if(g>=0){if(g>=a.length)continue;a[g][c].setValue(d.getValue())}}}c++}return a}static isValidBarcodeColumn(o,a){return a>=0&&a<=o.getBarcodeColumnCount()+1}static getStartColumn(o,a,c,u){let d=u?1:-1,g=null;if(Je.isValidBarcodeColumn(o,a-d)&&(g=o.getDetectionResultColumn(a-d).getCodeword(c)),g!=null)return u?g.getEndX():g.getStartX();if(g=o.getDetectionResultColumn(a).getCodewordNearby(c),g!=null)return u?g.getStartX():g.getEndX();if(Je.isValidBarcodeColumn(o,a-d)&&(g=o.getDetectionResultColumn(a-d).getCodewordNearby(c)),g!=null)return u?g.getEndX():g.getStartX();let y=0;for(;Je.isValidBarcodeColumn(o,a-d);){a-=d;for(let w of o.getDetectionResultColumn(a).getCodewords())if(w!=null)return(u?w.getEndX():w.getStartX())+d*y*(w.getEndX()-w.getStartX());y++}return u?o.getBoundingBox().getMinX():o.getBoundingBox().getMaxX()}static detectCodeword(o,a,c,u,d,g,y,w){d=Je.adjustCodewordStartColumn(o,a,c,u,d,g);let v=Je.getModuleBitCount(o,a,c,u,d,g);if(v==null)return null;let T,R=it.sum(v);if(u)T=d+R;else{for(let Y=0;Y<v.length/2;Y++){let Z=v[Y];v[Y]=v[v.length-1-Y],v[v.length-1-Y]=Z}T=d,d=T-R}if(!Je.checkCodewordSkew(R,y,w))return null;let O=yr.getDecodedValue(v),q=He.getCodeword(O);return q===-1?null:new Ha(d,T,Je.getCodewordBucketNumber(O),q)}static getModuleBitCount(o,a,c,u,d,g){let y=d,w=new Int32Array(8),v=0,T=u?1:-1,R=u;for(;(u?y<c:y>=a)&&v<w.length;)o.get(y,g)===R?(w[v]++,y+=T):(v++,R=!R);return v===w.length||y===(u?c:a)&&v===w.length-1?w:null}static getNumberOfECCodeWords(o){return 2<<o}static adjustCodewordStartColumn(o,a,c,u,d,g){let y=d,w=u?-1:1;for(let v=0;v<2;v++){for(;(u?y>=a:y<c)&&u===o.get(y,g);){if(Math.abs(d-y)>Je.CODEWORD_SKEW_SIZE)return d;y+=w}w=-w,u=!u}return y}static checkCodewordSkew(o,a,c){return a-Je.CODEWORD_SKEW_SIZE<=o&&o<=c+Je.CODEWORD_SKEW_SIZE}static decodeCodewords(o,a,c){if(o.length===0)throw k.getFormatInstance();let u=1<<a+1,d=Je.correctErrors(o,c,u);Je.verifyCodewordCount(o,u);let g=oe.decode(o,""+a);return g.setErrorsCorrected(d),g.setErasures(c.length),g}static correctErrors(o,a,c){if(a!=null&&a.length>c/2+Je.MAX_ERRORS||c<0||c>Je.MAX_EC_CODEWORDS)throw N.getChecksumInstance();return Je.errorCorrection.decode(o,c,a)}static verifyCodewordCount(o,a){if(o.length<4)throw k.getFormatInstance();let c=o[0];if(c>o.length)throw k.getFormatInstance();if(c===0)if(a<o.length)o[0]=o.length-a;else throw k.getFormatInstance()}static getBitCountForCodeword(o){let a=new Int32Array(8),c=0,u=a.length-1;for(;!((o&1)!==c&&(c=o&1,u--,u<0));)a[u]++,o>>=1;return a}static getCodewordBucketNumber(o){return o instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(o):this.getCodewordBucketNumber_number(o)}static getCodewordBucketNumber_number(o){return Je.getCodewordBucketNumber(Je.getBitCountForCodeword(o))}static getCodewordBucketNumber_Int32Array(o){return(o[0]-o[2]+o[4]-o[6]+9)%9}static toString(o){let a=new Oi;for(let c=0;c<o.length;c++){a.format("Row %2d: ",c);for(let u=0;u<o[c].length;u++){let d=o[c][u];d.getValue().length===0?a.format("        ",null):a.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}a.format("%n")}return a.toString()}}Je.CODEWORD_SKEW_SIZE=2,Je.MAX_ERRORS=3,Je.MAX_EC_CODEWORDS=512,Je.errorCorrection=new qa;class wn{decode(o,a=null){let c=wn.decode(o,a,!1);if(c==null||c.length===0||c[0]==null)throw se.getNotFoundInstance();return c[0]}decodeMultiple(o,a=null){try{return wn.decode(o,a,!0)}catch(c){throw c instanceof k||c instanceof N?se.getNotFoundInstance():c}}static decode(o,a,c){const u=new Array,d=Ze.detectMultiple(o,a,c);for(const g of d.getPoints()){const y=Je.decode(d.getBits(),g[4],g[5],g[6],g[7],wn.getMinCodewordWidth(g),wn.getMaxCodewordWidth(g)),w=new Bt(y.getText(),y.getRawBytes(),void 0,g,ke.PDF_417);w.putMetadata(ln.ERROR_CORRECTION_LEVEL,y.getECLevel());const v=y.getOther();v!=null&&w.putMetadata(ln.PDF417_EXTRA_METADATA,v),u.push(w)}return u.map(g=>g)}static getMaxWidth(o,a){return o==null||a==null?0:Math.trunc(Math.abs(o.getX()-a.getX()))}static getMinWidth(o,a){return o==null||a==null?P.MAX_VALUE:Math.trunc(Math.abs(o.getX()-a.getX()))}static getMaxCodewordWidth(o){return Math.floor(Math.max(Math.max(wn.getMaxWidth(o[0],o[4]),wn.getMaxWidth(o[6],o[2])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN),Math.max(wn.getMaxWidth(o[1],o[5]),wn.getMaxWidth(o[7],o[3])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(o){return Math.floor(Math.min(Math.min(wn.getMinWidth(o[0],o[4]),wn.getMinWidth(o[6],o[2])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN),Math.min(wn.getMinWidth(o[1],o[5]),wn.getMinWidth(o[7],o[3])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN)))}reset(){}}class ec extends m{}ec.kind="ReaderException";class th{constructor(o,a){this.verbose=o===!0,a&&this.setHints(a)}decode(o,a){return a&&this.setHints(a),this.decodeInternal(o)}decodeWithState(o){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(o)}setHints(o){this.hints=o;const a=!r(o)&&o.get(J.TRY_HARDER)===!0,c=r(o)?null:o.get(J.POSSIBLE_FORMATS),u=new Array;if(!r(c)){const d=c.some(g=>g===ke.UPC_A||g===ke.UPC_E||g===ke.EAN_13||g===ke.EAN_8||g===ke.CODABAR||g===ke.CODE_39||g===ke.CODE_93||g===ke.CODE_128||g===ke.ITF||g===ke.RSS_14||g===ke.RSS_EXPANDED);d&&!a&&u.push(new Gr(o,this.verbose)),c.includes(ke.QR_CODE)&&u.push(new Nr),c.includes(ke.DATA_MATRIX)&&u.push(new ki),c.includes(ke.AZTEC)&&u.push(new pr),c.includes(ke.PDF_417)&&u.push(new wn),d&&a&&u.push(new Gr(o,this.verbose))}u.length===0&&(a||u.push(new Gr(o,this.verbose)),u.push(new Nr),u.push(new ki),u.push(new pr),u.push(new wn),a&&u.push(new Gr(o,this.verbose))),this.readers=u}reset(){if(this.readers!==null)for(const o of this.readers)o.reset()}decodeInternal(o){if(this.readers===null)throw new ec("No readers where selected, nothing can be read.");for(const a of this.readers)try{return a.decode(o,this.hints)}catch(c){if(c instanceof ec)continue}throw new se("No MultiFormat Readers were able to detect the code.")}}class Wa extends Tt{constructor(o=null,a=500){const c=new th;c.setHints(o),super(c,a)}decodeBitmap(o){return this.reader.decodeWithState(o)}}class _f extends Tt{constructor(o=500){super(new wn,o)}}class Ef extends Tt{constructor(o=500){super(new Nr,o)}}var Ka;(function(S){S[S.ERROR_CORRECTION=0]="ERROR_CORRECTION",S[S.CHARACTER_SET=1]="CHARACTER_SET",S[S.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",S[S.MIN_SIZE=3]="MIN_SIZE",S[S.MAX_SIZE=4]="MAX_SIZE",S[S.MARGIN=5]="MARGIN",S[S.PDF417_COMPACT=6]="PDF417_COMPACT",S[S.PDF417_COMPACTION=7]="PDF417_COMPACTION",S[S.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",S[S.AZTEC_LAYERS=9]="AZTEC_LAYERS",S[S.QR_VERSION=10]="QR_VERSION"})(Ka||(Ka={}));var un=Ka;class tc{constructor(o){this.field=o,this.cachedGenerators=[],this.cachedGenerators.push(new Tn(o,Int32Array.from([1])))}buildGenerator(o){const a=this.cachedGenerators;if(o>=a.length){let c=a[a.length-1];const u=this.field;for(let d=a.length;d<=o;d++){const g=c.multiply(new Tn(u,Int32Array.from([1,u.exp(d-1+u.getGeneratorBase())])));a.push(g),c=g}}return a[o]}encode(o,a){if(a===0)throw new E("No error correction bytes");const c=o.length-a;if(c<=0)throw new E("No data bytes provided");const u=this.buildGenerator(a),d=new Int32Array(c);D.arraycopy(o,0,d,0,c);let g=new Tn(this.field,d);g=g.multiplyByMonomial(a,1);const w=g.divide(u)[1].getCoefficients(),v=a-w.length;for(let T=0;T<v;T++)o[c+T]=0;D.arraycopy(w,0,o,c+v,w.length)}}class jt{constructor(){}static applyMaskPenaltyRule1(o){return jt.applyMaskPenaltyRule1Internal(o,!0)+jt.applyMaskPenaltyRule1Internal(o,!1)}static applyMaskPenaltyRule2(o){let a=0;const c=o.getArray(),u=o.getWidth(),d=o.getHeight();for(let g=0;g<d-1;g++){const y=c[g];for(let w=0;w<u-1;w++){const v=y[w];v===y[w+1]&&v===c[g+1][w]&&v===c[g+1][w+1]&&a++}}return jt.N2*a}static applyMaskPenaltyRule3(o){let a=0;const c=o.getArray(),u=o.getWidth(),d=o.getHeight();for(let g=0;g<d;g++)for(let y=0;y<u;y++){const w=c[g];y+6<u&&w[y]===1&&w[y+1]===0&&w[y+2]===1&&w[y+3]===1&&w[y+4]===1&&w[y+5]===0&&w[y+6]===1&&(jt.isWhiteHorizontal(w,y-4,y)||jt.isWhiteHorizontal(w,y+7,y+11))&&a++,g+6<d&&c[g][y]===1&&c[g+1][y]===0&&c[g+2][y]===1&&c[g+3][y]===1&&c[g+4][y]===1&&c[g+5][y]===0&&c[g+6][y]===1&&(jt.isWhiteVertical(c,y,g-4,g)||jt.isWhiteVertical(c,y,g+7,g+11))&&a++}return a*jt.N3}static isWhiteHorizontal(o,a,c){a=Math.max(a,0),c=Math.min(c,o.length);for(let u=a;u<c;u++)if(o[u]===1)return!1;return!0}static isWhiteVertical(o,a,c,u){c=Math.max(c,0),u=Math.min(u,o.length);for(let d=c;d<u;d++)if(o[d][a]===1)return!1;return!0}static applyMaskPenaltyRule4(o){let a=0;const c=o.getArray(),u=o.getWidth(),d=o.getHeight();for(let w=0;w<d;w++){const v=c[w];for(let T=0;T<u;T++)v[T]===1&&a++}const g=o.getHeight()*o.getWidth();return Math.floor(Math.abs(a*2-g)*10/g)*jt.N4}static getDataMaskBit(o,a,c){let u,d;switch(o){case 0:u=c+a&1;break;case 1:u=c&1;break;case 2:u=a%3;break;case 3:u=(c+a)%3;break;case 4:u=Math.floor(c/2)+Math.floor(a/3)&1;break;case 5:d=c*a,u=(d&1)+d%3;break;case 6:d=c*a,u=(d&1)+d%3&1;break;case 7:d=c*a,u=d%3+(c+a&1)&1;break;default:throw new E("Invalid mask pattern: "+o)}return u===0}static applyMaskPenaltyRule1Internal(o,a){let c=0;const u=a?o.getHeight():o.getWidth(),d=a?o.getWidth():o.getHeight(),g=o.getArray();for(let y=0;y<u;y++){let w=0,v=-1;for(let T=0;T<d;T++){const R=a?g[y][T]:g[T][y];R===v?w++:(w>=5&&(c+=jt.N1+(w-5)),w=1,v=R)}w>=5&&(c+=jt.N1+(w-5))}return c}}jt.N1=3,jt.N2=3,jt.N3=40,jt.N4=10;class $a{constructor(o,a){this.width=o,this.height=a;const c=new Array(a);for(let u=0;u!==a;u++)c[u]=new Uint8Array(o);this.bytes=c}getHeight(){return this.height}getWidth(){return this.width}get(o,a){return this.bytes[a][o]}getArray(){return this.bytes}setNumber(o,a,c){this.bytes[a][o]=c}setBoolean(o,a,c){this.bytes[a][o]=c?1:0}clear(o){for(const a of this.bytes)b.fill(a,o)}equals(o){if(!(o instanceof $a))return!1;const a=o;if(this.width!==a.width||this.height!==a.height)return!1;for(let c=0,u=this.height;c<u;++c){const d=this.bytes[c],g=a.bytes[c];for(let y=0,w=this.width;y<w;++y)if(d[y]!==g[y])return!1}return!0}toString(){const o=new z;for(let a=0,c=this.height;a<c;++a){const u=this.bytes[a];for(let d=0,g=this.width;d<g;++d)switch(u[d]){case 0:o.append(" 0");break;case 1:o.append(" 1");break;default:o.append("  ");break}o.append(`
`)}return o.toString()}}class cs{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const o=new z;return o.append(`<<
`),o.append(" mode: "),o.append(this.mode?this.mode.toString():"null"),o.append(`
 ecLevel: `),o.append(this.ecLevel?this.ecLevel.toString():"null"),o.append(`
 version: `),o.append(this.version?this.version.toString():"null"),o.append(`
 maskPattern: `),o.append(this.maskPattern.toString()),this.matrix?(o.append(`
 matrix:
`),o.append(this.matrix.toString())):o.append(`
 matrix: null
`),o.append(`>>
`),o.toString()}setMode(o){this.mode=o}setECLevel(o){this.ecLevel=o}setVersion(o){this.version=o}setMaskPattern(o){this.maskPattern=o}setMatrix(o){this.matrix=o}static isValidMaskPattern(o){return o>=0&&o<cs.NUM_MASK_PATTERNS}}cs.NUM_MASK_PATTERNS=8;class ft extends m{}ft.kind="WriterException";class ze{constructor(){}static clearMatrix(o){o.clear(255)}static buildMatrix(o,a,c,u,d){ze.clearMatrix(d),ze.embedBasicPatterns(c,d),ze.embedTypeInfo(a,u,d),ze.maybeEmbedVersionInfo(c,d),ze.embedDataBits(o,u,d)}static embedBasicPatterns(o,a){ze.embedPositionDetectionPatternsAndSeparators(a),ze.embedDarkDotAtLeftBottomCorner(a),ze.maybeEmbedPositionAdjustmentPatterns(o,a),ze.embedTimingPatterns(a)}static embedTypeInfo(o,a,c){const u=new V;ze.makeTypeInfoBits(o,a,u);for(let d=0,g=u.getSize();d<g;++d){const y=u.get(u.getSize()-1-d),w=ze.TYPE_INFO_COORDINATES[d],v=w[0],T=w[1];if(c.setBoolean(v,T,y),d<8){const R=c.getWidth()-d-1,O=8;c.setBoolean(R,O,y)}else{const O=c.getHeight()-7+(d-8);c.setBoolean(8,O,y)}}}static maybeEmbedVersionInfo(o,a){if(o.getVersionNumber()<7)return;const c=new V;ze.makeVersionInfoBits(o,c);let u=6*3-1;for(let d=0;d<6;++d)for(let g=0;g<3;++g){const y=c.get(u);u--,a.setBoolean(d,a.getHeight()-11+g,y),a.setBoolean(a.getHeight()-11+g,d,y)}}static embedDataBits(o,a,c){let u=0,d=-1,g=c.getWidth()-1,y=c.getHeight()-1;for(;g>0;){for(g===6&&(g-=1);y>=0&&y<c.getHeight();){for(let w=0;w<2;++w){const v=g-w;if(!ze.isEmpty(c.get(v,y)))continue;let T;u<o.getSize()?(T=o.get(u),++u):T=!1,a!==255&&jt.getDataMaskBit(a,v,y)&&(T=!T),c.setBoolean(v,y,T)}y+=d}d=-d,y+=d,g-=2}if(u!==o.getSize())throw new ft("Not all bits consumed: "+u+"/"+o.getSize())}static findMSBSet(o){return 32-P.numberOfLeadingZeros(o)}static calculateBCHCode(o,a){if(a===0)throw new E("0 polynomial");const c=ze.findMSBSet(a);for(o<<=c-1;ze.findMSBSet(o)>=c;)o^=a<<ze.findMSBSet(o)-c;return o}static makeTypeInfoBits(o,a,c){if(!cs.isValidMaskPattern(a))throw new ft("Invalid mask pattern");const u=o.getBits()<<3|a;c.appendBits(u,5);const d=ze.calculateBCHCode(u,ze.TYPE_INFO_POLY);c.appendBits(d,10);const g=new V;if(g.appendBits(ze.TYPE_INFO_MASK_PATTERN,15),c.xor(g),c.getSize()!==15)throw new ft("should not happen but we got: "+c.getSize())}static makeVersionInfoBits(o,a){a.appendBits(o.getVersionNumber(),6);const c=ze.calculateBCHCode(o.getVersionNumber(),ze.VERSION_INFO_POLY);if(a.appendBits(c,12),a.getSize()!==18)throw new ft("should not happen but we got: "+a.getSize())}static isEmpty(o){return o===255}static embedTimingPatterns(o){for(let a=8;a<o.getWidth()-8;++a){const c=(a+1)%2;ze.isEmpty(o.get(a,6))&&o.setNumber(a,6,c),ze.isEmpty(o.get(6,a))&&o.setNumber(6,a,c)}}static embedDarkDotAtLeftBottomCorner(o){if(o.get(8,o.getHeight()-8)===0)throw new ft;o.setNumber(8,o.getHeight()-8,1)}static embedHorizontalSeparationPattern(o,a,c){for(let u=0;u<8;++u){if(!ze.isEmpty(c.get(o+u,a)))throw new ft;c.setNumber(o+u,a,0)}}static embedVerticalSeparationPattern(o,a,c){for(let u=0;u<7;++u){if(!ze.isEmpty(c.get(o,a+u)))throw new ft;c.setNumber(o,a+u,0)}}static embedPositionAdjustmentPattern(o,a,c){for(let u=0;u<5;++u){const d=ze.POSITION_ADJUSTMENT_PATTERN[u];for(let g=0;g<5;++g)c.setNumber(o+g,a+u,d[g])}}static embedPositionDetectionPattern(o,a,c){for(let u=0;u<7;++u){const d=ze.POSITION_DETECTION_PATTERN[u];for(let g=0;g<7;++g)c.setNumber(o+g,a+u,d[g])}}static embedPositionDetectionPatternsAndSeparators(o){const a=ze.POSITION_DETECTION_PATTERN[0].length;ze.embedPositionDetectionPattern(0,0,o),ze.embedPositionDetectionPattern(o.getWidth()-a,0,o),ze.embedPositionDetectionPattern(0,o.getWidth()-a,o);const c=8;ze.embedHorizontalSeparationPattern(0,c-1,o),ze.embedHorizontalSeparationPattern(o.getWidth()-c,c-1,o),ze.embedHorizontalSeparationPattern(0,o.getWidth()-c,o);const u=7;ze.embedVerticalSeparationPattern(u,0,o),ze.embedVerticalSeparationPattern(o.getHeight()-u-1,0,o),ze.embedVerticalSeparationPattern(u,o.getHeight()-u,o)}static maybeEmbedPositionAdjustmentPatterns(o,a){if(o.getVersionNumber()<2)return;const c=o.getVersionNumber()-1,u=ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[c];for(let d=0,g=u.length;d!==g;d++){const y=u[d];if(y>=0)for(let w=0;w!==g;w++){const v=u[w];v>=0&&ze.isEmpty(a.get(v,y))&&ze.embedPositionAdjustmentPattern(v-2,y-2,a)}}}}ze.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),ze.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),ze.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),ze.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),ze.VERSION_INFO_POLY=7973,ze.TYPE_INFO_POLY=1335,ze.TYPE_INFO_MASK_PATTERN=21522;class vf{constructor(o,a){this.dataBytes=o,this.errorCorrectionBytes=a}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Ft{constructor(){}static calculateMaskPenalty(o){return jt.applyMaskPenaltyRule1(o)+jt.applyMaskPenaltyRule2(o)+jt.applyMaskPenaltyRule3(o)+jt.applyMaskPenaltyRule4(o)}static encode(o,a,c=null){let u=Ft.DEFAULT_BYTE_MODE_ENCODING;const d=c!==null&&c.get(un.CHARACTER_SET)!==void 0;d&&(u=c.get(un.CHARACTER_SET).toString());const g=this.chooseMode(o,u),y=new V;if(g===Ue.BYTE&&(d||Ft.DEFAULT_BYTE_MODE_ENCODING!==u)){const _e=F.getCharacterSetECIByName(u);_e!==void 0&&this.appendECI(_e,y)}this.appendModeInfo(g,y);const w=new V;this.appendBytes(o,g,w,u);let v;if(c!==null&&c.get(un.QR_VERSION)!==void 0){const _e=Number.parseInt(c.get(un.QR_VERSION).toString(),10);v=Ve.getVersionForNumber(_e);const me=this.calculateBitsNeeded(g,y,w,v);if(!this.willFit(me,v,a))throw new ft("Data too big for requested version")}else v=this.recommendVersion(a,g,y,w);const T=new V;T.appendBitArray(y);const R=g===Ue.BYTE?w.getSizeInBytes():o.length;this.appendLengthInfo(R,v,g,T),T.appendBitArray(w);const O=v.getECBlocksForLevel(a),q=v.getTotalCodewords()-O.getTotalECCodewords();this.terminateBits(q,T);const Y=this.interleaveWithECBytes(T,v.getTotalCodewords(),q,O.getNumBlocks()),Z=new cs;Z.setECLevel(a),Z.setMode(g),Z.setVersion(v);const ie=v.getDimensionForVersion(),ce=new $a(ie,ie),we=this.chooseMaskPattern(Y,a,v,ce);return Z.setMaskPattern(we),ze.buildMatrix(Y,a,v,we,ce),Z.setMatrix(ce),Z}static recommendVersion(o,a,c,u){const d=this.calculateBitsNeeded(a,c,u,Ve.getVersionForNumber(1)),g=this.chooseVersion(d,o),y=this.calculateBitsNeeded(a,c,u,g);return this.chooseVersion(y,o)}static calculateBitsNeeded(o,a,c,u){return a.getSize()+o.getCharacterCountBits(u)+c.getSize()}static getAlphanumericCode(o){return o<Ft.ALPHANUMERIC_TABLE.length?Ft.ALPHANUMERIC_TABLE[o]:-1}static chooseMode(o,a=null){if(F.SJIS.getName()===a&&this.isOnlyDoubleByteKanji(o))return Ue.KANJI;let c=!1,u=!1;for(let d=0,g=o.length;d<g;++d){const y=o.charAt(d);if(Ft.isDigit(y))c=!0;else if(this.getAlphanumericCode(y.charCodeAt(0))!==-1)u=!0;else return Ue.BYTE}return u?Ue.ALPHANUMERIC:c?Ue.NUMERIC:Ue.BYTE}static isOnlyDoubleByteKanji(o){let a;try{a=K.encode(o,F.SJIS)}catch{return!1}const c=a.length;if(c%2!==0)return!1;for(let u=0;u<c;u+=2){const d=a[u]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(o,a,c,u){let d=Number.MAX_SAFE_INTEGER,g=-1;for(let y=0;y<cs.NUM_MASK_PATTERNS;y++){ze.buildMatrix(o,a,c,y,u);let w=this.calculateMaskPenalty(u);w<d&&(d=w,g=y)}return g}static chooseVersion(o,a){for(let c=1;c<=40;c++){const u=Ve.getVersionForNumber(c);if(Ft.willFit(o,u,a))return u}throw new ft("Data too big")}static willFit(o,a,c){const u=a.getTotalCodewords(),g=a.getECBlocksForLevel(c).getTotalECCodewords(),y=u-g,w=(o+7)/8;return y>=w}static terminateBits(o,a){const c=o*8;if(a.getSize()>c)throw new ft("data bits cannot fit in the QR Code"+a.getSize()+" > "+c);for(let g=0;g<4&&a.getSize()<c;++g)a.appendBit(!1);const u=a.getSize()&7;if(u>0)for(let g=u;g<8;g++)a.appendBit(!1);const d=o-a.getSizeInBytes();for(let g=0;g<d;++g)a.appendBits(g&1?17:236,8);if(a.getSize()!==c)throw new ft("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(o,a,c,u,d,g){if(u>=c)throw new ft("Block ID too large");const y=o%c,w=c-y,v=Math.floor(o/c),T=v+1,R=Math.floor(a/c),O=R+1,q=v-R,Y=T-O;if(q!==Y)throw new ft("EC bytes mismatch");if(c!==w+y)throw new ft("RS blocks mismatch");if(o!==(R+q)*w+(O+Y)*y)throw new ft("Total bytes mismatch");u<w?(d[0]=R,g[0]=q):(d[0]=O,g[0]=Y)}static interleaveWithECBytes(o,a,c,u){if(o.getSizeInBytes()!==c)throw new ft("Number of bits and data bytes does not match");let d=0,g=0,y=0;const w=new Array;for(let T=0;T<u;++T){const R=new Int32Array(1),O=new Int32Array(1);Ft.getNumDataBytesAndNumECBytesForBlockID(a,c,u,T,R,O);const q=R[0],Y=new Uint8Array(q);o.toBytes(8*d,Y,0,q);const Z=Ft.generateECBytes(Y,O[0]);w.push(new vf(Y,Z)),g=Math.max(g,q),y=Math.max(y,Z.length),d+=R[0]}if(c!==d)throw new ft("Data bytes does not match offset");const v=new V;for(let T=0;T<g;++T)for(const R of w){const O=R.getDataBytes();T<O.length&&v.appendBits(O[T],8)}for(let T=0;T<y;++T)for(const R of w){const O=R.getErrorCorrectionBytes();T<O.length&&v.appendBits(O[T],8)}if(a!==v.getSizeInBytes())throw new ft("Interleaving error: "+a+" and "+v.getSizeInBytes()+" differ.");return v}static generateECBytes(o,a){const c=o.length,u=new Int32Array(c+a);for(let g=0;g<c;g++)u[g]=o[g]&255;new tc(ot.QR_CODE_FIELD_256).encode(u,a);const d=new Uint8Array(a);for(let g=0;g<a;g++)d[g]=u[c+g];return d}static appendModeInfo(o,a){a.appendBits(o.getBits(),4)}static appendLengthInfo(o,a,c,u){const d=c.getCharacterCountBits(a);if(o>=1<<d)throw new ft(o+" is bigger than "+((1<<d)-1));u.appendBits(o,d)}static appendBytes(o,a,c,u){switch(a){case Ue.NUMERIC:Ft.appendNumericBytes(o,c);break;case Ue.ALPHANUMERIC:Ft.appendAlphanumericBytes(o,c);break;case Ue.BYTE:Ft.append8BitBytes(o,c,u);break;case Ue.KANJI:Ft.appendKanjiBytes(o,c);break;default:throw new ft("Invalid mode: "+a)}}static getDigit(o){return o.charCodeAt(0)-48}static isDigit(o){const a=Ft.getDigit(o);return a>=0&&a<=9}static appendNumericBytes(o,a){const c=o.length;let u=0;for(;u<c;){const d=Ft.getDigit(o.charAt(u));if(u+2<c){const g=Ft.getDigit(o.charAt(u+1)),y=Ft.getDigit(o.charAt(u+2));a.appendBits(d*100+g*10+y,10),u+=3}else if(u+1<c){const g=Ft.getDigit(o.charAt(u+1));a.appendBits(d*10+g,7),u+=2}else a.appendBits(d,4),u++}}static appendAlphanumericBytes(o,a){const c=o.length;let u=0;for(;u<c;){const d=Ft.getAlphanumericCode(o.charCodeAt(u));if(d===-1)throw new ft;if(u+1<c){const g=Ft.getAlphanumericCode(o.charCodeAt(u+1));if(g===-1)throw new ft;a.appendBits(d*45+g,11),u+=2}else a.appendBits(d,6),u++}}static append8BitBytes(o,a,c){let u;try{u=K.encode(o,c)}catch(d){throw new ft(d)}for(let d=0,g=u.length;d!==g;d++){const y=u[d];a.appendBits(y,8)}}static appendKanjiBytes(o,a){let c;try{c=K.encode(o,F.SJIS)}catch(d){throw new ft(d)}const u=c.length;for(let d=0;d<u;d+=2){const g=c[d]&255,y=c[d+1]&255,w=g<<8&4294967295|y;let v=-1;if(w>=33088&&w<=40956?v=w-33088:w>=57408&&w<=60351&&(v=w-49472),v===-1)throw new ft("Invalid byte sequence");const T=(v>>8)*192+(v&255);a.appendBits(T,13)}}static appendECI(o,a){a.appendBits(Ue.ECI.getBits(),4),a.appendBits(o.getValue(),8)}}Ft.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Ft.DEFAULT_BYTE_MODE_ENCODING=F.UTF8.getName();class us{write(o,a,c,u=null){if(o.length===0)throw new E("Found empty contents");if(a<0||c<0)throw new E("Requested dimensions are too small: "+a+"x"+c);let d=wt.L,g=us.QUIET_ZONE_SIZE;u!==null&&(u.get(un.ERROR_CORRECTION)!==void 0&&(d=wt.fromString(u.get(un.ERROR_CORRECTION).toString())),u.get(un.MARGIN)!==void 0&&(g=Number.parseInt(u.get(un.MARGIN).toString(),10)));const y=Ft.encode(o,d,u);return this.renderResult(y,a,c,g)}writeToDom(o,a,c,u,d=null){typeof o=="string"&&(o=document.querySelector(o));const g=this.write(a,c,u,d);o&&o.appendChild(g)}renderResult(o,a,c,u){const d=o.getMatrix();if(d===null)throw new sr;const g=d.getWidth(),y=d.getHeight(),w=g+u*2,v=y+u*2,T=Math.max(a,w),R=Math.max(c,v),O=Math.min(Math.floor(T/w),Math.floor(R/v)),q=Math.floor((T-g*O)/2),Y=Math.floor((R-y*O)/2),Z=this.createSVGElement(T,R);for(let ie=0,ce=Y;ie<y;ie++,ce+=O)for(let we=0,_e=q;we<g;we++,_e+=O)if(d.get(we,ie)===1){const me=this.createSvgRectElement(_e,ce,O,O);Z.appendChild(me)}return Z}createSVGElement(o,a){const c=document.createElementNS(us.SVG_NS,"svg");return c.setAttributeNS(null,"height",o.toString()),c.setAttributeNS(null,"width",a.toString()),c}createSvgRectElement(o,a,c,u){const d=document.createElementNS(us.SVG_NS,"rect");return d.setAttributeNS(null,"x",o.toString()),d.setAttributeNS(null,"y",a.toString()),d.setAttributeNS(null,"height",c.toString()),d.setAttributeNS(null,"width",u.toString()),d.setAttributeNS(null,"fill","#000000"),d}}us.QUIET_ZONE_SIZE=4,us.SVG_NS="http://www.w3.org/2000/svg";class Vi{encode(o,a,c,u,d){if(o.length===0)throw new E("Found empty contents");if(a!==ke.QR_CODE)throw new E("Can only encode QR_CODE, but got "+a);if(c<0||u<0)throw new E(`Requested dimensions are too small: ${c}x${u}`);let g=wt.L,y=Vi.QUIET_ZONE_SIZE;d!==null&&(d.get(un.ERROR_CORRECTION)!==void 0&&(g=wt.fromString(d.get(un.ERROR_CORRECTION).toString())),d.get(un.MARGIN)!==void 0&&(y=Number.parseInt(d.get(un.MARGIN).toString(),10)));const w=Ft.encode(o,g,d);return Vi.renderResult(w,c,u,y)}static renderResult(o,a,c,u){const d=o.getMatrix();if(d===null)throw new sr;const g=d.getWidth(),y=d.getHeight(),w=g+u*2,v=y+u*2,T=Math.max(a,w),R=Math.max(c,v),O=Math.min(Math.floor(T/w),Math.floor(R/v)),q=Math.floor((T-g*O)/2),Y=Math.floor((R-y*O)/2),Z=new Ge(T,R);for(let ie=0,ce=Y;ie<y;ie++,ce+=O)for(let we=0,_e=q;we<g;we++,_e+=O)d.get(we,ie)===1&&Z.setRegion(_e,ce,O,O);return Z}}Vi.QUIET_ZONE_SIZE=4;class Pr{encode(o,a,c,u,d){let g;switch(a){case ke.QR_CODE:g=new Vi;break;default:throw new E("No encoder available for format "+a)}return g.encode(o,a,c,u,d)}}class oi extends Ie{constructor(o,a,c,u,d,g,y,w){if(super(g,y),this.yuvData=o,this.dataWidth=a,this.dataHeight=c,this.left=u,this.top=d,u+g>a||d+y>c)throw new E("Crop rectangle does not fit within image data.");w&&this.reverseHorizontal(g,y)}getRow(o,a){if(o<0||o>=this.getHeight())throw new E("Requested row is outside the image: "+o);const c=this.getWidth();(a==null||a.length<c)&&(a=new Uint8ClampedArray(c));const u=(o+this.top)*this.dataWidth+this.left;return D.arraycopy(this.yuvData,u,a,0,c),a}getMatrix(){const o=this.getWidth(),a=this.getHeight();if(o===this.dataWidth&&a===this.dataHeight)return this.yuvData;const c=o*a,u=new Uint8ClampedArray(c);let d=this.top*this.dataWidth+this.left;if(o===this.dataWidth)return D.arraycopy(this.yuvData,d,u,0,c),u;for(let g=0;g<a;g++){const y=g*o;D.arraycopy(this.yuvData,d,u,y,o),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(o,a,c,u){return new oi(this.yuvData,this.dataWidth,this.dataHeight,this.left+o,this.top+a,c,u,!1)}renderThumbnail(){const o=this.getWidth()/oi.THUMBNAIL_SCALE_FACTOR,a=this.getHeight()/oi.THUMBNAIL_SCALE_FACTOR,c=new Int32Array(o*a),u=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let g=0;g<a;g++){const y=g*o;for(let w=0;w<o;w++){const v=u[d+w*oi.THUMBNAIL_SCALE_FACTOR]&255;c[y+w]=4278190080|v*65793}d+=this.dataWidth*oi.THUMBNAIL_SCALE_FACTOR}return c}getThumbnailWidth(){return this.getWidth()/oi.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/oi.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(o,a){const c=this.yuvData;for(let u=0,d=this.top*this.dataWidth+this.left;u<a;u++,d+=this.dataWidth){const g=d+o/2;for(let y=d,w=d+o-1;y<g;y++,w--){const v=c[y];c[y]=c[w],c[w]=v}}}invert(){return new Me(this)}}oi.THUMBNAIL_SCALE_FACTOR=2;class nc extends Ie{constructor(o,a,c,u,d,g,y){if(super(a,c),this.dataWidth=u,this.dataHeight=d,this.left=g,this.top=y,o.BYTES_PER_ELEMENT===4){const w=a*c,v=new Uint8ClampedArray(w);for(let T=0;T<w;T++){const R=o[T],O=R>>16&255,q=R>>7&510,Y=R&255;v[T]=(O+q+Y)/4&255}this.luminances=v}else this.luminances=o;if(u===void 0&&(this.dataWidth=a),d===void 0&&(this.dataHeight=c),g===void 0&&(this.left=0),y===void 0&&(this.top=0),this.left+a>this.dataWidth||this.top+c>this.dataHeight)throw new E("Crop rectangle does not fit within image data.")}getRow(o,a){if(o<0||o>=this.getHeight())throw new E("Requested row is outside the image: "+o);const c=this.getWidth();(a==null||a.length<c)&&(a=new Uint8ClampedArray(c));const u=(o+this.top)*this.dataWidth+this.left;return D.arraycopy(this.luminances,u,a,0,c),a}getMatrix(){const o=this.getWidth(),a=this.getHeight();if(o===this.dataWidth&&a===this.dataHeight)return this.luminances;const c=o*a,u=new Uint8ClampedArray(c);let d=this.top*this.dataWidth+this.left;if(o===this.dataWidth)return D.arraycopy(this.luminances,d,u,0,c),u;for(let g=0;g<a;g++){const y=g*o;D.arraycopy(this.luminances,d,u,y,o),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(o,a,c,u){return new nc(this.luminances,c,u,this.dataWidth,this.dataHeight,this.left+o,this.top+a)}invert(){return new Me(this)}}class Gs extends F{static forName(o){return this.getCharacterSetECIByName(o)}}class p{}p.ISO_8859_1=F.ISO8859_1;class I{isCompact(){return this.compact}setCompact(o){this.compact=o}getSize(){return this.size}setSize(o){this.size=o}getLayers(){return this.layers}setLayers(o){this.layers=o}getCodeWords(){return this.codeWords}setCodeWords(o){this.codeWords=o}getMatrix(){return this.matrix}setMatrix(o){this.matrix=o}}class C{static singletonList(o){return[o]}static min(o,a){return o.sort(a)[0]}}class B{constructor(o){this.previous=o}getPrevious(){return this.previous}}class ee extends B{constructor(o,a,c){super(o),this.value=a,this.bitCount=c}appendTo(o,a){o.appendBits(this.value,this.bitCount)}add(o,a){return new ee(this,o,a)}addBinaryShift(o,a){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new ee(this,o,a)}toString(){let o=this.value&(1<<this.bitCount)-1;return o|=1<<this.bitCount,"<"+P.toBinaryString(o|1<<this.bitCount).substring(1)+">"}}class le extends ee{constructor(o,a,c){super(o,0,0),this.binaryShiftStart=a,this.binaryShiftByteCount=c}appendTo(o,a){for(let c=0;c<this.binaryShiftByteCount;c++)(c===0||c===31&&this.binaryShiftByteCount<=62)&&(o.appendBits(31,5),this.binaryShiftByteCount>62?o.appendBits(this.binaryShiftByteCount-31,16):c===0?o.appendBits(Math.min(this.binaryShiftByteCount,31),5):o.appendBits(this.binaryShiftByteCount-31,5)),o.appendBits(a[this.binaryShiftStart+c],8)}addBinaryShift(o,a){return new le(this,o,a)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ve(S,o,a){return new le(S,o,a)}function vt(S,o,a){return new ee(S,o,a)}const qn=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],nt=0,bn=1,Pt=2,qs=3,_n=4,rc=new ee(null,0,0),Qa=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,917504+14336+928+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,655360+928+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,655360+992+28,655360+992+30,655360+992+29,0])];function GR(S){for(let o of S)b.fill(o,-1);return S[nt][_n]=0,S[bn][_n]=0,S[bn][nt]=28,S[qs][_n]=0,S[Pt][_n]=0,S[Pt][nt]=15,S}const Jw=GR(b.createInt32Array(6,6));class hs{constructor(o,a,c,u){this.token=o,this.mode=a,this.binaryShiftByteCount=c,this.bitCount=u}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(o,a){let c=this.bitCount,u=this.token;if(o!==this.mode){let g=Qa[this.mode][o];u=vt(u,g&65535,g>>16),c+=g>>16}let d=o===Pt?4:5;return u=vt(u,a,d),new hs(u,o,0,c+d)}shiftAndAppend(o,a){let c=this.token,u=this.mode===Pt?4:5;return c=vt(c,Jw[this.mode][o],u),c=vt(c,a,5),new hs(c,this.mode,0,this.bitCount+u+5)}addBinaryShiftChar(o){let a=this.token,c=this.mode,u=this.bitCount;if(this.mode===_n||this.mode===Pt){let y=Qa[c][nt];a=vt(a,y&65535,y>>16),u+=y>>16,c=nt}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,g=new hs(a,c,this.binaryShiftByteCount+1,u+d);return g.binaryShiftByteCount===2047+31&&(g=g.endBinaryShift(o+1)),g}endBinaryShift(o){if(this.binaryShiftByteCount===0)return this;let a=this.token;return a=ve(a,o-this.binaryShiftByteCount,this.binaryShiftByteCount),new hs(a,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(o){let a=this.bitCount+(Qa[this.mode][o.mode]>>16);return this.binaryShiftByteCount<o.binaryShiftByteCount?a+=hs.calculateBinaryShiftCost(o)-hs.calculateBinaryShiftCost(this):this.binaryShiftByteCount>o.binaryShiftByteCount&&o.binaryShiftByteCount>0&&(a+=10),a<=o.bitCount}toBitArray(o){let a=[];for(let u=this.endBinaryShift(o.length).token;u!==null;u=u.getPrevious())a.unshift(u);let c=new V;for(const u of a)u.appendTo(c,o);return c}toString(){return W.format("%s bits=%d bytes=%d",qn[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(o){return o.binaryShiftByteCount>62?21:o.binaryShiftByteCount>31?20:o.binaryShiftByteCount>0?10:0}}hs.INITIAL_STATE=new hs(rc,nt,0,0);function qR(S){const o=W.getCharCode(" "),a=W.getCharCode("."),c=W.getCharCode(",");S[nt][o]=1;const u=W.getCharCode("Z"),d=W.getCharCode("A");for(let O=d;O<=u;O++)S[nt][O]=O-d+2;S[bn][o]=1;const g=W.getCharCode("z"),y=W.getCharCode("a");for(let O=y;O<=g;O++)S[bn][O]=O-y+2;S[Pt][o]=1;const w=W.getCharCode("9"),v=W.getCharCode("0");for(let O=v;O<=w;O++)S[Pt][O]=O-v+2;S[Pt][c]=12,S[Pt][a]=13;const T=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let O=0;O<T.length;O++)S[qs][W.getCharCode(T[O])]=O;const R=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let O=0;O<R.length;O++)W.getCharCode(R[O])>0&&(S[_n][W.getCharCode(R[O])]=O);return S}const zg=qR(b.createInt32Array(5,256));class nh{constructor(o){this.text=o}encode(){const o=W.getCharCode(" "),a=W.getCharCode(`
`);let c=C.singletonList(hs.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let g,y=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case W.getCharCode("\r"):g=y===a?2:0;break;case W.getCharCode("."):g=y===o?3:0;break;case W.getCharCode(","):g=y===o?4:0;break;case W.getCharCode(":"):g=y===o?5:0;break;default:g=0}g>0?(c=nh.updateStateListForPair(c,d,g),d++):c=this.updateStateListForChar(c,d)}return C.min(c,(d,g)=>d.getBitCount()-g.getBitCount()).toBitArray(this.text)}updateStateListForChar(o,a){const c=[];for(let u of o)this.updateStateForChar(u,a,c);return nh.simplifyStates(c)}updateStateForChar(o,a,c){let u=this.text[a]&255,d=zg[o.getMode()][u]>0,g=null;for(let y=0;y<=_n;y++){let w=zg[y][u];if(w>0){if(g==null&&(g=o.endBinaryShift(a)),!d||y===o.getMode()||y===Pt){const v=g.latchAndAppend(y,w);c.push(v)}if(!d&&Jw[o.getMode()][y]>=0){const v=g.shiftAndAppend(y,w);c.push(v)}}}if(o.getBinaryShiftByteCount()>0||zg[o.getMode()][u]===0){let y=o.addBinaryShiftChar(a);c.push(y)}}static updateStateListForPair(o,a,c){const u=[];for(let d of o)this.updateStateForPair(d,a,c,u);return this.simplifyStates(u)}static updateStateForPair(o,a,c,u){let d=o.endBinaryShift(a);if(u.push(d.latchAndAppend(_n,c)),o.getMode()!==_n&&u.push(d.shiftAndAppend(_n,c)),c===3||c===4){let g=d.latchAndAppend(Pt,16-c).latchAndAppend(Pt,1);u.push(g)}if(o.getBinaryShiftByteCount()>0){let g=o.addBinaryShiftChar(a).addBinaryShiftChar(a+1);u.push(g)}}static simplifyStates(o){let a=[];for(const c of o){let u=!0;for(const d of a){if(d.isBetterThanOrEqualTo(c)){u=!1;break}c.isBetterThanOrEqualTo(d)&&(a=a.filter(g=>g!==d))}u&&a.push(c)}return a}}class It{constructor(){}static encodeBytes(o){return It.encode(o,It.DEFAULT_EC_PERCENT,It.DEFAULT_AZTEC_LAYERS)}static encode(o,a,c){let u=new nh(o).encode(),d=P.truncDivision(u.getSize()*a,100)+11,g=u.getSize()+d,y,w,v,T,R;if(c!==It.DEFAULT_AZTEC_LAYERS){if(y=c<0,w=Math.abs(c),w>(y?It.MAX_NB_BITS_COMPACT:It.MAX_NB_BITS))throw new E(W.format("Illegal value %s for layers",c));v=It.totalBitsInLayer(w,y),T=It.WORD_SIZE[w];let me=v-v%T;if(R=It.stuffBits(u,T),R.getSize()+d>me)throw new E("Data to large for user specified layer");if(y&&R.getSize()>T*64)throw new E("Data to large for user specified layer")}else{T=0,R=null;for(let me=0;;me++){if(me>It.MAX_NB_BITS)throw new E("Data too large for an Aztec code");if(y=me<=3,w=y?me+1:me,v=It.totalBitsInLayer(w,y),g>v)continue;(R==null||T!==It.WORD_SIZE[w])&&(T=It.WORD_SIZE[w],R=It.stuffBits(u,T));let ct=v-v%T;if(!(y&&R.getSize()>T*64)&&R.getSize()+d<=ct)break}}let O=It.generateCheckWords(R,v,T),q=R.getSize()/T,Y=It.generateModeMessage(y,w,q),Z=(y?11:14)+w*4,ie=new Int32Array(Z),ce;if(y){ce=Z;for(let me=0;me<ie.length;me++)ie[me]=me}else{ce=Z+1+2*P.truncDivision(P.truncDivision(Z,2)-1,15);let me=P.truncDivision(Z,2),ct=P.truncDivision(ce,2);for(let et=0;et<me;et++){let Hr=et+P.truncDivision(et,15);ie[me-et-1]=ct-Hr-1,ie[me+et]=ct+Hr+1}}let we=new Ge(ce);for(let me=0,ct=0;me<w;me++){let et=(w-me)*4+(y?9:12);for(let Hr=0;Hr<et;Hr++){let Bi=Hr*2;for(let Wr=0;Wr<2;Wr++)O.get(ct+Bi+Wr)&&we.set(ie[me*2+Wr],ie[me*2+Hr]),O.get(ct+et*2+Bi+Wr)&&we.set(ie[me*2+Hr],ie[Z-1-me*2-Wr]),O.get(ct+et*4+Bi+Wr)&&we.set(ie[Z-1-me*2-Wr],ie[Z-1-me*2-Hr]),O.get(ct+et*6+Bi+Wr)&&we.set(ie[Z-1-me*2-Hr],ie[me*2+Wr])}ct+=et*8}if(It.drawModeMessage(we,y,ce,Y),y)It.drawBullsEye(we,P.truncDivision(ce,2),5);else{It.drawBullsEye(we,P.truncDivision(ce,2),7);for(let me=0,ct=0;me<P.truncDivision(Z,2)-1;me+=15,ct+=16)for(let et=P.truncDivision(ce,2)&1;et<ce;et+=2)we.set(P.truncDivision(ce,2)-ct,et),we.set(P.truncDivision(ce,2)+ct,et),we.set(et,P.truncDivision(ce,2)-ct),we.set(et,P.truncDivision(ce,2)+ct)}let _e=new I;return _e.setCompact(y),_e.setSize(ce),_e.setLayers(w),_e.setCodeWords(q),_e.setMatrix(we),_e}static drawBullsEye(o,a,c){for(let u=0;u<c;u+=2)for(let d=a-u;d<=a+u;d++)o.set(d,a-u),o.set(d,a+u),o.set(a-u,d),o.set(a+u,d);o.set(a-c,a-c),o.set(a-c+1,a-c),o.set(a-c,a-c+1),o.set(a+c,a-c),o.set(a+c,a-c+1),o.set(a+c,a+c-1)}static generateModeMessage(o,a,c){let u=new V;return o?(u.appendBits(a-1,2),u.appendBits(c-1,6),u=It.generateCheckWords(u,28,4)):(u.appendBits(a-1,5),u.appendBits(c-1,11),u=It.generateCheckWords(u,40,4)),u}static drawModeMessage(o,a,c,u){let d=P.truncDivision(c,2);if(a)for(let g=0;g<7;g++){let y=d-3+g;u.get(g)&&o.set(y,d-5),u.get(g+7)&&o.set(d+5,y),u.get(20-g)&&o.set(y,d+5),u.get(27-g)&&o.set(d-5,y)}else for(let g=0;g<10;g++){let y=d-5+g+P.truncDivision(g,5);u.get(g)&&o.set(y,d-7),u.get(g+10)&&o.set(d+7,y),u.get(29-g)&&o.set(y,d+7),u.get(39-g)&&o.set(d-7,y)}}static generateCheckWords(o,a,c){let u=o.getSize()/c,d=new tc(It.getGF(c)),g=P.truncDivision(a,c),y=It.bitsToWords(o,c,g);d.encode(y,g-u);let w=a%c,v=new V;v.appendBits(0,w);for(const T of Array.from(y))v.appendBits(T,c);return v}static bitsToWords(o,a,c){let u=new Int32Array(c),d,g;for(d=0,g=o.getSize()/a;d<g;d++){let y=0;for(let w=0;w<a;w++)y|=o.get(d*a+w)?1<<a-w-1:0;u[d]=y}return u}static getGF(o){switch(o){case 4:return ot.AZTEC_PARAM;case 6:return ot.AZTEC_DATA_6;case 8:return ot.AZTEC_DATA_8;case 10:return ot.AZTEC_DATA_10;case 12:return ot.AZTEC_DATA_12;default:throw new E("Unsupported word size "+o)}}static stuffBits(o,a){let c=new V,u=o.getSize(),d=(1<<a)-2;for(let g=0;g<u;g+=a){let y=0;for(let w=0;w<a;w++)(g+w>=u||o.get(g+w))&&(y|=1<<a-1-w);(y&d)===d?(c.appendBits(y&d,a),g--):y&d?c.appendBits(y,a):(c.appendBits(y|1,a),g--)}return c}static totalBitsInLayer(o,a){return((a?88:112)+16*o)*o}}It.DEFAULT_EC_PERCENT=33,It.DEFAULT_AZTEC_LAYERS=0,It.MAX_NB_BITS=32,It.MAX_NB_BITS_COMPACT=4,It.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class If{encode(o,a,c,u){return this.encodeWithHints(o,a,c,u,null)}encodeWithHints(o,a,c,u,d){let g=p.ISO_8859_1,y=It.DEFAULT_EC_PERCENT,w=It.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(un.CHARACTER_SET)&&(g=Gs.forName(d.get(un.CHARACTER_SET).toString())),d.has(un.ERROR_CORRECTION)&&(y=P.parseInt(d.get(un.ERROR_CORRECTION).toString())),d.has(un.AZTEC_LAYERS)&&(w=P.parseInt(d.get(un.AZTEC_LAYERS).toString()))),If.encodeLayers(o,a,c,u,g,y,w)}static encodeLayers(o,a,c,u,d,g,y){if(a!==ke.AZTEC)throw new E("Can only encode AZTEC, but got "+a);let w=It.encode(W.getBytes(o,d),g,y);return If.renderResult(w,c,u)}static renderResult(o,a,c){let u=o.getMatrix();if(u==null)throw new sr;let d=u.getWidth(),g=u.getHeight(),y=Math.max(a,d),w=Math.max(c,g),v=Math.min(y/d,w/g),T=(y-d*v)/2,R=(w-g*v)/2,O=new Ge(y,w);for(let q=0,Y=R;q<g;q++,Y+=v)for(let Z=0,ie=T;Z<d;Z++,ie+=v)u.get(Z,q)&&O.setRegion(ie,Y,v,v);return O}}n.AbstractExpandedDecoder=Hu,n.ArgumentException=x,n.ArithmeticException=Pi,n.AztecCode=I,n.AztecCodeReader=pr,n.AztecCodeWriter=If,n.AztecDecoder=Nt,n.AztecDetector=ns,n.AztecDetectorResult=Ce,n.AztecEncoder=It,n.AztecHighLevelEncoder=nh,n.AztecPoint=Et,n.BarcodeFormat=ke,n.Binarizer=U,n.BinaryBitmap=A,n.BitArray=V,n.BitMatrix=Ge,n.BitSource=za,n.BrowserAztecCodeReader=Gu,n.BrowserBarcodeReader=$u,n.BrowserCodeReader=Tt,n.BrowserDatamatrixCodeReader=gf,n.BrowserMultiFormatReader=Wa,n.BrowserPDF417Reader=_f,n.BrowserQRCodeReader=Ef,n.BrowserQRCodeSvgWriter=us,n.CharacterSetECI=F,n.ChecksumException=N,n.Code128Reader=Ee,n.Code39Reader=tn,n.DataMatrixDecodedBitStreamParser=Di,n.DataMatrixReader=ki,n.DecodeHintType=J,n.DecoderResult=Ni,n.DefaultGridSampler=We,n.DetectorResult=ue,n.EAN13Reader=ii,n.EncodeHintType=un,n.Exception=m,n.FormatException=k,n.GenericGF=ot,n.GenericGFPoly=Tn,n.GlobalHistogramBinarizer=rt,n.GridSampler=pe,n.GridSamplerInstance=qe,n.HTMLCanvasElementLuminanceSource=je,n.HybridBinarizer=Oe,n.ITFReader=pt,n.IllegalArgumentException=E,n.IllegalStateException=sr,n.InvertedLuminanceSource=Me,n.LuminanceSource=Ie,n.MathUtils=it,n.MultiFormatOneDReader=Gr,n.MultiFormatReader=th,n.MultiFormatWriter=Pr,n.NotFoundException=se,n.OneDReader=bt,n.PDF417DecodedBitStreamParser=oe,n.PDF417DecoderErrorCorrection=qa,n.PDF417Reader=wn,n.PDF417ResultMetadata=Yu,n.PerspectiveTransform=be,n.PlanarYUVLuminanceSource=oi,n.QRCodeByteMatrix=$a,n.QRCodeDataMask=ar,n.QRCodeDecodedBitStreamParser=Xt,n.QRCodeDecoderErrorCorrectionLevel=wt,n.QRCodeDecoderFormatInformation=Wt,n.QRCodeEncoder=Ft,n.QRCodeEncoderQRCode=cs,n.QRCodeMaskUtil=jt,n.QRCodeMatrixUtil=ze,n.QRCodeMode=Ue,n.QRCodeReader=Nr,n.QRCodeVersion=Ve,n.QRCodeWriter=Vi,n.RGBLuminanceSource=nc,n.RSS14Reader=Mt,n.RSSExpandedReader=de,n.ReaderException=ec,n.ReedSolomonDecoder=ts,n.ReedSolomonEncoder=tc,n.ReedSolomonException=ri,n.Result=Bt,n.ResultMetadataType=ln,n.ResultPoint=X,n.StringUtils=W,n.UnsupportedOperationException=H,n.VideoInputDevice=Rt,n.WhiteRectangleDetector=xe,n.WriterException=ft,n.ZXingArrays=b,n.ZXingCharset=Gs,n.ZXingInteger=P,n.ZXingStandardCharsets=p,n.ZXingStringBuilder=z,n.ZXingStringEncoding=K,n.ZXingSystem=D,n.createAbstractExpandedDecoder=Wu,Object.defineProperty(n,"__esModule",{value:!0})})})(Cy,Cy.exports);var Zt=Cy.exports;const qF=oI(Zt),HF=sI({__proto__:null,default:qF},[Zt]);var jv=function(){function t(e,n,r){if(this.formatMap=new Map([[Ne.QR_CODE,Zt.BarcodeFormat.QR_CODE],[Ne.AZTEC,Zt.BarcodeFormat.AZTEC],[Ne.CODABAR,Zt.BarcodeFormat.CODABAR],[Ne.CODE_39,Zt.BarcodeFormat.CODE_39],[Ne.CODE_93,Zt.BarcodeFormat.CODE_93],[Ne.CODE_128,Zt.BarcodeFormat.CODE_128],[Ne.DATA_MATRIX,Zt.BarcodeFormat.DATA_MATRIX],[Ne.MAXICODE,Zt.BarcodeFormat.MAXICODE],[Ne.ITF,Zt.BarcodeFormat.ITF],[Ne.EAN_13,Zt.BarcodeFormat.EAN_13],[Ne.EAN_8,Zt.BarcodeFormat.EAN_8],[Ne.PDF_417,Zt.BarcodeFormat.PDF_417],[Ne.RSS_14,Zt.BarcodeFormat.RSS_14],[Ne.RSS_EXPANDED,Zt.BarcodeFormat.RSS_EXPANDED],[Ne.UPC_A,Zt.BarcodeFormat.UPC_A],[Ne.UPC_E,Zt.BarcodeFormat.UPC_E],[Ne.UPC_EAN_EXTENSION,Zt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!HF)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=r;var i=this.createZXingFormats(e),s=new Map;s.set(Zt.DecodeHintType.POSSIBLE_FORMATS,i),s.set(Zt.DecodeHintType.TRY_HARDER,!1),this.hints=s}return t.prototype.decodeAsync=function(e){var n=this;return new Promise(function(r,i){try{r(n.decode(e))}catch(s){i(s)}})},t.prototype.decode=function(e){var n=new Zt.MultiFormatReader(this.verbose,this.hints),r=new Zt.HTMLCanvasElementLuminanceSource(e),i=new Zt.BinaryBitmap(new Zt.HybridBinarizer(r)),s=n.decode(i);return{text:s.text,format:BR.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,i){e.set(n,r)}),e},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createZXingFormats=function(e){for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r];this.formatMap.has(s)?n.push(this.formatMap.get(s)):this.logger.logError("".concat(s," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),WF=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(E){l(E)}}function f(x){try{m(r.throw(x))}catch(E){l(E)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},KF=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},zv=function(){function t(e,n,r){if(this.formatMap=new Map([[Ne.QR_CODE,"qr_code"],[Ne.AZTEC,"aztec"],[Ne.CODABAR,"codabar"],[Ne.CODE_39,"code_39"],[Ne.CODE_93,"code_93"],[Ne.CODE_128,"code_128"],[Ne.DATA_MATRIX,"data_matrix"],[Ne.ITF,"itf"],[Ne.EAN_13,"ean_13"],[Ne.EAN_8,"ean_8"],[Ne.PDF_417,"pdf417"],[Ne.UPC_A,"upc_a"],[Ne.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=r;var i=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},t.prototype.decodeAsync=function(e){return WF(this,void 0,void 0,function(){var n,r;return KF(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(e)];case 1:if(n=i.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return r=this.selectLargestBarcode(n),[2,{text:r.rawValue,format:BR.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(e){for(var n=null,r=0,i=0,s=e;i<s.length;i++){var l=s[i],h=l.boundingBox.width*l.boundingBox.height;h>r&&(r=h,n=l)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(e){for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r];this.formatMap.has(s)?n.push(this.formatMap.get(s)):this.logger.warn("".concat(s," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,i){e.set(n,r)}),e},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),Gv=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(E){l(E)}}function f(x){try{m(r.throw(x))}catch(E){l(E)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},qv=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},$F=function(){function t(e,n,r,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=r,n&&zv.isSupported()?(this.primaryDecoder=new zv(e,r,i),this.secondaryDecoder=new jv(e,r,i)):this.primaryDecoder=new jv(e,r,i)}return t.prototype.decodeAsync=function(e){return Gv(this,void 0,void 0,function(){var n;return qv(this,function(r){switch(r.label){case 0:n=performance.now(),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,r.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(e){return Gv(this,void 0,void 0,function(){var n,r;return qv(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,i.sent()];case 3:if(r=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw r;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(e){if(this.verbose){var n=performance.now()-e;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,n=0,r=this.executionResults;n<r.length;n++){var i=r[n];e+=i}var s=e/this.executionResults.length;console.log("".concat(s," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),Zw=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),k1=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(E){l(E)}}function f(x){try{m(r.throw(x))}catch(E){l(E)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},O1=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},jR=function(){function t(e,n){this.name=e,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(e){var n={};n[this.name]=e;var r={advanced:[n]};return this.track.applyConstraints(r)},t.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var n=e[this.name];return n}return null},t}(),QF=function(t){Zw(e,t);function e(n,r){return t.call(this,n,r)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(n){var r={};r[this.name]=n;var i={advanced:[r]};return this.track.applyConstraints(i)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),r=n[this.name];return{min:r.min,max:r.max,step:r.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(jR),XF=function(t){Zw(e,t);function e(n){return t.call(this,"zoom",n)||this}return e}(QF),YF=function(t){Zw(e,t);function e(n){return t.call(this,"torch",n)||this}return e}(jR),ZF=function(){function t(e){this.track=e}return t.prototype.zoomFeature=function(){return new XF(this.track)},t.prototype.torchFeature=function(){return new YF(this.track)},t}(),JF=function(){function t(e,n,r){this.isClosed=!1,this.parentElement=e,this.mediaStream=n,this.callbacks=r,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return t.prototype.createVideoElement=function(e){var n=document.createElement("video");return n.style.width="".concat(e,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var r=e.surface.clientWidth,i=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(r,i),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(e,n,r,i){return k1(this,void 0,void 0,function(){var s,l;return O1(this,function(h){switch(h.label){case 0:return s=new t(e,n,i),r.aspectRatio?(l={aspectRatio:r.aspectRatio},[4,s.getFirstTrackOrFail().applyConstraints(l)]):[3,2];case 1:h.sent(),h.label=2;case 2:return s.setupSurface(),[2,s]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(e){this.failIfClosed();var n=this,r=function(){setTimeout(e,200),n.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(e){return k1(this,void 0,void 0,function(){return O1(this,function(n){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(n,r){var i=e.mediaStream.getVideoTracks(),s=i.length,l=0;e.mediaStream.getVideoTracks().forEach(function(h){e.mediaStream.removeTrack(h),h.stop(),++l,l>=s&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),n())})})},t.prototype.getCapabilities=function(){return new ZF(this.getFirstTrackOrFail())},t}(),eV=function(){function t(e){this.mediaStream=e}return t.prototype.render=function(e,n,r){return k1(this,void 0,void 0,function(){return O1(this,function(i){return[2,JF.create(e,this.mediaStream,n,r)]})})},t.create=function(e){return k1(this,void 0,void 0,function(){var n,r;return O1(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return r=i.sent(),[2,new t(r)]}})})},t}(),Hv=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(E){l(E)}}function f(x){try{m(r.throw(x))}catch(E){l(E)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},Wv=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},tV=function(){function t(){}return t.failIfNotSupported=function(){return Hv(this,void 0,void 0,function(){return Wv(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(e){return Hv(this,void 0,void 0,function(){return Wv(this,function(n){return[2,eV.create(e)]})})},t}(),nV=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(E){l(E)}}function f(x){try{m(r.throw(x))}catch(E){l(E)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},rV=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},iV=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var e=Nc.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(e=Nc.insecureContextCameraQueryError()),Promise.reject(e)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},t.getCamerasFromMediaDevices=function(){return nV(this,void 0,void 0,function(){var e,n,r,i,s,l,h;return rV(this,function(f){switch(f.label){case 0:return e=function(m){for(var x=m.getVideoTracks(),E=0,A=x;E<A.length;E++){var N=A[E];N.enabled=!1,N.stop(),m.removeTrack(N)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=f.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=f.sent(),i=[],s=0,l=r;s<l.length;s++)h=l[s],h.kind==="videoinput"&&i.push({id:h.deviceId,label:h.label});return e(n),[2,i]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,n){var r=function(s){for(var l=[],h=0,f=s;h<f.length;h++){var m=f[h];m.kind==="video"&&l.push({id:m.id,label:m.label})}e(l)},i=MediaStreamTrack;i.getSources(r)})},t}(),vn;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(vn||(vn={}));var sV=function(){function t(){this.state=vn.NOT_STARTED,this.onGoingTransactionNewState=vn.UNKNOWN}return t.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},t.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===vn.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=vn.UNKNOWN,this.directTransition(e)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===vn.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=vn.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==vn.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(e){switch(this.state){case vn.UNKNOWN:throw"Transition from unknown is not allowed";case vn.NOT_STARTED:this.failIfNewStateIs(e,[vn.PAUSED]);break;case vn.SCANNING:break;case vn.PAUSED:break}},t.prototype.failIfNewStateIs=function(e,n){for(var r=0,i=n;r<i.length;r++){var s=i[r];if(e===s)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},t}(),oV=function(){function t(e){this.stateManager=e}return t.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},t.prototype.directTransition=function(e){this.stateManager.directTransition(e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===vn.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==vn.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===vn.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===vn.PAUSED},t}(),aV=function(){function t(){}return t.create=function(){return new oV(new sV)},t}(),lV=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),li=function(t){lV(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(jF),cV=function(){function t(e,n){this.logger=n,this.fps=li.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=li.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?UR.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!$s(this.qrbox)},t.create=function(e,n){return new t(e,n)},t}(),uV=function(){function t(e,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var r;typeof n=="boolean"?this.verbose=n===!0:n&&(r=n,this.verbose=r.verbose===!0,r.experimentalFeatures),this.logger=new GF(this.verbose),this.qrcode=new $F(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(r),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=aV.create()}return t.prototype.start=function(e,n,r,i){var s=this;if(!e)throw"cameraIdOrConfig is required";if(!r||typeof r!="function")throw"qrCodeSuccessCallback is required and should be a function.";var l;i?l=i:l=this.verbose?this.logger.log:function(){};var h=cV.create(n,this.logger);this.clearElement();var f=!1;h.videoConstraints&&(h.isMediaStreamConstraintsValid()?f=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var m=f,x=document.getElementById(this.elementId);x.clientWidth?x.clientWidth:li.DEFAULT_WIDTH,x.style.position="relative",this.shouldScan=!0,this.element=x;var E=this,A=this.stateManagerProxy.startTransition(vn.SCANNING);return new Promise(function(N,U){var D=m?h.videoConstraints:E.createVideoConstraints(e);if(!D){A.cancel(),U("videoConstraints should be defined");return}var G={};(!m||h.aspectRatio)&&(G.aspectRatio=h.aspectRatio);var M={onRenderSurfaceReady:function(b,P){E.setupUi(b,P,h),E.isScanning=!0,E.foreverScan(h,r,l)}};tV.failIfNotSupported().then(function(b){b.create(D).then(function(P){return P.render(s.element,G,M).then(function(V){E.renderedCamera=V,A.execute(),N(null)}).catch(function(V){A.cancel(),U(V)})}).catch(function(P){A.cancel(),U(Nc.errorGettingUserMedia(P))})}).catch(function(b){A.cancel(),U(Nc.cameraStreamingNotSupported())})})},t.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(vn.PAUSED),this.showPausedState(),($s(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,n=function(){e.stateManagerProxy.directTransition(vn.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(vn.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var r=function(){if(e.element){var s=document.getElementById(li.SHADED_REGION_ELEMENT_ID);s&&e.element.removeChild(s)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),r(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),n.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(e,n){return this.scanFileV2(e,n).then(function(r){return r.decodedText})},t.prototype.scanFileV2=function(e,n){var r=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if($s(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,s){r.possiblyCloseLastScanImageFile(),r.clearElement(),r.lastScanImageFile=URL.createObjectURL(e);var l=new Image;l.onload=function(){var h=l.width,f=l.height,m=document.getElementById(r.elementId),x=m.clientWidth?m.clientWidth:li.DEFAULT_WIDTH,E=Math.max(m.clientHeight?m.clientHeight:f,li.FILE_SCAN_MIN_HEIGHT),A=r.computeCanvasDrawConfig(h,f,x,E);if(n){var N=r.createCanvasElement(x,E,"qr-canvas-visible");N.style.display="inline-block",m.appendChild(N);var U=N.getContext("2d");if(!U)throw"Unable to get 2d context from canvas";U.canvas.width=x,U.canvas.height=E,U.drawImage(l,0,0,h,f,A.x,A.y,A.width,A.height)}var D=li.FILE_SCAN_HIDDEN_CANVAS_PADDING,G=Math.max(l.width,A.width),M=Math.max(l.height,A.height),b=G+2*D,P=M+2*D,V=r.createCanvasElement(b,P);m.appendChild(V);var $=V.getContext("2d");if(!$)throw"Unable to get 2d context from canvas";$.canvas.width=b,$.canvas.height=P,$.drawImage(l,0,0,h,f,D,D,G,M);try{r.qrcode.decodeRobustlyAsync(V).then(function(J){i(Uv.createFromQrcodeResult(J))}).catch(s)}catch(J){s("QR code parse error, error = ".concat(J))}},l.onerror=s,l.onabort=s,l.onstalled=s,l.onsuspend=s,l.src=URL.createObjectURL(e)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return iV.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(e){if(e){if(!UR.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(e){var n=[Ne.QR_CODE,Ne.AZTEC,Ne.CODABAR,Ne.CODE_39,Ne.CODE_93,Ne.CODE_128,Ne.DATA_MATRIX,Ne.MAXICODE,Ne.ITF,Ne.EAN_13,Ne.EAN_8,Ne.PDF_417,Ne.RSS_14,Ne.RSS_EXPANDED,Ne.UPC_A,Ne.UPC_E,Ne.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return n;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var r=[],i=0,s=e.formatsToSupport;i<s.length;i++){var l=s[i];UF(l)?r.push(l):this.logger.warn("Invalid format: ".concat(l," passed in config, ignoring."))}if(r.length===0)throw"None of formatsToSupport match supported values.";return r},t.prototype.getUseBarCodeDetectorIfSupported=function(e){if($s(e))return!0;if(!$s(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if($s(e.experimentalFeatures))return!0;var n=e.experimentalFeatures;return $s(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(e,n,r){var i=this,s=r.qrbox;this.validateQrboxConfig(s);var l=this.toQrdimensions(e,n,s),h=function(m){if(m<li.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(li.MIN_QR_BOX_SIZE,"px.")},f=function(m){return m>e&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),m=e),m};h(l.width),h(l.height),l.width=f(l.width)},t.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(e,n,r){if(typeof r=="number")return{width:r,height:r};if(typeof r=="function")try{return r(e,n)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return r},t.prototype.setupUi=function(e,n,r){r.isShadedBoxEnabled()&&this.validateQrboxSize(e,n,r);var i=$s(r.qrbox)?{width:e,height:n}:r.qrbox;this.validateQrboxConfig(i);var s=this.toQrdimensions(e,n,i);s.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var l=r.isShadedBoxEnabled()&&s.height<=n,h={x:0,y:0,width:e,height:n},f=l?this.getShadedRegionBounds(e,n,s):h,m=this.createCanvasElement(f.width,f.height),x={willReadFrequently:!0},E=m.getContext("2d",x);E.canvas.width=f.width,E.canvas.height=f.height,this.element.append(m),l&&this.possiblyInsertShadingElement(this.element,e,n,s),this.createScannerPausedUiElement(this.element),this.qrRegion=f,this.context=E,this.canvasElement=m},t.prototype.createScannerPausedUiElement=function(e){var n=document.createElement("div");n.innerText=Nc.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",e.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(e,n){var r=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return e(i.text,Uv.createFromQrcodeResult(i)),r.possiblyUpdateShaders(!0),!0}).catch(function(i){r.possiblyUpdateShaders(!1);var s=Nc.codeParseError(i);return n(s,zF.createFrom(s)),!1})},t.prototype.foreverScan=function(e,n,r){var i=this;if(this.shouldScan&&this.renderedCamera){var s=this.renderedCamera.getSurface(),l=s.videoWidth/s.clientWidth,h=s.videoHeight/s.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var f=this.qrRegion.width*l,m=this.qrRegion.height*h,x=this.qrRegion.x*l,E=this.qrRegion.y*h;this.context.drawImage(s,x,E,f,m,0,0,this.qrRegion.width,this.qrRegion.height);var A=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(e,n,r)},i.getTimeoutFps(e.fps))};this.scanContext(n,r).then(function(N){!N&&e.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(n,r).finally(function(){A()})):A()}).catch(function(N){i.logger.logError("Error happend while scanning context",N),A()})}},t.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var n="facingMode",r="deviceId",i={user:!0,environment:!0},s="exact",l=function(U){if(U in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(U,"'")},h=Object.keys(e);if(h.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(h.length," keys");var f=Object.keys(e)[0];if(f!==n&&f!==r)throw"Only '".concat(n,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(f===n){var m=e.facingMode;if(typeof m=="string"){if(l(m))return{facingMode:m}}else if(typeof m=="object")if(s in m){if(l(m["".concat(s)]))return{facingMode:{exact:m["".concat(s)]}}}else throw"'facingMode' should be string or object with"+" ".concat(s," as key.");else{var x=typeof m;throw"Invalid type of 'facingMode' = ".concat(x)}}else{var E=e.deviceId;if(typeof E=="string")return{deviceId:E};if(typeof E=="object"){if(s in E)return{deviceId:{exact:E["".concat(s)]}};throw"'deviceId' should be string or object with"+" ".concat(s," as key.")}else{var A=typeof E;throw"Invalid type of 'deviceId' = ".concat(A)}}}var N=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(N)},t.prototype.computeCanvasDrawConfig=function(e,n,r,i){if(e<=r&&n<=i){var s=(r-e)/2,l=(i-n)/2;return{x:s,y:l,width:e,height:n}}else{var h=e,f=n;return e>r&&(n=r/e*n,e=r),n>i&&(e=i/n*e,n=i),this.logger.log("Image downsampled from "+"".concat(h,"X").concat(f)+" to ".concat(e,"X").concat(n,".")),this.computeCanvasDrawConfig(e,n,r,i)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},t.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=e?li.BORDER_SHADER_MATCH_COLOR:li.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(e,n,r){var i=e,s=n,l=document.createElement("canvas");return l.style.width="".concat(i,"px"),l.style.height="".concat(s,"px"),l.style.display="none",l.id=$s(r)?"qr-canvas":r,l},t.prototype.getShadedRegionBounds=function(e,n,r){if(r.width>e||r.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-r.width)/2,y:(n-r.height)/2,width:r.width,height:r.height}},t.prototype.possiblyInsertShadingElement=function(e,n,r,i){if(!(n-i.width<1||r-i.height<1)){var s=document.createElement("div");s.style.position="absolute";var l=(n-i.width)/2,h=(r-i.height)/2;if(s.style.borderLeft="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderRight="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderTop="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderBottom="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),s.style.boxSizing="border-box",s.style.top="0px",s.style.bottom="0px",s.style.left="0px",s.style.right="0px",s.id="".concat(li.SHADED_REGION_ELEMENT_ID),n-i.width<11||r-i.height<11)this.hasBorderShaders=!1;else{var f=5,m=40;this.insertShaderBorders(s,m,f,-f,null,0,!0),this.insertShaderBorders(s,m,f,-f,null,0,!1),this.insertShaderBorders(s,m,f,null,-f,0,!0),this.insertShaderBorders(s,m,f,null,-f,0,!1),this.insertShaderBorders(s,f,m+f,-f,null,-f,!0),this.insertShaderBorders(s,f,m+f,null,-f,-f,!0),this.insertShaderBorders(s,f,m+f,-f,null,-f,!1),this.insertShaderBorders(s,f,m+f,null,-f,-f,!1),this.hasBorderShaders=!0}e.append(s)}},t.prototype.insertShaderBorders=function(e,n,r,i,s,l,h){var f=document.createElement("div");f.style.position="absolute",f.style.backgroundColor=li.BORDER_SHADER_DEFAULT_COLOR,f.style.width="".concat(n,"px"),f.style.height="".concat(r,"px"),i!==null&&(f.style.top="".concat(i,"px")),s!==null&&(f.style.bottom="".concat(s,"px")),h?f.style.left="".concat(l,"px"):f.style.right="".concat(l,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(f),e.appendChild(f)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(e){return 1e3/e},t}();globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var Kv;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Kv||(Kv={}));const hV=()=>{const t=ir(),e=ne.useRef(null),n=ne.useRef(!1),[r,i]=ne.useState(!1),[s,l]=ne.useState(null),[h,f]=ne.useState(""),[m,x]=ne.useState(null);ne.useEffect(()=>()=>{e.current&&r&&e.current.stop().catch(console.error)},[r]);const E=async()=>{try{if(e.current)try{await e.current.stop(),e.current.clear()}catch{console.log("No scanner to stop")}n.current=!1,i(!0),await new Promise(G=>setTimeout(G,100));const D=new uV("qr-reader");e.current=D,await D.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},G=>{N(G)},G=>{}),l(!0),Fe.success("Scanner ready! Point camera at QR code")}catch(D){console.error("Error starting scanner:",D),i(!1),l(!1),D.name==="NotAllowedError"?Fe.error("Camera permission denied. Please enable camera access."):D.name==="NotFoundError"?Fe.error("No camera found on this device."):Fe.error("Failed to start scanner. Try manual entry.")}},A=async()=>{if(e.current&&r)try{await e.current.stop(),i(!1),Fe.success("Scanner stopped")}catch(D){console.error("Error stopping scanner:",D)}},N=D=>{if(n.current){console.log("Already processing, ignoring duplicate scan");return}n.current=!0,console.log("Processing QR code:",D),e.current&&e.current.pause(!0),x(D);const G=D.match(/\/artifacts\/([a-zA-Z0-9-_]+)/);if(G&&G[1]){const M=G[1];A(),Fe.success("QR Code scanned successfully!",{duration:2e3,icon:""}),setTimeout(()=>{t(`/artifacts/${M}`)},500)}else A(),Fe.error("Invalid QR code. Expected artifact URL."),setTimeout(()=>{n.current=!1,E()},2e3)},U=D=>{if(D.preventDefault(),!h.trim()){Fe.error("Please enter an artifact ID");return}Fe.success("Opening artifact..."),t(`/artifacts/${h.trim()}`)};return _.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("div",{className:"mb-8",children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"QR Code Scanner"}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Scan QR codes to quickly access artifact information"})]}),_.jsx("div",{className:"card mb-6",children:_.jsxs("div",{className:"card-content",children:[s===!1&&_.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4 flex items-start gap-3",children:[_.jsx(xR,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-red-800 font-medium",children:"Camera Access Required"}),_.jsx("p",{className:"text-red-700 text-sm mt-1",children:"Please enable camera permissions in your browser settings to use the scanner."})]})]}),!r&&_.jsxs("div",{className:"text-center py-12",children:[_.jsx(Dv,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Scan"}),_.jsx("p",{className:"text-gray-600 mb-6",children:"Click the button below to activate your camera"}),_.jsxs("button",{onClick:E,className:"btn btn-primary btn-lg flex items-center gap-2 mx-auto",children:[_.jsx(Dv,{className:"w-5 h-5"}),"Start Scanner"]})]}),r&&_.jsx("div",{className:"relative bg-black rounded-lg overflow-hidden",style:{minHeight:"400px"},children:_.jsx("div",{id:"qr-reader",style:{width:"100%"}})}),r&&_.jsxs("div",{className:"mt-4 text-center",children:[_.jsxs("button",{onClick:A,className:"btn btn-danger btn-sm flex items-center gap-2 mx-auto",children:[_.jsx(j7,{className:"w-4 h-4"}),"Stop Scanner"]}),_.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Point your camera at a QR code"})]}),m&&_.jsxs("div",{className:"mt-4 bg-green-50 border border-green-200 rounded-lg p-3 flex items-start gap-2",children:[_.jsx(bd,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("p",{className:"text-green-800 font-medium text-sm",children:"Last Scanned:"}),_.jsx("p",{className:"text-green-700 text-xs truncate",children:m})]})]})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[_.jsx(b1,{className:"w-5 h-5"}),"Manual Entry"]}),_.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Already know the artifact ID? Enter it directly below."}),_.jsxs("form",{onSubmit:U,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"artifactId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Artifact ID"}),_.jsx("input",{type:"text",id:"artifactId",value:h,onChange:D=>f(D.target.value),className:"input",placeholder:"e.g., xHDc4cQXBh13pTnzJSCN"})]}),_.jsxs("button",{type:"submit",className:"btn btn-outline w-full flex items-center justify-center gap-2",children:[_.jsx(b1,{className:"w-4 h-4"}),"Go to Artifact"]})]})]})}),_.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[_.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" Scanning Tips:"}),_.jsxs("ul",{className:"text-blue-800 text-sm space-y-1 list-disc list-inside",children:[_.jsx("li",{children:"Hold your phone steady"}),_.jsx("li",{children:"Ensure good lighting"}),_.jsx("li",{children:"Center the QR code in the frame"}),_.jsx("li",{children:"Keep camera 4-6 inches from QR code"}),_.jsx("li",{children:"Use manual entry if scanning doesn't work"})]})]})]})})},dV=()=>{var n,r,i,s;const{user:t}=ni(),e=ir();return t?(console.log("UserProfilePage: user.role =",t.role),console.log("UserProfilePage: showing admin button?",t.role==="admin"),_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e("/dashboard"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Dashboard"]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Profile"}),_.jsx("p",{className:"mt-2 text-gray-600",children:"View and manage your account information"})]}),_.jsxs("div",{className:"grid gap-6",children:[_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[_.jsx("div",{className:"w-20 h-20 rounded-full bg-primary-600 text-white flex items-center justify-center text-3xl font-bold",children:((r=(n=t.displayName)==null?void 0:n[0])==null?void 0:r.toUpperCase())||((s=(i=t.email)==null?void 0:i[0])==null?void 0:s.toUpperCase())||"U"}),_.jsxs("div",{children:[_.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.displayName||t.username||"User"}),t.role&&_.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-800 mt-2",children:t.role})]})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[_.jsx(_R,{className:"w-5 h-5 text-gray-400"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),_.jsx("p",{className:"text-gray-900",children:t.email})]})]}),t.username&&_.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[_.jsx(R1,{className:"w-5 h-5 text-gray-400"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Username"}),_.jsx("p",{className:"text-gray-900",children:t.username})]})]}),t.role&&_.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[_.jsx(zc,{className:"w-5 h-5 text-gray-400"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Role"}),_.jsx("p",{className:"text-gray-900 capitalize",children:t.role})]})]}),t.createdAt&&_.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[_.jsx(wR,{className:"w-5 h-5 text-gray-400"}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Member Since"}),_.jsx("p",{className:"text-gray-900",children:new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Actions"}),_.jsxs("div",{className:"space-y-3",children:[_.jsx("button",{onClick:()=>e("/profile/edit"),className:"btn btn-outline w-full justify-start",children:"Edit Profile Information"}),_.jsx("button",{onClick:()=>e("/profile/change-password"),className:"btn btn-outline w-full justify-start",children:"Change Password"}),t.role!=="admin"&&_.jsxs("button",{onClick:()=>e("/profile/request-role"),className:"btn btn-primary w-full justify-start",children:[_.jsx(zc,{className:"w-4 h-4 mr-2"}),"Request Role Upgrade"]}),t.role==="admin"&&_.jsxs("button",{onClick:()=>e("/admin"),className:"btn btn-primary w-full justify-start",children:[_.jsx(zc,{className:"w-4 h-4 mr-2"}),"Admin Panel"]}),_.jsx("button",{onClick:()=>e("/profile/delete"),className:"btn btn-danger w-full justify-start",children:"Delete Account"})]})]})})]})]})})):null},fV=()=>{const{user:t}=ni(),e=ir(),[n,r]=ne.useState(!1),{register:i,handleSubmit:s,formState:{errors:l}}=cf({defaultValues:{displayName:(t==null?void 0:t.displayName)||"",username:(t==null?void 0:t.username)||"",email:(t==null?void 0:t.email)||""}}),h=async f=>{if(!t||!Gt.currentUser){Fe.error("User not authenticated");return}r(!0);try{if(await SC(Gt.currentUser,{displayName:f.displayName}),f.email!==t.email)try{await fk(Gt.currentUser,f.email)}catch(x){if(x.code==="auth/requires-recent-login"){Fe.error("Please log out and log back in before changing your email",{duration:5e3}),r(!1);return}throw x}const m=Lr(dn,"users",t.id);await po(m,{displayName:f.displayName,username:f.username,email:f.email}),Fe.success("Profile updated successfully!",{duration:3e3,icon:""}),window.location.href="/profile"}catch(m){console.error("Error updating profile:",m),Fe.error(m.message||"Failed to update profile")}finally{r(!1)}};return t?_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e("/profile"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Profile"]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Profile"}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Update your personal information"})]}),_.jsx("div",{className:"card",children:_.jsxs("form",{onSubmit:s(h),className:"card-content space-y-6",children:[_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(R1,{className:"w-4 h-4 inline mr-1"}),"Display Name"]}),_.jsx("input",{...i("displayName",{required:"Display name is required",minLength:{value:2,message:"Display name must be at least 2 characters"},maxLength:{value:50,message:"Display name must be less than 50 characters"}}),type:"text",id:"displayName",className:"input",placeholder:"Enter your display name"}),l.displayName&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:l.displayName.message})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(R1,{className:"w-4 h-4 inline mr-1"}),"Username"]}),_.jsx("input",{...i("username",{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"},maxLength:{value:30,message:"Username must be less than 30 characters"},pattern:{value:/^[a-zA-Z0-9_-]+$/,message:"Username can only contain letters, numbers, hyphens, and underscores"}}),type:"text",id:"username",className:"input",placeholder:"Enter your username"}),l.username&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:l.username.message})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(_R,{className:"w-4 h-4 inline mr-1"}),"Email Address"]}),_.jsx("input",{...i("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),type:"email",id:"email",className:"input",placeholder:"Enter your email"}),l.email&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:l.email.message}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:" Changing your email may require you to log in again"})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(zc,{className:"w-4 h-4 inline mr-1"}),"Role"]}),_.jsx("input",{type:"text",id:"role",value:t.role,className:"input bg-gray-100 cursor-not-allowed",disabled:!0,readOnly:!0}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Role cannot be changed. Contact an administrator if you need a different role."})]}),_.jsxs("div",{className:"flex gap-3 pt-4",children:[_.jsx("button",{type:"button",onClick:()=>e("/profile"),className:"btn btn-outline flex-1",disabled:n,children:"Cancel"}),_.jsx("button",{type:"submit",disabled:n,className:"btn btn-primary flex-1",children:n?"Saving...":"Save Changes"})]})]})})]})}):null},gV=()=>{const t=ir(),[e,n]=ne.useState(!1),{register:r,handleSubmit:i,formState:{errors:s},watch:l,reset:h}=cf(),f=l("newPassword"),m=async x=>{if(!Gt.currentUser||!Gt.currentUser.email){Fe.error("User not authenticated");return}n(!0);try{const E=Gl.credential(Gt.currentUser.email,x.currentPassword);await ck(Gt.currentUser,E),await gk(Gt.currentUser,x.newPassword),Fe.success("Password changed successfully!",{duration:3e3,icon:""}),h(),t("/profile")}catch(E){console.error("Error changing password:",E),E.code==="auth/wrong-password"?Fe.error("Current password is incorrect"):E.code==="auth/weak-password"?Fe.error("New password is too weak. Use at least 6 characters"):Fe.error(E.message||"Failed to change password")}finally{n(!1)}};return _.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>t("/profile"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Profile"]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Change Password"}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Update your account password"})]}),_.jsx("div",{className:"card",children:_.jsxs("form",{onSubmit:i(m),className:"card-content space-y-6",children:[_.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[_.jsx(xR,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),_.jsxs("div",{className:"text-sm text-blue-800",children:[_.jsx("p",{className:"font-medium mb-1",children:"Password Requirements:"}),_.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[_.jsx("li",{children:"At least 6 characters long"}),_.jsx("li",{children:"Use a mix of letters, numbers, and symbols"}),_.jsx("li",{children:"Avoid common passwords"})]})]})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(Om,{className:"w-4 h-4 inline mr-1"}),"Current Password"]}),_.jsx("input",{...r("currentPassword",{required:"Current password is required"}),type:"password",id:"currentPassword",className:"input",placeholder:"Enter your current password"}),s.currentPassword&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.currentPassword.message})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(Om,{className:"w-4 h-4 inline mr-1"}),"New Password"]}),_.jsx("input",{...r("newPassword",{required:"New password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",id:"newPassword",className:"input",placeholder:"Enter your new password"}),s.newPassword&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.newPassword.message})]}),_.jsxs("div",{children:[_.jsxs("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:[_.jsx(Om,{className:"w-4 h-4 inline mr-1"}),"Confirm New Password"]}),_.jsx("input",{...r("confirmPassword",{required:"Please confirm your new password",validate:x=>x===f||"Passwords do not match"}),type:"password",id:"confirmPassword",className:"input",placeholder:"Confirm your new password"}),s.confirmPassword&&_.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.confirmPassword.message})]}),_.jsxs("div",{className:"flex gap-3 pt-4",children:[_.jsx("button",{type:"button",onClick:()=>t("/profile"),className:"btn btn-outline flex-1",disabled:e,children:"Cancel"}),_.jsx("button",{type:"submit",disabled:e,className:"btn btn-primary flex-1",children:e?"Changing Password...":"Change Password"})]})]})})]})})},mV="modulepreload",pV=function(t){return"/"+t},$v={},Qv=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=pV(s),s in $v)return;$v[s]=!0;const l=s.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(!!r)for(let x=i.length-1;x>=0;x--){const E=i[x];if(E.href===s&&(!l||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${h}`))return;const m=document.createElement("link");if(m.rel=l?"stylesheet":mV,l||(m.as="script",m.crossOrigin=""),m.href=s,document.head.appendChild(m),l)return new Promise((x,E)=>{m.addEventListener("load",x),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},yV=()=>{const{user:t}=ni(),e=ir(),[n,r]=ne.useState(""),[i,s]=ne.useState(!1),l=async()=>{if(n!=="DELETE"){Fe.error("Please type DELETE to confirm");return}if(!Gt.currentUser||!t){Fe.error("No user logged in");return}s(!0);try{const h=Gt.currentUser.uid,{doc:f,updateDoc:m,serverTimestamp:x}=await Qv(()=>import("./index.esm-de330378.js"),[]),{db:E}=await Qv(()=>Promise.resolve().then(()=>ZL),void 0);await m(f(E,"users",h),{isActive:!1,deletedAt:x(),deletedBy:h}),await xk(Gt.currentUser),Fe.success("Account deleted successfully"),e("/login")}catch(h){console.error("Error deleting account:",h),h.code==="auth/requires-recent-login"?Fe.error("Please log out and log back in before deleting your account",{duration:5e3}):Fe.error("Failed to delete account. Please try again.")}finally{s(!1)}};return t?_.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e("/profile"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Profile"]}),_.jsx("div",{className:"card border-2 border-red-200",children:_.jsxs("div",{className:"card-content",children:[_.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[_.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:_.jsx(N7,{className:"w-6 h-6 text-red-600"})}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Delete Account"}),_.jsx("p",{className:"text-sm text-red-600",children:"This action cannot be undone"})]})]}),_.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[_.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:" Warning"}),_.jsxs("ul",{className:"text-sm text-red-800 space-y-1 list-disc list-inside",children:[_.jsx("li",{children:"Your account will be permanently deleted"}),_.jsx("li",{children:"All your artifacts will remain in the system"}),_.jsx("li",{children:"You will lose access to all your data"}),_.jsx("li",{children:"This action cannot be reversed"})]})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Type ",_.jsx("span",{className:"font-bold text-red-600",children:"DELETE"})," to confirm"]}),_.jsx("input",{type:"text",value:n,onChange:h=>r(h.target.value),className:"input",placeholder:"Type DELETE here",disabled:i})]}),_.jsxs("div",{className:"flex gap-3",children:[_.jsx("button",{onClick:()=>e("/profile"),className:"btn btn-outline flex-1",disabled:i,children:"Cancel"}),_.jsx("button",{onClick:l,disabled:n!=="DELETE"||i,className:"btn btn-danger flex-1",children:i?"Deleting...":"Delete My Account"})]})]})]})})]})}):null},zu="roleRequests",xV=async t=>{try{const e=Gt.currentUser;if(!e)throw new Error("User must be authenticated");const n=await Oo.getUserProfile(e.uid);if(await zR(e.uid))throw new Error("You already have a pending role request");if(t.requestedRole==="researcher")throw new Error("Cannot request researcher role");const i={userId:e.uid,userEmail:n.email,username:n.username,currentRole:n.role,requestedRole:t.requestedRole,reason:t.reason,status:"pending",createdAt:Ri(),updatedAt:Ri()},s=await sR(Fa(dn,zu),i);return console.log(" Role request created:",s.id),s.id}catch(e){throw console.error(" Error creating role request:",e),e}},zR=async t=>{var e,n,r,i,s,l;try{const h=Bu(Fa(dn,zu),Sd("userId","==",t),Sd("status","==","pending")),f=await ju(h);if(f.empty)return null;const m=f.docs[0],x=m.data();return{id:m.id,...x,createdAt:((n=(e=x.createdAt)==null?void 0:e.toDate)==null?void 0:n.call(e))||new Date,updatedAt:((i=(r=x.updatedAt)==null?void 0:r.toDate)==null?void 0:i.call(r))||new Date,reviewedAt:((l=(s=x.reviewedAt)==null?void 0:s.toDate)==null?void 0:l.call(s))||void 0}}catch(h){throw console.error(" Error getting pending request:",h),h}},wV=async t=>{try{const e=Bu(Fa(dn,zu),Sd("userId","==",t),Sg("createdAt","desc")),n=await ju(e),r=[];return n.forEach(i=>{var l,h,f,m,x,E;const s=i.data();r.push({id:i.id,...s,createdAt:((h=(l=s.createdAt)==null?void 0:l.toDate)==null?void 0:h.call(l))||new Date,updatedAt:((m=(f=s.updatedAt)==null?void 0:f.toDate)==null?void 0:m.call(f))||new Date,reviewedAt:((E=(x=s.reviewedAt)==null?void 0:x.toDate)==null?void 0:E.call(x))||void 0})}),r}catch(e){throw console.error(" Error getting role requests:",e),e}},_V=async()=>{try{const t=Bu(Fa(dn,zu),Sd("status","==","pending"),Sg("createdAt","asc")),e=await ju(t),n=[];return e.forEach(r=>{var s,l,h,f,m,x;const i=r.data();n.push({id:r.id,...i,createdAt:((l=(s=i.createdAt)==null?void 0:s.toDate)==null?void 0:l.call(s))||new Date,updatedAt:((f=(h=i.updatedAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date,reviewedAt:((x=(m=i.reviewedAt)==null?void 0:m.toDate)==null?void 0:x.call(m))||void 0})}),n}catch(t){throw console.error(" Error getting pending requests:",t),t}},EV=async(t,e)=>{try{const n=Gt.currentUser;if(!n)throw new Error("User must be authenticated");const r=Lr(dn,zu,t),i=await Dg(r);if(!i.exists())throw new Error("Role request not found");const s=i.data();if(await po(r,{status:e.status,reviewedBy:n.uid,reviewedAt:Ri(),reviewNotes:e.reviewNotes||"",updatedAt:Ri()}),e.status==="approved"){const l=Lr(dn,"users",s.userId);await po(l,{role:s.requestedRole}),console.log(" User role updated to:",s.requestedRole)}console.log(" Role request reviewed:",t,e.status)}catch(n){throw console.error(" Error reviewing role request:",n),n}},vV=async()=>{try{const t=Bu(Fa(dn,zu),Sg("createdAt","desc")),e=await ju(t),n=[];return e.forEach(r=>{var s,l,h,f,m,x;const i=r.data();n.push({id:r.id,...i,createdAt:((l=(s=i.createdAt)==null?void 0:s.toDate)==null?void 0:l.call(s))||new Date,updatedAt:((f=(h=i.updatedAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date,reviewedAt:((x=(m=i.reviewedAt)==null?void 0:m.toDate)==null?void 0:x.call(m))||void 0})}),n}catch(t){throw console.error(" Error getting all role requests:",t),t}},IV=()=>{const{user:t}=ni(),e=ir(),[n,r]=ne.useState("archaeologist"),[i,s]=ne.useState(""),[l,h]=ne.useState(!1),[f,m]=ne.useState(null),[x,E]=ne.useState([]),[A,N]=ne.useState(!0);ne.useEffect(()=>{U()},[t]);const U=async()=>{var M,b;if(t)try{N(!0);const P=await zR(t.id);m(P);const V=await wV(t.id);E(V)}catch(P){console.error("Error loading requests:",P),!((M=P.message)!=null&&M.includes("permission"))&&!((b=P.message)!=null&&b.includes("denied"))&&Fe.error("Failed to load role requests")}finally{N(!1)}},D=async M=>{if(M.preventDefault(),!i.trim()){Fe.error("Please provide a reason for your request");return}if(i.trim().length<20){Fe.error("Please provide a more detailed reason (at least 20 characters)");return}try{h(!0),await xV({requestedRole:n,reason:i.trim()}),Fe.success("Role request submitted successfully!"),s(""),U()}catch(b){console.error("Error submitting request:",b),Fe.error(b.message||"Failed to submit request")}finally{h(!1)}};if(!t)return null;const G=M=>{switch(M){case"pending":return _.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[_.jsx(S1,{className:"w-3 h-3"}),"Pending"]});case"approved":return _.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[_.jsx(bd,{className:"w-3 h-3"}),"Approved"]});case"denied":return _.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[_.jsx(_y,{className:"w-3 h-3"}),"Denied"]})}};return _.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e("/profile"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Profile"]}),_.jsxs("div",{className:"mb-8",children:[_.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[_.jsx(zc,{className:"w-8 h-8 text-primary-600"}),"Request Role Upgrade"]}),_.jsxs("p",{className:"mt-2 text-gray-600",children:["Current Role: ",_.jsx("strong",{className:"text-gray-900 capitalize",children:t.role})]})]}),f&&_.jsx("div",{className:"card mb-6 border-yellow-300 bg-yellow-50",children:_.jsx("div",{className:"card-content",children:_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx(S1,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),_.jsxs("div",{className:"flex-1",children:[_.jsx("h3",{className:"font-semibold text-yellow-900",children:"Pending Request"}),_.jsxs("p",{className:"text-yellow-800 text-sm mt-1",children:["You have a pending request for ",_.jsx("strong",{className:"capitalize",children:f.requestedRole})," role. Please wait for an administrator to review your request."]}),_.jsxs("p",{className:"text-yellow-700 text-xs mt-2",children:["Submitted: ",f.createdAt.toLocaleDateString()]})]})]})})}),!f&&t.role!=="admin"&&_.jsxs("div",{className:"card mb-6",children:[_.jsx("div",{className:"card-header",children:_.jsx("h2",{className:"text-xl font-semibold",children:"Submit New Request"})}),_.jsxs("form",{onSubmit:D,className:"card-content space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Requested Role"}),_.jsxs("select",{id:"role",value:n,onChange:M=>r(M.target.value),className:"input",disabled:l,children:[_.jsx("option",{value:"archaeologist",children:"Archaeologist - Create and edit artifacts"}),t.role==="archaeologist"&&_.jsx("option",{value:"admin",children:"Administrator - Full system access"})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Request"}),_.jsx("textarea",{id:"reason",value:i,onChange:M=>s(M.target.value),className:"input min-h-[120px]",placeholder:"Please explain why you need this role upgrade. Include your qualifications, experience, or institutional affiliation...",disabled:l,required:!0}),_.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i.length,"/500 characters (minimum 20)"]})]}),_.jsx("button",{type:"submit",disabled:l||i.length<20,className:"btn btn-primary w-full",children:l?"Submitting...":"Submit Request"})]})]}),t.role==="admin"&&_.jsx("div",{className:"card border-green-300 bg-green-50",children:_.jsx("div",{className:"card-content",children:_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx(bd,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-semibold text-green-900",children:"Administrator Account"}),_.jsx("p",{className:"text-green-800 text-sm mt-1",children:"You have the highest level of access. You can manage role requests from other users in the Admin Panel."})]})]})})}),x.length>0&&_.jsxs("div",{className:"card",children:[_.jsx("div",{className:"card-header",children:_.jsx("h2",{className:"text-xl font-semibold",children:"Request History"})}),_.jsx("div",{className:"card-content",children:_.jsx("div",{className:"space-y-4",children:x.map(M=>_.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[_.jsxs("div",{className:"flex items-start justify-between mb-2",children:[_.jsxs("div",{children:[_.jsxs("p",{className:"font-medium text-gray-900",children:[_.jsx("span",{className:"capitalize",children:M.currentRole}),"  ",_.jsx("span",{className:"capitalize",children:M.requestedRole})]}),_.jsxs("p",{className:"text-sm text-gray-500",children:[M.createdAt.toLocaleDateString()," at"," ",M.createdAt.toLocaleTimeString()]})]}),G(M.status)]}),_.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[_.jsx("strong",{children:"Reason:"})," ",M.reason]}),M.reviewNotes&&_.jsxs("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[_.jsx("strong",{children:"Admin Response:"})," ",M.reviewNotes]})]},M.id))})})]})]})})},AV=()=>{const{user:t}=ni(),e=ir(),[n,r]=ne.useState([]),[i,s]=ne.useState([]),[l,h]=ne.useState(!0),[f,m]=ne.useState("pending"),[x,E]=ne.useState(null),[A,N]=ne.useState("");ne.useEffect(()=>{if(console.log("AdminPanelPage: user =",t),console.log("AdminPanelPage: user.role =",t==null?void 0:t.role),!t){console.log(" Waiting for user to load...");return}if(t.role!=="admin"){console.log(" Access denied. User role:",t.role,"(expected: admin)"),e("/dashboard",{replace:!0});return}console.log(" Admin access granted. Loading requests..."),U()},[t,e]);const U=async()=>{try{h(!0);const[b,P]=await Promise.all([_V(),vV()]);r(b),s(P)}catch(b){console.error("Error loading requests:",b),Fe.error("Failed to load role requests")}finally{h(!1)}},D=async(b,P)=>{try{await EV(b,{status:P,reviewNotes:A.trim()||void 0}),Fe.success(`Request ${P}!`),E(null),N(""),U()}catch(V){console.error("Error reviewing request:",V),Fe.error(V.message||"Failed to review request")}},G=b=>{switch(b){case"pending":return _.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[_.jsx(S1,{className:"w-3 h-3"}),"Pending"]});case"approved":return _.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[_.jsx(bd,{className:"w-3 h-3"}),"Approved"]});case"denied":return _.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[_.jsx(_y,{className:"w-3 h-3"}),"Denied"]})}};if(!t||t.role!=="admin")return null;const M=f==="pending"?n:i;return _.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e("/dashboard"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Dashboard"]}),_.jsx("div",{className:"mb-8",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[_.jsx(zc,{className:"w-8 h-8 text-primary-600"}),"Admin Panel"]}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Manage role requests from users"})]}),_.jsxs("button",{onClick:()=>e("/admin/users"),className:"btn btn-primary flex items-center gap-2",children:[_.jsx(Hh,{className:"w-5 h-5"}),"Manage Users"]})]})}),_.jsxs("div",{className:"flex gap-2 mb-6",children:[_.jsxs("button",{onClick:()=>m("pending"),className:`btn ${f==="pending"?"btn-primary":"btn-outline"}`,children:[_.jsx(S1,{className:"w-4 h-4 mr-2"}),"Pending (",n.length,")"]}),_.jsxs("button",{onClick:()=>m("all"),className:`btn ${f==="all"?"btn-primary":"btn-outline"}`,children:[_.jsx(Hh,{className:"w-4 h-4 mr-2"}),"All Requests (",i.length,")"]})]}),l?_.jsx("div",{className:"card",children:_.jsx("div",{className:"card-content text-center py-12",children:_.jsx("p",{className:"text-gray-500",children:"Loading requests..."})})}):M.length===0?_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content text-center py-12",children:[_.jsx(Hh,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),_.jsx("p",{className:"text-gray-500",children:f==="pending"?"No pending requests":"No role requests yet"})]})}):_.jsx("div",{className:"space-y-4",children:M.map(b=>{var P;return _.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsxs("div",{className:"flex items-start justify-between mb-4",children:[_.jsxs("div",{children:[_.jsxs("h3",{className:"font-semibold text-gray-900",children:[b.username," (",b.userEmail,")"]}),_.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[_.jsx("span",{className:"capitalize",children:b.currentRole}),"  ",_.jsx("span",{className:"capitalize font-medium",children:b.requestedRole})]}),_.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Submitted: ",b.createdAt.toLocaleDateString()," at"," ",b.createdAt.toLocaleTimeString()]})]}),G(b.status)]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Reason:"}),_.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded",children:b.reason})]}),b.status==="pending"&&_.jsx("div",{className:"border-t pt-4",children:x===b.id?_.jsxs("div",{className:"space-y-3",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Review Notes (Optional)"}),_.jsx("textarea",{value:A,onChange:V=>N(V.target.value),className:"input min-h-[80px]",placeholder:"Add any notes or feedback..."})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsxs("button",{onClick:()=>D(b.id,"approved"),className:"btn btn-primary flex-1",children:[_.jsx(bd,{className:"w-4 h-4 mr-2"}),"Approve"]}),_.jsxs("button",{onClick:()=>D(b.id,"denied"),className:"btn btn-danger flex-1",children:[_.jsx(_y,{className:"w-4 h-4 mr-2"}),"Deny"]}),_.jsx("button",{onClick:()=>{E(null),N("")},className:"btn btn-ghost",children:"Cancel"})]})]}):_.jsx("button",{onClick:()=>E(b.id),className:"btn btn-primary w-full",children:"Review Request"})}),b.status!=="pending"&&_.jsxs("div",{className:"border-t pt-4",children:[_.jsxs("p",{className:"text-sm text-gray-600",children:[_.jsx("strong",{children:"Reviewed:"})," ",(P=b.reviewedAt)==null?void 0:P.toLocaleDateString()]}),b.reviewNotes&&_.jsxs("p",{className:"text-sm text-gray-600 mt-2 bg-gray-50 p-2 rounded",children:[_.jsx("strong",{children:"Notes:"})," ",b.reviewNotes]})]})]})},b.id)})})]})})},TV=async()=>{try{const t=Bu(Fa(dn,"users"),Sg("createdAt","desc")),e=await ju(t),n=[];return e.forEach(r=>{const i=r.data();n.push({id:r.id,email:i.email,username:i.username,role:i.role,displayName:i.displayName,createdAt:i.createdAt,lastLoginAt:i.lastLoginAt,isActive:i.isActive})}),n}catch(t){throw console.error(" Error getting all users:",t),t}},CV=async t=>{try{const e=Gt.currentUser;if(!e)throw new Error("Must be authenticated");const n=Lr(dn,"users",t);await po(n,{isActive:!1,deletedAt:Ri(),deletedBy:e.uid}),console.log(" User deactivated:",t)}catch(e){throw console.error(" Error deactivating user:",e),e}},SV=async t=>{try{const e=Gt.currentUser;if(!e)throw new Error("Must be authenticated");const n=Lr(dn,"users",t);await po(n,{isActive:!0,reactivatedAt:Ri(),reactivatedBy:e.uid,deletedAt:null,deletedBy:null}),console.log(" User reactivated:",t)}catch(e){throw console.error(" Error reactivating user:",e),e}},bV=async(t,e)=>{try{const n=Gt.currentUser;if(!n)throw new Error("Must be authenticated");const r=Lr(dn,"users",t);await po(r,{role:e,roleUpdatedAt:Ri(),roleUpdatedBy:n.uid}),console.log(" User role updated:",t,"to",e)}catch(n){throw console.error(" Error updating user role:",n),n}},RV=()=>{const{user:t}=ni(),e=ir(),[n,r]=ne.useState([]),[i,s]=ne.useState(!0),[l,h]=ne.useState(""),[f,m]=ne.useState("all"),[x,E]=ne.useState(null),[A,N]=ne.useState("researcher");ne.useEffect(()=>{if(t){if(t.role!=="admin"){e("/dashboard",{replace:!0});return}U()}},[t,e]);const U=async()=>{try{s(!0);const V=await TV();r(V)}catch(V){console.error("Error loading users:",V),Fe.error("Failed to load users")}finally{s(!1)}},D=async(V,$)=>{if(window.confirm(`Are you sure you want to deactivate ${$}? They will not be able to log in.`))try{await CV(V),Fe.success("User deactivated successfully"),U()}catch(k){console.error("Error deactivating user:",k),Fe.error(k.message||"Failed to deactivate user")}},G=async(V,$)=>{try{await SV(V),Fe.success(`${$} has been reactivated`),U()}catch(J){console.error("Error reactivating user:",J),Fe.error(J.message||"Failed to reactivate user")}},M=async V=>{try{await bV(V,A),Fe.success("User role updated successfully"),E(null),U()}catch($){console.error("Error updating role:",$),Fe.error($.message||"Failed to update role")}},b=V=>{switch(V){case"admin":return"bg-red-100 text-red-800";case"archaeologist":return"bg-blue-100 text-blue-800";case"researcher":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};if(!t||t.role!=="admin")return null;const P=n.filter(V=>{var k;const $=V.email.toLowerCase().includes(l.toLowerCase())||V.username.toLowerCase().includes(l.toLowerCase())||((k=V.displayName)==null?void 0:k.toLowerCase().includes(l.toLowerCase())),J=f==="all"||V.role===f;return $&&J});return _.jsx("div",{className:"min-h-screen bg-gray-50",children:_.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[_.jsxs("button",{onClick:()=>e("/dashboard"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[_.jsx(Ms,{className:"w-4 h-4"}),"Back to Dashboard"]}),_.jsxs("div",{className:"mb-8",children:[_.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[_.jsx(Hh,{className:"w-8 h-8 text-primary-600"}),"User Management"]}),_.jsx("p",{className:"mt-2 text-gray-600",children:"Manage user accounts and permissions"})]}),_.jsx("div",{className:"card mb-6",children:_.jsx("div",{className:"card-content",children:_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Users"}),_.jsxs("div",{className:"relative",children:[_.jsx(b1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),_.jsx("input",{type:"text",value:l,onChange:V=>h(V.target.value),className:"input pl-10",placeholder:"Search by email, username, or name..."})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Role"}),_.jsxs("select",{value:f,onChange:V=>m(V.target.value),className:"input",children:[_.jsx("option",{value:"all",children:"All Roles"}),_.jsx("option",{value:"admin",children:"Admin"}),_.jsx("option",{value:"archaeologist",children:"Archaeologist"}),_.jsx("option",{value:"researcher",children:"Researcher"})]})]})]})})}),i?_.jsx("div",{className:"card",children:_.jsx("div",{className:"card-content text-center py-12",children:_.jsx("p",{className:"text-gray-500",children:"Loading users..."})})}):P.length===0?_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content text-center py-12",children:[_.jsx(Hh,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),_.jsx("p",{className:"text-gray-500",children:"No users found"})]})}):_.jsx("div",{className:"card",children:_.jsx("div",{className:"card-content p-0",children:_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full",children:[_.jsx("thead",{className:"bg-gray-50 border-b",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),_.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),_.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),_.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),_.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),_.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(V=>_.jsxs("tr",{className:V.isActive?"":"bg-gray-50 opacity-60",children:[_.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_.jsxs("div",{children:[_.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[V.displayName||V.username,V.id===t.id&&_.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(You)"})]}),_.jsx("div",{className:"text-sm text-gray-500",children:V.email})]})}),_.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x===V.id&&V.role!=="admin"?_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs("select",{value:A,onChange:$=>N($.target.value),className:"input input-sm",children:[_.jsx("option",{value:"researcher",children:"Researcher"}),_.jsx("option",{value:"archaeologist",children:"Archaeologist"})]}),_.jsx("button",{onClick:()=>M(V.id),className:"btn btn-primary btn-sm",children:"Save"}),_.jsx("button",{onClick:()=>E(null),className:"btn btn-ghost btn-sm",children:"Cancel"})]}):_.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b(V.role)}`,children:V.role})}),_.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${V.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:V.isActive?"Active":"Inactive"})}),_.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(V.createdAt).toLocaleDateString()}),_.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:_.jsxs("div",{className:"flex items-center justify-end gap-2",children:[V.role!=="admin"&&V.id!==t.id&&_.jsx(_.Fragment,{children:V.isActive?_.jsxs(_.Fragment,{children:[_.jsx("button",{onClick:()=>{E(V.id),N(V.role)},className:"btn btn-ghost btn-sm",title:"Change role",children:_.jsx(M7,{className:"w-4 h-4"})}),_.jsx("button",{onClick:()=>D(V.id,V.email),className:"btn btn-danger btn-sm",title:"Deactivate user",children:_.jsx(Ww,{className:"w-4 h-4"})})]}):_.jsx("button",{onClick:()=>G(V.id,V.email),className:"btn btn-primary btn-sm",title:"Reactivate user",children:_.jsx(V7,{className:"w-4 h-4"})})}),V.role==="admin"&&V.id!==t.id&&_.jsx("span",{className:"text-xs text-gray-400",children:"Protected"}),V.id===t.id&&_.jsx("span",{className:"text-xs text-gray-400",children:""})]})})]},V.id))})]})})})}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("p",{className:"text-sm text-gray-600",children:"Total Users"}),_.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("p",{className:"text-sm text-gray-600",children:"Admins"}),_.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.filter(V=>V.role==="admin").length})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("p",{className:"text-sm text-gray-600",children:"Archaeologists"}),_.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.filter(V=>V.role==="archaeologist").length})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"card-content",children:[_.jsx("p",{className:"text-sm text-gray-600",children:"Researchers"}),_.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.filter(V=>V.role==="researcher").length})]})})]})]})})};class NV extends ne.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){this.setState({error:e,errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:_.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:_.jsx("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:_.jsxs("div",{className:"flex items-center",children:[_.jsx("div",{className:"flex-shrink-0",children:_.jsx("svg",{className:"h-8 w-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),_.jsxs("div",{className:"ml-3",children:[_.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Something went wrong"}),_.jsx("div",{className:"mt-2 text-sm text-gray-500",children:_.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."})}),!1,_.jsx("div",{className:"mt-4",children:_.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary btn-sm",children:"Refresh Page"})})]})]})})}):this.props.children}}const PV=()=>{const{user:t}=ni(),e=ir(),[n,r]=ne.useState(!1),i=ne.useRef(null);ne.useEffect(()=>{const m=x=>{i.current&&!i.current.contains(x.target)&&r(!1)};return n&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[n]);const s=async()=>{try{await RC(Gt),Fe.success("Logged out successfully"),e("/login")}catch(m){console.error("Error logging out:",m),Fe.error("Failed to log out")}},l=()=>{r(!1),e("/profile")},h=()=>{r(!1),e("/profile/delete")};if(!t)return null;const f=()=>{var m,x;return t.displayName?t.displayName.split(" ").map(E=>E[0]).join("").toUpperCase().slice(0,2):((x=(m=t.email)==null?void 0:m[0])==null?void 0:x.toUpperCase())||"U"};return _.jsxs("div",{className:"relative",ref:i,children:[_.jsxs("button",{onClick:()=>r(!n),className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"User menu",children:[_.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-600 text-white flex items-center justify-center font-semibold text-sm",children:f()}),_.jsxs("div",{className:"hidden md:block text-left",children:[_.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.displayName||t.username||"User"}),_.jsx("p",{className:"text-xs text-gray-500",children:t.email})]}),_.jsx(P7,{className:`w-4 h-4 text-gray-500 transition-transform ${n?"rotate-180":""}`})]}),n&&_.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[_.jsxs("div",{className:"px-4 py-3 border-b border-gray-200",children:[_.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.displayName||t.username||"User"}),_.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.email}),t.role&&_.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary-100 text-primary-800 mt-1",children:t.role})]}),_.jsxs("div",{className:"py-1",children:[_.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[_.jsx(R1,{className:"w-4 h-4"}),_.jsx("span",{children:"View Profile"})]}),_.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[_.jsx(B7,{className:"w-4 h-4"}),_.jsx("span",{children:"Account Settings"})]})]}),_.jsxs("div",{className:"border-t border-gray-200 py-1",children:[_.jsxs("button",{onClick:h,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[_.jsx(Ww,{className:"w-4 h-4"}),_.jsx("span",{children:"Delete Account"})]}),_.jsxs("button",{onClick:s,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[_.jsx(k7,{className:"w-4 h-4"}),_.jsx("span",{children:"Log Out"})]})]})]})]})},DV=()=>{const{user:t}=ni();return _.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:_.jsxs("div",{className:"flex justify-between items-center h-16",children:[_.jsxs(Gf,{to:"/dashboard",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[_.jsx(Hw,{className:"w-8 h-8 text-primary-600"}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Artifacts Scanner"}),_.jsx("p",{className:"text-xs text-gray-500",children:"Archaeological Management"})]})]}),t&&_.jsxs("nav",{className:"hidden md:flex items-center gap-6",children:[_.jsx(Gf,{to:"/dashboard",className:"text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors",children:"Dashboard"}),_.jsx(Gf,{to:"/artifacts",className:"text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors",children:"Artifacts"}),_.jsx(Gf,{to:"/scanner",className:"text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors",children:"Scanner"})]}),t&&_.jsx(PV,{})]})})})};function kV(){const{user:t,loading:e}=ni();return e?_.jsx(uf,{}):_.jsx(NV,{children:_.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&_.jsx(DV,{}),_.jsxs(BP,{children:[_.jsx(Ir,{path:"/login",element:t?_.jsx(vr,{to:"/dashboard",replace:!0}):_.jsx(C7,{})}),_.jsx(Ir,{path:"/dashboard",element:t?_.jsx(S7,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/artifacts",element:t?_.jsx(OF,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/artifacts/new",element:t?_.jsx(LF,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/artifacts/:id/edit",element:t?_.jsx(FF,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/artifacts/:id",element:t?_.jsx(BF,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/scanner",element:t?_.jsx(hV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/profile",element:t?_.jsx(dV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/profile/edit",element:t?_.jsx(fV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/profile/change-password",element:t?_.jsx(gV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/profile/delete",element:t?_.jsx(yV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/profile/request-role",element:t?_.jsx(IV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/admin",element:t?_.jsx(AV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/admin/users",element:t?_.jsx(RV,{}):_.jsx(vr,{to:"/login",replace:!0})}),_.jsx(Ir,{path:"/",element:_.jsx(vr,{to:t?"/dashboard":"/login",replace:!0})})]})]})})}const OV=new K4({defaultOptions:{queries:{staleTime:5*60*1e3,retry:1}}});Um.createRoot(document.getElementById("root")).render(_.jsx(Ar.StrictMode,{children:_.jsx(Q4,{client:OV,children:_.jsxs(WP,{children:[_.jsx(kV,{}),_.jsx(F8,{position:"top-right"})]})})}));export{Fa as $,iR as A,Ll as B,Rs as C,kn as D,WB as E,ql as F,bw as G,HB as H,GV as I,bi as J,V9 as K,U9 as L,sR as M,pB as N,yB as O,lL as P,gr as Q,aB as R,$V as S,gn as T,LB as U,vg as V,oL as W,MB as X,mB as Y,ZV as Z,$C as _,Ad as a,WV as a0,B9 as a1,Q9 as a2,qB as a3,IB as a4,OB as a5,tB as a6,GB as a7,Lr as a8,sB as a9,iB as aA,AB as aB,TB as aC,oB as aD,Sg as aE,NB as aF,PB as aG,iL as aH,Bu as aI,qb as aJ,KV as aK,kB as aL,Ri as aM,Pm as aN,UB as aO,BV as aP,xB as aQ,hB as aR,uB as aS,gB as aT,nB as aU,po as aV,VB as aW,JV as aX,Sd as aY,BB as aZ,XV as aa,YV as ab,eB as ac,zB as ad,fB as ae,dB as af,pn as ag,of as ah,Y9 as ai,CB as aj,Dg as ak,wB as al,_B as am,ju as an,EB as ao,vB as ap,j9 as aq,jB as ar,FB as as,QV as at,lB as au,cB as av,rB as aw,SB as ax,RB as ay,bB as az,z9 as b,xu as c,Hl as d,qt as e,ge as f,Uu as g,rf as h,S0 as i,Ng as j,sf as k,bg as l,Fw as m,wu as n,Rg as o,ll as p,aL as q,An as r,bl as s,Te as t,jV as u,PO as v,on as w,KB as x,at as y,UV as z};
//# sourceMappingURL=index-21883578.js.map
