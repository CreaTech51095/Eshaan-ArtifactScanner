var L3=Object.defineProperty;var F3=(t,e,n)=>e in t?L3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Pg=(t,e,n)=>(F3(t,typeof e!="symbol"?e+"":e,n),n),Dg=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var he=(t,e,n)=>(Dg(t,e,"read from private field"),n?n.call(t):e.get(t)),gt=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},$e=(t,e,n,r)=>(Dg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var mf=(t,e,n,r)=>({set _(i){$e(t,e,i,n)},get _(){return he(t,e,r)}}),pr=(t,e,n)=>(Dg(t,e,"access private method"),n);function Kv(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $v(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qv={exports:{}},A1={},Xv={exports:{}},lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ad=Symbol.for("react.element"),V3=Symbol.for("react.portal"),B3=Symbol.for("react.fragment"),U3=Symbol.for("react.strict_mode"),j3=Symbol.for("react.profiler"),z3=Symbol.for("react.provider"),G3=Symbol.for("react.context"),H3=Symbol.for("react.forward_ref"),W3=Symbol.for("react.suspense"),q3=Symbol.for("react.memo"),K3=Symbol.for("react.lazy"),zx=Symbol.iterator;function $3(t){return t===null||typeof t!="object"?null:(t=zx&&t[zx]||t["@@iterator"],typeof t=="function"?t:null)}var Yv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Zv=Object.assign,Jv={};function Eu(t,e,n){this.props=t,this.context=e,this.refs=Jv,this.updater=n||Yv}Eu.prototype.isReactComponent={};Eu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Eu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function eI(){}eI.prototype=Eu.prototype;function py(t,e,n){this.props=t,this.context=e,this.refs=Jv,this.updater=n||Yv}var yy=py.prototype=new eI;yy.constructor=py;Zv(yy,Eu.prototype);yy.isPureReactComponent=!0;var Gx=Array.isArray,tI=Object.prototype.hasOwnProperty,wy={current:null},nI={key:!0,ref:!0,__self:!0,__source:!0};function rI(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)tI.call(e,r)&&!nI.hasOwnProperty(r)&&(i[r]=e[r]);var h=arguments.length-2;if(h===1)i.children=n;else if(1<h){for(var f=Array(h),m=0;m<h;m++)f[m]=arguments[m+2];i.children=f}if(t&&t.defaultProps)for(r in h=t.defaultProps,h)i[r]===void 0&&(i[r]=h[r]);return{$$typeof:Ad,type:t,key:s,ref:l,props:i,_owner:wy.current}}function Q3(t,e){return{$$typeof:Ad,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function xy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ad}function X3(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Hx=/\/+/g;function kg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?X3(""+t.key):e.toString(36)}function Kf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case Ad:case V3:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+kg(l,0):r,Gx(i)?(n="",t!=null&&(n=t.replace(Hx,"$&/")+"/"),Kf(i,e,n,"",function(m){return m})):i!=null&&(xy(i)&&(i=Q3(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(Hx,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",Gx(t))for(var h=0;h<t.length;h++){s=t[h];var f=r+kg(s,h);l+=Kf(s,e,n,f,i)}else if(f=$3(t),typeof f=="function")for(t=f.call(t),h=0;!(s=t.next()).done;)s=s.value,f=r+kg(s,h++),l+=Kf(s,e,n,f,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function pf(t,e,n){if(t==null)return t;var r=[],i=0;return Kf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Y3(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kr={current:null},$f={transition:null},Z3={ReactCurrentDispatcher:kr,ReactCurrentBatchConfig:$f,ReactCurrentOwner:wy};function iI(){throw Error("act(...) is not supported in production builds of React.")}lt.Children={map:pf,forEach:function(t,e,n){pf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return pf(t,function(){e++}),e},toArray:function(t){return pf(t,function(e){return e})||[]},only:function(t){if(!xy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};lt.Component=Eu;lt.Fragment=B3;lt.Profiler=j3;lt.PureComponent=py;lt.StrictMode=U3;lt.Suspense=W3;lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z3;lt.act=iI;lt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Zv({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=wy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var h=t.type.defaultProps;for(f in e)tI.call(e,f)&&!nI.hasOwnProperty(f)&&(r[f]=e[f]===void 0&&h!==void 0?h[f]:e[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){h=Array(f);for(var m=0;m<f;m++)h[m]=arguments[m+2];r.children=h}return{$$typeof:Ad,type:t.type,key:i,ref:s,props:r,_owner:l}};lt.createContext=function(t){return t={$$typeof:G3,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:z3,_context:t},t.Consumer=t};lt.createElement=rI;lt.createFactory=function(t){var e=rI.bind(null,t);return e.type=t,e};lt.createRef=function(){return{current:null}};lt.forwardRef=function(t){return{$$typeof:H3,render:t}};lt.isValidElement=xy;lt.lazy=function(t){return{$$typeof:K3,_payload:{_status:-1,_result:t},_init:Y3}};lt.memo=function(t,e){return{$$typeof:q3,type:t,compare:e===void 0?null:e}};lt.startTransition=function(t){var e=$f.transition;$f.transition={};try{t()}finally{$f.transition=e}};lt.unstable_act=iI;lt.useCallback=function(t,e){return kr.current.useCallback(t,e)};lt.useContext=function(t){return kr.current.useContext(t)};lt.useDebugValue=function(){};lt.useDeferredValue=function(t){return kr.current.useDeferredValue(t)};lt.useEffect=function(t,e){return kr.current.useEffect(t,e)};lt.useId=function(){return kr.current.useId()};lt.useImperativeHandle=function(t,e,n){return kr.current.useImperativeHandle(t,e,n)};lt.useInsertionEffect=function(t,e){return kr.current.useInsertionEffect(t,e)};lt.useLayoutEffect=function(t,e){return kr.current.useLayoutEffect(t,e)};lt.useMemo=function(t,e){return kr.current.useMemo(t,e)};lt.useReducer=function(t,e,n){return kr.current.useReducer(t,e,n)};lt.useRef=function(t){return kr.current.useRef(t)};lt.useState=function(t){return kr.current.useState(t)};lt.useSyncExternalStore=function(t,e,n){return kr.current.useSyncExternalStore(t,e,n)};lt.useTransition=function(){return kr.current.useTransition()};lt.version="18.3.1";Xv.exports=lt;var oe=Xv.exports;const _r=$v(oe),J3=Kv({__proto__:null,default:_r},[oe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eR=oe,tR=Symbol.for("react.element"),nR=Symbol.for("react.fragment"),rR=Object.prototype.hasOwnProperty,iR=eR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sR={key:!0,ref:!0,__self:!0,__source:!0};function sI(t,e,n){var r,i={},s=null,l=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)rR.call(e,r)&&!sR.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:tR,type:t,key:s,ref:l,props:i,_owner:iR.current}}A1.Fragment=nR;A1.jsx=sI;A1.jsxs=sI;Qv.exports=A1;var A=Qv.exports,bm={},oI={exports:{}},hi={},aI={exports:{}},lI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ie,Me){var Ue=Ie.length;Ie.push(Me);e:for(;0<Ue;){var Rt=Ue-1>>>1,Xe=Ie[Rt];if(0<i(Xe,Me))Ie[Rt]=Me,Ie[Ue]=Xe,Ue=Rt;else break e}}function n(Ie){return Ie.length===0?null:Ie[0]}function r(Ie){if(Ie.length===0)return null;var Me=Ie[0],Ue=Ie.pop();if(Ue!==Me){Ie[0]=Ue;e:for(var Rt=0,Xe=Ie.length,Tt=Xe>>>1;Rt<Tt;){var Vt=2*(Rt+1)-1,fr=Ie[Vt],ke=Vt+1,Qn=Ie[ke];if(0>i(fr,Ue))ke<Xe&&0>i(Qn,fr)?(Ie[Rt]=Qn,Ie[ke]=Ue,Rt=ke):(Ie[Rt]=fr,Ie[Vt]=Ue,Rt=Vt);else if(ke<Xe&&0>i(Qn,Ue))Ie[Rt]=Qn,Ie[ke]=Ue,Rt=ke;else break e}}return Me}function i(Ie,Me){var Ue=Ie.sortIndex-Me.sortIndex;return Ue!==0?Ue:Ie.id-Me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,h=l.now();t.unstable_now=function(){return l.now()-h}}var f=[],m=[],x=1,_=null,I=3,R=!1,B=!1,D=!1,G=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(Ie){for(var Me=n(m);Me!==null;){if(Me.callback===null)r(m);else if(Me.startTime<=Ie)r(m),Me.sortIndex=Me.expirationTime,e(f,Me);else break;Me=n(m)}}function H(Ie){if(D=!1,N(Ie),!B)if(n(f)!==null)B=!0,rt(Y);else{var Me=n(m);Me!==null&&Oe(H,Me.startTime-Ie)}}function Y(Ie,Me){B=!1,D&&(D=!1,F(M),M=-1),R=!0;var Ue=I;try{for(N(Me),_=n(f);_!==null&&(!(_.expirationTime>Me)||Ie&&!K());){var Rt=_.callback;if(typeof Rt=="function"){_.callback=null,I=_.priorityLevel;var Xe=Rt(_.expirationTime<=Me);Me=t.unstable_now(),typeof Xe=="function"?_.callback=Xe:_===n(f)&&r(f),N(Me)}else r(f);_=n(f)}if(_!==null)var Tt=!0;else{var Vt=n(m);Vt!==null&&Oe(H,Vt.startTime-Me),Tt=!1}return Tt}finally{_=null,I=Ue,R=!1}}var J=!1,k=null,M=-1,L=5,W=-1;function K(){return!(t.unstable_now()-W<L)}function q(){if(k!==null){var Ie=t.unstable_now();W=Ie;var Me=!0;try{Me=k(!0,Ie)}finally{Me?j():(J=!1,k=null)}}else J=!1}var j;if(typeof P=="function")j=function(){P(q)};else if(typeof MessageChannel<"u"){var ze=new MessageChannel,ie=ze.port2;ze.port1.onmessage=q,j=function(){ie.postMessage(null)}}else j=function(){G(q,0)};function rt(Ie){k=Ie,J||(J=!0,j())}function Oe(Ie,Me){M=G(function(){Ie(t.unstable_now())},Me)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ie){Ie.callback=null},t.unstable_continueExecution=function(){B||R||(B=!0,rt(Y))},t.unstable_forceFrameRate=function(Ie){0>Ie||125<Ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<Ie?Math.floor(1e3/Ie):5},t.unstable_getCurrentPriorityLevel=function(){return I},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(Ie){switch(I){case 1:case 2:case 3:var Me=3;break;default:Me=I}var Ue=I;I=Me;try{return Ie()}finally{I=Ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ie,Me){switch(Ie){case 1:case 2:case 3:case 4:case 5:break;default:Ie=3}var Ue=I;I=Ie;try{return Me()}finally{I=Ue}},t.unstable_scheduleCallback=function(Ie,Me,Ue){var Rt=t.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?Rt+Ue:Rt):Ue=Rt,Ie){case 1:var Xe=-1;break;case 2:Xe=250;break;case 5:Xe=1073741823;break;case 4:Xe=1e4;break;default:Xe=5e3}return Xe=Ue+Xe,Ie={id:x++,callback:Me,priorityLevel:Ie,startTime:Ue,expirationTime:Xe,sortIndex:-1},Ue>Rt?(Ie.sortIndex=Ue,e(m,Ie),n(f)===null&&Ie===n(m)&&(D?(F(M),M=-1):D=!0,Oe(H,Ue-Rt))):(Ie.sortIndex=Xe,e(f,Ie),B||R||(B=!0,rt(Y))),Ie},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(Ie){var Me=I;return function(){var Ue=I;I=Me;try{return Ie.apply(this,arguments)}finally{I=Ue}}}})(lI);aI.exports=lI;var oR=aI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aR=oe,ci=oR;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cI=new Set,Bh={};function Ol(t,e){Kc(t,e),Kc(t+"Capture",e)}function Kc(t,e){for(Bh[t]=e,t=0;t<e.length;t++)cI.add(e[t])}var ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rm=Object.prototype.hasOwnProperty,lR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wx={},qx={};function cR(t){return Rm.call(qx,t)?!0:Rm.call(Wx,t)?!1:lR.test(t)?qx[t]=!0:(Wx[t]=!0,!1)}function uR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hR(t,e,n,r){if(e===null||typeof e>"u"||uR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Or(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var hr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hr[t]=new Or(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hr[e]=new Or(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){hr[t]=new Or(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hr[t]=new Or(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hr[t]=new Or(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){hr[t]=new Or(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){hr[t]=new Or(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){hr[t]=new Or(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){hr[t]=new Or(t,5,!1,t.toLowerCase(),null,!1,!1)});var _y=/[\-:]([a-z])/g;function Ey(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(_y,Ey);hr[e]=new Or(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(_y,Ey);hr[e]=new Or(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(_y,Ey);hr[e]=new Or(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){hr[t]=new Or(t,1,!1,t.toLowerCase(),null,!1,!1)});hr.xlinkHref=new Or("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){hr[t]=new Or(t,1,!1,t.toLowerCase(),null,!0,!0)});function vy(t,e,n,r){var i=hr.hasOwnProperty(e)?hr[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hR(e,n,i,r)&&(n=null),r||i===null?cR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var go=aR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yf=Symbol.for("react.element"),gc=Symbol.for("react.portal"),mc=Symbol.for("react.fragment"),Iy=Symbol.for("react.strict_mode"),Nm=Symbol.for("react.profiler"),uI=Symbol.for("react.provider"),hI=Symbol.for("react.context"),Ay=Symbol.for("react.forward_ref"),Pm=Symbol.for("react.suspense"),Dm=Symbol.for("react.suspense_list"),Ty=Symbol.for("react.memo"),Po=Symbol.for("react.lazy"),dI=Symbol.for("react.offscreen"),Kx=Symbol.iterator;function Yu(t){return t===null||typeof t!="object"?null:(t=Kx&&t[Kx]||t["@@iterator"],typeof t=="function"?t:null)}var fn=Object.assign,Og;function hh(t){if(Og===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Og=e&&e[1]||""}return`
`+Og+t}var Mg=!1;function Lg(t,e){if(!t||Mg)return"";Mg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var r=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){r=m}t.call(e.prototype)}else{try{throw Error()}catch(m){r=m}t()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var i=m.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,h=s.length-1;1<=l&&0<=h&&i[l]!==s[h];)h--;for(;1<=l&&0<=h;l--,h--)if(i[l]!==s[h]){if(l!==1||h!==1)do if(l--,h--,0>h||i[l]!==s[h]){var f=`
`+i[l].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=l&&0<=h);break}}}finally{Mg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?hh(t):""}function dR(t){switch(t.tag){case 5:return hh(t.type);case 16:return hh("Lazy");case 13:return hh("Suspense");case 19:return hh("SuspenseList");case 0:case 2:case 15:return t=Lg(t.type,!1),t;case 11:return t=Lg(t.type.render,!1),t;case 1:return t=Lg(t.type,!0),t;default:return""}}function km(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case mc:return"Fragment";case gc:return"Portal";case Nm:return"Profiler";case Iy:return"StrictMode";case Pm:return"Suspense";case Dm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case hI:return(t.displayName||"Context")+".Consumer";case uI:return(t._context.displayName||"Context")+".Provider";case Ay:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ty:return e=t.displayName||null,e!==null?e:km(t.type)||"Memo";case Po:e=t._payload,t=t._init;try{return km(t(e))}catch{}}return null}function fR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return km(e);case 8:return e===Iy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function da(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function gR(t){var e=fI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wf(t){t._valueTracker||(t._valueTracker=gR(t))}function gI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=fI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function x0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Om(t,e){var n=e.checked;return fn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function $x(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=da(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mI(t,e){e=e.checked,e!=null&&vy(t,"checked",e,!1)}function Mm(t,e){mI(t,e);var n=da(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Lm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Lm(t,e.type,da(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Qx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Lm(t,e,n){(e!=="number"||x0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var dh=Array.isArray;function bc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+da(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Fm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return fn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Xx(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ye(92));if(dh(n)){if(1<n.length)throw Error(ye(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:da(n)}}function pI(t,e){var n=da(e.value),r=da(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Yx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var xf,wI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(xf=xf||document.createElement("div"),xf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=xf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Uh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Eh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mR=["Webkit","ms","Moz","O"];Object.keys(Eh).forEach(function(t){mR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Eh[e]=Eh[t]})});function xI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Eh.hasOwnProperty(t)&&Eh[t]?(""+e).trim():e+"px"}function _I(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=xI(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var pR=fn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bm(t,e){if(e){if(pR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function Um(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jm=null;function Cy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zm=null,Rc=null,Nc=null;function Zx(t){if(t=Sd(t)){if(typeof zm!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=R1(e),zm(t.stateNode,t.type,e))}}function EI(t){Rc?Nc?Nc.push(t):Nc=[t]:Rc=t}function vI(){if(Rc){var t=Rc,e=Nc;if(Nc=Rc=null,Zx(t),e)for(t=0;t<e.length;t++)Zx(e[t])}}function II(t,e){return t(e)}function AI(){}var Fg=!1;function TI(t,e,n){if(Fg)return t(e,n);Fg=!0;try{return II(t,e,n)}finally{Fg=!1,(Rc!==null||Nc!==null)&&(AI(),vI())}}function jh(t,e){var n=t.stateNode;if(n===null)return null;var r=R1(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ye(231,e,typeof n));return n}var Gm=!1;if(ro)try{var Zu={};Object.defineProperty(Zu,"passive",{get:function(){Gm=!0}}),window.addEventListener("test",Zu,Zu),window.removeEventListener("test",Zu,Zu)}catch{Gm=!1}function yR(t,e,n,r,i,s,l,h,f){var m=Array.prototype.slice.call(arguments,3);try{e.apply(n,m)}catch(x){this.onError(x)}}var vh=!1,_0=null,E0=!1,Hm=null,wR={onError:function(t){vh=!0,_0=t}};function xR(t,e,n,r,i,s,l,h,f){vh=!1,_0=null,yR.apply(wR,arguments)}function _R(t,e,n,r,i,s,l,h,f){if(xR.apply(this,arguments),vh){if(vh){var m=_0;vh=!1,_0=null}else throw Error(ye(198));E0||(E0=!0,Hm=m)}}function Ml(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function CI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Jx(t){if(Ml(t)!==t)throw Error(ye(188))}function ER(t){var e=t.alternate;if(!e){if(e=Ml(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Jx(i),t;if(s===r)return Jx(i),e;s=s.sibling}throw Error(ye(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,h=i.child;h;){if(h===n){l=!0,n=i,r=s;break}if(h===r){l=!0,r=i,n=s;break}h=h.sibling}if(!l){for(h=s.child;h;){if(h===n){l=!0,n=s,r=i;break}if(h===r){l=!0,r=s,n=i;break}h=h.sibling}if(!l)throw Error(ye(189))}}if(n.alternate!==r)throw Error(ye(190))}if(n.tag!==3)throw Error(ye(188));return n.stateNode.current===n?t:e}function SI(t){return t=ER(t),t!==null?bI(t):null}function bI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bI(t);if(e!==null)return e;t=t.sibling}return null}var RI=ci.unstable_scheduleCallback,e_=ci.unstable_cancelCallback,vR=ci.unstable_shouldYield,IR=ci.unstable_requestPaint,bn=ci.unstable_now,AR=ci.unstable_getCurrentPriorityLevel,Sy=ci.unstable_ImmediatePriority,NI=ci.unstable_UserBlockingPriority,v0=ci.unstable_NormalPriority,TR=ci.unstable_LowPriority,PI=ci.unstable_IdlePriority,T1=null,_s=null;function CR(t){if(_s&&typeof _s.onCommitFiberRoot=="function")try{_s.onCommitFiberRoot(T1,t,void 0,(t.current.flags&128)===128)}catch{}}var $i=Math.clz32?Math.clz32:RR,SR=Math.log,bR=Math.LN2;function RR(t){return t>>>=0,t===0?32:31-(SR(t)/bR|0)|0}var _f=64,Ef=4194304;function fh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function I0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var h=l&~i;h!==0?r=fh(h):(s&=l,s!==0&&(r=fh(s)))}else l=n&~i,l!==0?r=fh(l):s!==0&&(r=fh(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-$i(e),i=1<<n,r|=t[n],e&=~i;return r}function NR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-$i(s),h=1<<l,f=i[l];f===-1?(!(h&n)||h&r)&&(i[l]=NR(h,e)):f<=e&&(t.expiredLanes|=h),s&=~h}}function Wm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function DI(){var t=_f;return _f<<=1,!(_f&4194240)&&(_f=64),t}function Vg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Td(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$i(e),t[e]=n}function DR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-$i(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function by(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-$i(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var kt=0;function kI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var OI,Ry,MI,LI,FI,qm=!1,vf=[],ta=null,na=null,ra=null,zh=new Map,Gh=new Map,ko=[],kR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function t_(t,e){switch(t){case"focusin":case"focusout":ta=null;break;case"dragenter":case"dragleave":na=null;break;case"mouseover":case"mouseout":ra=null;break;case"pointerover":case"pointerout":zh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gh.delete(e.pointerId)}}function Ju(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Sd(e),e!==null&&Ry(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function OR(t,e,n,r,i){switch(e){case"focusin":return ta=Ju(ta,t,e,n,r,i),!0;case"dragenter":return na=Ju(na,t,e,n,r,i),!0;case"mouseover":return ra=Ju(ra,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return zh.set(s,Ju(zh.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Gh.set(s,Ju(Gh.get(s)||null,t,e,n,r,i)),!0}return!1}function VI(t){var e=tl(t.target);if(e!==null){var n=Ml(e);if(n!==null){if(e=n.tag,e===13){if(e=CI(n),e!==null){t.blockedOn=e,FI(t.priority,function(){MI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Qf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Km(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);jm=r,n.target.dispatchEvent(r),jm=null}else return e=Sd(n),e!==null&&Ry(e),t.blockedOn=n,!1;e.shift()}return!0}function n_(t,e,n){Qf(t)&&n.delete(e)}function MR(){qm=!1,ta!==null&&Qf(ta)&&(ta=null),na!==null&&Qf(na)&&(na=null),ra!==null&&Qf(ra)&&(ra=null),zh.forEach(n_),Gh.forEach(n_)}function eh(t,e){t.blockedOn===e&&(t.blockedOn=null,qm||(qm=!0,ci.unstable_scheduleCallback(ci.unstable_NormalPriority,MR)))}function Hh(t){function e(i){return eh(i,t)}if(0<vf.length){eh(vf[0],t);for(var n=1;n<vf.length;n++){var r=vf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ta!==null&&eh(ta,t),na!==null&&eh(na,t),ra!==null&&eh(ra,t),zh.forEach(e),Gh.forEach(e),n=0;n<ko.length;n++)r=ko[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ko.length&&(n=ko[0],n.blockedOn===null);)VI(n),n.blockedOn===null&&ko.shift()}var Pc=go.ReactCurrentBatchConfig,A0=!0;function LR(t,e,n,r){var i=kt,s=Pc.transition;Pc.transition=null;try{kt=1,Ny(t,e,n,r)}finally{kt=i,Pc.transition=s}}function FR(t,e,n,r){var i=kt,s=Pc.transition;Pc.transition=null;try{kt=4,Ny(t,e,n,r)}finally{kt=i,Pc.transition=s}}function Ny(t,e,n,r){if(A0){var i=Km(t,e,n,r);if(i===null)$g(t,e,r,T0,n),t_(t,r);else if(OR(i,t,e,n,r))r.stopPropagation();else if(t_(t,r),e&4&&-1<kR.indexOf(t)){for(;i!==null;){var s=Sd(i);if(s!==null&&OI(s),s=Km(t,e,n,r),s===null&&$g(t,e,r,T0,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else $g(t,e,r,null,n)}}var T0=null;function Km(t,e,n,r){if(T0=null,t=Cy(r),t=tl(t),t!==null)if(e=Ml(t),e===null)t=null;else if(n=e.tag,n===13){if(t=CI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return T0=t,null}function BI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AR()){case Sy:return 1;case NI:return 4;case v0:case TR:return 16;case PI:return 536870912;default:return 16}default:return 16}}var Xo=null,Py=null,Xf=null;function UI(){if(Xf)return Xf;var t,e=Py,n=e.length,r,i="value"in Xo?Xo.value:Xo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return Xf=i.slice(t,1<r?1-r:void 0)}function Yf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function If(){return!0}function r_(){return!1}function di(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var h in t)t.hasOwnProperty(h)&&(n=t[h],this[h]=n?n(s):s[h]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?If:r_,this.isPropagationStopped=r_,this}return fn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=If)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=If)},persist:function(){},isPersistent:If}),e}var vu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dy=di(vu),Cd=fn({},vu,{view:0,detail:0}),VR=di(Cd),Bg,Ug,th,C1=fn({},Cd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ky,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==th&&(th&&t.type==="mousemove"?(Bg=t.screenX-th.screenX,Ug=t.screenY-th.screenY):Ug=Bg=0,th=t),Bg)},movementY:function(t){return"movementY"in t?t.movementY:Ug}}),i_=di(C1),BR=fn({},C1,{dataTransfer:0}),UR=di(BR),jR=fn({},Cd,{relatedTarget:0}),jg=di(jR),zR=fn({},vu,{animationName:0,elapsedTime:0,pseudoElement:0}),GR=di(zR),HR=fn({},vu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),WR=di(HR),qR=fn({},vu,{data:0}),s_=di(qR),KR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$R={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=QR[t])?!!e[t]:!1}function ky(){return XR}var YR=fn({},Cd,{key:function(t){if(t.key){var e=KR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Yf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$R[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ky,charCode:function(t){return t.type==="keypress"?Yf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Yf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ZR=di(YR),JR=fn({},C1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),o_=di(JR),eN=fn({},Cd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ky}),tN=di(eN),nN=fn({},vu,{propertyName:0,elapsedTime:0,pseudoElement:0}),rN=di(nN),iN=fn({},C1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sN=di(iN),oN=[9,13,27,32],Oy=ro&&"CompositionEvent"in window,Ih=null;ro&&"documentMode"in document&&(Ih=document.documentMode);var aN=ro&&"TextEvent"in window&&!Ih,jI=ro&&(!Oy||Ih&&8<Ih&&11>=Ih),a_=String.fromCharCode(32),l_=!1;function zI(t,e){switch(t){case"keyup":return oN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var pc=!1;function lN(t,e){switch(t){case"compositionend":return GI(e);case"keypress":return e.which!==32?null:(l_=!0,a_);case"textInput":return t=e.data,t===a_&&l_?null:t;default:return null}}function cN(t,e){if(pc)return t==="compositionend"||!Oy&&zI(t,e)?(t=UI(),Xf=Py=Xo=null,pc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return jI&&e.locale!=="ko"?null:e.data;default:return null}}var uN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!uN[t.type]:e==="textarea"}function HI(t,e,n,r){EI(r),e=C0(e,"onChange"),0<e.length&&(n=new Dy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ah=null,Wh=null;function hN(t){tA(t,0)}function S1(t){var e=xc(t);if(gI(e))return t}function dN(t,e){if(t==="change")return e}var WI=!1;if(ro){var zg;if(ro){var Gg="oninput"in document;if(!Gg){var u_=document.createElement("div");u_.setAttribute("oninput","return;"),Gg=typeof u_.oninput=="function"}zg=Gg}else zg=!1;WI=zg&&(!document.documentMode||9<document.documentMode)}function h_(){Ah&&(Ah.detachEvent("onpropertychange",qI),Wh=Ah=null)}function qI(t){if(t.propertyName==="value"&&S1(Wh)){var e=[];HI(e,Wh,t,Cy(t)),TI(hN,e)}}function fN(t,e,n){t==="focusin"?(h_(),Ah=e,Wh=n,Ah.attachEvent("onpropertychange",qI)):t==="focusout"&&h_()}function gN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return S1(Wh)}function mN(t,e){if(t==="click")return S1(e)}function pN(t,e){if(t==="input"||t==="change")return S1(e)}function yN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Xi=typeof Object.is=="function"?Object.is:yN;function qh(t,e){if(Xi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Rm.call(e,i)||!Xi(t[i],e[i]))return!1}return!0}function d_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function f_(t,e){var n=d_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=d_(n)}}function KI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?KI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function $I(){for(var t=window,e=x0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=x0(t.document)}return e}function My(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wN(t){var e=$I(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&KI(n.ownerDocument.documentElement,n)){if(r!==null&&My(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=f_(n,s);var l=f_(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var xN=ro&&"documentMode"in document&&11>=document.documentMode,yc=null,$m=null,Th=null,Qm=!1;function g_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qm||yc==null||yc!==x0(r)||(r=yc,"selectionStart"in r&&My(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Th&&qh(Th,r)||(Th=r,r=C0($m,"onSelect"),0<r.length&&(e=new Dy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=yc)))}function Af(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wc={animationend:Af("Animation","AnimationEnd"),animationiteration:Af("Animation","AnimationIteration"),animationstart:Af("Animation","AnimationStart"),transitionend:Af("Transition","TransitionEnd")},Hg={},QI={};ro&&(QI=document.createElement("div").style,"AnimationEvent"in window||(delete wc.animationend.animation,delete wc.animationiteration.animation,delete wc.animationstart.animation),"TransitionEvent"in window||delete wc.transitionend.transition);function b1(t){if(Hg[t])return Hg[t];if(!wc[t])return t;var e=wc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in QI)return Hg[t]=e[n];return t}var XI=b1("animationend"),YI=b1("animationiteration"),ZI=b1("animationstart"),JI=b1("transitionend"),eA=new Map,m_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ia(t,e){eA.set(t,e),Ol(e,[t])}for(var Wg=0;Wg<m_.length;Wg++){var qg=m_[Wg],_N=qg.toLowerCase(),EN=qg[0].toUpperCase()+qg.slice(1);Ia(_N,"on"+EN)}Ia(XI,"onAnimationEnd");Ia(YI,"onAnimationIteration");Ia(ZI,"onAnimationStart");Ia("dblclick","onDoubleClick");Ia("focusin","onFocus");Ia("focusout","onBlur");Ia(JI,"onTransitionEnd");Kc("onMouseEnter",["mouseout","mouseover"]);Kc("onMouseLeave",["mouseout","mouseover"]);Kc("onPointerEnter",["pointerout","pointerover"]);Kc("onPointerLeave",["pointerout","pointerover"]);Ol("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ol("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ol("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ol("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ol("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ol("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vN=new Set("cancel close invalid load scroll toggle".split(" ").concat(gh));function p_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,_R(r,e,void 0,t),t.currentTarget=null}function tA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var h=r[l],f=h.instance,m=h.currentTarget;if(h=h.listener,f!==s&&i.isPropagationStopped())break e;p_(i,h,m),s=f}else for(l=0;l<r.length;l++){if(h=r[l],f=h.instance,m=h.currentTarget,h=h.listener,f!==s&&i.isPropagationStopped())break e;p_(i,h,m),s=f}}}if(E0)throw t=Hm,E0=!1,Hm=null,t}function Qt(t,e){var n=e[ep];n===void 0&&(n=e[ep]=new Set);var r=t+"__bubble";n.has(r)||(nA(e,t,2,!1),n.add(r))}function Kg(t,e,n){var r=0;e&&(r|=4),nA(n,t,r,e)}var Tf="_reactListening"+Math.random().toString(36).slice(2);function Kh(t){if(!t[Tf]){t[Tf]=!0,cI.forEach(function(n){n!=="selectionchange"&&(vN.has(n)||Kg(n,!1,t),Kg(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Tf]||(e[Tf]=!0,Kg("selectionchange",!1,e))}}function nA(t,e,n,r){switch(BI(e)){case 1:var i=LR;break;case 4:i=FR;break;default:i=Ny}n=i.bind(null,e,n,t),i=void 0,!Gm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function $g(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var h=r.stateNode.containerInfo;if(h===i||h.nodeType===8&&h.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var f=l.tag;if((f===3||f===4)&&(f=l.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;l=l.return}for(;h!==null;){if(l=tl(h),l===null)return;if(f=l.tag,f===5||f===6){r=s=l;continue e}h=h.parentNode}}r=r.return}TI(function(){var m=s,x=Cy(n),_=[];e:{var I=eA.get(t);if(I!==void 0){var R=Dy,B=t;switch(t){case"keypress":if(Yf(n)===0)break e;case"keydown":case"keyup":R=ZR;break;case"focusin":B="focus",R=jg;break;case"focusout":B="blur",R=jg;break;case"beforeblur":case"afterblur":R=jg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=i_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=UR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=tN;break;case XI:case YI:case ZI:R=GR;break;case JI:R=rN;break;case"scroll":R=VR;break;case"wheel":R=sN;break;case"copy":case"cut":case"paste":R=WR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=o_}var D=(e&4)!==0,G=!D&&t==="scroll",F=D?I!==null?I+"Capture":null:I;D=[];for(var P=m,N;P!==null;){N=P;var H=N.stateNode;if(N.tag===5&&H!==null&&(N=H,F!==null&&(H=jh(P,F),H!=null&&D.push($h(P,H,N)))),G)break;P=P.return}0<D.length&&(I=new R(I,B,null,n,x),_.push({event:I,listeners:D}))}}if(!(e&7)){e:{if(I=t==="mouseover"||t==="pointerover",R=t==="mouseout"||t==="pointerout",I&&n!==jm&&(B=n.relatedTarget||n.fromElement)&&(tl(B)||B[io]))break e;if((R||I)&&(I=x.window===x?x:(I=x.ownerDocument)?I.defaultView||I.parentWindow:window,R?(B=n.relatedTarget||n.toElement,R=m,B=B?tl(B):null,B!==null&&(G=Ml(B),B!==G||B.tag!==5&&B.tag!==6)&&(B=null)):(R=null,B=m),R!==B)){if(D=i_,H="onMouseLeave",F="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(D=o_,H="onPointerLeave",F="onPointerEnter",P="pointer"),G=R==null?I:xc(R),N=B==null?I:xc(B),I=new D(H,P+"leave",R,n,x),I.target=G,I.relatedTarget=N,H=null,tl(x)===m&&(D=new D(F,P+"enter",B,n,x),D.target=N,D.relatedTarget=G,H=D),G=H,R&&B)t:{for(D=R,F=B,P=0,N=D;N;N=rc(N))P++;for(N=0,H=F;H;H=rc(H))N++;for(;0<P-N;)D=rc(D),P--;for(;0<N-P;)F=rc(F),N--;for(;P--;){if(D===F||F!==null&&D===F.alternate)break t;D=rc(D),F=rc(F)}D=null}else D=null;R!==null&&y_(_,I,R,D,!1),B!==null&&G!==null&&y_(_,G,B,D,!0)}}e:{if(I=m?xc(m):window,R=I.nodeName&&I.nodeName.toLowerCase(),R==="select"||R==="input"&&I.type==="file")var Y=dN;else if(c_(I))if(WI)Y=pN;else{Y=gN;var J=fN}else(R=I.nodeName)&&R.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(Y=mN);if(Y&&(Y=Y(t,m))){HI(_,Y,n,x);break e}J&&J(t,I,m),t==="focusout"&&(J=I._wrapperState)&&J.controlled&&I.type==="number"&&Lm(I,"number",I.value)}switch(J=m?xc(m):window,t){case"focusin":(c_(J)||J.contentEditable==="true")&&(yc=J,$m=m,Th=null);break;case"focusout":Th=$m=yc=null;break;case"mousedown":Qm=!0;break;case"contextmenu":case"mouseup":case"dragend":Qm=!1,g_(_,n,x);break;case"selectionchange":if(xN)break;case"keydown":case"keyup":g_(_,n,x)}var k;if(Oy)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else pc?zI(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(jI&&n.locale!=="ko"&&(pc||M!=="onCompositionStart"?M==="onCompositionEnd"&&pc&&(k=UI()):(Xo=x,Py="value"in Xo?Xo.value:Xo.textContent,pc=!0)),J=C0(m,M),0<J.length&&(M=new s_(M,t,null,n,x),_.push({event:M,listeners:J}),k?M.data=k:(k=GI(n),k!==null&&(M.data=k)))),(k=aN?lN(t,n):cN(t,n))&&(m=C0(m,"onBeforeInput"),0<m.length&&(x=new s_("onBeforeInput","beforeinput",null,n,x),_.push({event:x,listeners:m}),x.data=k))}tA(_,e)})}function $h(t,e,n){return{instance:t,listener:e,currentTarget:n}}function C0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=jh(t,n),s!=null&&r.unshift($h(t,s,i)),s=jh(t,e),s!=null&&r.push($h(t,s,i))),t=t.return}return r}function rc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function y_(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var h=n,f=h.alternate,m=h.stateNode;if(f!==null&&f===r)break;h.tag===5&&m!==null&&(h=m,i?(f=jh(n,s),f!=null&&l.unshift($h(n,f,h))):i||(f=jh(n,s),f!=null&&l.push($h(n,f,h)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var IN=/\r\n?/g,AN=/\u0000|\uFFFD/g;function w_(t){return(typeof t=="string"?t:""+t).replace(IN,`
`).replace(AN,"")}function Cf(t,e,n){if(e=w_(e),w_(t)!==e&&n)throw Error(ye(425))}function S0(){}var Xm=null,Ym=null;function Zm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Jm=typeof setTimeout=="function"?setTimeout:void 0,TN=typeof clearTimeout=="function"?clearTimeout:void 0,x_=typeof Promise=="function"?Promise:void 0,CN=typeof queueMicrotask=="function"?queueMicrotask:typeof x_<"u"?function(t){return x_.resolve(null).then(t).catch(SN)}:Jm;function SN(t){setTimeout(function(){throw t})}function Qg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Hh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Hh(e)}function ia(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function __(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Iu=Math.random().toString(36).slice(2),ms="__reactFiber$"+Iu,Qh="__reactProps$"+Iu,io="__reactContainer$"+Iu,ep="__reactEvents$"+Iu,bN="__reactListeners$"+Iu,RN="__reactHandles$"+Iu;function tl(t){var e=t[ms];if(e)return e;for(var n=t.parentNode;n;){if(e=n[io]||n[ms]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=__(t);t!==null;){if(n=t[ms])return n;t=__(t)}return e}t=n,n=t.parentNode}return null}function Sd(t){return t=t[ms]||t[io],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function xc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function R1(t){return t[Qh]||null}var tp=[],_c=-1;function Aa(t){return{current:t}}function Zt(t){0>_c||(t.current=tp[_c],tp[_c]=null,_c--)}function qt(t,e){_c++,tp[_c]=t.current,t.current=e}var fa={},Tr=Aa(fa),$r=Aa(!1),pl=fa;function $c(t,e){var n=t.type.contextTypes;if(!n)return fa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Qr(t){return t=t.childContextTypes,t!=null}function b0(){Zt($r),Zt(Tr)}function E_(t,e,n){if(Tr.current!==fa)throw Error(ye(168));qt(Tr,e),qt($r,n)}function rA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ye(108,fR(t)||"Unknown",i));return fn({},n,r)}function R0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fa,pl=Tr.current,qt(Tr,t),qt($r,$r.current),!0}function v_(t,e,n){var r=t.stateNode;if(!r)throw Error(ye(169));n?(t=rA(t,e,pl),r.__reactInternalMemoizedMergedChildContext=t,Zt($r),Zt(Tr),qt(Tr,t)):Zt($r),qt($r,n)}var $s=null,N1=!1,Xg=!1;function iA(t){$s===null?$s=[t]:$s.push(t)}function NN(t){N1=!0,iA(t)}function Ta(){if(!Xg&&$s!==null){Xg=!0;var t=0,e=kt;try{var n=$s;for(kt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$s=null,N1=!1}catch(i){throw $s!==null&&($s=$s.slice(t+1)),RI(Sy,Ta),i}finally{kt=e,Xg=!1}}return null}var Ec=[],vc=0,N0=null,P0=0,wi=[],xi=0,yl=null,Xs=1,Ys="";function Ka(t,e){Ec[vc++]=P0,Ec[vc++]=N0,N0=t,P0=e}function sA(t,e,n){wi[xi++]=Xs,wi[xi++]=Ys,wi[xi++]=yl,yl=t;var r=Xs;t=Ys;var i=32-$i(r)-1;r&=~(1<<i),n+=1;var s=32-$i(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Xs=1<<32-$i(e)+i|n<<i|r,Ys=s+t}else Xs=1<<s|n<<i|r,Ys=t}function Ly(t){t.return!==null&&(Ka(t,1),sA(t,1,0))}function Fy(t){for(;t===N0;)N0=Ec[--vc],Ec[vc]=null,P0=Ec[--vc],Ec[vc]=null;for(;t===yl;)yl=wi[--xi],wi[xi]=null,Ys=wi[--xi],wi[xi]=null,Xs=wi[--xi],wi[xi]=null}var li=null,ai=null,nn=!1,Gi=null;function oA(t,e){var n=_i(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function I_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,li=t,ai=ia(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,li=t,ai=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=yl!==null?{id:Xs,overflow:Ys}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=_i(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,li=t,ai=null,!0):!1;default:return!1}}function np(t){return(t.mode&1)!==0&&(t.flags&128)===0}function rp(t){if(nn){var e=ai;if(e){var n=e;if(!I_(t,e)){if(np(t))throw Error(ye(418));e=ia(n.nextSibling);var r=li;e&&I_(t,e)?oA(r,n):(t.flags=t.flags&-4097|2,nn=!1,li=t)}}else{if(np(t))throw Error(ye(418));t.flags=t.flags&-4097|2,nn=!1,li=t}}}function A_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;li=t}function Sf(t){if(t!==li)return!1;if(!nn)return A_(t),nn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Zm(t.type,t.memoizedProps)),e&&(e=ai)){if(np(t))throw aA(),Error(ye(418));for(;e;)oA(t,e),e=ia(e.nextSibling)}if(A_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ai=ia(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ai=null}}else ai=li?ia(t.stateNode.nextSibling):null;return!0}function aA(){for(var t=ai;t;)t=ia(t.nextSibling)}function Qc(){ai=li=null,nn=!1}function Vy(t){Gi===null?Gi=[t]:Gi.push(t)}var PN=go.ReactCurrentBatchConfig;function nh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ye(309));var r=n.stateNode}if(!r)throw Error(ye(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var h=i.refs;l===null?delete h[s]:h[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(ye(284));if(!n._owner)throw Error(ye(290,t))}return t}function bf(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function T_(t){var e=t._init;return e(t._payload)}function lA(t){function e(F,P){if(t){var N=F.deletions;N===null?(F.deletions=[P],F.flags|=16):N.push(P)}}function n(F,P){if(!t)return null;for(;P!==null;)e(F,P),P=P.sibling;return null}function r(F,P){for(F=new Map;P!==null;)P.key!==null?F.set(P.key,P):F.set(P.index,P),P=P.sibling;return F}function i(F,P){return F=la(F,P),F.index=0,F.sibling=null,F}function s(F,P,N){return F.index=N,t?(N=F.alternate,N!==null?(N=N.index,N<P?(F.flags|=2,P):N):(F.flags|=2,P)):(F.flags|=1048576,P)}function l(F){return t&&F.alternate===null&&(F.flags|=2),F}function h(F,P,N,H){return P===null||P.tag!==6?(P=rm(N,F.mode,H),P.return=F,P):(P=i(P,N),P.return=F,P)}function f(F,P,N,H){var Y=N.type;return Y===mc?x(F,P,N.props.children,H,N.key):P!==null&&(P.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Po&&T_(Y)===P.type)?(H=i(P,N.props),H.ref=nh(F,P,N),H.return=F,H):(H=i0(N.type,N.key,N.props,null,F.mode,H),H.ref=nh(F,P,N),H.return=F,H)}function m(F,P,N,H){return P===null||P.tag!==4||P.stateNode.containerInfo!==N.containerInfo||P.stateNode.implementation!==N.implementation?(P=im(N,F.mode,H),P.return=F,P):(P=i(P,N.children||[]),P.return=F,P)}function x(F,P,N,H,Y){return P===null||P.tag!==7?(P=fl(N,F.mode,H,Y),P.return=F,P):(P=i(P,N),P.return=F,P)}function _(F,P,N){if(typeof P=="string"&&P!==""||typeof P=="number")return P=rm(""+P,F.mode,N),P.return=F,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case yf:return N=i0(P.type,P.key,P.props,null,F.mode,N),N.ref=nh(F,null,P),N.return=F,N;case gc:return P=im(P,F.mode,N),P.return=F,P;case Po:var H=P._init;return _(F,H(P._payload),N)}if(dh(P)||Yu(P))return P=fl(P,F.mode,N,null),P.return=F,P;bf(F,P)}return null}function I(F,P,N,H){var Y=P!==null?P.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return Y!==null?null:h(F,P,""+N,H);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case yf:return N.key===Y?f(F,P,N,H):null;case gc:return N.key===Y?m(F,P,N,H):null;case Po:return Y=N._init,I(F,P,Y(N._payload),H)}if(dh(N)||Yu(N))return Y!==null?null:x(F,P,N,H,null);bf(F,N)}return null}function R(F,P,N,H,Y){if(typeof H=="string"&&H!==""||typeof H=="number")return F=F.get(N)||null,h(P,F,""+H,Y);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case yf:return F=F.get(H.key===null?N:H.key)||null,f(P,F,H,Y);case gc:return F=F.get(H.key===null?N:H.key)||null,m(P,F,H,Y);case Po:var J=H._init;return R(F,P,N,J(H._payload),Y)}if(dh(H)||Yu(H))return F=F.get(N)||null,x(P,F,H,Y,null);bf(P,H)}return null}function B(F,P,N,H){for(var Y=null,J=null,k=P,M=P=0,L=null;k!==null&&M<N.length;M++){k.index>M?(L=k,k=null):L=k.sibling;var W=I(F,k,N[M],H);if(W===null){k===null&&(k=L);break}t&&k&&W.alternate===null&&e(F,k),P=s(W,P,M),J===null?Y=W:J.sibling=W,J=W,k=L}if(M===N.length)return n(F,k),nn&&Ka(F,M),Y;if(k===null){for(;M<N.length;M++)k=_(F,N[M],H),k!==null&&(P=s(k,P,M),J===null?Y=k:J.sibling=k,J=k);return nn&&Ka(F,M),Y}for(k=r(F,k);M<N.length;M++)L=R(k,F,M,N[M],H),L!==null&&(t&&L.alternate!==null&&k.delete(L.key===null?M:L.key),P=s(L,P,M),J===null?Y=L:J.sibling=L,J=L);return t&&k.forEach(function(K){return e(F,K)}),nn&&Ka(F,M),Y}function D(F,P,N,H){var Y=Yu(N);if(typeof Y!="function")throw Error(ye(150));if(N=Y.call(N),N==null)throw Error(ye(151));for(var J=Y=null,k=P,M=P=0,L=null,W=N.next();k!==null&&!W.done;M++,W=N.next()){k.index>M?(L=k,k=null):L=k.sibling;var K=I(F,k,W.value,H);if(K===null){k===null&&(k=L);break}t&&k&&K.alternate===null&&e(F,k),P=s(K,P,M),J===null?Y=K:J.sibling=K,J=K,k=L}if(W.done)return n(F,k),nn&&Ka(F,M),Y;if(k===null){for(;!W.done;M++,W=N.next())W=_(F,W.value,H),W!==null&&(P=s(W,P,M),J===null?Y=W:J.sibling=W,J=W);return nn&&Ka(F,M),Y}for(k=r(F,k);!W.done;M++,W=N.next())W=R(k,F,M,W.value,H),W!==null&&(t&&W.alternate!==null&&k.delete(W.key===null?M:W.key),P=s(W,P,M),J===null?Y=W:J.sibling=W,J=W);return t&&k.forEach(function(q){return e(F,q)}),nn&&Ka(F,M),Y}function G(F,P,N,H){if(typeof N=="object"&&N!==null&&N.type===mc&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case yf:e:{for(var Y=N.key,J=P;J!==null;){if(J.key===Y){if(Y=N.type,Y===mc){if(J.tag===7){n(F,J.sibling),P=i(J,N.props.children),P.return=F,F=P;break e}}else if(J.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Po&&T_(Y)===J.type){n(F,J.sibling),P=i(J,N.props),P.ref=nh(F,J,N),P.return=F,F=P;break e}n(F,J);break}else e(F,J);J=J.sibling}N.type===mc?(P=fl(N.props.children,F.mode,H,N.key),P.return=F,F=P):(H=i0(N.type,N.key,N.props,null,F.mode,H),H.ref=nh(F,P,N),H.return=F,F=H)}return l(F);case gc:e:{for(J=N.key;P!==null;){if(P.key===J)if(P.tag===4&&P.stateNode.containerInfo===N.containerInfo&&P.stateNode.implementation===N.implementation){n(F,P.sibling),P=i(P,N.children||[]),P.return=F,F=P;break e}else{n(F,P);break}else e(F,P);P=P.sibling}P=im(N,F.mode,H),P.return=F,F=P}return l(F);case Po:return J=N._init,G(F,P,J(N._payload),H)}if(dh(N))return B(F,P,N,H);if(Yu(N))return D(F,P,N,H);bf(F,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,P!==null&&P.tag===6?(n(F,P.sibling),P=i(P,N),P.return=F,F=P):(n(F,P),P=rm(N,F.mode,H),P.return=F,F=P),l(F)):n(F,P)}return G}var Xc=lA(!0),cA=lA(!1),D0=Aa(null),k0=null,Ic=null,By=null;function Uy(){By=Ic=k0=null}function jy(t){var e=D0.current;Zt(D0),t._currentValue=e}function ip(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Dc(t,e){k0=t,By=Ic=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Hr=!0),t.firstContext=null)}function Ai(t){var e=t._currentValue;if(By!==t)if(t={context:t,memoizedValue:e,next:null},Ic===null){if(k0===null)throw Error(ye(308));Ic=t,k0.dependencies={lanes:0,firstContext:t}}else Ic=Ic.next=t;return e}var nl=null;function zy(t){nl===null?nl=[t]:nl.push(t)}function uA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,zy(e)):(n.next=i.next,i.next=n),e.interleaved=n,so(t,r)}function so(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Do=!1;function Gy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function no(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function sa(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,At&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,so(t,n)}return i=r.interleaved,i===null?(e.next=e,zy(r)):(e.next=i.next,i.next=e),r.interleaved=e,so(t,n)}function Zf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,by(t,n)}}function C_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function O0(t,e,n,r){var i=t.updateQueue;Do=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,h=i.shared.pending;if(h!==null){i.shared.pending=null;var f=h,m=f.next;f.next=null,l===null?s=m:l.next=m,l=f;var x=t.alternate;x!==null&&(x=x.updateQueue,h=x.lastBaseUpdate,h!==l&&(h===null?x.firstBaseUpdate=m:h.next=m,x.lastBaseUpdate=f))}if(s!==null){var _=i.baseState;l=0,x=m=f=null,h=s;do{var I=h.lane,R=h.eventTime;if((r&I)===I){x!==null&&(x=x.next={eventTime:R,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var B=t,D=h;switch(I=e,R=n,D.tag){case 1:if(B=D.payload,typeof B=="function"){_=B.call(R,_,I);break e}_=B;break e;case 3:B.flags=B.flags&-65537|128;case 0:if(B=D.payload,I=typeof B=="function"?B.call(R,_,I):B,I==null)break e;_=fn({},_,I);break e;case 2:Do=!0}}h.callback!==null&&h.lane!==0&&(t.flags|=64,I=i.effects,I===null?i.effects=[h]:I.push(h))}else R={eventTime:R,lane:I,tag:h.tag,payload:h.payload,callback:h.callback,next:null},x===null?(m=x=R,f=_):x=x.next=R,l|=I;if(h=h.next,h===null){if(h=i.shared.pending,h===null)break;I=h,h=I.next,I.next=null,i.lastBaseUpdate=I,i.shared.pending=null}}while(1);if(x===null&&(f=_),i.baseState=f,i.firstBaseUpdate=m,i.lastBaseUpdate=x,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);xl|=l,t.lanes=l,t.memoizedState=_}}function S_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ye(191,i));i.call(r)}}}var bd={},Es=Aa(bd),Xh=Aa(bd),Yh=Aa(bd);function rl(t){if(t===bd)throw Error(ye(174));return t}function Hy(t,e){switch(qt(Yh,e),qt(Xh,t),qt(Es,bd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vm(e,t)}Zt(Es),qt(Es,e)}function Yc(){Zt(Es),Zt(Xh),Zt(Yh)}function dA(t){rl(Yh.current);var e=rl(Es.current),n=Vm(e,t.type);e!==n&&(qt(Xh,t),qt(Es,n))}function Wy(t){Xh.current===t&&(Zt(Es),Zt(Xh))}var un=Aa(0);function M0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yg=[];function qy(){for(var t=0;t<Yg.length;t++)Yg[t]._workInProgressVersionPrimary=null;Yg.length=0}var Jf=go.ReactCurrentDispatcher,Zg=go.ReactCurrentBatchConfig,wl=0,hn=null,Hn=null,Jn=null,L0=!1,Ch=!1,Zh=0,DN=0;function yr(){throw Error(ye(321))}function Ky(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Xi(t[n],e[n]))return!1;return!0}function $y(t,e,n,r,i,s){if(wl=s,hn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Jf.current=t===null||t.memoizedState===null?LN:FN,t=n(r,i),Ch){s=0;do{if(Ch=!1,Zh=0,25<=s)throw Error(ye(301));s+=1,Jn=Hn=null,e.updateQueue=null,Jf.current=VN,t=n(r,i)}while(Ch)}if(Jf.current=F0,e=Hn!==null&&Hn.next!==null,wl=0,Jn=Hn=hn=null,L0=!1,e)throw Error(ye(300));return t}function Qy(){var t=Zh!==0;return Zh=0,t}function us(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?hn.memoizedState=Jn=t:Jn=Jn.next=t,Jn}function Ti(){if(Hn===null){var t=hn.alternate;t=t!==null?t.memoizedState:null}else t=Hn.next;var e=Jn===null?hn.memoizedState:Jn.next;if(e!==null)Jn=e,Hn=t;else{if(t===null)throw Error(ye(310));Hn=t,t={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},Jn===null?hn.memoizedState=Jn=t:Jn=Jn.next=t}return Jn}function Jh(t,e){return typeof e=="function"?e(t):e}function Jg(t){var e=Ti(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=Hn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var h=l=null,f=null,m=s;do{var x=m.lane;if((wl&x)===x)f!==null&&(f=f.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:t(r,m.action);else{var _={lane:x,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};f===null?(h=f=_,l=r):f=f.next=_,hn.lanes|=x,xl|=x}m=m.next}while(m!==null&&m!==s);f===null?l=r:f.next=h,Xi(r,e.memoizedState)||(Hr=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=f,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,hn.lanes|=s,xl|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function em(t){var e=Ti(),n=e.queue;if(n===null)throw Error(ye(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);Xi(s,e.memoizedState)||(Hr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function fA(){}function gA(t,e){var n=hn,r=Ti(),i=e(),s=!Xi(r.memoizedState,i);if(s&&(r.memoizedState=i,Hr=!0),r=r.queue,Xy(yA.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Jn!==null&&Jn.memoizedState.tag&1){if(n.flags|=2048,ed(9,pA.bind(null,n,r,i,e),void 0,null),tr===null)throw Error(ye(349));wl&30||mA(n,e,i)}return i}function mA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=hn.updateQueue,e===null?(e={lastEffect:null,stores:null},hn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pA(t,e,n,r){e.value=n,e.getSnapshot=r,wA(e)&&xA(t)}function yA(t,e,n){return n(function(){wA(e)&&xA(t)})}function wA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Xi(t,n)}catch{return!0}}function xA(t){var e=so(t,1);e!==null&&Qi(e,t,1,-1)}function b_(t){var e=us();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Jh,lastRenderedState:t},e.queue=t,t=t.dispatch=MN.bind(null,hn,t),[e.memoizedState,t]}function ed(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=hn.updateQueue,e===null?(e={lastEffect:null,stores:null},hn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function _A(){return Ti().memoizedState}function e0(t,e,n,r){var i=us();hn.flags|=t,i.memoizedState=ed(1|e,n,void 0,r===void 0?null:r)}function P1(t,e,n,r){var i=Ti();r=r===void 0?null:r;var s=void 0;if(Hn!==null){var l=Hn.memoizedState;if(s=l.destroy,r!==null&&Ky(r,l.deps)){i.memoizedState=ed(e,n,s,r);return}}hn.flags|=t,i.memoizedState=ed(1|e,n,s,r)}function R_(t,e){return e0(8390656,8,t,e)}function Xy(t,e){return P1(2048,8,t,e)}function EA(t,e){return P1(4,2,t,e)}function vA(t,e){return P1(4,4,t,e)}function IA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function AA(t,e,n){return n=n!=null?n.concat([t]):null,P1(4,4,IA.bind(null,e,t),n)}function Yy(){}function TA(t,e){var n=Ti();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ky(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function CA(t,e){var n=Ti();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ky(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function SA(t,e,n){return wl&21?(Xi(n,e)||(n=DI(),hn.lanes|=n,xl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Hr=!0),t.memoizedState=n)}function kN(t,e){var n=kt;kt=n!==0&&4>n?n:4,t(!0);var r=Zg.transition;Zg.transition={};try{t(!1),e()}finally{kt=n,Zg.transition=r}}function bA(){return Ti().memoizedState}function ON(t,e,n){var r=aa(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},RA(t))NA(e,n);else if(n=uA(t,e,n,r),n!==null){var i=Dr();Qi(n,t,r,i),PA(n,e,r)}}function MN(t,e,n){var r=aa(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(RA(t))NA(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,h=s(l,n);if(i.hasEagerState=!0,i.eagerState=h,Xi(h,l)){var f=e.interleaved;f===null?(i.next=i,zy(e)):(i.next=f.next,f.next=i),e.interleaved=i;return}}catch{}finally{}n=uA(t,e,i,r),n!==null&&(i=Dr(),Qi(n,t,r,i),PA(n,e,r))}}function RA(t){var e=t.alternate;return t===hn||e!==null&&e===hn}function NA(t,e){Ch=L0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function PA(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,by(t,n)}}var F0={readContext:Ai,useCallback:yr,useContext:yr,useEffect:yr,useImperativeHandle:yr,useInsertionEffect:yr,useLayoutEffect:yr,useMemo:yr,useReducer:yr,useRef:yr,useState:yr,useDebugValue:yr,useDeferredValue:yr,useTransition:yr,useMutableSource:yr,useSyncExternalStore:yr,useId:yr,unstable_isNewReconciler:!1},LN={readContext:Ai,useCallback:function(t,e){return us().memoizedState=[t,e===void 0?null:e],t},useContext:Ai,useEffect:R_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,e0(4194308,4,IA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return e0(4194308,4,t,e)},useInsertionEffect:function(t,e){return e0(4,2,t,e)},useMemo:function(t,e){var n=us();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=us();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ON.bind(null,hn,t),[r.memoizedState,t]},useRef:function(t){var e=us();return t={current:t},e.memoizedState=t},useState:b_,useDebugValue:Yy,useDeferredValue:function(t){return us().memoizedState=t},useTransition:function(){var t=b_(!1),e=t[0];return t=kN.bind(null,t[1]),us().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=hn,i=us();if(nn){if(n===void 0)throw Error(ye(407));n=n()}else{if(n=e(),tr===null)throw Error(ye(349));wl&30||mA(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,R_(yA.bind(null,r,s,t),[t]),r.flags|=2048,ed(9,pA.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=us(),e=tr.identifierPrefix;if(nn){var n=Ys,r=Xs;n=(r&~(1<<32-$i(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Zh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=DN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},FN={readContext:Ai,useCallback:TA,useContext:Ai,useEffect:Xy,useImperativeHandle:AA,useInsertionEffect:EA,useLayoutEffect:vA,useMemo:CA,useReducer:Jg,useRef:_A,useState:function(){return Jg(Jh)},useDebugValue:Yy,useDeferredValue:function(t){var e=Ti();return SA(e,Hn.memoizedState,t)},useTransition:function(){var t=Jg(Jh)[0],e=Ti().memoizedState;return[t,e]},useMutableSource:fA,useSyncExternalStore:gA,useId:bA,unstable_isNewReconciler:!1},VN={readContext:Ai,useCallback:TA,useContext:Ai,useEffect:Xy,useImperativeHandle:AA,useInsertionEffect:EA,useLayoutEffect:vA,useMemo:CA,useReducer:em,useRef:_A,useState:function(){return em(Jh)},useDebugValue:Yy,useDeferredValue:function(t){var e=Ti();return Hn===null?e.memoizedState=t:SA(e,Hn.memoizedState,t)},useTransition:function(){var t=em(Jh)[0],e=Ti().memoizedState;return[t,e]},useMutableSource:fA,useSyncExternalStore:gA,useId:bA,unstable_isNewReconciler:!1};function Vi(t,e){if(t&&t.defaultProps){e=fn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function sp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:fn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var D1={isMounted:function(t){return(t=t._reactInternals)?Ml(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Dr(),i=aa(t),s=no(r,i);s.payload=e,n!=null&&(s.callback=n),e=sa(t,s,i),e!==null&&(Qi(e,t,i,r),Zf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Dr(),i=aa(t),s=no(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=sa(t,s,i),e!==null&&(Qi(e,t,i,r),Zf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Dr(),r=aa(t),i=no(n,r);i.tag=2,e!=null&&(i.callback=e),e=sa(t,i,r),e!==null&&(Qi(e,t,r,n),Zf(e,t,r))}};function N_(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!qh(n,r)||!qh(i,s):!0}function DA(t,e,n){var r=!1,i=fa,s=e.contextType;return typeof s=="object"&&s!==null?s=Ai(s):(i=Qr(e)?pl:Tr.current,r=e.contextTypes,s=(r=r!=null)?$c(t,i):fa),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=D1,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function P_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&D1.enqueueReplaceState(e,e.state,null)}function op(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Gy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ai(s):(s=Qr(e)?pl:Tr.current,i.context=$c(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(sp(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&D1.enqueueReplaceState(i,i.state,null),O0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Zc(t,e){try{var n="",r=e;do n+=dR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function tm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ap(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var BN=typeof WeakMap=="function"?WeakMap:Map;function kA(t,e,n){n=no(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){B0||(B0=!0,yp=r),ap(t,e)},n}function OA(t,e,n){n=no(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ap(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ap(t,e),typeof r!="function"&&(oa===null?oa=new Set([this]):oa.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function D_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new BN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=JN.bind(null,t,e,n),e.then(t,t))}function k_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function O_(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=no(-1,1),e.tag=2,sa(n,e,1))),n.lanes|=1),t)}var UN=go.ReactCurrentOwner,Hr=!1;function Rr(t,e,n,r){e.child=t===null?cA(e,null,n,r):Xc(e,t.child,n,r)}function M_(t,e,n,r,i){n=n.render;var s=e.ref;return Dc(e,i),r=$y(t,e,n,r,s,i),n=Qy(),t!==null&&!Hr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oo(t,e,i)):(nn&&n&&Ly(e),e.flags|=1,Rr(t,e,r,i),e.child)}function L_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!sw(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,MA(t,e,s,r,i)):(t=i0(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:qh,n(l,r)&&t.ref===e.ref)return oo(t,e,i)}return e.flags|=1,t=la(s,r),t.ref=e.ref,t.return=e,e.child=t}function MA(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(qh(s,r)&&t.ref===e.ref)if(Hr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Hr=!0);else return e.lanes=t.lanes,oo(t,e,i)}return lp(t,e,n,r,i)}function LA(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(Tc,si),si|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,qt(Tc,si),si|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,qt(Tc,si),si|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,qt(Tc,si),si|=r;return Rr(t,e,i,n),e.child}function FA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function lp(t,e,n,r,i){var s=Qr(n)?pl:Tr.current;return s=$c(e,s),Dc(e,i),n=$y(t,e,n,r,s,i),r=Qy(),t!==null&&!Hr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,oo(t,e,i)):(nn&&r&&Ly(e),e.flags|=1,Rr(t,e,n,i),e.child)}function F_(t,e,n,r,i){if(Qr(n)){var s=!0;R0(e)}else s=!1;if(Dc(e,i),e.stateNode===null)t0(t,e),DA(e,n,r),op(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,h=e.memoizedProps;l.props=h;var f=l.context,m=n.contextType;typeof m=="object"&&m!==null?m=Ai(m):(m=Qr(n)?pl:Tr.current,m=$c(e,m));var x=n.getDerivedStateFromProps,_=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function";_||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==r||f!==m)&&P_(e,l,r,m),Do=!1;var I=e.memoizedState;l.state=I,O0(e,r,l,i),f=e.memoizedState,h!==r||I!==f||$r.current||Do?(typeof x=="function"&&(sp(e,n,x,r),f=e.memoizedState),(h=Do||N_(e,n,h,r,I,f,m))?(_||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=f),l.props=r,l.state=f,l.context=m,r=h):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,hA(t,e),h=e.memoizedProps,m=e.type===e.elementType?h:Vi(e.type,h),l.props=m,_=e.pendingProps,I=l.context,f=n.contextType,typeof f=="object"&&f!==null?f=Ai(f):(f=Qr(n)?pl:Tr.current,f=$c(e,f));var R=n.getDerivedStateFromProps;(x=typeof R=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==_||I!==f)&&P_(e,l,r,f),Do=!1,I=e.memoizedState,l.state=I,O0(e,r,l,i);var B=e.memoizedState;h!==_||I!==B||$r.current||Do?(typeof R=="function"&&(sp(e,n,R,r),B=e.memoizedState),(m=Do||N_(e,n,m,r,I,B,f)||!1)?(x||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,B,f),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,B,f)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=B),l.props=r,l.state=B,l.context=f,r=m):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&I===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&I===t.memoizedState||(e.flags|=1024),r=!1)}return cp(t,e,n,r,s,i)}function cp(t,e,n,r,i,s){FA(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&v_(e,n,!1),oo(t,e,s);r=e.stateNode,UN.current=e;var h=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=Xc(e,t.child,null,s),e.child=Xc(e,null,h,s)):Rr(t,e,h,s),e.memoizedState=r.state,i&&v_(e,n,!0),e.child}function VA(t){var e=t.stateNode;e.pendingContext?E_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&E_(t,e.context,!1),Hy(t,e.containerInfo)}function V_(t,e,n,r,i){return Qc(),Vy(i),e.flags|=256,Rr(t,e,n,r),e.child}var up={dehydrated:null,treeContext:null,retryLane:0};function hp(t){return{baseLanes:t,cachePool:null,transitions:null}}function BA(t,e,n){var r=e.pendingProps,i=un.current,s=!1,l=(e.flags&128)!==0,h;if((h=l)||(h=t!==null&&t.memoizedState===null?!1:(i&2)!==0),h?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),qt(un,i&1),t===null)return rp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=M1(l,r,0,null),t=fl(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=hp(n),e.memoizedState=up,t):Zy(e,l));if(i=t.memoizedState,i!==null&&(h=i.dehydrated,h!==null))return jN(t,e,l,r,h,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,h=i.sibling;var f={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=f,e.deletions=null):(r=la(i,f),r.subtreeFlags=i.subtreeFlags&14680064),h!==null?s=la(h,s):(s=fl(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?hp(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=up,r}return s=t.child,t=s.sibling,r=la(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Zy(t,e){return e=M1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rf(t,e,n,r){return r!==null&&Vy(r),Xc(e,t.child,null,n),t=Zy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function jN(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=tm(Error(ye(422))),Rf(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=M1({mode:"visible",children:r.children},i,0,null),s=fl(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Xc(e,t.child,null,l),e.child.memoizedState=hp(l),e.memoizedState=up,s);if(!(e.mode&1))return Rf(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var h=r.dgst;return r=h,s=Error(ye(419)),r=tm(s,r,void 0),Rf(t,e,l,r)}if(h=(l&t.childLanes)!==0,Hr||h){if(r=tr,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,so(t,i),Qi(r,t,i,-1))}return iw(),r=tm(Error(ye(421))),Rf(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=e4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ai=ia(i.nextSibling),li=e,nn=!0,Gi=null,t!==null&&(wi[xi++]=Xs,wi[xi++]=Ys,wi[xi++]=yl,Xs=t.id,Ys=t.overflow,yl=e),e=Zy(e,r.children),e.flags|=4096,e)}function B_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ip(t.return,e,n)}function nm(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function UA(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Rr(t,e,r.children,n),r=un.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&B_(t,n,e);else if(t.tag===19)B_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(qt(un,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&M0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),nm(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&M0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}nm(e,!0,n,null,s);break;case"together":nm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function t0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function oo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,n=la(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=la(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function zN(t,e,n){switch(e.tag){case 3:VA(e),Qc();break;case 5:dA(e);break;case 1:Qr(e.type)&&R0(e);break;case 4:Hy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;qt(D0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(qt(un,un.current&1),e.flags|=128,null):n&e.child.childLanes?BA(t,e,n):(qt(un,un.current&1),t=oo(t,e,n),t!==null?t.sibling:null);qt(un,un.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return UA(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),qt(un,un.current),r)break;return null;case 22:case 23:return e.lanes=0,LA(t,e,n)}return oo(t,e,n)}var jA,dp,zA,GA;jA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};dp=function(){};zA=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,rl(Es.current);var s=null;switch(n){case"input":i=Om(t,i),r=Om(t,r),s=[];break;case"select":i=fn({},i,{value:void 0}),r=fn({},r,{value:void 0}),s=[];break;case"textarea":i=Fm(t,i),r=Fm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=S0)}Bm(n,r);var l;n=null;for(m in i)if(!r.hasOwnProperty(m)&&i.hasOwnProperty(m)&&i[m]!=null)if(m==="style"){var h=i[m];for(l in h)h.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Bh.hasOwnProperty(m)?s||(s=[]):(s=s||[]).push(m,null));for(m in r){var f=r[m];if(h=i!=null?i[m]:void 0,r.hasOwnProperty(m)&&f!==h&&(f!=null||h!=null))if(m==="style")if(h){for(l in h)!h.hasOwnProperty(l)||f&&f.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in f)f.hasOwnProperty(l)&&h[l]!==f[l]&&(n||(n={}),n[l]=f[l])}else n||(s||(s=[]),s.push(m,n)),n=f;else m==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,h=h?h.__html:void 0,f!=null&&h!==f&&(s=s||[]).push(m,f)):m==="children"?typeof f!="string"&&typeof f!="number"||(s=s||[]).push(m,""+f):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(Bh.hasOwnProperty(m)?(f!=null&&m==="onScroll"&&Qt("scroll",t),s||h===f||(s=[])):(s=s||[]).push(m,f))}n&&(s=s||[]).push("style",n);var m=s;(e.updateQueue=m)&&(e.flags|=4)}};GA=function(t,e,n,r){n!==r&&(e.flags|=4)};function rh(t,e){if(!nn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function wr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function GN(t,e,n){var r=e.pendingProps;switch(Fy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(e),null;case 1:return Qr(e.type)&&b0(),wr(e),null;case 3:return r=e.stateNode,Yc(),Zt($r),Zt(Tr),qy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Sf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gi!==null&&(_p(Gi),Gi=null))),dp(t,e),wr(e),null;case 5:Wy(e);var i=rl(Yh.current);if(n=e.type,t!==null&&e.stateNode!=null)zA(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ye(166));return wr(e),null}if(t=rl(Es.current),Sf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[ms]=e,r[Qh]=s,t=(e.mode&1)!==0,n){case"dialog":Qt("cancel",r),Qt("close",r);break;case"iframe":case"object":case"embed":Qt("load",r);break;case"video":case"audio":for(i=0;i<gh.length;i++)Qt(gh[i],r);break;case"source":Qt("error",r);break;case"img":case"image":case"link":Qt("error",r),Qt("load",r);break;case"details":Qt("toggle",r);break;case"input":$x(r,s),Qt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Qt("invalid",r);break;case"textarea":Xx(r,s),Qt("invalid",r)}Bm(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var h=s[l];l==="children"?typeof h=="string"?r.textContent!==h&&(s.suppressHydrationWarning!==!0&&Cf(r.textContent,h,t),i=["children",h]):typeof h=="number"&&r.textContent!==""+h&&(s.suppressHydrationWarning!==!0&&Cf(r.textContent,h,t),i=["children",""+h]):Bh.hasOwnProperty(l)&&h!=null&&l==="onScroll"&&Qt("scroll",r)}switch(n){case"input":wf(r),Qx(r,s,!0);break;case"textarea":wf(r),Yx(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=S0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[ms]=e,t[Qh]=r,jA(t,e,!1,!1),e.stateNode=t;e:{switch(l=Um(n,r),n){case"dialog":Qt("cancel",t),Qt("close",t),i=r;break;case"iframe":case"object":case"embed":Qt("load",t),i=r;break;case"video":case"audio":for(i=0;i<gh.length;i++)Qt(gh[i],t);i=r;break;case"source":Qt("error",t),i=r;break;case"img":case"image":case"link":Qt("error",t),Qt("load",t),i=r;break;case"details":Qt("toggle",t),i=r;break;case"input":$x(t,r),i=Om(t,r),Qt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=fn({},r,{value:void 0}),Qt("invalid",t);break;case"textarea":Xx(t,r),i=Fm(t,r),Qt("invalid",t);break;default:i=r}Bm(n,i),h=i;for(s in h)if(h.hasOwnProperty(s)){var f=h[s];s==="style"?_I(t,f):s==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&wI(t,f)):s==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&Uh(t,f):typeof f=="number"&&Uh(t,""+f):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Bh.hasOwnProperty(s)?f!=null&&s==="onScroll"&&Qt("scroll",t):f!=null&&vy(t,s,f,l))}switch(n){case"input":wf(t),Qx(t,r,!1);break;case"textarea":wf(t),Yx(t);break;case"option":r.value!=null&&t.setAttribute("value",""+da(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?bc(t,!!r.multiple,s,!1):r.defaultValue!=null&&bc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=S0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return wr(e),null;case 6:if(t&&e.stateNode!=null)GA(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ye(166));if(n=rl(Yh.current),rl(Es.current),Sf(e)){if(r=e.stateNode,n=e.memoizedProps,r[ms]=e,(s=r.nodeValue!==n)&&(t=li,t!==null))switch(t.tag){case 3:Cf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ms]=e,e.stateNode=r}return wr(e),null;case 13:if(Zt(un),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(nn&&ai!==null&&e.mode&1&&!(e.flags&128))aA(),Qc(),e.flags|=98560,s=!1;else if(s=Sf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ye(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ye(317));s[ms]=e}else Qc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;wr(e),s=!1}else Gi!==null&&(_p(Gi),Gi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||un.current&1?qn===0&&(qn=3):iw())),e.updateQueue!==null&&(e.flags|=4),wr(e),null);case 4:return Yc(),dp(t,e),t===null&&Kh(e.stateNode.containerInfo),wr(e),null;case 10:return jy(e.type._context),wr(e),null;case 17:return Qr(e.type)&&b0(),wr(e),null;case 19:if(Zt(un),s=e.memoizedState,s===null)return wr(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)rh(s,!1);else{if(qn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=M0(t),l!==null){for(e.flags|=128,rh(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return qt(un,un.current&1|2),e.child}t=t.sibling}s.tail!==null&&bn()>Jc&&(e.flags|=128,r=!0,rh(s,!1),e.lanes=4194304)}else{if(!r)if(t=M0(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!nn)return wr(e),null}else 2*bn()-s.renderingStartTime>Jc&&n!==1073741824&&(e.flags|=128,r=!0,rh(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=bn(),e.sibling=null,n=un.current,qt(un,r?n&1|2:n&1),e):(wr(e),null);case 22:case 23:return rw(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?si&1073741824&&(wr(e),e.subtreeFlags&6&&(e.flags|=8192)):wr(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function HN(t,e){switch(Fy(e),e.tag){case 1:return Qr(e.type)&&b0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yc(),Zt($r),Zt(Tr),qy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Wy(e),null;case 13:if(Zt(un),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));Qc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Zt(un),null;case 4:return Yc(),null;case 10:return jy(e.type._context),null;case 22:case 23:return rw(),null;case 24:return null;default:return null}}var Nf=!1,vr=!1,WN=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function Ac(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){En(t,e,r)}else n.current=null}function fp(t,e,n){try{n()}catch(r){En(t,e,r)}}var U_=!1;function qN(t,e){if(Xm=A0,t=$I(),My(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,h=-1,f=-1,m=0,x=0,_=t,I=null;t:for(;;){for(var R;_!==n||i!==0&&_.nodeType!==3||(h=l+i),_!==s||r!==0&&_.nodeType!==3||(f=l+r),_.nodeType===3&&(l+=_.nodeValue.length),(R=_.firstChild)!==null;)I=_,_=R;for(;;){if(_===t)break t;if(I===n&&++m===i&&(h=l),I===s&&++x===r&&(f=l),(R=_.nextSibling)!==null)break;_=I,I=_.parentNode}_=R}n=h===-1||f===-1?null:{start:h,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ym={focusedElem:t,selectionRange:n},A0=!1,Pe=e;Pe!==null;)if(e=Pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Pe=t;else for(;Pe!==null;){e=Pe;try{var B=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var D=B.memoizedProps,G=B.memoizedState,F=e.stateNode,P=F.getSnapshotBeforeUpdate(e.elementType===e.type?D:Vi(e.type,D),G);F.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(H){En(e,e.return,H)}if(t=e.sibling,t!==null){t.return=e.return,Pe=t;break}Pe=e.return}return B=U_,U_=!1,B}function Sh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&fp(e,n,s)}i=i.next}while(i!==r)}}function k1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function HA(t){var e=t.alternate;e!==null&&(t.alternate=null,HA(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ms],delete e[Qh],delete e[ep],delete e[bN],delete e[RN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function WA(t){return t.tag===5||t.tag===3||t.tag===4}function j_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||WA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function mp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=S0));else if(r!==4&&(t=t.child,t!==null))for(mp(t,e,n),t=t.sibling;t!==null;)mp(t,e,n),t=t.sibling}function pp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pp(t,e,n),t=t.sibling;t!==null;)pp(t,e,n),t=t.sibling}var ar=null,zi=!1;function Co(t,e,n){for(n=n.child;n!==null;)qA(t,e,n),n=n.sibling}function qA(t,e,n){if(_s&&typeof _s.onCommitFiberUnmount=="function")try{_s.onCommitFiberUnmount(T1,n)}catch{}switch(n.tag){case 5:vr||Ac(n,e);case 6:var r=ar,i=zi;ar=null,Co(t,e,n),ar=r,zi=i,ar!==null&&(zi?(t=ar,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ar.removeChild(n.stateNode));break;case 18:ar!==null&&(zi?(t=ar,n=n.stateNode,t.nodeType===8?Qg(t.parentNode,n):t.nodeType===1&&Qg(t,n),Hh(t)):Qg(ar,n.stateNode));break;case 4:r=ar,i=zi,ar=n.stateNode.containerInfo,zi=!0,Co(t,e,n),ar=r,zi=i;break;case 0:case 11:case 14:case 15:if(!vr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&fp(n,e,l),i=i.next}while(i!==r)}Co(t,e,n);break;case 1:if(!vr&&(Ac(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(h){En(n,e,h)}Co(t,e,n);break;case 21:Co(t,e,n);break;case 22:n.mode&1?(vr=(r=vr)||n.memoizedState!==null,Co(t,e,n),vr=r):Co(t,e,n);break;default:Co(t,e,n)}}function z_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new WN),e.forEach(function(r){var i=t4.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Fi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,h=l;e:for(;h!==null;){switch(h.tag){case 5:ar=h.stateNode,zi=!1;break e;case 3:ar=h.stateNode.containerInfo,zi=!0;break e;case 4:ar=h.stateNode.containerInfo,zi=!0;break e}h=h.return}if(ar===null)throw Error(ye(160));qA(s,l,i),ar=null,zi=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(m){En(i,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)KA(e,t),e=e.sibling}function KA(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Fi(e,t),cs(t),r&4){try{Sh(3,t,t.return),k1(3,t)}catch(D){En(t,t.return,D)}try{Sh(5,t,t.return)}catch(D){En(t,t.return,D)}}break;case 1:Fi(e,t),cs(t),r&512&&n!==null&&Ac(n,n.return);break;case 5:if(Fi(e,t),cs(t),r&512&&n!==null&&Ac(n,n.return),t.flags&32){var i=t.stateNode;try{Uh(i,"")}catch(D){En(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,h=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{h==="input"&&s.type==="radio"&&s.name!=null&&mI(i,s),Um(h,l);var m=Um(h,s);for(l=0;l<f.length;l+=2){var x=f[l],_=f[l+1];x==="style"?_I(i,_):x==="dangerouslySetInnerHTML"?wI(i,_):x==="children"?Uh(i,_):vy(i,x,_,m)}switch(h){case"input":Mm(i,s);break;case"textarea":pI(i,s);break;case"select":var I=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var R=s.value;R!=null?bc(i,!!s.multiple,R,!1):I!==!!s.multiple&&(s.defaultValue!=null?bc(i,!!s.multiple,s.defaultValue,!0):bc(i,!!s.multiple,s.multiple?[]:"",!1))}i[Qh]=s}catch(D){En(t,t.return,D)}}break;case 6:if(Fi(e,t),cs(t),r&4){if(t.stateNode===null)throw Error(ye(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(D){En(t,t.return,D)}}break;case 3:if(Fi(e,t),cs(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hh(e.containerInfo)}catch(D){En(t,t.return,D)}break;case 4:Fi(e,t),cs(t);break;case 13:Fi(e,t),cs(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(tw=bn())),r&4&&z_(t);break;case 22:if(x=n!==null&&n.memoizedState!==null,t.mode&1?(vr=(m=vr)||x,Fi(e,t),vr=m):Fi(e,t),cs(t),r&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!x&&t.mode&1)for(Pe=t,x=t.child;x!==null;){for(_=Pe=x;Pe!==null;){switch(I=Pe,R=I.child,I.tag){case 0:case 11:case 14:case 15:Sh(4,I,I.return);break;case 1:Ac(I,I.return);var B=I.stateNode;if(typeof B.componentWillUnmount=="function"){r=I,n=I.return;try{e=r,B.props=e.memoizedProps,B.state=e.memoizedState,B.componentWillUnmount()}catch(D){En(r,n,D)}}break;case 5:Ac(I,I.return);break;case 22:if(I.memoizedState!==null){H_(_);continue}}R!==null?(R.return=I,Pe=R):H_(_)}x=x.sibling}e:for(x=null,_=t;;){if(_.tag===5){if(x===null){x=_;try{i=_.stateNode,m?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(h=_.stateNode,f=_.memoizedProps.style,l=f!=null&&f.hasOwnProperty("display")?f.display:null,h.style.display=xI("display",l))}catch(D){En(t,t.return,D)}}}else if(_.tag===6){if(x===null)try{_.stateNode.nodeValue=m?"":_.memoizedProps}catch(D){En(t,t.return,D)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===t)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===t)break e;for(;_.sibling===null;){if(_.return===null||_.return===t)break e;x===_&&(x=null),_=_.return}x===_&&(x=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:Fi(e,t),cs(t),r&4&&z_(t);break;case 21:break;default:Fi(e,t),cs(t)}}function cs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(WA(n)){var r=n;break e}n=n.return}throw Error(ye(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Uh(i,""),r.flags&=-33);var s=j_(t);pp(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,h=j_(t);mp(t,h,l);break;default:throw Error(ye(161))}}catch(f){En(t,t.return,f)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function KN(t,e,n){Pe=t,$A(t)}function $A(t,e,n){for(var r=(t.mode&1)!==0;Pe!==null;){var i=Pe,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||Nf;if(!l){var h=i.alternate,f=h!==null&&h.memoizedState!==null||vr;h=Nf;var m=vr;if(Nf=l,(vr=f)&&!m)for(Pe=i;Pe!==null;)l=Pe,f=l.child,l.tag===22&&l.memoizedState!==null?W_(i):f!==null?(f.return=l,Pe=f):W_(i);for(;s!==null;)Pe=s,$A(s),s=s.sibling;Pe=i,Nf=h,vr=m}G_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Pe=s):G_(t)}}function G_(t){for(;Pe!==null;){var e=Pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vr||k1(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!vr)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Vi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&S_(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}S_(e,l,n)}break;case 5:var h=e.stateNode;if(n===null&&e.flags&4){n=h;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var x=m.memoizedState;if(x!==null){var _=x.dehydrated;_!==null&&Hh(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}vr||e.flags&512&&gp(e)}catch(I){En(e,e.return,I)}}if(e===t){Pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Pe=n;break}Pe=e.return}}function H_(t){for(;Pe!==null;){var e=Pe;if(e===t){Pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Pe=n;break}Pe=e.return}}function W_(t){for(;Pe!==null;){var e=Pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{k1(4,e)}catch(f){En(e,n,f)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(f){En(e,i,f)}}var s=e.return;try{gp(e)}catch(f){En(e,s,f)}break;case 5:var l=e.return;try{gp(e)}catch(f){En(e,l,f)}}}catch(f){En(e,e.return,f)}if(e===t){Pe=null;break}var h=e.sibling;if(h!==null){h.return=e.return,Pe=h;break}Pe=e.return}}var $N=Math.ceil,V0=go.ReactCurrentDispatcher,Jy=go.ReactCurrentOwner,vi=go.ReactCurrentBatchConfig,At=0,tr=null,Fn=null,ur=0,si=0,Tc=Aa(0),qn=0,td=null,xl=0,O1=0,ew=0,bh=null,Gr=null,tw=0,Jc=1/0,Ks=null,B0=!1,yp=null,oa=null,Pf=!1,Yo=null,U0=0,Rh=0,wp=null,n0=-1,r0=0;function Dr(){return At&6?bn():n0!==-1?n0:n0=bn()}function aa(t){return t.mode&1?At&2&&ur!==0?ur&-ur:PN.transition!==null?(r0===0&&(r0=DI()),r0):(t=kt,t!==0||(t=window.event,t=t===void 0?16:BI(t.type)),t):1}function Qi(t,e,n,r){if(50<Rh)throw Rh=0,wp=null,Error(ye(185));Td(t,n,r),(!(At&2)||t!==tr)&&(t===tr&&(!(At&2)&&(O1|=n),qn===4&&Oo(t,ur)),Xr(t,r),n===1&&At===0&&!(e.mode&1)&&(Jc=bn()+500,N1&&Ta()))}function Xr(t,e){var n=t.callbackNode;PR(t,e);var r=I0(t,t===tr?ur:0);if(r===0)n!==null&&e_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&e_(n),e===1)t.tag===0?NN(q_.bind(null,t)):iA(q_.bind(null,t)),CN(function(){!(At&6)&&Ta()}),n=null;else{switch(kI(r)){case 1:n=Sy;break;case 4:n=NI;break;case 16:n=v0;break;case 536870912:n=PI;break;default:n=v0}n=nT(n,QA.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function QA(t,e){if(n0=-1,r0=0,At&6)throw Error(ye(327));var n=t.callbackNode;if(kc()&&t.callbackNode!==n)return null;var r=I0(t,t===tr?ur:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=j0(t,r);else{e=r;var i=At;At|=2;var s=YA();(tr!==t||ur!==e)&&(Ks=null,Jc=bn()+500,dl(t,e));do try{YN();break}catch(h){XA(t,h)}while(1);Uy(),V0.current=s,At=i,Fn!==null?e=0:(tr=null,ur=0,e=qn)}if(e!==0){if(e===2&&(i=Wm(t),i!==0&&(r=i,e=xp(t,i))),e===1)throw n=td,dl(t,0),Oo(t,r),Xr(t,bn()),n;if(e===6)Oo(t,r);else{if(i=t.current.alternate,!(r&30)&&!QN(i)&&(e=j0(t,r),e===2&&(s=Wm(t),s!==0&&(r=s,e=xp(t,s))),e===1))throw n=td,dl(t,0),Oo(t,r),Xr(t,bn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ye(345));case 2:$a(t,Gr,Ks);break;case 3:if(Oo(t,r),(r&130023424)===r&&(e=tw+500-bn(),10<e)){if(I0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Dr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Jm($a.bind(null,t,Gr,Ks),e);break}$a(t,Gr,Ks);break;case 4:if(Oo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-$i(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=bn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*$N(r/1960))-r,10<r){t.timeoutHandle=Jm($a.bind(null,t,Gr,Ks),r);break}$a(t,Gr,Ks);break;case 5:$a(t,Gr,Ks);break;default:throw Error(ye(329))}}}return Xr(t,bn()),t.callbackNode===n?QA.bind(null,t):null}function xp(t,e){var n=bh;return t.current.memoizedState.isDehydrated&&(dl(t,e).flags|=256),t=j0(t,e),t!==2&&(e=Gr,Gr=n,e!==null&&_p(e)),t}function _p(t){Gr===null?Gr=t:Gr.push.apply(Gr,t)}function QN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Xi(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oo(t,e){for(e&=~ew,e&=~O1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-$i(e),r=1<<n;t[n]=-1,e&=~r}}function q_(t){if(At&6)throw Error(ye(327));kc();var e=I0(t,0);if(!(e&1))return Xr(t,bn()),null;var n=j0(t,e);if(t.tag!==0&&n===2){var r=Wm(t);r!==0&&(e=r,n=xp(t,r))}if(n===1)throw n=td,dl(t,0),Oo(t,e),Xr(t,bn()),n;if(n===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$a(t,Gr,Ks),Xr(t,bn()),null}function nw(t,e){var n=At;At|=1;try{return t(e)}finally{At=n,At===0&&(Jc=bn()+500,N1&&Ta())}}function _l(t){Yo!==null&&Yo.tag===0&&!(At&6)&&kc();var e=At;At|=1;var n=vi.transition,r=kt;try{if(vi.transition=null,kt=1,t)return t()}finally{kt=r,vi.transition=n,At=e,!(At&6)&&Ta()}}function rw(){si=Tc.current,Zt(Tc)}function dl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,TN(n)),Fn!==null)for(n=Fn.return;n!==null;){var r=n;switch(Fy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&b0();break;case 3:Yc(),Zt($r),Zt(Tr),qy();break;case 5:Wy(r);break;case 4:Yc();break;case 13:Zt(un);break;case 19:Zt(un);break;case 10:jy(r.type._context);break;case 22:case 23:rw()}n=n.return}if(tr=t,Fn=t=la(t.current,null),ur=si=e,qn=0,td=null,ew=O1=xl=0,Gr=bh=null,nl!==null){for(e=0;e<nl.length;e++)if(n=nl[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}nl=null}return t}function XA(t,e){do{var n=Fn;try{if(Uy(),Jf.current=F0,L0){for(var r=hn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}L0=!1}if(wl=0,Jn=Hn=hn=null,Ch=!1,Zh=0,Jy.current=null,n===null||n.return===null){qn=1,td=e,Fn=null;break}e:{var s=t,l=n.return,h=n,f=e;if(e=ur,h.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var m=f,x=h,_=x.tag;if(!(x.mode&1)&&(_===0||_===11||_===15)){var I=x.alternate;I?(x.updateQueue=I.updateQueue,x.memoizedState=I.memoizedState,x.lanes=I.lanes):(x.updateQueue=null,x.memoizedState=null)}var R=k_(l);if(R!==null){R.flags&=-257,O_(R,l,h,s,e),R.mode&1&&D_(s,m,e),e=R,f=m;var B=e.updateQueue;if(B===null){var D=new Set;D.add(f),e.updateQueue=D}else B.add(f);break e}else{if(!(e&1)){D_(s,m,e),iw();break e}f=Error(ye(426))}}else if(nn&&h.mode&1){var G=k_(l);if(G!==null){!(G.flags&65536)&&(G.flags|=256),O_(G,l,h,s,e),Vy(Zc(f,h));break e}}s=f=Zc(f,h),qn!==4&&(qn=2),bh===null?bh=[s]:bh.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var F=kA(s,f,e);C_(s,F);break e;case 1:h=f;var P=s.type,N=s.stateNode;if(!(s.flags&128)&&(typeof P.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(oa===null||!oa.has(N)))){s.flags|=65536,e&=-e,s.lanes|=e;var H=OA(s,h,e);C_(s,H);break e}}s=s.return}while(s!==null)}JA(n)}catch(Y){e=Y,Fn===n&&n!==null&&(Fn=n=n.return);continue}break}while(1)}function YA(){var t=V0.current;return V0.current=F0,t===null?F0:t}function iw(){(qn===0||qn===3||qn===2)&&(qn=4),tr===null||!(xl&268435455)&&!(O1&268435455)||Oo(tr,ur)}function j0(t,e){var n=At;At|=2;var r=YA();(tr!==t||ur!==e)&&(Ks=null,dl(t,e));do try{XN();break}catch(i){XA(t,i)}while(1);if(Uy(),At=n,V0.current=r,Fn!==null)throw Error(ye(261));return tr=null,ur=0,qn}function XN(){for(;Fn!==null;)ZA(Fn)}function YN(){for(;Fn!==null&&!vR();)ZA(Fn)}function ZA(t){var e=tT(t.alternate,t,si);t.memoizedProps=t.pendingProps,e===null?JA(t):Fn=e,Jy.current=null}function JA(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=HN(n,e),n!==null){n.flags&=32767,Fn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qn=6,Fn=null;return}}else if(n=GN(n,e,si),n!==null){Fn=n;return}if(e=e.sibling,e!==null){Fn=e;return}Fn=e=t}while(e!==null);qn===0&&(qn=5)}function $a(t,e,n){var r=kt,i=vi.transition;try{vi.transition=null,kt=1,ZN(t,e,n,r)}finally{vi.transition=i,kt=r}return null}function ZN(t,e,n,r){do kc();while(Yo!==null);if(At&6)throw Error(ye(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(DR(t,s),t===tr&&(Fn=tr=null,ur=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Pf||(Pf=!0,nT(v0,function(){return kc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=vi.transition,vi.transition=null;var l=kt;kt=1;var h=At;At|=4,Jy.current=null,qN(t,n),KA(n,t),wN(Ym),A0=!!Xm,Ym=Xm=null,t.current=n,KN(n),IR(),At=h,kt=l,vi.transition=s}else t.current=n;if(Pf&&(Pf=!1,Yo=t,U0=i),s=t.pendingLanes,s===0&&(oa=null),CR(n.stateNode),Xr(t,bn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(B0)throw B0=!1,t=yp,yp=null,t;return U0&1&&t.tag!==0&&kc(),s=t.pendingLanes,s&1?t===wp?Rh++:(Rh=0,wp=t):Rh=0,Ta(),null}function kc(){if(Yo!==null){var t=kI(U0),e=vi.transition,n=kt;try{if(vi.transition=null,kt=16>t?16:t,Yo===null)var r=!1;else{if(t=Yo,Yo=null,U0=0,At&6)throw Error(ye(331));var i=At;for(At|=4,Pe=t.current;Pe!==null;){var s=Pe,l=s.child;if(Pe.flags&16){var h=s.deletions;if(h!==null){for(var f=0;f<h.length;f++){var m=h[f];for(Pe=m;Pe!==null;){var x=Pe;switch(x.tag){case 0:case 11:case 15:Sh(8,x,s)}var _=x.child;if(_!==null)_.return=x,Pe=_;else for(;Pe!==null;){x=Pe;var I=x.sibling,R=x.return;if(HA(x),x===m){Pe=null;break}if(I!==null){I.return=R,Pe=I;break}Pe=R}}}var B=s.alternate;if(B!==null){var D=B.child;if(D!==null){B.child=null;do{var G=D.sibling;D.sibling=null,D=G}while(D!==null)}}Pe=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Pe=l;else e:for(;Pe!==null;){if(s=Pe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Sh(9,s,s.return)}var F=s.sibling;if(F!==null){F.return=s.return,Pe=F;break e}Pe=s.return}}var P=t.current;for(Pe=P;Pe!==null;){l=Pe;var N=l.child;if(l.subtreeFlags&2064&&N!==null)N.return=l,Pe=N;else e:for(l=P;Pe!==null;){if(h=Pe,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:k1(9,h)}}catch(Y){En(h,h.return,Y)}if(h===l){Pe=null;break e}var H=h.sibling;if(H!==null){H.return=h.return,Pe=H;break e}Pe=h.return}}if(At=i,Ta(),_s&&typeof _s.onPostCommitFiberRoot=="function")try{_s.onPostCommitFiberRoot(T1,t)}catch{}r=!0}return r}finally{kt=n,vi.transition=e}}return!1}function K_(t,e,n){e=Zc(n,e),e=kA(t,e,1),t=sa(t,e,1),e=Dr(),t!==null&&(Td(t,1,e),Xr(t,e))}function En(t,e,n){if(t.tag===3)K_(t,t,n);else for(;e!==null;){if(e.tag===3){K_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(oa===null||!oa.has(r))){t=Zc(n,t),t=OA(e,t,1),e=sa(e,t,1),t=Dr(),e!==null&&(Td(e,1,t),Xr(e,t));break}}e=e.return}}function JN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Dr(),t.pingedLanes|=t.suspendedLanes&n,tr===t&&(ur&n)===n&&(qn===4||qn===3&&(ur&130023424)===ur&&500>bn()-tw?dl(t,0):ew|=n),Xr(t,e)}function eT(t,e){e===0&&(t.mode&1?(e=Ef,Ef<<=1,!(Ef&130023424)&&(Ef=4194304)):e=1);var n=Dr();t=so(t,e),t!==null&&(Td(t,e,n),Xr(t,n))}function e4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),eT(t,n)}function t4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ye(314))}r!==null&&r.delete(e),eT(t,n)}var tT;tT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$r.current)Hr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Hr=!1,zN(t,e,n);Hr=!!(t.flags&131072)}else Hr=!1,nn&&e.flags&1048576&&sA(e,P0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;t0(t,e),t=e.pendingProps;var i=$c(e,Tr.current);Dc(e,n),i=$y(null,e,r,t,i,n);var s=Qy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qr(r)?(s=!0,R0(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Gy(e),i.updater=D1,e.stateNode=i,i._reactInternals=e,op(e,r,t,n),e=cp(null,e,r,!0,s,n)):(e.tag=0,nn&&s&&Ly(e),Rr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(t0(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=r4(r),t=Vi(r,t),i){case 0:e=lp(null,e,r,t,n);break e;case 1:e=F_(null,e,r,t,n);break e;case 11:e=M_(null,e,r,t,n);break e;case 14:e=L_(null,e,r,Vi(r.type,t),n);break e}throw Error(ye(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vi(r,i),lp(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vi(r,i),F_(t,e,r,i,n);case 3:e:{if(VA(e),t===null)throw Error(ye(387));r=e.pendingProps,s=e.memoizedState,i=s.element,hA(t,e),O0(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Zc(Error(ye(423)),e),e=V_(t,e,r,n,i);break e}else if(r!==i){i=Zc(Error(ye(424)),e),e=V_(t,e,r,n,i);break e}else for(ai=ia(e.stateNode.containerInfo.firstChild),li=e,nn=!0,Gi=null,n=cA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Qc(),r===i){e=oo(t,e,n);break e}Rr(t,e,r,n)}e=e.child}return e;case 5:return dA(e),t===null&&rp(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,Zm(r,i)?l=null:s!==null&&Zm(r,s)&&(e.flags|=32),FA(t,e),Rr(t,e,l,n),e.child;case 6:return t===null&&rp(e),null;case 13:return BA(t,e,n);case 4:return Hy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Xc(e,null,r,n):Rr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vi(r,i),M_(t,e,r,i,n);case 7:return Rr(t,e,e.pendingProps,n),e.child;case 8:return Rr(t,e,e.pendingProps.children,n),e.child;case 12:return Rr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,qt(D0,r._currentValue),r._currentValue=l,s!==null)if(Xi(s.value,l)){if(s.children===i.children&&!$r.current){e=oo(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var h=s.dependencies;if(h!==null){l=s.child;for(var f=h.firstContext;f!==null;){if(f.context===r){if(s.tag===1){f=no(-1,n&-n),f.tag=2;var m=s.updateQueue;if(m!==null){m=m.shared;var x=m.pending;x===null?f.next=f:(f.next=x.next,x.next=f),m.pending=f}}s.lanes|=n,f=s.alternate,f!==null&&(f.lanes|=n),ip(s.return,n,e),h.lanes|=n;break}f=f.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(ye(341));l.lanes|=n,h=l.alternate,h!==null&&(h.lanes|=n),ip(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Rr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Dc(e,n),i=Ai(i),r=r(i),e.flags|=1,Rr(t,e,r,n),e.child;case 14:return r=e.type,i=Vi(r,e.pendingProps),i=Vi(r.type,i),L_(t,e,r,i,n);case 15:return MA(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Vi(r,i),t0(t,e),e.tag=1,Qr(r)?(t=!0,R0(e)):t=!1,Dc(e,n),DA(e,r,i),op(e,r,i,n),cp(null,e,r,!0,t,n);case 19:return UA(t,e,n);case 22:return LA(t,e,n)}throw Error(ye(156,e.tag))};function nT(t,e){return RI(t,e)}function n4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _i(t,e,n,r){return new n4(t,e,n,r)}function sw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function r4(t){if(typeof t=="function")return sw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ay)return 11;if(t===Ty)return 14}return 2}function la(t,e){var n=t.alternate;return n===null?(n=_i(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function i0(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")sw(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case mc:return fl(n.children,i,s,e);case Iy:l=8,i|=8;break;case Nm:return t=_i(12,n,e,i|2),t.elementType=Nm,t.lanes=s,t;case Pm:return t=_i(13,n,e,i),t.elementType=Pm,t.lanes=s,t;case Dm:return t=_i(19,n,e,i),t.elementType=Dm,t.lanes=s,t;case dI:return M1(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case uI:l=10;break e;case hI:l=9;break e;case Ay:l=11;break e;case Ty:l=14;break e;case Po:l=16,r=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=_i(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function fl(t,e,n,r){return t=_i(7,t,r,e),t.lanes=n,t}function M1(t,e,n,r){return t=_i(22,t,r,e),t.elementType=dI,t.lanes=n,t.stateNode={isHidden:!1},t}function rm(t,e,n){return t=_i(6,t,null,e),t.lanes=n,t}function im(t,e,n){return e=_i(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function i4(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vg(0),this.expirationTimes=Vg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ow(t,e,n,r,i,s,l,h,f){return t=new i4(t,e,n,h,f),e===1?(e=1,s===!0&&(e|=8)):e=0,s=_i(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gy(s),t}function s4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function rT(t){if(!t)return fa;t=t._reactInternals;e:{if(Ml(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var n=t.type;if(Qr(n))return rA(t,n,e)}return e}function iT(t,e,n,r,i,s,l,h,f){return t=ow(n,r,!0,t,i,s,l,h,f),t.context=rT(null),n=t.current,r=Dr(),i=aa(n),s=no(r,i),s.callback=e??null,sa(n,s,i),t.current.lanes=i,Td(t,i,r),Xr(t,r),t}function L1(t,e,n,r){var i=e.current,s=Dr(),l=aa(i);return n=rT(n),e.context===null?e.context=n:e.pendingContext=n,e=no(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=sa(i,e,l),t!==null&&(Qi(t,i,l,s),Zf(t,i,l)),l}function z0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function $_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function aw(t,e){$_(t,e),(t=t.alternate)&&$_(t,e)}function o4(){return null}var sT=typeof reportError=="function"?reportError:function(t){console.error(t)};function lw(t){this._internalRoot=t}F1.prototype.render=lw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));L1(t,e,null,null)};F1.prototype.unmount=lw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_l(function(){L1(null,t,null,null)}),e[io]=null}};function F1(t){this._internalRoot=t}F1.prototype.unstable_scheduleHydration=function(t){if(t){var e=LI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ko.length&&e!==0&&e<ko[n].priority;n++);ko.splice(n,0,t),n===0&&VI(t)}};function cw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function V1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Q_(){}function a4(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var m=z0(l);s.call(m)}}var l=iT(e,r,t,0,null,!1,!1,"",Q_);return t._reactRootContainer=l,t[io]=l.current,Kh(t.nodeType===8?t.parentNode:t),_l(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var h=r;r=function(){var m=z0(f);h.call(m)}}var f=ow(t,0,!1,null,null,!1,!1,"",Q_);return t._reactRootContainer=f,t[io]=f.current,Kh(t.nodeType===8?t.parentNode:t),_l(function(){L1(e,f,n,r)}),f}function B1(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var h=i;i=function(){var f=z0(l);h.call(f)}}L1(e,l,t,i)}else l=a4(n,e,t,i,r);return z0(l)}OI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=fh(e.pendingLanes);n!==0&&(by(e,n|1),Xr(e,bn()),!(At&6)&&(Jc=bn()+500,Ta()))}break;case 13:_l(function(){var r=so(t,1);if(r!==null){var i=Dr();Qi(r,t,1,i)}}),aw(t,1)}};Ry=function(t){if(t.tag===13){var e=so(t,134217728);if(e!==null){var n=Dr();Qi(e,t,134217728,n)}aw(t,134217728)}};MI=function(t){if(t.tag===13){var e=aa(t),n=so(t,e);if(n!==null){var r=Dr();Qi(n,t,e,r)}aw(t,e)}};LI=function(){return kt};FI=function(t,e){var n=kt;try{return kt=t,e()}finally{kt=n}};zm=function(t,e,n){switch(e){case"input":if(Mm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=R1(r);if(!i)throw Error(ye(90));gI(r),Mm(r,i)}}}break;case"textarea":pI(t,n);break;case"select":e=n.value,e!=null&&bc(t,!!n.multiple,e,!1)}};II=nw;AI=_l;var l4={usingClientEntryPoint:!1,Events:[Sd,xc,R1,EI,vI,nw]},ih={findFiberByHostInstance:tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},c4={bundleType:ih.bundleType,version:ih.version,rendererPackageName:ih.rendererPackageName,rendererConfig:ih.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:go.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=SI(t),t===null?null:t.stateNode},findFiberByHostInstance:ih.findFiberByHostInstance||o4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{T1=Df.inject(c4),_s=Df}catch{}}hi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=l4;hi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cw(e))throw Error(ye(200));return s4(t,e,null,n)};hi.createRoot=function(t,e){if(!cw(t))throw Error(ye(299));var n=!1,r="",i=sT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=ow(t,1,!1,null,null,n,!1,r,i),t[io]=e.current,Kh(t.nodeType===8?t.parentNode:t),new lw(e)};hi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=SI(e),t=t===null?null:t.stateNode,t};hi.flushSync=function(t){return _l(t)};hi.hydrate=function(t,e,n){if(!V1(e))throw Error(ye(200));return B1(null,t,e,!0,n)};hi.hydrateRoot=function(t,e,n){if(!cw(t))throw Error(ye(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=sT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=iT(e,null,t,1,n??null,i,!1,s,l),t[io]=e.current,Kh(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new F1(e)};hi.render=function(t,e,n){if(!V1(e))throw Error(ye(200));return B1(null,t,e,!1,n)};hi.unmountComponentAtNode=function(t){if(!V1(t))throw Error(ye(40));return t._reactRootContainer?(_l(function(){B1(null,null,t,!1,function(){t._reactRootContainer=null,t[io]=null})}),!0):!1};hi.unstable_batchedUpdates=nw;hi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!V1(n))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return B1(t,e,n,!1,r)};hi.version="18.3.1-next-f1338f8080-20240426";function oT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oT)}catch(t){console.error(t)}}oT(),oI.exports=hi;var u4=oI.exports,X_=u4;bm.createRoot=X_.createRoot,bm.hydrateRoot=X_.hydrateRoot;var U1=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},h4={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Ho,my,Vv,d4=(Vv=class{constructor(){gt(this,Ho,h4);gt(this,my,!1)}setTimeoutProvider(t){$e(this,Ho,t)}setTimeout(t,e){return he(this,Ho).setTimeout(t,e)}clearTimeout(t){he(this,Ho).clearTimeout(t)}setInterval(t,e){return he(this,Ho).setInterval(t,e)}clearInterval(t){he(this,Ho).clearInterval(t)}},Ho=new WeakMap,my=new WeakMap,Vv),Ep=new d4;function f4(t){setTimeout(t,0)}var j1=typeof window>"u"||"Deno"in globalThis;function Bi(){}function g4(t,e){return typeof t=="function"?t(e):t}function m4(t){return typeof t=="number"&&t>=0&&t!==1/0}function p4(t,e){return Math.max(t+(e||0)-Date.now(),0)}function vp(t,e){return typeof t=="function"?t(e):t}function y4(t,e){return typeof t=="function"?t(e):t}function Y_(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:l,stale:h}=t;if(l){if(r){if(e.queryHash!==uw(l,e.options))return!1}else if(!rd(e.queryKey,l))return!1}if(n!=="all"){const f=e.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||i&&i!==e.state.fetchStatus||s&&!s(e))}function Z_(t,e){const{exact:n,status:r,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(nd(e.options.mutationKey)!==nd(s))return!1}else if(!rd(e.options.mutationKey,s))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function uw(t,e){return((e==null?void 0:e.queryKeyHashFn)||nd)(t)}function nd(t){return JSON.stringify(t,(e,n)=>Ip(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function rd(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>rd(t[n],e[n])):!1}var w4=Object.prototype.hasOwnProperty;function aT(t,e){if(t===e)return t;const n=J_(t)&&J_(e);if(!n&&!(Ip(t)&&Ip(e)))return e;const i=(n?t:Object.keys(t)).length,s=n?e:Object.keys(e),l=s.length,h=n?new Array(l):{};let f=0;for(let m=0;m<l;m++){const x=n?m:s[m],_=t[x],I=e[x];if(_===I){h[x]=_,(n?m<i:w4.call(t,x))&&f++;continue}if(_===null||I===null||typeof _!="object"||typeof I!="object"){h[x]=I;continue}const R=aT(_,I);h[x]=R,R===_&&f++}return i===l&&f===i?t:h}function J_(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ip(t){if(!e2(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!e2(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function e2(t){return Object.prototype.toString.call(t)==="[object Object]"}function x4(t){return new Promise(e=>{Ep.setTimeout(e,t)})}function _4(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?aT(t,e):e}function E4(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function v4(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var hw=Symbol();function lT(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===hw?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ol,Wo,Bc,Bv,I4=(Bv=class extends U1{constructor(){super();gt(this,ol,void 0);gt(this,Wo,void 0);gt(this,Bc,void 0);$e(this,Bc,e=>{if(!j1&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){he(this,Wo)||this.setEventListener(he(this,Bc))}onUnsubscribe(){var e;this.hasListeners()||((e=he(this,Wo))==null||e.call(this),$e(this,Wo,void 0))}setEventListener(e){var n;$e(this,Bc,e),(n=he(this,Wo))==null||n.call(this),$e(this,Wo,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){he(this,ol)!==e&&($e(this,ol,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof he(this,ol)=="boolean"?he(this,ol):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ol=new WeakMap,Wo=new WeakMap,Bc=new WeakMap,Bv),cT=new I4;function A4(){let t,e;const n=new Promise((i,s)=>{t=i,e=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var T4=f4;function C4(){let t=[],e=0,n=h=>{h()},r=h=>{h()},i=T4;const s=h=>{e?t.push(h):i(()=>{n(h)})},l=()=>{const h=t;t=[],h.length&&i(()=>{r(()=>{h.forEach(f=>{n(f)})})})};return{batch:h=>{let f;e++;try{f=h()}finally{e--,e||l()}return f},batchCalls:h=>(...f)=>{s(()=>{h(...f)})},schedule:s,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{r=h},setScheduler:h=>{i=h}}}var Pr=C4(),Uc,qo,jc,Uv,S4=(Uv=class extends U1{constructor(){super();gt(this,Uc,!0);gt(this,qo,void 0);gt(this,jc,void 0);$e(this,jc,e=>{if(!j1&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){he(this,qo)||this.setEventListener(he(this,jc))}onUnsubscribe(){var e;this.hasListeners()||((e=he(this,qo))==null||e.call(this),$e(this,qo,void 0))}setEventListener(e){var n;$e(this,jc,e),(n=he(this,qo))==null||n.call(this),$e(this,qo,e(this.setOnline.bind(this)))}setOnline(e){he(this,Uc)!==e&&($e(this,Uc,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return he(this,Uc)}},Uc=new WeakMap,qo=new WeakMap,jc=new WeakMap,Uv),G0=new S4;function b4(t){return Math.min(1e3*2**t,3e4)}function uT(t){return(t??"online")==="online"?G0.isOnline():!0}var Ap=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function hT(t){let e=!1,n=0,r;const i=A4(),s=()=>i.status!=="pending",l=D=>{var G;if(!s()){const F=new Ap(D);I(F),(G=t.onCancel)==null||G.call(t,F)}},h=()=>{e=!0},f=()=>{e=!1},m=()=>cT.isFocused()&&(t.networkMode==="always"||G0.isOnline())&&t.canRun(),x=()=>uT(t.networkMode)&&t.canRun(),_=D=>{s()||(r==null||r(),i.resolve(D))},I=D=>{s()||(r==null||r(),i.reject(D))},R=()=>new Promise(D=>{var G;r=F=>{(s()||m())&&D(F)},(G=t.onPause)==null||G.call(t)}).then(()=>{var D;r=void 0,s()||(D=t.onContinue)==null||D.call(t)}),B=()=>{if(s())return;let D;const G=n===0?t.initialPromise:void 0;try{D=G??t.fn()}catch(F){D=Promise.reject(F)}Promise.resolve(D).then(_).catch(F=>{var J;if(s())return;const P=t.retry??(j1?0:3),N=t.retryDelay??b4,H=typeof N=="function"?N(n,F):N,Y=P===!0||typeof P=="number"&&n<P||typeof P=="function"&&P(n,F);if(e||!Y){I(F);return}n++,(J=t.onFail)==null||J.call(t,n,F),x4(H).then(()=>m()?void 0:R()).then(()=>{e?I(F):B()})})};return{promise:i,status:()=>i.status,cancel:l,continue:()=>(r==null||r(),i),cancelRetry:h,continueRetry:f,canStart:x,start:()=>(x()?B():R().then(B),i)}}var al,jv,dT=(jv=class{constructor(){gt(this,al,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),m4(this.gcTime)&&$e(this,al,Ep.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(j1?1/0:5*60*1e3))}clearGcTimeout(){he(this,al)&&(Ep.clearTimeout(he(this,al)),$e(this,al,void 0))}},al=new WeakMap,jv),ll,zc,yi,cl,Yn,Ed,ul,Ui,Ws,zv,R4=(zv=class extends dT{constructor(n){super();gt(this,Ui);gt(this,ll,void 0);gt(this,zc,void 0);gt(this,yi,void 0);gt(this,cl,void 0);gt(this,Yn,void 0);gt(this,Ed,void 0);gt(this,ul,void 0);$e(this,ul,!1),$e(this,Ed,n.defaultOptions),this.setOptions(n.options),this.observers=[],$e(this,cl,n.client),$e(this,yi,he(this,cl).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,$e(this,ll,t2(this.options)),this.state=n.state??he(this,ll),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=he(this,Yn))==null?void 0:n.promise}setOptions(n){if(this.options={...he(this,Ed),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=t2(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),$e(this,ll,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&he(this,yi).remove(this)}setData(n,r){const i=_4(this.state.data,n,this.options);return pr(this,Ui,Ws).call(this,{data:i,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),i}setState(n,r){pr(this,Ui,Ws).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var i,s;const r=(i=he(this,Yn))==null?void 0:i.promise;return(s=he(this,Yn))==null||s.cancel(n),r?r.then(Bi).catch(Bi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(he(this,ll))}isActive(){return this.observers.some(n=>y4(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===hw||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>vp(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!p4(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=this.observers.find(i=>i.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=he(this,Yn))==null||r.continue()}onOnline(){var r;const n=this.observers.find(i=>i.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=he(this,Yn))==null||r.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),he(this,yi).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(r=>r!==n),this.observers.length||(he(this,Yn)&&(he(this,ul)?he(this,Yn).cancel({revert:!0}):he(this,Yn).cancelRetry()),this.scheduleGc()),he(this,yi).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||pr(this,Ui,Ws).call(this,{type:"invalidate"})}async fetch(n,r){var m,x,_,I,R,B,D,G,F,P,N,H;if(this.state.fetchStatus!=="idle"&&((m=he(this,Yn))==null?void 0:m.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(he(this,Yn))return he(this,Yn).continueRetry(),he(this,Yn).promise}if(n&&this.setOptions(n),!this.options.queryFn){const Y=this.observers.find(J=>J.options.queryFn);Y&&this.setOptions(Y.options)}const i=new AbortController,s=Y=>{Object.defineProperty(Y,"signal",{enumerable:!0,get:()=>($e(this,ul,!0),i.signal)})},l=()=>{const Y=lT(this.options,r),k=(()=>{const M={client:he(this,cl),queryKey:this.queryKey,meta:this.meta};return s(M),M})();return $e(this,ul,!1),this.options.persister?this.options.persister(Y,k,this):Y(k)},f=(()=>{const Y={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:he(this,cl),state:this.state,fetchFn:l};return s(Y),Y})();(x=this.options.behavior)==null||x.onFetch(f,this),$e(this,zc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((_=f.fetchOptions)==null?void 0:_.meta))&&pr(this,Ui,Ws).call(this,{type:"fetch",meta:(I=f.fetchOptions)==null?void 0:I.meta}),$e(this,Yn,hT({initialPromise:r==null?void 0:r.initialPromise,fn:f.fetchFn,onCancel:Y=>{Y instanceof Ap&&Y.revert&&this.setState({...he(this,zc),fetchStatus:"idle"}),i.abort()},onFail:(Y,J)=>{pr(this,Ui,Ws).call(this,{type:"failed",failureCount:Y,error:J})},onPause:()=>{pr(this,Ui,Ws).call(this,{type:"pause"})},onContinue:()=>{pr(this,Ui,Ws).call(this,{type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0}));try{const Y=await he(this,Yn).start();if(Y===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(Y),(B=(R=he(this,yi).config).onSuccess)==null||B.call(R,Y,this),(G=(D=he(this,yi).config).onSettled)==null||G.call(D,Y,this.state.error,this),Y}catch(Y){if(Y instanceof Ap){if(Y.silent)return he(this,Yn).promise;if(Y.revert){if(this.state.data===void 0)throw Y;return this.state.data}}throw pr(this,Ui,Ws).call(this,{type:"error",error:Y}),(P=(F=he(this,yi).config).onError)==null||P.call(F,Y,this),(H=(N=he(this,yi).config).onSettled)==null||H.call(N,this.state.data,Y,this),Y}finally{this.scheduleGc()}}},ll=new WeakMap,zc=new WeakMap,yi=new WeakMap,cl=new WeakMap,Yn=new WeakMap,Ed=new WeakMap,ul=new WeakMap,Ui=new WeakSet,Ws=function(n){const r=i=>{switch(n.type){case"failed":return{...i,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...N4(i.data,this.options),fetchMeta:n.meta??null};case"success":const s={...i,data:n.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:n.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return $e(this,zc,n.manual?s:void 0),s;case"error":const l=n.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...n.state}}};this.state=r(this.state),Pr.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),he(this,yi).notify({query:this,type:"updated",action:n})})},zv);function N4(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uT(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function t2(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function n2(t){return{onFetch:(e,n)=>{var x,_,I,R,B;const r=e.options,i=(I=(_=(x=e.fetchOptions)==null?void 0:x.meta)==null?void 0:_.fetchMore)==null?void 0:I.direction,s=((R=e.state.data)==null?void 0:R.pages)||[],l=((B=e.state.data)==null?void 0:B.pageParams)||[];let h={pages:[],pageParams:[]},f=0;const m=async()=>{let D=!1;const G=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(e.signal.aborted?D=!0:e.signal.addEventListener("abort",()=>{D=!0}),e.signal)})},F=lT(e.options,e.fetchOptions),P=async(N,H,Y)=>{if(D)return Promise.reject();if(H==null&&N.pages.length)return Promise.resolve(N);const k=(()=>{const K={client:e.client,queryKey:e.queryKey,pageParam:H,direction:Y?"backward":"forward",meta:e.options.meta};return G(K),K})(),M=await F(k),{maxPages:L}=e.options,W=Y?v4:E4;return{pages:W(N.pages,M,L),pageParams:W(N.pageParams,H,L)}};if(i&&s.length){const N=i==="backward",H=N?P4:r2,Y={pages:s,pageParams:l},J=H(r,Y);h=await P(Y,J,N)}else{const N=t??s.length;do{const H=f===0?l[0]??r.initialPageParam:r2(r,h);if(f>0&&H==null)break;h=await P(h,H),f++}while(f<N)}return h};e.options.persister?e.fetchFn=()=>{var D,G;return(G=(D=e.options).persister)==null?void 0:G.call(D,m,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=m}}}function r2(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function P4(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var vd,ds,br,hl,fs,No,Gv,D4=(Gv=class extends dT{constructor(n){super();gt(this,fs);gt(this,vd,void 0);gt(this,ds,void 0);gt(this,br,void 0);gt(this,hl,void 0);$e(this,vd,n.client),this.mutationId=n.mutationId,$e(this,br,n.mutationCache),$e(this,ds,[]),this.state=n.state||k4(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){he(this,ds).includes(n)||(he(this,ds).push(n),this.clearGcTimeout(),he(this,br).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){$e(this,ds,he(this,ds).filter(r=>r!==n)),this.scheduleGc(),he(this,br).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){he(this,ds).length||(this.state.status==="pending"?this.scheduleGc():he(this,br).remove(this))}continue(){var n;return((n=he(this,hl))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var h,f,m,x,_,I,R,B,D,G,F,P,N,H,Y,J,k,M,L,W;const r=()=>{pr(this,fs,No).call(this,{type:"continue"})},i={client:he(this,vd),meta:this.options.meta,mutationKey:this.options.mutationKey};$e(this,hl,hT({fn:()=>this.options.mutationFn?this.options.mutationFn(n,i):Promise.reject(new Error("No mutationFn found")),onFail:(K,q)=>{pr(this,fs,No).call(this,{type:"failed",failureCount:K,error:q})},onPause:()=>{pr(this,fs,No).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>he(this,br).canRun(this)}));const s=this.state.status==="pending",l=!he(this,hl).canStart();try{if(s)r();else{pr(this,fs,No).call(this,{type:"pending",variables:n,isPaused:l}),await((f=(h=he(this,br).config).onMutate)==null?void 0:f.call(h,n,this,i));const q=await((x=(m=this.options).onMutate)==null?void 0:x.call(m,n,i));q!==this.state.context&&pr(this,fs,No).call(this,{type:"pending",context:q,variables:n,isPaused:l})}const K=await he(this,hl).start();return await((I=(_=he(this,br).config).onSuccess)==null?void 0:I.call(_,K,n,this.state.context,this,i)),await((B=(R=this.options).onSuccess)==null?void 0:B.call(R,K,n,this.state.context,i)),await((G=(D=he(this,br).config).onSettled)==null?void 0:G.call(D,K,null,this.state.variables,this.state.context,this,i)),await((P=(F=this.options).onSettled)==null?void 0:P.call(F,K,null,n,this.state.context,i)),pr(this,fs,No).call(this,{type:"success",data:K}),K}catch(K){try{throw await((H=(N=he(this,br).config).onError)==null?void 0:H.call(N,K,n,this.state.context,this,i)),await((J=(Y=this.options).onError)==null?void 0:J.call(Y,K,n,this.state.context,i)),await((M=(k=he(this,br).config).onSettled)==null?void 0:M.call(k,void 0,K,this.state.variables,this.state.context,this,i)),await((W=(L=this.options).onSettled)==null?void 0:W.call(L,void 0,K,n,this.state.context,i)),K}finally{pr(this,fs,No).call(this,{type:"error",error:K})}}finally{he(this,br).runNext(this)}}},vd=new WeakMap,ds=new WeakMap,br=new WeakMap,hl=new WeakMap,fs=new WeakSet,No=function(n){const r=i=>{switch(n.type){case"failed":return{...i,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...i,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:n.error,failureCount:i.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Pr.batch(()=>{he(this,ds).forEach(i=>{i.onMutationUpdate(n)}),he(this,br).notify({mutation:this,type:"updated",action:n})})},Gv);function k4(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Qs,ji,Id,Hv,O4=(Hv=class extends U1{constructor(e={}){super();gt(this,Qs,void 0);gt(this,ji,void 0);gt(this,Id,void 0);this.config=e,$e(this,Qs,new Set),$e(this,ji,new Map),$e(this,Id,0)}build(e,n,r){const i=new D4({client:e,mutationCache:this,mutationId:++mf(this,Id)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){he(this,Qs).add(e);const n=kf(e);if(typeof n=="string"){const r=he(this,ji).get(n);r?r.push(e):he(this,ji).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(he(this,Qs).delete(e)){const n=kf(e);if(typeof n=="string"){const r=he(this,ji).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&he(this,ji).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=kf(e);if(typeof n=="string"){const r=he(this,ji).get(n),i=r==null?void 0:r.find(s=>s.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=kf(e);if(typeof n=="string"){const i=(r=he(this,ji).get(n))==null?void 0:r.find(s=>s!==e&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Pr.batch(()=>{he(this,Qs).forEach(e=>{this.notify({type:"removed",mutation:e})}),he(this,Qs).clear(),he(this,ji).clear()})}getAll(){return Array.from(he(this,Qs))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Z_(n,r))}findAll(e={}){return this.getAll().filter(n=>Z_(e,n))}notify(e){Pr.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Pr.batch(()=>Promise.all(e.map(n=>n.continue().catch(Bi))))}},Qs=new WeakMap,ji=new WeakMap,Id=new WeakMap,Hv);function kf(t){var e;return(e=t.options.scope)==null?void 0:e.id}var gs,Wv,M4=(Wv=class extends U1{constructor(e={}){super();gt(this,gs,void 0);this.config=e,$e(this,gs,new Map)}build(e,n,r){const i=n.queryKey,s=n.queryHash??uw(i,n);let l=this.get(s);return l||(l=new R4({client:e,queryKey:i,queryHash:s,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(l)),l}add(e){he(this,gs).has(e.queryHash)||(he(this,gs).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=he(this,gs).get(e.queryHash);n&&(e.destroy(),n===e&&he(this,gs).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Pr.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return he(this,gs).get(e)}getAll(){return[...he(this,gs).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Y_(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>Y_(e,r)):n}notify(e){Pr.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Pr.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Pr.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},gs=new WeakMap,Wv),xn,Ko,$o,Gc,Hc,Qo,Wc,qc,qv,L4=(qv=class{constructor(t={}){gt(this,xn,void 0);gt(this,Ko,void 0);gt(this,$o,void 0);gt(this,Gc,void 0);gt(this,Hc,void 0);gt(this,Qo,void 0);gt(this,Wc,void 0);gt(this,qc,void 0);$e(this,xn,t.queryCache||new M4),$e(this,Ko,t.mutationCache||new O4),$e(this,$o,t.defaultOptions||{}),$e(this,Gc,new Map),$e(this,Hc,new Map),$e(this,Qo,0)}mount(){mf(this,Qo)._++,he(this,Qo)===1&&($e(this,Wc,cT.subscribe(async t=>{t&&(await this.resumePausedMutations(),he(this,xn).onFocus())})),$e(this,qc,G0.subscribe(async t=>{t&&(await this.resumePausedMutations(),he(this,xn).onOnline())})))}unmount(){var t,e;mf(this,Qo)._--,he(this,Qo)===0&&((t=he(this,Wc))==null||t.call(this),$e(this,Wc,void 0),(e=he(this,qc))==null||e.call(this),$e(this,qc,void 0))}isFetching(t){return he(this,xn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return he(this,Ko).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=he(this,xn).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=he(this,xn).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(vp(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return he(this,xn).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=he(this,xn).get(r.queryHash),s=i==null?void 0:i.state.data,l=g4(e,s);if(l!==void 0)return he(this,xn).build(this,r).setData(l,{...n,manual:!0})}setQueriesData(t,e,n){return Pr.batch(()=>he(this,xn).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=he(this,xn).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=he(this,xn);Pr.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=he(this,xn);return Pr.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Pr.batch(()=>he(this,xn).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(Bi).catch(Bi)}invalidateQueries(t,e={}){return Pr.batch(()=>(he(this,xn).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Pr.batch(()=>he(this,xn).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(Bi)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(Bi)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=he(this,xn).build(this,e);return n.isStaleByTime(vp(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Bi).catch(Bi)}fetchInfiniteQuery(t){return t.behavior=n2(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Bi).catch(Bi)}ensureInfiniteQueryData(t){return t.behavior=n2(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return G0.isOnline()?he(this,Ko).resumePausedMutations():Promise.resolve()}getQueryCache(){return he(this,xn)}getMutationCache(){return he(this,Ko)}getDefaultOptions(){return he(this,$o)}setDefaultOptions(t){$e(this,$o,t)}setQueryDefaults(t,e){he(this,Gc).set(nd(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...he(this,Gc).values()],n={};return e.forEach(r=>{rd(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){he(this,Hc).set(nd(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...he(this,Hc).values()],n={};return e.forEach(r=>{rd(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...he(this,$o).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=uw(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===hw&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...he(this,$o).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){he(this,xn).clear(),he(this,Ko).clear()}},xn=new WeakMap,Ko=new WeakMap,$o=new WeakMap,Gc=new WeakMap,Hc=new WeakMap,Qo=new WeakMap,Wc=new WeakMap,qc=new WeakMap,qv),F4=oe.createContext(void 0),V4=({client:t,children:e})=>(oe.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),A.jsx(F4.Provider,{value:t,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function id(){return id=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},id.apply(this,arguments)}var Zo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Zo||(Zo={}));const i2="popstate";function B4(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:l,hash:h}=r.location;return Tp("",{pathname:s,search:l,hash:h},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:H0(i)}return j4(e,n,null,t)}function Nn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function fT(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function U4(){return Math.random().toString(36).substr(2,8)}function s2(t,e){return{usr:t.state,key:t.key,idx:e}}function Tp(t,e,n,r){return n===void 0&&(n=null),id({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Au(e):e,{state:n,key:e&&e.key||r||U4()})}function H0(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Au(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function j4(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,l=i.history,h=Zo.Pop,f=null,m=x();m==null&&(m=0,l.replaceState(id({},l.state,{idx:m}),""));function x(){return(l.state||{idx:null}).idx}function _(){h=Zo.Pop;let G=x(),F=G==null?null:G-m;m=G,f&&f({action:h,location:D.location,delta:F})}function I(G,F){h=Zo.Push;let P=Tp(D.location,G,F);n&&n(P,G),m=x()+1;let N=s2(P,m),H=D.createHref(P);try{l.pushState(N,"",H)}catch(Y){if(Y instanceof DOMException&&Y.name==="DataCloneError")throw Y;i.location.assign(H)}s&&f&&f({action:h,location:D.location,delta:1})}function R(G,F){h=Zo.Replace;let P=Tp(D.location,G,F);n&&n(P,G),m=x();let N=s2(P,m),H=D.createHref(P);l.replaceState(N,"",H),s&&f&&f({action:h,location:D.location,delta:0})}function B(G){let F=i.location.origin!=="null"?i.location.origin:i.location.href,P=typeof G=="string"?G:H0(G);return P=P.replace(/ $/,"%20"),Nn(F,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,F)}let D={get action(){return h},get location(){return t(i,l)},listen(G){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(i2,_),f=G,()=>{i.removeEventListener(i2,_),f=null}},createHref(G){return e(i,G)},createURL:B,encodeLocation(G){let F=B(G);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:I,replace:R,go(G){return l.go(G)}};return D}var o2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(o2||(o2={}));function z4(t,e,n){return n===void 0&&(n="/"),G4(t,e,n,!1)}function G4(t,e,n,r){let i=typeof e=="string"?Au(e):e,s=dw(i.pathname||"/",n);if(s==null)return null;let l=gT(t);H4(l);let h=null;for(let f=0;h==null&&f<l.length;++f){let m=tP(s);h=J4(l[f],m,r)}return h}function gT(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,l,h)=>{let f={relativePath:h===void 0?s.path||"":h,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};f.relativePath.startsWith("/")&&(Nn(f.relativePath.startsWith(r),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(r.length));let m=ca([r,f.relativePath]),x=n.concat(f);s.children&&s.children.length>0&&(Nn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),gT(s.children,e,x,m)),!(s.path==null&&!s.index)&&e.push({path:m,score:Y4(m,s.index),routesMeta:x})};return t.forEach((s,l)=>{var h;if(s.path===""||!((h=s.path)!=null&&h.includes("?")))i(s,l);else for(let f of mT(s.path))i(s,l,f)}),e}function mT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let l=mT(r.join("/")),h=[];return h.push(...l.map(f=>f===""?s:[s,f].join("/"))),i&&h.push(...l),h.map(f=>t.startsWith("/")&&f===""?"/":f)}function H4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Z4(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const W4=/^:[\w-]+$/,q4=3,K4=2,$4=1,Q4=10,X4=-2,a2=t=>t==="*";function Y4(t,e){let n=t.split("/"),r=n.length;return n.some(a2)&&(r+=X4),e&&(r+=K4),n.filter(i=>!a2(i)).reduce((i,s)=>i+(W4.test(s)?q4:s===""?$4:Q4),r)}function Z4(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function J4(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},s="/",l=[];for(let h=0;h<r.length;++h){let f=r[h],m=h===r.length-1,x=s==="/"?e:e.slice(s.length)||"/",_=l2({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},x),I=f.route;if(!_&&m&&n&&!r[r.length-1].route.index&&(_=l2({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},x)),!_)return null;Object.assign(i,_.params),l.push({params:i,pathname:ca([s,_.pathname]),pathnameBase:sP(ca([s,_.pathnameBase])),route:I}),_.pathnameBase!=="/"&&(s=ca([s,_.pathnameBase]))}return l}function l2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=eP(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],l=s.replace(/(.)\/+$/,"$1"),h=i.slice(1);return{params:r.reduce((m,x,_)=>{let{paramName:I,isOptional:R}=x;if(I==="*"){let D=h[_]||"";l=s.slice(0,s.length-D.length).replace(/(.)\/+$/,"$1")}const B=h[_];return R&&!B?m[I]=void 0:m[I]=(B||"").replace(/%2F/g,"/"),m},{}),pathname:s,pathnameBase:l,pattern:t}}function eP(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),fT(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,h,f)=>(r.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function tP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return fT(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function dw(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function nP(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Au(t):t;return{pathname:n?n.startsWith("/")?n:rP(n,e):e,search:oP(r),hash:aP(i)}}function rP(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function sm(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function iP(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function fw(t,e){let n=iP(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function gw(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Au(t):(i=id({},t),Nn(!i.pathname||!i.pathname.includes("?"),sm("?","pathname","search",i)),Nn(!i.pathname||!i.pathname.includes("#"),sm("#","pathname","hash",i)),Nn(!i.search||!i.search.includes("#"),sm("#","search","hash",i)));let s=t===""||i.pathname==="",l=s?"/":i.pathname,h;if(l==null)h=n;else{let _=e.length-1;if(!r&&l.startsWith("..")){let I=l.split("/");for(;I[0]==="..";)I.shift(),_-=1;i.pathname=I.join("/")}h=_>=0?e[_]:"/"}let f=nP(i,h),m=l&&l!=="/"&&l.endsWith("/"),x=(s||l===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(m||x)&&(f.pathname+="/"),f}const ca=t=>t.join("/").replace(/\/\/+/g,"/"),sP=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),oP=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,aP=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function lP(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const pT=["post","put","patch","delete"];new Set(pT);const cP=["get",...pT];new Set(cP);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sd(){return sd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sd.apply(this,arguments)}const mw=oe.createContext(null),uP=oe.createContext(null),Ca=oe.createContext(null),z1=oe.createContext(null),mo=oe.createContext({outlet:null,matches:[],isDataRoute:!1}),yT=oe.createContext(null);function hP(t,e){let{relative:n}=e===void 0?{}:e;Tu()||Nn(!1);let{basename:r,navigator:i}=oe.useContext(Ca),{hash:s,pathname:l,search:h}=_T(t,{relative:n}),f=l;return r!=="/"&&(f=l==="/"?r:ca([r,l])),i.createHref({pathname:f,search:h,hash:s})}function Tu(){return oe.useContext(z1)!=null}function Rd(){return Tu()||Nn(!1),oe.useContext(z1).location}function wT(t){oe.useContext(Ca).static||oe.useLayoutEffect(t)}function fi(){let{isDataRoute:t}=oe.useContext(mo);return t?AP():dP()}function dP(){Tu()||Nn(!1);let t=oe.useContext(mw),{basename:e,future:n,navigator:r}=oe.useContext(Ca),{matches:i}=oe.useContext(mo),{pathname:s}=Rd(),l=JSON.stringify(fw(i,n.v7_relativeSplatPath)),h=oe.useRef(!1);return wT(()=>{h.current=!0}),oe.useCallback(function(m,x){if(x===void 0&&(x={}),!h.current)return;if(typeof m=="number"){r.go(m);return}let _=gw(m,JSON.parse(l),s,x.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:ca([e,_.pathname])),(x.replace?r.replace:r.push)(_,x.state,x)},[e,r,l,s,t])}function xT(){let{matches:t}=oe.useContext(mo),e=t[t.length-1];return e?e.params:{}}function _T(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=oe.useContext(Ca),{matches:i}=oe.useContext(mo),{pathname:s}=Rd(),l=JSON.stringify(fw(i,r.v7_relativeSplatPath));return oe.useMemo(()=>gw(t,JSON.parse(l),s,n==="path"),[t,l,s,n])}function fP(t,e){return gP(t,e)}function gP(t,e,n,r){Tu()||Nn(!1);let{navigator:i}=oe.useContext(Ca),{matches:s}=oe.useContext(mo),l=s[s.length-1],h=l?l.params:{};l&&l.pathname;let f=l?l.pathnameBase:"/";l&&l.route;let m=Rd(),x;if(e){var _;let G=typeof e=="string"?Au(e):e;f==="/"||(_=G.pathname)!=null&&_.startsWith(f)||Nn(!1),x=G}else x=m;let I=x.pathname||"/",R=I;if(f!=="/"){let G=f.replace(/^\//,"").split("/");R="/"+I.replace(/^\//,"").split("/").slice(G.length).join("/")}let B=z4(t,{pathname:R}),D=xP(B&&B.map(G=>Object.assign({},G,{params:Object.assign({},h,G.params),pathname:ca([f,i.encodeLocation?i.encodeLocation(G.pathname).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?f:ca([f,i.encodeLocation?i.encodeLocation(G.pathnameBase).pathname:G.pathnameBase])})),s,n,r);return e&&D?oe.createElement(z1.Provider,{value:{location:sd({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:Zo.Pop}},D):D}function mP(){let t=IP(),e=lP(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return oe.createElement(oe.Fragment,null,oe.createElement("h2",null,"Unexpected Application Error!"),oe.createElement("h3",{style:{fontStyle:"italic"}},e),n?oe.createElement("pre",{style:i},n):null,s)}const pP=oe.createElement(mP,null);class yP extends oe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?oe.createElement(mo.Provider,{value:this.props.routeContext},oe.createElement(yT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function wP(t){let{routeContext:e,match:n,children:r}=t,i=oe.useContext(mw);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),oe.createElement(mo.Provider,{value:e},r)}function xP(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,h=(i=n)==null?void 0:i.errors;if(h!=null){let x=l.findIndex(_=>_.route.id&&(h==null?void 0:h[_.route.id])!==void 0);x>=0||Nn(!1),l=l.slice(0,Math.min(l.length,x+1))}let f=!1,m=-1;if(n&&r&&r.v7_partialHydration)for(let x=0;x<l.length;x++){let _=l[x];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(m=x),_.route.id){let{loaderData:I,errors:R}=n,B=_.route.loader&&I[_.route.id]===void 0&&(!R||R[_.route.id]===void 0);if(_.route.lazy||B){f=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((x,_,I)=>{let R,B=!1,D=null,G=null;n&&(R=h&&_.route.id?h[_.route.id]:void 0,D=_.route.errorElement||pP,f&&(m<0&&I===0?(TP("route-fallback",!1),B=!0,G=null):m===I&&(B=!0,G=_.route.hydrateFallbackElement||null)));let F=e.concat(l.slice(0,I+1)),P=()=>{let N;return R?N=D:B?N=G:_.route.Component?N=oe.createElement(_.route.Component,null):_.route.element?N=_.route.element:N=x,oe.createElement(wP,{match:_,routeContext:{outlet:x,matches:F,isDataRoute:n!=null},children:N})};return n&&(_.route.ErrorBoundary||_.route.errorElement||I===0)?oe.createElement(yP,{location:n.location,revalidation:n.revalidation,component:D,error:R,children:P(),routeContext:{outlet:null,matches:F,isDataRoute:!0}}):P()},null)}var ET=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(ET||{}),W0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(W0||{});function _P(t){let e=oe.useContext(mw);return e||Nn(!1),e}function EP(t){let e=oe.useContext(uP);return e||Nn(!1),e}function vP(t){let e=oe.useContext(mo);return e||Nn(!1),e}function vT(t){let e=vP(),n=e.matches[e.matches.length-1];return n.route.id||Nn(!1),n.route.id}function IP(){var t;let e=oe.useContext(yT),n=EP(W0.UseRouteError),r=vT(W0.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function AP(){let{router:t}=_P(ET.UseNavigateStable),e=vT(W0.UseNavigateStable),n=oe.useRef(!1);return wT(()=>{n.current=!0}),oe.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,sd({fromRouteId:e},s)))},[t,e])}const c2={};function TP(t,e,n){!e&&!c2[t]&&(c2[t]=!0)}function CP(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function ni(t){let{to:e,replace:n,state:r,relative:i}=t;Tu()||Nn(!1);let{future:s,static:l}=oe.useContext(Ca),{matches:h}=oe.useContext(mo),{pathname:f}=Rd(),m=fi(),x=gw(e,fw(h,s.v7_relativeSplatPath),f,i==="path"),_=JSON.stringify(x);return oe.useEffect(()=>m(JSON.parse(_),{replace:n,state:r,relative:i}),[m,_,i,n,r]),null}function ri(t){Nn(!1)}function SP(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Zo.Pop,navigator:s,static:l=!1,future:h}=t;Tu()&&Nn(!1);let f=e.replace(/^\/*/,"/"),m=oe.useMemo(()=>({basename:f,navigator:s,static:l,future:sd({v7_relativeSplatPath:!1},h)}),[f,h,s,l]);typeof r=="string"&&(r=Au(r));let{pathname:x="/",search:_="",hash:I="",state:R=null,key:B="default"}=r,D=oe.useMemo(()=>{let G=dw(x,f);return G==null?null:{location:{pathname:G,search:_,hash:I,state:R,key:B},navigationType:i}},[f,x,_,I,R,B,i]);return D==null?null:oe.createElement(Ca.Provider,{value:m},oe.createElement(z1.Provider,{children:n,value:D}))}function bP(t){let{children:e,location:n}=t;return fP(Cp(e),n)}new Promise(()=>{});function Cp(t,e){e===void 0&&(e=[]);let n=[];return oe.Children.forEach(t,(r,i)=>{if(!oe.isValidElement(r))return;let s=[...e,i];if(r.type===oe.Fragment){n.push.apply(n,Cp(r.props.children,s));return}r.type!==ri&&Nn(!1),!r.props.index||!r.props.children||Nn(!1);let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Cp(r.props.children,s)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sp(){return Sp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sp.apply(this,arguments)}function RP(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function NP(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function PP(t,e){return t.button===0&&(!e||e==="_self")&&!NP(t)}const DP=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kP="6";try{window.__reactRouterVersion=kP}catch{}const OP="startTransition",u2=J3[OP];function MP(t){let{basename:e,children:n,future:r,window:i}=t,s=oe.useRef();s.current==null&&(s.current=B4({window:i,v5Compat:!0}));let l=s.current,[h,f]=oe.useState({action:l.action,location:l.location}),{v7_startTransition:m}=r||{},x=oe.useCallback(_=>{m&&u2?u2(()=>f(_)):f(_)},[f,m]);return oe.useLayoutEffect(()=>l.listen(x),[l,x]),oe.useEffect(()=>CP(r),[r]),oe.createElement(SP,{basename:e,children:n,location:h.location,navigationType:h.action,navigator:l,future:r})}const LP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",FP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Of=oe.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:l,state:h,target:f,to:m,preventScrollReset:x,viewTransition:_}=e,I=RP(e,DP),{basename:R}=oe.useContext(Ca),B,D=!1;if(typeof m=="string"&&FP.test(m)&&(B=m,LP))try{let N=new URL(window.location.href),H=m.startsWith("//")?new URL(N.protocol+m):new URL(m),Y=dw(H.pathname,R);H.origin===N.origin&&Y!=null?m=Y+H.search+H.hash:D=!0}catch{}let G=hP(m,{relative:i}),F=VP(m,{replace:l,state:h,target:f,preventScrollReset:x,relative:i,viewTransition:_});function P(N){r&&r(N),N.defaultPrevented||F(N)}return oe.createElement("a",Sp({},I,{href:B||G,onClick:D||s?r:P,ref:n,target:f}))});var h2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(h2||(h2={}));var d2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(d2||(d2={}));function VP(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:l,viewTransition:h}=e===void 0?{}:e,f=fi(),m=Rd(),x=_T(t,{relative:l});return oe.useCallback(_=>{if(PP(_,n)){_.preventDefault();let I=r!==void 0?r:H0(m)===H0(x);f(t,{replace:I,state:i,preventScrollReset:s,relative:l,viewTransition:h})}},[m,f,x,r,i,n,t,s,l,h])}let BP={data:""},UP=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||BP,jP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,zP=/\/\*[^]*?\*\/|  +/g,f2=/\n+/g,Mo=(t,e)=>{let n="",r="",i="";for(let s in t){let l=t[s];s[0]=="@"?s[1]=="i"?n=s+" "+l+";":r+=s[1]=="f"?Mo(l,s):s+"{"+Mo(l,s[1]=="k"?"":e)+"}":typeof l=="object"?r+=Mo(l,e?e.replace(/([^,])+/g,h=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,h):h?h+" "+f:f)):s):l!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Mo.p?Mo.p(s,l):s+":"+l+";")}return n+(e&&i?e+"{"+i+"}":i)+r},Gs={},IT=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+IT(t[n]);return e}return t},GP=(t,e,n,r,i)=>{let s=IT(t),l=Gs[s]||(Gs[s]=(f=>{let m=0,x=11;for(;m<f.length;)x=101*x+f.charCodeAt(m++)>>>0;return"go"+x})(s));if(!Gs[l]){let f=s!==t?t:(m=>{let x,_,I=[{}];for(;x=jP.exec(m.replace(zP,""));)x[4]?I.shift():x[3]?(_=x[3].replace(f2," ").trim(),I.unshift(I[0][_]=I[0][_]||{})):I[0][x[1]]=x[2].replace(f2," ").trim();return I[0]})(t);Gs[l]=Mo(i?{["@keyframes "+l]:f}:f,n?"":"."+l)}let h=n&&Gs.g?Gs.g:null;return n&&(Gs.g=Gs[l]),((f,m,x,_)=>{_?m.data=m.data.replace(_,f):m.data.indexOf(f)===-1&&(m.data=x?f+m.data:m.data+f)})(Gs[l],e,r,h),l},HP=(t,e,n)=>t.reduce((r,i,s)=>{let l=e[s];if(l&&l.call){let h=l(n),f=h&&h.props&&h.props.className||/^go/.test(h)&&h;l=f?"."+f:h&&typeof h=="object"?h.props?"":Mo(h,""):h===!1?"":h}return r+i+(l??"")},"");function G1(t){let e=this||{},n=t.call?t(e.p):t;return GP(n.unshift?n.raw?HP(n,[].slice.call(arguments,1),e.p):n.reduce((r,i)=>Object.assign(r,i&&i.call?i(e.p):i),{}):n,UP(e.target),e.g,e.o,e.k)}let AT,bp,Rp;G1.bind({g:1});let ao=G1.bind({k:1});function WP(t,e,n,r){Mo.p=e,AT=t,bp=n,Rp=r}function Sa(t,e){let n=this||{};return function(){let r=arguments;function i(s,l){let h=Object.assign({},s),f=h.className||i.className;n.p=Object.assign({theme:bp&&bp()},h),n.o=/ *go\d+/.test(f),h.className=G1.apply(n,r)+(f?" "+f:""),e&&(h.ref=l);let m=t;return t[0]&&(m=h.as||t,delete h.as),Rp&&m[0]&&Rp(h),AT(m,h)}return e?e(i):i}}var qP=t=>typeof t=="function",q0=(t,e)=>qP(t)?t(e):t,KP=(()=>{let t=0;return()=>(++t).toString()})(),TT=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),$P=20,pw="default",CT=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(l=>l.id===e.toast.id?{...l,...e.toast}:l)};case 2:let{toast:r}=e;return CT(t,{type:t.toasts.find(l=>l.id===r.id)?1:0,toast:r});case 3:let{toastId:i}=e;return{...t,toasts:t.toasts.map(l=>l.id===i||i===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(l=>l.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let s=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+s}))}}},s0=[],ST={toasts:[],pausedAt:void 0,settings:{toastLimit:$P}},ps={},bT=(t,e=pw)=>{ps[e]=CT(ps[e]||ST,t),s0.forEach(([n,r])=>{n===e&&r(ps[e])})},RT=t=>Object.keys(ps).forEach(e=>bT(t,e)),QP=t=>Object.keys(ps).find(e=>ps[e].toasts.some(n=>n.id===t)),H1=(t=pw)=>e=>{bT(e,t)},XP={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},YP=(t={},e=pw)=>{let[n,r]=oe.useState(ps[e]||ST),i=oe.useRef(ps[e]);oe.useEffect(()=>(i.current!==ps[e]&&r(ps[e]),s0.push([e,r]),()=>{let l=s0.findIndex(([h])=>h===e);l>-1&&s0.splice(l,1)}),[e]);let s=n.toasts.map(l=>{var h,f,m;return{...t,...t[l.type],...l,removeDelay:l.removeDelay||((h=t[l.type])==null?void 0:h.removeDelay)||(t==null?void 0:t.removeDelay),duration:l.duration||((f=t[l.type])==null?void 0:f.duration)||(t==null?void 0:t.duration)||XP[l.type],style:{...t.style,...(m=t[l.type])==null?void 0:m.style,...l.style}}});return{...n,toasts:s}},ZP=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||KP()}),Nd=t=>(e,n)=>{let r=ZP(e,t,n);return H1(r.toasterId||QP(r.id))({type:2,toast:r}),r.id},Wn=(t,e)=>Nd("blank")(t,e);Wn.error=Nd("error");Wn.success=Nd("success");Wn.loading=Nd("loading");Wn.custom=Nd("custom");Wn.dismiss=(t,e)=>{let n={type:3,toastId:t};e?H1(e)(n):RT(n)};Wn.dismissAll=t=>Wn.dismiss(void 0,t);Wn.remove=(t,e)=>{let n={type:4,toastId:t};e?H1(e)(n):RT(n)};Wn.removeAll=t=>Wn.remove(void 0,t);Wn.promise=(t,e,n)=>{let r=Wn.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(i=>{let s=e.success?q0(e.success,i):void 0;return s?Wn.success(s,{id:r,...n,...n==null?void 0:n.success}):Wn.dismiss(r),i}).catch(i=>{let s=e.error?q0(e.error,i):void 0;s?Wn.error(s,{id:r,...n,...n==null?void 0:n.error}):Wn.dismiss(r)}),t};var JP=1e3,e8=(t,e="default")=>{let{toasts:n,pausedAt:r}=YP(t,e),i=oe.useRef(new Map).current,s=oe.useCallback((_,I=JP)=>{if(i.has(_))return;let R=setTimeout(()=>{i.delete(_),l({type:4,toastId:_})},I);i.set(_,R)},[]);oe.useEffect(()=>{if(r)return;let _=Date.now(),I=n.map(R=>{if(R.duration===1/0)return;let B=(R.duration||0)+R.pauseDuration-(_-R.createdAt);if(B<0){R.visible&&Wn.dismiss(R.id);return}return setTimeout(()=>Wn.dismiss(R.id,e),B)});return()=>{I.forEach(R=>R&&clearTimeout(R))}},[n,r,e]);let l=oe.useCallback(H1(e),[e]),h=oe.useCallback(()=>{l({type:5,time:Date.now()})},[l]),f=oe.useCallback((_,I)=>{l({type:1,toast:{id:_,height:I}})},[l]),m=oe.useCallback(()=>{r&&l({type:6,time:Date.now()})},[r,l]),x=oe.useCallback((_,I)=>{let{reverseOrder:R=!1,gutter:B=8,defaultPosition:D}=I||{},G=n.filter(N=>(N.position||D)===(_.position||D)&&N.height),F=G.findIndex(N=>N.id===_.id),P=G.filter((N,H)=>H<F&&N.visible).length;return G.filter(N=>N.visible).slice(...R?[P+1]:[0,P]).reduce((N,H)=>N+(H.height||0)+B,0)},[n]);return oe.useEffect(()=>{n.forEach(_=>{if(_.dismissed)s(_.id,_.removeDelay);else{let I=i.get(_.id);I&&(clearTimeout(I),i.delete(_.id))}})},[n,s]),{toasts:n,handlers:{updateHeight:f,startPause:h,endPause:m,calculateOffset:x}}},t8=ao`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,n8=ao`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,r8=ao`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,i8=Sa("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${t8} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${n8} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${r8} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,s8=ao`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,o8=Sa("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${s8} 1s linear infinite;
`,a8=ao`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,l8=ao`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,c8=Sa("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${a8} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${l8} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,u8=Sa("div")`
  position: absolute;
`,h8=Sa("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,d8=ao`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,f8=Sa("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${d8} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,g8=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?oe.createElement(f8,null,e):e:n==="blank"?null:oe.createElement(h8,null,oe.createElement(o8,{...r}),n!=="loading"&&oe.createElement(u8,null,n==="error"?oe.createElement(i8,{...r}):oe.createElement(c8,{...r})))},m8=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,p8=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,y8="0%{opacity:0;} 100%{opacity:1;}",w8="0%{opacity:1;} 100%{opacity:0;}",x8=Sa("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,_8=Sa("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,E8=(t,e)=>{let n=t.includes("top")?1:-1,[r,i]=TT()?[y8,w8]:[m8(n),p8(n)];return{animation:e?`${ao(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ao(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},v8=oe.memo(({toast:t,position:e,style:n,children:r})=>{let i=t.height?E8(t.position||e||"top-center",t.visible):{opacity:0},s=oe.createElement(g8,{toast:t}),l=oe.createElement(_8,{...t.ariaProps},q0(t.message,t));return oe.createElement(x8,{className:t.className,style:{...i,...n,...t.style}},typeof r=="function"?r({icon:s,message:l}):oe.createElement(oe.Fragment,null,s,l))});WP(oe.createElement);var I8=({id:t,className:e,style:n,onHeightUpdate:r,children:i})=>{let s=oe.useCallback(l=>{if(l){let h=()=>{let f=l.getBoundingClientRect().height;r(t,f)};h(),new MutationObserver(h).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return oe.createElement("div",{ref:s,className:e,style:n},i)},A8=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},i=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:TT()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...i}},T8=G1`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Mf=16,C8=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:i,toasterId:s,containerStyle:l,containerClassName:h})=>{let{toasts:f,handlers:m}=e8(n,s);return oe.createElement("div",{"data-rht-toaster":s||"",style:{position:"fixed",zIndex:9999,top:Mf,left:Mf,right:Mf,bottom:Mf,pointerEvents:"none",...l},className:h,onMouseEnter:m.startPause,onMouseLeave:m.endPause},f.map(x=>{let _=x.position||e,I=m.calculateOffset(x,{reverseOrder:t,gutter:r,defaultPosition:e}),R=A8(_,I);return oe.createElement(I8,{id:x.id,key:x.id,onHeightUpdate:m.updateHeight,className:x.visible?T8:"",style:R},x.type==="custom"?q0(x.message,x):i?i(x):oe.createElement(v8,{toast:x,position:_}))}))},Qe=Wn;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},S8=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],l=t[n++],h=t[n++],f=((i&7)<<18|(s&63)<<12|(l&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const s=t[n++],l=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|l&63)}}return e.join("")},PT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],l=i+1<t.length,h=l?t[i+1]:0,f=i+2<t.length,m=f?t[i+2]:0,x=s>>2,_=(s&3)<<4|h>>4;let I=(h&15)<<2|m>>6,R=m&63;f||(R=64,l||(I=64)),r.push(n[x],n[_],n[I],n[R])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(NT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):S8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],h=i<t.length?n[t.charAt(i)]:0;++i;const m=i<t.length?n[t.charAt(i)]:64;++i;const _=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||h==null||m==null||_==null)throw new b8;const I=s<<2|h>>4;if(r.push(I),m!==64){const R=h<<4&240|m>>2;if(r.push(R),_!==64){const B=m<<6&192|_;r.push(B)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class b8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const R8=function(t){const e=NT(t);return PT.encodeByteArray(e,!0)},K0=function(t){return R8(t).replace(/\./g,"")},DT=function(t){try{return PT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P8=()=>N8().__FIREBASE_DEFAULTS__,D8=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},k8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&DT(t[1]);return e&&JSON.parse(e)},W1=()=>{try{return P8()||D8()||k8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},kT=t=>{var e,n;return(n=(e=W1())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},yw=t=>{const e=kT(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},OT=()=>{var t;return(t=W1())===null||t===void 0?void 0:t.config},MT=t=>{var e;return(e=W1())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),h="";return[K0(JSON.stringify(n)),K0(JSON.stringify(l)),h].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function M8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kn())}function L8(){var t;const e=(t=W1())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function F8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function V8(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function B8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function U8(){const t=Kn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function FT(){return!L8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function VT(){try{return typeof indexedDB=="object"}catch{return!1}}function j8(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z8="FirebaseError";class Ns extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=z8,Object.setPrototypeOf(this,Ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pd.prototype.create)}}class Pd{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],l=s?G8(s,r):"Error",h=`${this.serviceName}: ${l} (${i}).`;return new Ns(i,h,r)}}function G8(t,e){return t.replace(H8,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const H8=/\{\$([^}]+)}/g;function W8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ga(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],l=e[i];if(g2(s)&&g2(l)){if(!ga(s,l))return!1}else if(s!==l)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function g2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function mh(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function ph(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function q8(t,e){const n=new K8(t,e);return n.subscribe.bind(n)}class K8{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");$8(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=om),i.error===void 0&&(i.error=om),i.complete===void 0&&(i.complete=om);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $8(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function om(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t){return t&&t._delegate?t._delegate:t}class lo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new O8;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Y8(e))try{this.getOrInitializeService({instanceIdentifier:Qa})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Qa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qa){return this.instances.has(e)}getOptions(e=Qa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(s);r===h&&l.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const l=this.instances.get(i);return l&&e(l,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:X8(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Qa){return this.component?this.component.multipleInstances?e:Qa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function X8(t){return t===Qa?void 0:t}function Y8(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Q8(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ut||(ut={}));const J8={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},eD=ut.INFO,tD={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},nD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=tD[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ww{constructor(e){this.name=e,this._logLevel=eD,this._logHandler=nD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?J8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const rD=(t,e)=>e.some(n=>t instanceof n);let m2,p2;function iD(){return m2||(m2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sD(){return p2||(p2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const BT=new WeakMap,Np=new WeakMap,UT=new WeakMap,am=new WeakMap,xw=new WeakMap;function oD(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",l)},s=()=>{n(ua(t.result)),i()},l=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",l)});return e.then(n=>{n instanceof IDBCursor&&BT.set(n,t)}).catch(()=>{}),xw.set(e,t),e}function aD(t){if(Np.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",l),t.removeEventListener("abort",l)},s=()=>{n(),i()},l=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",l),t.addEventListener("abort",l)});Np.set(t,e)}let Pp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Np.get(t);if(e==="objectStoreNames")return t.objectStoreNames||UT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ua(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lD(t){Pp=t(Pp)}function cD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(lm(this),e,...n);return UT.set(r,e.sort?e.sort():[e]),ua(r)}:sD().includes(t)?function(...e){return t.apply(lm(this),e),ua(BT.get(this))}:function(...e){return ua(t.apply(lm(this),e))}}function uD(t){return typeof t=="function"?cD(t):(t instanceof IDBTransaction&&aD(t),rD(t,iD())?new Proxy(t,Pp):t)}function ua(t){if(t instanceof IDBRequest)return oD(t);if(am.has(t))return am.get(t);const e=uD(t);return e!==t&&(am.set(t,e),xw.set(e,t)),e}const lm=t=>xw.get(t);function hD(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const l=indexedDB.open(t,e),h=ua(l);return r&&l.addEventListener("upgradeneeded",f=>{r(ua(l.result),f.oldVersion,f.newVersion,ua(l.transaction),f)}),n&&l.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),h.then(f=>{s&&f.addEventListener("close",()=>s()),i&&f.addEventListener("versionchange",m=>i(m.oldVersion,m.newVersion,m))}).catch(()=>{}),h}const dD=["get","getKey","getAll","getAllKeys","count"],fD=["put","add","delete","clear"],cm=new Map;function y2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cm.get(e))return cm.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=fD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||dD.includes(n)))return;const s=async function(l,...h){const f=this.transaction(l,i?"readwrite":"readonly");let m=f.store;return r&&(m=m.index(h.shift())),(await Promise.all([m[n](...h),i&&f.done]))[0]};return cm.set(e,s),s}lD(t=>({...t,get:(e,n,r)=>y2(e,n)||t.get(e,n,r),has:(e,n)=>!!y2(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Dp="@firebase/app",w2="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co=new ww("@firebase/app"),pD="@firebase/app-compat",yD="@firebase/analytics-compat",wD="@firebase/analytics",xD="@firebase/app-check-compat",_D="@firebase/app-check",ED="@firebase/auth",vD="@firebase/auth-compat",ID="@firebase/database",AD="@firebase/data-connect",TD="@firebase/database-compat",CD="@firebase/functions",SD="@firebase/functions-compat",bD="@firebase/installations",RD="@firebase/installations-compat",ND="@firebase/messaging",PD="@firebase/messaging-compat",DD="@firebase/performance",kD="@firebase/performance-compat",OD="@firebase/remote-config",MD="@firebase/remote-config-compat",LD="@firebase/storage",FD="@firebase/storage-compat",VD="@firebase/firestore",BD="@firebase/vertexai-preview",UD="@firebase/firestore-compat",jD="firebase",zD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0="[DEFAULT]",GD={[Dp]:"fire-core",[pD]:"fire-core-compat",[wD]:"fire-analytics",[yD]:"fire-analytics-compat",[_D]:"fire-app-check",[xD]:"fire-app-check-compat",[ED]:"fire-auth",[vD]:"fire-auth-compat",[ID]:"fire-rtdb",[AD]:"fire-data-connect",[TD]:"fire-rtdb-compat",[CD]:"fire-fn",[SD]:"fire-fn-compat",[bD]:"fire-iid",[RD]:"fire-iid-compat",[ND]:"fire-fcm",[PD]:"fire-fcm-compat",[DD]:"fire-perf",[kD]:"fire-perf-compat",[OD]:"fire-rc",[MD]:"fire-rc-compat",[LD]:"fire-gcs",[FD]:"fire-gcs-compat",[VD]:"fire-fst",[UD]:"fire-fst-compat",[BD]:"fire-vertex","fire-js":"fire-js",[jD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=new Map,HD=new Map,kp=new Map;function x2(t,e){try{t.container.addComponent(e)}catch(n){co.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ma(t){const e=t.name;if(kp.has(e))return co.debug(`There were multiple attempts to register component ${e}.`),!1;kp.set(e,t);for(const n of Q0.values())x2(n,t);for(const n of HD.values())x2(n,t);return!0}function Ll(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function WD(t,e,n=$0){Ll(t,e).clearInstance(n)}function qi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ha=new Pd("app","Firebase",qD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ha.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=zD;function jT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:$0,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ha.create("bad-app-name",{appName:String(i)});if(n||(n=OT()),!n)throw ha.create("no-options");const s=Q0.get(i);if(s){if(ga(n,s.options)&&ga(r,s.config))return s;throw ha.create("duplicate-app",{appName:i})}const l=new Z8(i);for(const f of kp.values())l.addComponent(f);const h=new KD(n,r,l);return Q0.set(i,h),h}function q1(t=$0){const e=Q0.get(t);if(!e&&t===$0&&OT())return jT();if(!e)throw ha.create("no-app",{appName:t});return e}function Ii(t,e,n){var r;let i=(r=GD[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),l=e.match(/\s|\//);if(s||l){const h=[`Unable to register library "${i}" with version "${e}":`];s&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&l&&h.push("and"),l&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),co.warn(h.join(" "));return}ma(new lo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D="firebase-heartbeat-database",QD=1,od="firebase-heartbeat-store";let um=null;function zT(){return um||(um=hD($D,QD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(od)}catch(n){console.warn(n)}}}}).catch(t=>{throw ha.create("idb-open",{originalErrorMessage:t.message})})),um}async function XD(t){try{const n=(await zT()).transaction(od),r=await n.objectStore(od).get(GT(t));return await n.done,r}catch(e){if(e instanceof Ns)co.warn(e.message);else{const n=ha.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});co.warn(n.message)}}}async function _2(t,e){try{const r=(await zT()).transaction(od,"readwrite");await r.objectStore(od).put(e,GT(t)),await r.done}catch(n){if(n instanceof Ns)co.warn(n.message);else{const r=ha.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});co.warn(r.message)}}}function GT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=1024,ZD=30*24*60*60*1e3;class JD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new t6(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=E2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(l=>l.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(l=>{const h=new Date(l.date).valueOf();return Date.now()-h<=ZD}),this._storage.overwrite(this._heartbeatsCache))}catch(r){co.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=E2(),{heartbeatsToSend:r,unsentEntries:i}=e6(this._heartbeatsCache.heartbeats),s=K0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return co.warn(n),""}}}function E2(){return new Date().toISOString().substring(0,10)}function e6(t,e=YD){const n=[];let r=t.slice();for(const i of t){const s=n.find(l=>l.agent===i.agent);if(s){if(s.dates.push(i.date),v2(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),v2(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class t6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VT()?j8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await XD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return _2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return _2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function v2(t){return K0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n6(t){ma(new lo("platform-logger",e=>new gD(e),"PRIVATE")),ma(new lo("heartbeat",e=>new JD(e),"PRIVATE")),Ii(Dp,w2,t),Ii(Dp,w2,"esm2017"),Ii("fire-js","")}n6("");function _w(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function HT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const r6=HT,WT=new Pd("auth","Firebase",HT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0=new ww("@firebase/auth");function i6(t,...e){X0.logLevel<=ut.WARN&&X0.warn(`Auth (${Fl}): ${t}`,...e)}function o0(t,...e){X0.logLevel<=ut.ERROR&&X0.error(`Auth (${Fl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t,...e){throw Ew(t,...e)}function vs(t,...e){return Ew(t,...e)}function qT(t,e,n){const r=Object.assign(Object.assign({},r6()),{[e]:n});return new Pd("auth","Firebase",r).create(e,{appName:t.name})}function Is(t){return qT(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ew(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return WT.create(t,...e)}function qe(t,e,...n){if(!t)throw Ew(e,...n)}function Zs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw o0(e),new Error(e)}function uo(t,e){t||Zs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Op(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function s6(){return I2()==="http:"||I2()==="https:"}function I2(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(s6()||V8()||"connection"in navigator)?navigator.onLine:!0}function a6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,n){this.shortDelay=e,this.longDelay=n,uo(n>e,"Short delay should be less than long delay!"),this.isMobile=M8()||B8()}get(){return o6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t,e){uo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Zs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Zs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Zs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c6=new kd(3e4,6e4);function ba(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ps(t,e,n,r,i={}){return $T(t,i,async()=>{let s={},l={};r&&(e==="GET"?l=r:s={body:JSON.stringify(r)});const h=Dd(Object.assign({key:t.config.apiKey},l)).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const m=Object.assign({method:e,headers:f},s);return F8()||(m.referrerPolicy="no-referrer"),KT.fetch()(QT(t,t.config.apiHost,n,h),m)})}async function $T(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},l6),e);try{const i=new h6(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const l=await s.json();if("needConfirmation"in l)throw Lf(t,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{const h=s.ok?l.errorMessage:l.error.message,[f,m]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Lf(t,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Lf(t,"email-already-in-use",l);if(f==="USER_DISABLED")throw Lf(t,"user-disabled",l);const x=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw qT(t,x,m);Yi(t,x)}}catch(i){if(i instanceof Ns)throw i;Yi(t,"network-request-failed",{message:String(i)})}}async function Od(t,e,n,r,i={}){const s=await Ps(t,e,n,r,i);return"mfaPendingCredential"in s&&Yi(t,"multi-factor-auth-required",{_serverResponse:s}),s}function QT(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?vw(t.config,i):`${t.config.apiScheme}://${i}`}function u6(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class h6{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(vs(this.auth,"network-request-failed")),c6.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Lf(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=vs(t,e,r);return i.customData._tokenResponse=n,i}function A2(t){return t!==void 0&&t.enterprise!==void 0}class d6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return u6(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function f6(t,e){return Ps(t,"GET","/v2/recaptchaConfig",ba(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g6(t,e){return Ps(t,"POST","/v1/accounts:delete",e)}async function XT(t,e){return Ps(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function m6(t,e=!1){const n=mt(t),r=await n.getIdToken(e),i=Iw(r);qe(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,l=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Nh(hm(i.auth_time)),issuedAtTime:Nh(hm(i.iat)),expirationTime:Nh(hm(i.exp)),signInProvider:l||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function hm(t){return Number(t)*1e3}function Iw(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return o0("JWT malformed, contained fewer than 3 sections"),null;try{const i=DT(n);return i?JSON.parse(i):(o0("Failed to decode base64 JWT payload"),null)}catch(i){return o0("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function T2(t){const e=Iw(t);return qe(e,"internal-error"),qe(typeof e.exp<"u","internal-error"),qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function El(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ns&&p6(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function p6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nh(this.lastLoginAt),this.creationTime=Nh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y0(t){var e;const n=t.auth,r=await t.getIdToken(),i=await El(t,XT(n,{idToken:r}));qe(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const l=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?YT(s.providerUserInfo):[],h=x6(t.providerData,l),f=t.isAnonymous,m=!(t.email&&s.passwordHash)&&!(h!=null&&h.length),x=f?m:!1,_={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:h,metadata:new Mp(s.createdAt,s.lastLoginAt),isAnonymous:x};Object.assign(t,_)}async function w6(t){const e=mt(t);await Y0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function x6(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function YT(t){return t.map(e=>{var{providerId:n}=e,r=_w(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _6(t,e){const n=await $T(t,{},async()=>{const r=Dd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,l=QT(t,i,"/v1/token",`key=${s}`),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",KT.fetch()(l,{method:"POST",headers:h,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function E6(t,e){return Ps(t,"POST","/v2/accounts:revokeToken",ba(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qe(e.idToken,"internal-error"),qe(typeof e.idToken<"u","internal-error"),qe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):T2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){qe(e.length!==0,"internal-error");const n=T2(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await _6(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,l=new Oc;return r&&(qe(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),i&&(qe(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),s&&(qe(typeof s=="number","internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Oc,this.toJSON())}_performRefresh(){return Zs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t,e){qe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Js{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=_w(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new y6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Mp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await El(this,this.stsTokenManager.getToken(this.auth,e));return qe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return m6(this,e)}reload(){return w6(this)}_assign(e){this!==e&&(qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Js(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Y0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qi(this.auth.app))return Promise.reject(Is(this.auth));const e=await this.getIdToken();return await El(this,g6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,l,h,f,m,x;const _=(r=n.displayName)!==null&&r!==void 0?r:void 0,I=(i=n.email)!==null&&i!==void 0?i:void 0,R=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,B=(l=n.photoURL)!==null&&l!==void 0?l:void 0,D=(h=n.tenantId)!==null&&h!==void 0?h:void 0,G=(f=n._redirectEventId)!==null&&f!==void 0?f:void 0,F=(m=n.createdAt)!==null&&m!==void 0?m:void 0,P=(x=n.lastLoginAt)!==null&&x!==void 0?x:void 0,{uid:N,emailVerified:H,isAnonymous:Y,providerData:J,stsTokenManager:k}=n;qe(N&&k,e,"internal-error");const M=Oc.fromJSON(this.name,k);qe(typeof N=="string",e,"internal-error"),So(_,e.name),So(I,e.name),qe(typeof H=="boolean",e,"internal-error"),qe(typeof Y=="boolean",e,"internal-error"),So(R,e.name),So(B,e.name),So(D,e.name),So(G,e.name),So(F,e.name),So(P,e.name);const L=new Js({uid:N,auth:e,email:I,emailVerified:H,displayName:_,isAnonymous:Y,photoURL:B,phoneNumber:R,tenantId:D,stsTokenManager:M,createdAt:F,lastLoginAt:P});return J&&Array.isArray(J)&&(L.providerData=J.map(W=>Object.assign({},W))),G&&(L._redirectEventId=G),L}static async _fromIdTokenResponse(e,n,r=!1){const i=new Oc;i.updateFromServerResponse(n);const s=new Js({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Y0(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];qe(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?YT(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),h=new Oc;h.updateFromIdToken(r);const f=new Js({uid:i.localId,auth:e,stsTokenManager:h,isAnonymous:l}),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Mp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=new Map;function eo(t){uo(t instanceof Function,"Expected a class definition");let e=C2.get(t);return e?(uo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,C2.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ZT.type="NONE";const S2=ZT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(t,e,n){return`firebase:${t}:${e}:${n}`}class Mc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=a0(this.userKey,i.apiKey,s),this.fullPersistenceKey=a0("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Js._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Mc(eo(S2),e,r);const i=(await Promise.all(n.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let s=i[0]||eo(S2);const l=a0(r,e.config.apiKey,e.name);let h=null;for(const m of n)try{const x=await m._get(l);if(x){const _=Js._fromJSON(e,x);m!==s&&(h=_),s=m;break}}catch{}const f=i.filter(m=>m._shouldAllowMigration);return!s._shouldAllowMigration||!f.length?new Mc(s,e,r):(s=f[0],h&&await s._set(l,h.toJSON()),await Promise.all(n.map(async m=>{if(m!==s)try{await m._remove(l)}catch{}})),new Mc(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(JT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(iC(e))return"Blackberry";if(sC(e))return"Webos";if(eC(e))return"Safari";if((e.includes("chrome/")||tC(e))&&!e.includes("edge/"))return"Chrome";if(rC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function JT(t=Kn()){return/firefox\//i.test(t)}function eC(t=Kn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tC(t=Kn()){return/crios\//i.test(t)}function nC(t=Kn()){return/iemobile/i.test(t)}function rC(t=Kn()){return/android/i.test(t)}function iC(t=Kn()){return/blackberry/i.test(t)}function sC(t=Kn()){return/webos/i.test(t)}function Aw(t=Kn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function v6(t=Kn()){var e;return Aw(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function I6(){return U8()&&document.documentMode===10}function oC(t=Kn()){return Aw(t)||rC(t)||sC(t)||iC(t)||/windows phone/i.test(t)||nC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(t,e=[]){let n;switch(t){case"Browser":n=b2(Kn());break;case"Worker":n=`${b2(Kn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Fl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((l,h)=>{try{const f=e(s);l(f)}catch(f){h(f)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T6(t,e={}){return Ps(t,"GET","/v2/passwordPolicy",ba(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=6;class S6{constructor(e){var n,r,i,s;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=l.minPasswordLength)!==null&&n!==void 0?n:C6,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,l,h;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(n=f.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),f.isValid&&(f.isValid=(r=f.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(i=f.containsLowercaseLetter)!==null&&i!==void 0?i:!0),f.isValid&&(f.isValid=(s=f.containsUppercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(l=f.containsNumericCharacter)!==null&&l!==void 0?l:!0),f.isValid&&(f.isValid=(h=f.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),f}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new R2(this),this.idTokenSubscription=new R2(this),this.beforeStateQueue=new A6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=WT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=eo(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Mc.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await XT(this,{idToken:e}),r=await Js._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(qi(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(h,h))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,h=i==null?void 0:i._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===h)&&(f!=null&&f.user)&&(i=f.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Y0(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=a6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qi(this.app))return Promise.reject(Is(this));const n=e?mt(e):null;return n&&qe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qi(this.app)?Promise.reject(Is(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qi(this.app)?Promise.reject(Is(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(eo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await T6(this),n=new S6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pd("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await E6(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&eo(e)||this._popupRedirectResolver;qe(n,this,"argument-error"),this.redirectPersistenceManager=await Mc.create(this,[eo(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let l=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(qe(h,this,"internal-error"),h.then(()=>{l||s(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,r,i);return()=>{l=!0,f()}}else{const f=e.addObserver(n);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&i6(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Vl(t){return mt(t)}class R2{constructor(e){this.auth=e,this.observer=null,this.addObserver=q8(n=>this.observer=n)}get next(){return qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let K1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function R6(t){K1=t}function lC(t){return K1.loadJS(t)}function N6(){return K1.recaptchaEnterpriseScript}function P6(){return K1.gapiScript}function D6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const k6="recaptcha-enterprise",O6="NO_RECAPTCHA";class M6{constructor(e){this.type=k6,this.auth=Vl(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(l,h)=>{f6(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const m=new d6(f);return s.tenantId==null?s._agentRecaptchaConfig=m:s._tenantRecaptchaConfigs[s.tenantId]=m,l(m.siteKey)}}).catch(f=>{h(f)})})}function i(s,l,h){const f=window.grecaptcha;A2(f)?f.enterprise.ready(()=>{f.enterprise.execute(s,{action:e}).then(m=>{l(m)}).catch(()=>{l(O6)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,l)=>{r(this.auth).then(h=>{if(!n&&A2(window.grecaptcha))i(h,s,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=N6();f.length!==0&&(f+=h),lC(f).then(()=>{i(h,s,l)}).catch(m=>{l(m)})}}).catch(h=>{l(h)})})}}async function N2(t,e,n,r=!1){const i=new M6(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const l=Object.assign({},e);return r?Object.assign(l,{captchaResp:s}):Object.assign(l,{captchaResponse:s}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Lp(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await N2(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await N2(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L6(t,e){const n=Ll(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(ga(s,e??{}))return i;Yi(i,"already-initialized")}return n.initialize({options:e})}function F6(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(eo);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function V6(t,e,n){const r=Vl(t);qe(r._canInitEmulator,r,"emulator-config-failed"),qe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=cC(e),{host:l,port:h}=B6(e),f=h===null?"":`:${h}`;r.config.emulator={url:`${s}//${l}${f}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:l,port:h,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||U6()}function cC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function B6(t){const e=cC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:P2(r.substr(s.length+1))}}else{const[s,l]=r.split(":");return{host:s,port:P2(l)}}}function P2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function U6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Zs("not implemented")}_getIdTokenResponse(e){return Zs("not implemented")}_linkToIdToken(e,n){return Zs("not implemented")}_getReauthenticationResolver(e){return Zs("not implemented")}}async function j6(t,e){return Ps(t,"POST","/v1/accounts:update",e)}async function z6(t,e){return Ps(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G6(t,e){return Od(t,"POST","/v1/accounts:signInWithPassword",ba(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H6(t,e){return Od(t,"POST","/v1/accounts:signInWithEmailLink",ba(t,e))}async function W6(t,e){return Od(t,"POST","/v1/accounts:signInWithEmailLink",ba(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad extends Tw{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new ad(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ad(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lp(e,n,"signInWithPassword",G6);case"emailLink":return H6(e,{email:this._email,oobCode:this._password});default:Yi(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lp(e,r,"signUpPassword",z6);case"emailLink":return W6(e,{idToken:n,email:this._email,oobCode:this._password});default:Yi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lc(t,e){return Od(t,"POST","/v1/accounts:signInWithIdp",ba(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q6="http://localhost";class vl extends Tw{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new vl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Yi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=_w(n,["providerId","signInMethod"]);if(!r||!i)return null;const l=new vl(r,i);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){const n=this.buildRequest();return Lc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Lc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Lc(e,n)}buildRequest(){const e={requestUri:q6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Dd(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K6(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $6(t){const e=mh(ph(t)).link,n=e?mh(ph(e)).deep_link_id:null,r=mh(ph(t)).deep_link_id;return(r?mh(ph(r)).link:null)||r||n||e||t}class Cw{constructor(e){var n,r,i,s,l,h;const f=mh(ph(e)),m=(n=f.apiKey)!==null&&n!==void 0?n:null,x=(r=f.oobCode)!==null&&r!==void 0?r:null,_=K6((i=f.mode)!==null&&i!==void 0?i:null);qe(m&&x&&_,"argument-error"),this.apiKey=m,this.operation=_,this.code=x,this.continueUrl=(s=f.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(l=f.languageCode)!==null&&l!==void 0?l:null,this.tenantId=(h=f.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const n=$6(e);try{return new Cw(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(){this.providerId=Bl.PROVIDER_ID}static credential(e,n){return ad._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Cw.parseLink(n);return qe(r,"argument-error"),ad._fromEmailAndCode(e,r.code,r.tenantId)}}Bl.PROVIDER_ID="password";Bl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Bl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md extends uC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo extends Md{constructor(){super("facebook.com")}static credential(e){return vl._fromParams({providerId:Lo.PROVIDER_ID,signInMethod:Lo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lo.credentialFromTaggedObject(e)}static credentialFromError(e){return Lo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lo.credential(e.oauthAccessToken)}catch{return null}}}Lo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Lo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo extends Md{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return vl._fromParams({providerId:Fo.PROVIDER_ID,signInMethod:Fo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fo.credentialFromTaggedObject(e)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Fo.credential(n,r)}catch{return null}}}Fo.GOOGLE_SIGN_IN_METHOD="google.com";Fo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo extends Md{constructor(){super("github.com")}static credential(e){return vl._fromParams({providerId:Vo.PROVIDER_ID,signInMethod:Vo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vo.credentialFromTaggedObject(e)}static credentialFromError(e){return Vo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vo.credential(e.oauthAccessToken)}catch{return null}}}Vo.GITHUB_SIGN_IN_METHOD="github.com";Vo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo extends Md{constructor(){super("twitter.com")}static credential(e,n){return vl._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Bo.credential(n,r)}catch{return null}}}Bo.TWITTER_SIGN_IN_METHOD="twitter.com";Bo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q6(t,e){return Od(t,"POST","/v1/accounts:signUp",ba(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Js._fromIdTokenResponse(e,r,i),l=D2(r);return new Il({user:s,providerId:l,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=D2(r);return new Il({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function D2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0 extends Ns{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Z0.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Z0(e,n,r,i)}}function hC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Z0._fromErrorAndOperation(t,s,e,r):s})}async function X6(t,e,n=!1){const r=await El(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Il._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dC(t,e,n=!1){const{auth:r}=t;if(qi(r.app))return Promise.reject(Is(r));const i="reauthenticate";try{const s=await El(t,hC(r,i,e,t),n);qe(s.idToken,r,"internal-error");const l=Iw(s.idToken);qe(l,r,"internal-error");const{sub:h}=l;return qe(t.uid===h,r,"user-mismatch"),Il._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Yi(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fC(t,e,n=!1){if(qi(t.app))return Promise.reject(Is(t));const r="signIn",i=await hC(t,r,e),s=await Il._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Y6(t,e){return fC(Vl(t),e)}async function Z6(t,e){return dC(mt(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gC(t){const e=Vl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function J6(t,e,n){if(qi(t.app))return Promise.reject(Is(t));const r=Vl(t),l=await Lp(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Q6).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&gC(t),f}),h=await Il._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(h.user),h}function ek(t,e,n){return qi(t.app)?Promise.reject(Is(t)):Y6(mt(t),Bl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&gC(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tk(t,e){return Ps(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mC(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=mt(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},l=await El(r,tk(r.auth,s));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const h=r.providerData.find(({providerId:f})=>f==="password");h&&(h.displayName=r.displayName,h.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function nk(t,e){const n=mt(t);return qi(n.auth.app)?Promise.reject(Is(n.auth)):pC(n,e,null)}function rk(t,e){return pC(mt(t),null,e)}async function pC(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const l=await El(t,j6(r,s));await t._updateTokensIfNecessary(l,!0)}function ik(t,e,n,r){return mt(t).onIdTokenChanged(e,n,r)}function sk(t,e,n){return mt(t).beforeAuthStateChanged(e,n)}function ok(t,e,n,r){return mt(t).onAuthStateChanged(e,n,r)}function yC(t){return mt(t).signOut()}async function ak(t){return mt(t).delete()}const J0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(J0,"1"),this.storage.removeItem(J0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=1e3,ck=10;class xC extends wC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=oC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((l,h,f)=>{this.notifyListeners(l,f)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(r);!n&&this.localCache[r]===l||this.notifyListeners(r,l)},s=this.storage.getItem(r);I6()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,ck):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},lk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}xC.type="LOCAL";const uk=xC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C extends wC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}_C.type="SESSION";const EC=_C;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new $1(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,l=this.handlersMap[i];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const h=Array.from(l).map(async m=>m(n.origin,s)),f=await hk(h);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,l;return new Promise((h,f)=>{const m=Sw("",20);i.port1.start();const x=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:i,onMessage(_){const I=_;if(I.data.eventId===m)switch(I.data.status){case"ack":clearTimeout(x),s=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),h(I.data.response);break;default:clearTimeout(x),clearTimeout(s),f(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:n},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(){return window}function fk(t){As().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(){return typeof As().WorkerGlobalScope<"u"&&typeof As().importScripts=="function"}async function gk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function pk(){return vC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC="firebaseLocalStorageDb",yk=1,e1="firebaseLocalStorage",AC="fbase_key";class Ld{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Q1(t,e){return t.transaction([e1],e?"readwrite":"readonly").objectStore(e1)}function wk(){const t=indexedDB.deleteDatabase(IC);return new Ld(t).toPromise()}function Fp(){const t=indexedDB.open(IC,yk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(e1,{keyPath:AC})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(e1)?e(r):(r.close(),await wk(),e(await Fp()))})})}async function k2(t,e,n){const r=Q1(t,!0).put({[AC]:e,value:n});return new Ld(r).toPromise()}async function xk(t,e){const n=Q1(t,!1).get(e),r=await new Ld(n).toPromise();return r===void 0?null:r.value}function O2(t,e){const n=Q1(t,!0).delete(e);return new Ld(n).toPromise()}const _k=800,Ek=3;class TC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Fp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Ek)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$1._getInstance(pk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await gk(),!this.activeServiceWorker)return;this.sender=new dk(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Fp();return await k2(e,J0,"1"),await O2(e,J0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>k2(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>xk(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>O2(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Q1(i,!1).getAll();return new Ld(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_k)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}TC.type="LOCAL";const vk=TC;new kd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(t,e){return e?eo(e):(qe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw extends Tw{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Lc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Lc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Ak(t){return fC(t.auth,new bw(t),t.bypassAuthState)}function Tk(t){const{auth:e,user:n}=t;return qe(n,e,"internal-error"),dC(n,new bw(t),t.bypassAuthState)}async function Ck(t){const{auth:e,user:n}=t;return qe(n,e,"internal-error"),X6(n,new bw(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:l,type:h}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ak;case"linkViaPopup":case"linkViaRedirect":return Ck;case"reauthViaPopup":case"reauthViaRedirect":return Tk;default:Yi(this.auth,"internal-error")}}resolve(e){uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){uo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=new kd(2e3,1e4);class Cc extends CC{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Cc.currentPopupAction&&Cc.currentPopupAction.cancel(),Cc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qe(e,this.auth,"internal-error"),e}async onExecution(){uo(this.filter.length===1,"Popup operations only handle one event");const e=Sw();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(vs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(vs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Cc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Sk.get())};e()}}Cc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk="pendingRedirect",l0=new Map;class Rk extends CC{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=l0.get(this.auth._key());if(!e){try{const r=await Nk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}l0.set(this.auth._key(),e)}return this.bypassAuthState||l0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Nk(t,e){const n=kk(e),r=Dk(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function Pk(t,e){l0.set(t._key(),e)}function Dk(t){return eo(t._redirectPersistence)}function kk(t){return a0(bk,t.config.apiKey,t.name)}async function Ok(t,e,n=!1){if(qi(t.app))return Promise.reject(Is(t));const r=Vl(t),i=Ik(r,e),l=await new Rk(r,i,n).execute();return l&&!n&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk=10*60*1e3;class Lk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Fk(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!SC(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(vs(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Mk&&this.cachedEventUids.clear(),this.cachedEventUids.has(M2(e))}saveEventToCache(e){this.cachedEventUids.add(M2(e)),this.lastProcessedEventTime=Date.now()}}function M2(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function SC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Fk(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return SC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vk(t,e={}){return Ps(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Uk=/^https?/;async function jk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Vk(t);for(const n of e)try{if(zk(n))return}catch{}Yi(t,"unauthorized-domain")}function zk(t){const e=Op(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===r}if(!Uk.test(n))return!1;if(Bk.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk=new kd(3e4,6e4);function L2(){const t=As().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Hk(t){return new Promise((e,n)=>{var r,i,s;function l(){L2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{L2(),n(vs(t,"network-request-failed"))},timeout:Gk.get()})}if(!((i=(r=As().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=As().gapi)===null||s===void 0)&&s.load)l();else{const h=D6("iframefcb");return As()[h]=()=>{gapi.load?l():n(vs(t,"network-request-failed"))},lC(`${P6()}?onload=${h}`).catch(f=>n(f))}}).catch(e=>{throw c0=null,e})}let c0=null;function Wk(t){return c0=c0||Hk(t),c0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk=new kd(5e3,15e3),Kk="__/auth/iframe",$k="emulator/auth/iframe",Qk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Xk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yk(t){const e=t.config;qe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?vw(e,$k):`https://${t.config.authDomain}/${Kk}`,r={apiKey:e.apiKey,appName:t.name,v:Fl},i=Xk.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Dd(r).slice(1)}`}async function Zk(t){const e=await Wk(t),n=As().gapi;return qe(n,t,"internal-error"),e.open({where:document.body,url:Yk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Qk,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const l=vs(t,"network-request-failed"),h=As().setTimeout(()=>{s(l)},qk.get());function f(){As().clearTimeout(h),i(r)}r.ping(f).then(f,()=>{s(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},eO=500,tO=600,nO="_blank",rO="http://localhost";class F2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function iO(t,e,n,r=eO,i=tO){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const f=Object.assign(Object.assign({},Jk),{width:r.toString(),height:i.toString(),top:s,left:l}),m=Kn().toLowerCase();n&&(h=tC(m)?nO:n),JT(m)&&(e=e||rO,f.scrollbars="yes");const x=Object.entries(f).reduce((I,[R,B])=>`${I}${R}=${B},`,"");if(v6(m)&&h!=="_self")return sO(e||"",h),new F2(null);const _=window.open(e||"",h,x);qe(_,t,"popup-blocked");try{_.focus()}catch{}return new F2(_)}function sO(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO="__/auth/handler",aO="emulator/auth/handler",lO=encodeURIComponent("fac");async function V2(t,e,n,r,i,s){qe(t.config.authDomain,t,"auth-domain-config-required"),qe(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Fl,eventId:i};if(e instanceof uC){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",W8(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,_]of Object.entries(s||{}))l[x]=_}if(e instanceof Md){const x=e.getScopes().filter(_=>_!=="");x.length>0&&(l.scopes=x.join(","))}t.tenantId&&(l.tid=t.tenantId);const h=l;for(const x of Object.keys(h))h[x]===void 0&&delete h[x];const f=await t._getAppCheckToken(),m=f?`#${lO}=${encodeURIComponent(f)}`:"";return`${cO(t)}?${Dd(h).slice(1)}${m}`}function cO({config:t}){return t.emulator?vw(t,aO):`https://${t.authDomain}/${oO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm="webStorageSupport";class uO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=EC,this._completeRedirectFn=Ok,this._overrideRedirectResult=Pk}async _openPopup(e,n,r,i){var s;uo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const l=await V2(e,n,r,Op(),i);return iO(e,l,Sw())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await V2(e,n,r,Op(),i);return fk(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(uo(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Zk(e),r=new Lk(e);return n.register("authEvent",i=>(qe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(dm,{type:dm},i=>{var s;const l=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[dm];l!==void 0&&n(!!l),Yi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=jk(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return oC()||eC()||Aw()}}const hO=uO;var B2="@firebase/auth",U2="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function gO(t){ma(new lo("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=r.options;qe(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aC(t)},m=new b6(r,i,s,f);return F6(m,n),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ma(new lo("auth-internal",e=>{const n=Vl(e.getProvider("auth").getImmediate());return(r=>new dO(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ii(B2,U2,fO(t)),Ii(B2,U2,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mO=5*60,pO=MT("authIdTokenMaxAge")||mO;let j2=null;const yO=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>pO)return;const i=n==null?void 0:n.token;j2!==i&&(j2=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function wO(t=q1()){const e=Ll(t,"auth");if(e.isInitialized())return e.getImmediate();const n=L6(t,{popupRedirectResolver:hO,persistence:[vk,uk,EC]}),r=MT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const l=yO(s.toString());sk(n,l,()=>l(n.currentUser)),ik(n,h=>l(h))}}const i=kT("auth");return i&&V6(n,`http://${i}`),n}function xO(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}R6({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=vs("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",xO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});gO("Browser");var z2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gl,bC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,M){function L(){}L.prototype=M.prototype,k.D=M.prototype,k.prototype=new L,k.prototype.constructor=k,k.C=function(W,K,q){for(var j=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)j[ze-2]=arguments[ze];return M.prototype[K].apply(W,j)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,M,L){L||(L=0);var W=Array(16);if(typeof M=="string")for(var K=0;16>K;++K)W[K]=M.charCodeAt(L++)|M.charCodeAt(L++)<<8|M.charCodeAt(L++)<<16|M.charCodeAt(L++)<<24;else for(K=0;16>K;++K)W[K]=M[L++]|M[L++]<<8|M[L++]<<16|M[L++]<<24;M=k.g[0],L=k.g[1],K=k.g[2];var q=k.g[3],j=M+(q^L&(K^q))+W[0]+3614090360&4294967295;M=L+(j<<7&4294967295|j>>>25),j=q+(K^M&(L^K))+W[1]+3905402710&4294967295,q=M+(j<<12&4294967295|j>>>20),j=K+(L^q&(M^L))+W[2]+606105819&4294967295,K=q+(j<<17&4294967295|j>>>15),j=L+(M^K&(q^M))+W[3]+3250441966&4294967295,L=K+(j<<22&4294967295|j>>>10),j=M+(q^L&(K^q))+W[4]+4118548399&4294967295,M=L+(j<<7&4294967295|j>>>25),j=q+(K^M&(L^K))+W[5]+1200080426&4294967295,q=M+(j<<12&4294967295|j>>>20),j=K+(L^q&(M^L))+W[6]+2821735955&4294967295,K=q+(j<<17&4294967295|j>>>15),j=L+(M^K&(q^M))+W[7]+4249261313&4294967295,L=K+(j<<22&4294967295|j>>>10),j=M+(q^L&(K^q))+W[8]+1770035416&4294967295,M=L+(j<<7&4294967295|j>>>25),j=q+(K^M&(L^K))+W[9]+2336552879&4294967295,q=M+(j<<12&4294967295|j>>>20),j=K+(L^q&(M^L))+W[10]+4294925233&4294967295,K=q+(j<<17&4294967295|j>>>15),j=L+(M^K&(q^M))+W[11]+2304563134&4294967295,L=K+(j<<22&4294967295|j>>>10),j=M+(q^L&(K^q))+W[12]+1804603682&4294967295,M=L+(j<<7&4294967295|j>>>25),j=q+(K^M&(L^K))+W[13]+4254626195&4294967295,q=M+(j<<12&4294967295|j>>>20),j=K+(L^q&(M^L))+W[14]+2792965006&4294967295,K=q+(j<<17&4294967295|j>>>15),j=L+(M^K&(q^M))+W[15]+1236535329&4294967295,L=K+(j<<22&4294967295|j>>>10),j=M+(K^q&(L^K))+W[1]+4129170786&4294967295,M=L+(j<<5&4294967295|j>>>27),j=q+(L^K&(M^L))+W[6]+3225465664&4294967295,q=M+(j<<9&4294967295|j>>>23),j=K+(M^L&(q^M))+W[11]+643717713&4294967295,K=q+(j<<14&4294967295|j>>>18),j=L+(q^M&(K^q))+W[0]+3921069994&4294967295,L=K+(j<<20&4294967295|j>>>12),j=M+(K^q&(L^K))+W[5]+3593408605&4294967295,M=L+(j<<5&4294967295|j>>>27),j=q+(L^K&(M^L))+W[10]+38016083&4294967295,q=M+(j<<9&4294967295|j>>>23),j=K+(M^L&(q^M))+W[15]+3634488961&4294967295,K=q+(j<<14&4294967295|j>>>18),j=L+(q^M&(K^q))+W[4]+3889429448&4294967295,L=K+(j<<20&4294967295|j>>>12),j=M+(K^q&(L^K))+W[9]+568446438&4294967295,M=L+(j<<5&4294967295|j>>>27),j=q+(L^K&(M^L))+W[14]+3275163606&4294967295,q=M+(j<<9&4294967295|j>>>23),j=K+(M^L&(q^M))+W[3]+4107603335&4294967295,K=q+(j<<14&4294967295|j>>>18),j=L+(q^M&(K^q))+W[8]+1163531501&4294967295,L=K+(j<<20&4294967295|j>>>12),j=M+(K^q&(L^K))+W[13]+2850285829&4294967295,M=L+(j<<5&4294967295|j>>>27),j=q+(L^K&(M^L))+W[2]+4243563512&4294967295,q=M+(j<<9&4294967295|j>>>23),j=K+(M^L&(q^M))+W[7]+1735328473&4294967295,K=q+(j<<14&4294967295|j>>>18),j=L+(q^M&(K^q))+W[12]+2368359562&4294967295,L=K+(j<<20&4294967295|j>>>12),j=M+(L^K^q)+W[5]+4294588738&4294967295,M=L+(j<<4&4294967295|j>>>28),j=q+(M^L^K)+W[8]+2272392833&4294967295,q=M+(j<<11&4294967295|j>>>21),j=K+(q^M^L)+W[11]+1839030562&4294967295,K=q+(j<<16&4294967295|j>>>16),j=L+(K^q^M)+W[14]+4259657740&4294967295,L=K+(j<<23&4294967295|j>>>9),j=M+(L^K^q)+W[1]+2763975236&4294967295,M=L+(j<<4&4294967295|j>>>28),j=q+(M^L^K)+W[4]+1272893353&4294967295,q=M+(j<<11&4294967295|j>>>21),j=K+(q^M^L)+W[7]+4139469664&4294967295,K=q+(j<<16&4294967295|j>>>16),j=L+(K^q^M)+W[10]+3200236656&4294967295,L=K+(j<<23&4294967295|j>>>9),j=M+(L^K^q)+W[13]+681279174&4294967295,M=L+(j<<4&4294967295|j>>>28),j=q+(M^L^K)+W[0]+3936430074&4294967295,q=M+(j<<11&4294967295|j>>>21),j=K+(q^M^L)+W[3]+3572445317&4294967295,K=q+(j<<16&4294967295|j>>>16),j=L+(K^q^M)+W[6]+76029189&4294967295,L=K+(j<<23&4294967295|j>>>9),j=M+(L^K^q)+W[9]+3654602809&4294967295,M=L+(j<<4&4294967295|j>>>28),j=q+(M^L^K)+W[12]+3873151461&4294967295,q=M+(j<<11&4294967295|j>>>21),j=K+(q^M^L)+W[15]+530742520&4294967295,K=q+(j<<16&4294967295|j>>>16),j=L+(K^q^M)+W[2]+3299628645&4294967295,L=K+(j<<23&4294967295|j>>>9),j=M+(K^(L|~q))+W[0]+4096336452&4294967295,M=L+(j<<6&4294967295|j>>>26),j=q+(L^(M|~K))+W[7]+1126891415&4294967295,q=M+(j<<10&4294967295|j>>>22),j=K+(M^(q|~L))+W[14]+2878612391&4294967295,K=q+(j<<15&4294967295|j>>>17),j=L+(q^(K|~M))+W[5]+4237533241&4294967295,L=K+(j<<21&4294967295|j>>>11),j=M+(K^(L|~q))+W[12]+1700485571&4294967295,M=L+(j<<6&4294967295|j>>>26),j=q+(L^(M|~K))+W[3]+2399980690&4294967295,q=M+(j<<10&4294967295|j>>>22),j=K+(M^(q|~L))+W[10]+4293915773&4294967295,K=q+(j<<15&4294967295|j>>>17),j=L+(q^(K|~M))+W[1]+2240044497&4294967295,L=K+(j<<21&4294967295|j>>>11),j=M+(K^(L|~q))+W[8]+1873313359&4294967295,M=L+(j<<6&4294967295|j>>>26),j=q+(L^(M|~K))+W[15]+4264355552&4294967295,q=M+(j<<10&4294967295|j>>>22),j=K+(M^(q|~L))+W[6]+2734768916&4294967295,K=q+(j<<15&4294967295|j>>>17),j=L+(q^(K|~M))+W[13]+1309151649&4294967295,L=K+(j<<21&4294967295|j>>>11),j=M+(K^(L|~q))+W[4]+4149444226&4294967295,M=L+(j<<6&4294967295|j>>>26),j=q+(L^(M|~K))+W[11]+3174756917&4294967295,q=M+(j<<10&4294967295|j>>>22),j=K+(M^(q|~L))+W[2]+718787259&4294967295,K=q+(j<<15&4294967295|j>>>17),j=L+(q^(K|~M))+W[9]+3951481745&4294967295,k.g[0]=k.g[0]+M&4294967295,k.g[1]=k.g[1]+(K+(j<<21&4294967295|j>>>11))&4294967295,k.g[2]=k.g[2]+K&4294967295,k.g[3]=k.g[3]+q&4294967295}r.prototype.u=function(k,M){M===void 0&&(M=k.length);for(var L=M-this.blockSize,W=this.B,K=this.h,q=0;q<M;){if(K==0)for(;q<=L;)i(this,k,q),q+=this.blockSize;if(typeof k=="string"){for(;q<M;)if(W[K++]=k.charCodeAt(q++),K==this.blockSize){i(this,W),K=0;break}}else for(;q<M;)if(W[K++]=k[q++],K==this.blockSize){i(this,W),K=0;break}}this.h=K,this.o+=M},r.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var M=1;M<k.length-8;++M)k[M]=0;var L=8*this.o;for(M=k.length-8;M<k.length;++M)k[M]=L&255,L/=256;for(this.u(k),k=Array(16),M=L=0;4>M;++M)for(var W=0;32>W;W+=8)k[L++]=this.g[M]>>>W&255;return k};function s(k,M){var L=h;return Object.prototype.hasOwnProperty.call(L,k)?L[k]:L[k]=M(k)}function l(k,M){this.h=M;for(var L=[],W=!0,K=k.length-1;0<=K;K--){var q=k[K]|0;W&&q==M||(L[K]=q,W=!1)}this.g=L}var h={};function f(k){return-128<=k&&128>k?s(k,function(M){return new l([M|0],0>M?-1:0)}):new l([k|0],0>k?-1:0)}function m(k){if(isNaN(k)||!isFinite(k))return _;if(0>k)return G(m(-k));for(var M=[],L=1,W=0;k>=L;W++)M[W]=k/L|0,L*=4294967296;return new l(M,0)}function x(k,M){if(k.length==0)throw Error("number format error: empty string");if(M=M||10,2>M||36<M)throw Error("radix out of range: "+M);if(k.charAt(0)=="-")return G(x(k.substring(1),M));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var L=m(Math.pow(M,8)),W=_,K=0;K<k.length;K+=8){var q=Math.min(8,k.length-K),j=parseInt(k.substring(K,K+q),M);8>q?(q=m(Math.pow(M,q)),W=W.j(q).add(m(j))):(W=W.j(L),W=W.add(m(j)))}return W}var _=f(0),I=f(1),R=f(16777216);t=l.prototype,t.m=function(){if(D(this))return-G(this).m();for(var k=0,M=1,L=0;L<this.g.length;L++){var W=this.i(L);k+=(0<=W?W:4294967296+W)*M,M*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(B(this))return"0";if(D(this))return"-"+G(this).toString(k);for(var M=m(Math.pow(k,6)),L=this,W="";;){var K=H(L,M).g;L=F(L,K.j(M));var q=((0<L.g.length?L.g[0]:L.h)>>>0).toString(k);if(L=K,B(L))return q+W;for(;6>q.length;)q="0"+q;W=q+W}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function B(k){if(k.h!=0)return!1;for(var M=0;M<k.g.length;M++)if(k.g[M]!=0)return!1;return!0}function D(k){return k.h==-1}t.l=function(k){return k=F(this,k),D(k)?-1:B(k)?0:1};function G(k){for(var M=k.g.length,L=[],W=0;W<M;W++)L[W]=~k.g[W];return new l(L,~k.h).add(I)}t.abs=function(){return D(this)?G(this):this},t.add=function(k){for(var M=Math.max(this.g.length,k.g.length),L=[],W=0,K=0;K<=M;K++){var q=W+(this.i(K)&65535)+(k.i(K)&65535),j=(q>>>16)+(this.i(K)>>>16)+(k.i(K)>>>16);W=j>>>16,q&=65535,j&=65535,L[K]=j<<16|q}return new l(L,L[L.length-1]&-2147483648?-1:0)};function F(k,M){return k.add(G(M))}t.j=function(k){if(B(this)||B(k))return _;if(D(this))return D(k)?G(this).j(G(k)):G(G(this).j(k));if(D(k))return G(this.j(G(k)));if(0>this.l(R)&&0>k.l(R))return m(this.m()*k.m());for(var M=this.g.length+k.g.length,L=[],W=0;W<2*M;W++)L[W]=0;for(W=0;W<this.g.length;W++)for(var K=0;K<k.g.length;K++){var q=this.i(W)>>>16,j=this.i(W)&65535,ze=k.i(K)>>>16,ie=k.i(K)&65535;L[2*W+2*K]+=j*ie,P(L,2*W+2*K),L[2*W+2*K+1]+=q*ie,P(L,2*W+2*K+1),L[2*W+2*K+1]+=j*ze,P(L,2*W+2*K+1),L[2*W+2*K+2]+=q*ze,P(L,2*W+2*K+2)}for(W=0;W<M;W++)L[W]=L[2*W+1]<<16|L[2*W];for(W=M;W<2*M;W++)L[W]=0;return new l(L,0)};function P(k,M){for(;(k[M]&65535)!=k[M];)k[M+1]+=k[M]>>>16,k[M]&=65535,M++}function N(k,M){this.g=k,this.h=M}function H(k,M){if(B(M))throw Error("division by zero");if(B(k))return new N(_,_);if(D(k))return M=H(G(k),M),new N(G(M.g),G(M.h));if(D(M))return M=H(k,G(M)),new N(G(M.g),M.h);if(30<k.g.length){if(D(k)||D(M))throw Error("slowDivide_ only works with positive integers.");for(var L=I,W=M;0>=W.l(k);)L=Y(L),W=Y(W);var K=J(L,1),q=J(W,1);for(W=J(W,2),L=J(L,2);!B(W);){var j=q.add(W);0>=j.l(k)&&(K=K.add(L),q=j),W=J(W,1),L=J(L,1)}return M=F(k,K.j(M)),new N(K,M)}for(K=_;0<=k.l(M);){for(L=Math.max(1,Math.floor(k.m()/M.m())),W=Math.ceil(Math.log(L)/Math.LN2),W=48>=W?1:Math.pow(2,W-48),q=m(L),j=q.j(M);D(j)||0<j.l(k);)L-=W,q=m(L),j=q.j(M);B(q)&&(q=I),K=K.add(q),k=F(k,j)}return new N(K,k)}t.A=function(k){return H(this,k).h},t.and=function(k){for(var M=Math.max(this.g.length,k.g.length),L=[],W=0;W<M;W++)L[W]=this.i(W)&k.i(W);return new l(L,this.h&k.h)},t.or=function(k){for(var M=Math.max(this.g.length,k.g.length),L=[],W=0;W<M;W++)L[W]=this.i(W)|k.i(W);return new l(L,this.h|k.h)},t.xor=function(k){for(var M=Math.max(this.g.length,k.g.length),L=[],W=0;W<M;W++)L[W]=this.i(W)^k.i(W);return new l(L,this.h^k.h)};function Y(k){for(var M=k.g.length+1,L=[],W=0;W<M;W++)L[W]=k.i(W)<<1|k.i(W-1)>>>31;return new l(L,k.h)}function J(k,M){var L=M>>5;M%=32;for(var W=k.g.length-L,K=[],q=0;q<W;q++)K[q]=0<M?k.i(q+L)>>>M|k.i(q+L+1)<<32-M:k.i(q+L);return new l(K,k.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,bC=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=x,gl=l}).apply(typeof z2<"u"?z2:typeof self<"u"?self:typeof window<"u"?window:{});var Ff=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var RC,yh,NC,u0,Vp,PC,DC,kC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,v,C){return p==Array.prototype||p==Object.prototype||(p[v]=C.value),p};function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ff=="object"&&Ff];for(var v=0;v<p.length;++v){var C=p[v];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var r=n(this);function i(p,v){if(v)e:{var C=r;p=p.split(".");for(var V=0;V<p.length-1;V++){var ee=p[V];if(!(ee in C))break e;C=C[ee]}p=p[p.length-1],V=C[p],v=v(V),v!=V&&v!=null&&e(C,p,{configurable:!0,writable:!0,value:v})}}function s(p,v){p instanceof String&&(p+="");var C=0,V=!1,ee={next:function(){if(!V&&C<p.length){var le=C++;return{value:v(le,p[le]),done:!1}}return V=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}i("Array.prototype.values",function(p){return p||function(){return s(this,function(v,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},h=this||self;function f(p){var v=typeof p;return v=v!="object"?v:p?Array.isArray(p)?"array":v:"null",v=="array"||v=="object"&&typeof p.length=="number"}function m(p){var v=typeof p;return v=="object"&&p!=null||v=="function"}function x(p,v,C){return p.call.apply(p.bind,arguments)}function _(p,v,C){if(!p)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var ee=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ee,V),p.apply(v,ee)}}return function(){return p.apply(v,arguments)}}function I(p,v,C){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:_,I.apply(null,arguments)}function R(p,v){var C=Array.prototype.slice.call(arguments,1);return function(){var V=C.slice();return V.push.apply(V,arguments),p.apply(this,V)}}function B(p,v){function C(){}C.prototype=v.prototype,p.aa=v.prototype,p.prototype=new C,p.prototype.constructor=p,p.Qb=function(V,ee,le){for(var ve=Array(arguments.length-2),vt=2;vt<arguments.length;vt++)ve[vt-2]=arguments[vt];return v.prototype[ee].apply(V,ve)}}function D(p){const v=p.length;if(0<v){const C=Array(v);for(let V=0;V<v;V++)C[V]=p[V];return C}return[]}function G(p,v){for(let C=1;C<arguments.length;C++){const V=arguments[C];if(f(V)){const ee=p.length||0,le=V.length||0;p.length=ee+le;for(let ve=0;ve<le;ve++)p[ee+ve]=V[ve]}else p.push(V)}}class F{constructor(v,C){this.i=v,this.j=C,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function P(p){return/^[\s\xa0]*$/.test(p)}function N(){var p=h.navigator;return p&&(p=p.userAgent)?p:""}function H(p){return H[" "](p),p}H[" "]=function(){};var Y=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function J(p,v,C){for(const V in p)v.call(C,p[V],V,p)}function k(p,v){for(const C in p)v.call(void 0,p[C],C,p)}function M(p){const v={};for(const C in p)v[C]=p[C];return v}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(p,v){let C,V;for(let ee=1;ee<arguments.length;ee++){V=arguments[ee];for(C in V)p[C]=V[C];for(let le=0;le<L.length;le++)C=L[le],Object.prototype.hasOwnProperty.call(V,C)&&(p[C]=V[C])}}function K(p){var v=1;p=p.split(":");const C=[];for(;0<v&&p.length;)C.push(p.shift()),v--;return p.length&&C.push(p.join(":")),C}function q(p){h.setTimeout(()=>{throw p},0)}function j(){var p=Me;let v=null;return p.g&&(v=p.g,p.g=p.g.next,p.g||(p.h=null),v.next=null),v}class ze{constructor(){this.h=this.g=null}add(v,C){const V=ie.get();V.set(v,C),this.h?this.h.next=V:this.g=V,this.h=V}}var ie=new F(()=>new rt,p=>p.reset());class rt{constructor(){this.next=this.g=this.h=null}set(v,C){this.h=v,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let Oe,Ie=!1,Me=new ze,Ue=()=>{const p=h.Promise.resolve(void 0);Oe=()=>{p.then(Rt)}};var Rt=()=>{for(var p;p=j();){try{p.h.call(p.g)}catch(C){q(C)}var v=ie;v.j(p),100>v.h&&(v.h++,p.next=v.g,v.g=p)}Ie=!1};function Xe(){this.s=this.s,this.C=this.C}Xe.prototype.s=!1,Xe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Xe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Tt(p,v){this.type=p,this.g=this.target=v,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var Vt=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var p=!1,v=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const C=()=>{};h.addEventListener("test",C,v),h.removeEventListener("test",C,v)}catch{}return p}();function fr(p,v){if(Tt.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var C=this.type=p.type,V=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=v,v=p.relatedTarget){if(Y){e:{try{H(v.nodeName);var ee=!0;break e}catch{}ee=!1}ee||(v=null)}}else C=="mouseover"?v=p.fromElement:C=="mouseout"&&(v=p.toElement);this.relatedTarget=v,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ke[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&fr.aa.h.call(this)}}B(fr,Tt);var ke={2:"touch",3:"pen",4:"mouse"};fr.prototype.h=function(){fr.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Qn="closure_listenable_"+(1e6*Math.random()|0),an=0;function Si(p,v,C,V,ee){this.listener=p,this.proxy=null,this.src=v,this.type=C,this.capture=!!V,this.ha=ee,this.key=++an,this.da=this.fa=!1}function Mr(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function An(p){this.src=p,this.g={},this.h=0}An.prototype.add=function(p,v,C,V,ee){var le=p.toString();p=this.g[le],p||(p=this.g[le]=[],this.h++);var ve=ot(p,v,V,ee);return-1<ve?(v=p[ve],C||(v.fa=!1)):(v=new Si(v,this.src,le,!!V,ee),v.fa=C,p.push(v)),v};function bi(p,v){var C=v.type;if(C in p.g){var V=p.g[C],ee=Array.prototype.indexOf.call(V,v,void 0),le;(le=0<=ee)&&Array.prototype.splice.call(V,ee,1),le&&(Mr(v),p.g[C].length==0&&(delete p.g[C],p.h--))}}function ot(p,v,C,V){for(var ee=0;ee<p.length;++ee){var le=p[ee];if(!le.da&&le.listener==v&&le.capture==!!C&&le.ha==V)return ee}return-1}var Yr="closure_lm_"+(1e6*Math.random()|0),rr={};function Zi(p,v,C,V,ee){if(V&&V.once)return it(p,v,C,V,ee);if(Array.isArray(v)){for(var le=0;le<v.length;le++)Zi(p,v[le],C,V,ee);return null}return C=be(C),p&&p[Qn]?p.K(v,C,m(V)?!!V.capture:!!V,ee):mn(p,v,C,!1,V,ee)}function mn(p,v,C,V,ee,le){if(!v)throw Error("Invalid event type");var ve=m(ee)?!!ee.capture:!!ee,vt=we(p);if(vt||(p[Yr]=vt=new An(p)),C=vt.add(v,C,V,ve,le),C.proxy)return C;if(V=Nt(),C.proxy=V,V.src=p,V.listener=C,p.addEventListener)Vt||(ee=ve),ee===void 0&&(ee=!1),p.addEventListener(v.toString(),V,ee);else if(p.attachEvent)p.attachEvent(ue(v.toString()),V);else if(p.addListener&&p.removeListener)p.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Nt(){function p(C){return v.call(p.src,p.listener,C)}const v=Ce;return p}function it(p,v,C,V,ee){if(Array.isArray(v)){for(var le=0;le<v.length;le++)it(p,v[le],C,V,ee);return null}return C=be(C),p&&p[Qn]?p.L(v,C,m(V)?!!V.capture:!!V,ee):mn(p,v,C,!0,V,ee)}function $(p,v,C,V,ee){if(Array.isArray(v))for(var le=0;le<v.length;le++)$(p,v[le],C,V,ee);else V=m(V)?!!V.capture:!!V,C=be(C),p&&p[Qn]?(p=p.i,v=String(v).toString(),v in p.g&&(le=p.g[v],C=ot(le,C,V,ee),-1<C&&(Mr(le[C]),Array.prototype.splice.call(le,C,1),le.length==0&&(delete p.g[v],p.h--)))):p&&(p=we(p))&&(v=p.g[v.toString()],p=-1,v&&(p=ot(v,C,V,ee)),(C=-1<p?v[p]:null)&&Q(C))}function Q(p){if(typeof p!="number"&&p&&!p.da){var v=p.src;if(v&&v[Qn])bi(v.i,p);else{var C=p.type,V=p.proxy;v.removeEventListener?v.removeEventListener(C,V,p.capture):v.detachEvent?v.detachEvent(ue(C),V):v.addListener&&v.removeListener&&v.removeListener(V),(C=we(v))?(bi(C,p),C.h==0&&(C.src=null,v[Yr]=null)):Mr(p)}}}function ue(p){return p in rr?rr[p]:rr[p]="on"+p}function Ce(p,v){if(p.da)p=!0;else{v=new fr(v,this);var C=p.listener,V=p.ha||p.src;p.fa&&Q(p),p=C.call(V,v)}return p}function we(p){return p=p[Yr],p instanceof An?p:null}var pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(p){return typeof p=="function"?p:(p[pe]||(p[pe]=function(v){return p.handleEvent(v)}),p[pe])}function We(){Xe.call(this),this.i=new An(this),this.M=this,this.F=null}B(We,Xe),We.prototype[Qn]=!0,We.prototype.removeEventListener=function(p,v,C,V){$(this,p,v,C,V)};function Ge(p,v){var C,V=p.F;if(V)for(C=[];V;V=V.F)C.push(V);if(p=p.M,V=v.type||v,typeof v=="string")v=new Tt(v,p);else if(v instanceof Tt)v.target=v.target||p;else{var ee=v;v=new Tt(V,p),W(v,ee)}if(ee=!0,C)for(var le=C.length-1;0<=le;le--){var ve=v.g=C[le];ee=Et(ve,V,!0,v)&&ee}if(ve=v.g=p,ee=Et(ve,V,!0,v)&&ee,ee=Et(ve,V,!1,v)&&ee,C)for(le=0;le<C.length;le++)ve=v.g=C[le],ee=Et(ve,V,!1,v)&&ee}We.prototype.N=function(){if(We.aa.N.call(this),this.i){var p=this.i,v;for(v in p.g){for(var C=p.g[v],V=0;V<C.length;V++)Mr(C[V]);delete p.g[v],p.h--}}this.F=null},We.prototype.K=function(p,v,C,V){return this.i.add(String(p),v,!1,C,V)},We.prototype.L=function(p,v,C,V){return this.i.add(String(p),v,!0,C,V)};function Et(p,v,C,V){if(v=p.i.g[String(v)],!v)return!0;v=v.concat();for(var ee=!0,le=0;le<v.length;++le){var ve=v[le];if(ve&&!ve.da&&ve.capture==C){var vt=ve.listener,Gn=ve.ha||ve.src;ve.fa&&bi(p.i,ve),ee=vt.call(Gn,V)!==!1&&ee}}return ee&&!V.defaultPrevented}function Ji(p,v,C){if(typeof p=="function")C&&(p=I(p,C));else if(p&&typeof p.handleEvent=="function")p=I(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:h.setTimeout(p,v||0)}function gr(p){p.g=Ji(()=>{p.g=null,p.i&&(p.i=!1,gr(p))},p.l);const v=p.h;p.h=null,p.m.apply(null,v)}class Lu extends Xe{constructor(v,C){super(),this.m=v,this.l=C,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:gr(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bt(p){Xe.call(this),this.h=p,this.g={}}B(bt,Xe);var Ee=[];function Jt(p){J(p.g,function(v,C){this.g.hasOwnProperty(C)&&Q(v)},p),p.g={}}bt.prototype.N=function(){bt.aa.N.call(this),Jt(this)},bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pt=h.JSON.stringify,Gt=h.JSON.parse,es=class{stringify(p){return h.JSON.stringify(p,void 0)}parse(p){return h.JSON.parse(p,void 0)}};function Ma(){}Ma.prototype.h=null;function Fu(p){return p.h||(p.h=p.i())}function yt(){}var Zr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Wl(){Tt.call(this,"d")}B(Wl,Tt);function ql(){Tt.call(this,"c")}B(ql,Tt);var Bn={},Kl=null;function Tn(){return Kl=Kl||new We}Bn.La="serverreachability";function Ms(p){Tt.call(this,Bn.La,p)}B(Ms,Tt);function ts(p){const v=Tn();Ge(v,new Ms(v))}Bn.STAT_EVENT="statevent";function Jr(p,v){Tt.call(this,Bn.STAT_EVENT,p),this.stat=v}B(Jr,Tt);function ir(p){const v=Tn();Ge(v,new Jr(v,p))}Bn.Ma="timingevent";function ns(p,v){Tt.call(this,Bn.Ma,p),this.size=v}B(ns,Tt);function Ls(p,v){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){p()},v)}function kn(){this.g=!0}kn.prototype.xa=function(){this.g=!1};function Fs(p,v,C,V,ee,le){p.info(function(){if(p.g)if(le)for(var ve="",vt=le.split("&"),Gn=0;Gn<vt.length;Gn++){var nt=vt[Gn].split("=");if(1<nt.length){var Sn=nt[0];nt=nt[1];var Pt=Sn.split("_");ve=2<=Pt.length&&Pt[1]=="type"?ve+(Sn+"="+nt+"&"):ve+(Sn+"=redacted&")}}else ve=null;else ve=le;return"XMLHTTP REQ ("+V+") [attempt "+ee+"]: "+v+`
`+C+`
`+ve})}function Lr(p,v,C,V,ee,le,ve){p.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+ee+"]: "+v+`
`+C+`
`+le+" "+ve})}function Se(p,v,C,V){p.info(function(){return"XMLHTTP TEXT ("+v+"): "+Vu(p,C)+(V?" "+V:"")})}function _o(p,v){p.info(function(){return"TIMEOUT: "+v})}kn.prototype.info=function(){};function Vu(p,v){if(!p.g)return v;if(!v)return null;try{var C=JSON.parse(v);if(C){for(p=0;p<C.length;p++)if(Array.isArray(C[p])){var V=C[p];if(!(2>V.length)){var ee=V[1];if(Array.isArray(ee)&&!(1>ee.length)){var le=ee[0];if(le!="noop"&&le!="stop"&&le!="close")for(var ve=1;ve<ee.length;ve++)ee[ve]=""}}}}return pt(C)}catch{return v}}var Un={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Vs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Eo;function Bs(){}B(Bs,Ma),Bs.prototype.g=function(){return new XMLHttpRequest},Bs.prototype.i=function(){return{}},Eo=new Bs;function jn(p,v,C,V){this.j=p,this.i=v,this.l=C,this.R=V||1,this.U=new bt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new nf}function nf(){this.i=null,this.g="",this.h=!1}var rf={},Fr={};function zn(p,v,C){p.L=1,p.v=sr(Ht(v)),p.m=C,p.P=!0,Bt(p,null)}function Bt(p,v){p.F=Date.now(),vo(p),p.A=Ht(p.v);var C=p.A,V=p.R;Array.isArray(V)||(V=[String(V)]),Ao(C.i,"t",V),p.C=0,C=p.j.J,p.h=new nf,p.g=Lt(p.j,C?v:null,!p.m),0<p.O&&(p.M=new Lu(I(p.Y,p,p.g),p.O)),v=p.U,C=p.g,V=p.ca;var ee="readystatechange";Array.isArray(ee)||(ee&&(Ee[0]=ee.toString()),ee=Ee);for(var le=0;le<ee.length;le++){var ve=Zi(C,ee[le],V||v.handleEvent,!1,v.h||v);if(!ve)break;v.g[ve.key]=ve}v=p.H?M(p.H):{},p.m?(p.u||(p.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,v)):(p.u="GET",p.g.ea(p.A,p.u,null,v)),ts(),Fs(p.i,p.u,p.A,p.l,p.R,p.m)}jn.prototype.ca=function(p){p=p.target;const v=this.M;v&&ki(p)==3?v.j():this.Y(p)},jn.prototype.Y=function(p){try{if(p==this.g)e:{const Pt=ki(this.g);var v=this.g.Ba();const zs=this.g.Z();if(!(3>Pt)&&(Pt!=3||this.g&&(this.h.h||this.g.oa()||St(this.g)))){this.J||Pt!=4||v==7||(v==8||0>=zs?ts(3):ts(2)),Uu(this);var C=this.g.Z();this.X=C;t:if(Bu(this)){var V=St(this.g);p="";var ee=V.length,le=ki(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vr(this),Ot(this);var ve="";break t}this.h.i=new h.TextDecoder}for(v=0;v<ee;v++)this.h.h=!0,p+=this.h.i.decode(V[v],{stream:!(le&&v==ee-1)});V.length=0,this.h.g+=p,this.C=0,ve=this.h.g}else ve=this.g.oa();if(this.o=C==200,Lr(this.i,this.u,this.A,this.l,this.R,Pt,C),this.o){if(this.T&&!this.K){t:{if(this.g){var vt,Gn=this.g;if((vt=Gn.g?Gn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(vt)){var nt=vt;break t}}nt=null}if(C=nt)Se(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ju(this,C);else{this.o=!1,this.s=3,ir(12),Vr(this),Ot(this);break e}}if(this.P){C=!0;let wn;for(;!this.J&&this.C<ve.length;)if(wn=rs(this,ve),wn==Fr){Pt==4&&(this.s=4,ir(14),C=!1),Se(this.i,this.l,null,"[Incomplete Response]");break}else if(wn==rf){this.s=4,ir(15),Se(this.i,this.l,ve,"[Invalid Chunk]"),C=!1;break}else Se(this.i,this.l,wn,null),ju(this,wn);if(Bu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pt!=4||ve.length!=0||this.h.h||(this.s=1,ir(16),C=!1),this.o=this.o&&C,!C)Se(this.i,this.l,ve,"[Invalid Chunked Response]"),Vr(this),Ot(this);else if(0<ve.length&&!this.W){this.W=!0;var Sn=this.j;Sn.g==this&&Sn.ba&&!Sn.M&&(Sn.j.info("Great, no buffering proxy detected. Bytes received: "+ve.length),cn(Sn),Sn.M=!0,ir(11))}}else Se(this.i,this.l,ve,null),ju(this,ve);Pt==4&&Vr(this),this.o&&!this.J&&(Pt==4?Ga(this.j,this):(this.o=!1,vo(this)))}else uf(this.g),C==400&&0<ve.indexOf("Unknown SID")?(this.s=3,ir(12)):(this.s=0,ir(13)),Vr(this),Ot(this)}}}catch{}finally{}};function Bu(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function rs(p,v){var C=p.C,V=v.indexOf(`
`,C);return V==-1?Fr:(C=Number(v.substring(C,V)),isNaN(C)?rf:(V+=1,V+C>v.length?Fr:(v=v.slice(V,V+C),p.C=V+C,v)))}jn.prototype.cancel=function(){this.J=!0,Vr(this)};function vo(p){p.S=Date.now()+p.I,de(p,p.I)}function de(p,v){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Ls(I(p.ba,p),v)}function Uu(p){p.B&&(h.clearTimeout(p.B),p.B=null)}jn.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(_o(this.i,this.A),this.L!=2&&(ts(),ir(17)),Vr(this),this.s=2,Ot(this)):de(this,this.S-p)};function Ot(p){p.j.G==0||p.J||Ga(p.j,p)}function Vr(p){Uu(p);var v=p.M;v&&typeof v.ma=="function"&&v.ma(),p.M=null,Jt(p.U),p.g&&(v=p.g,p.g=null,v.abort(),v.ma())}function ju(p,v){try{var C=p.j;if(C.G!=0&&(C.g==p||La(C.h,p))){if(!p.K&&La(C.h,p)&&C.G==3){try{var V=C.Da.g.parse(v)}catch{V=null}if(Array.isArray(V)&&V.length==3){var ee=V;if(ee[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<p.F)Ut(C),se(C);else break e;za(C),ir(18)}}else C.za=ee[1],0<C.za-C.T&&37500>ee[2]&&C.F&&C.v==0&&!C.C&&(C.C=Ls(I(C.Za,C),6e3));if(1>=$l(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else ft(C,11)}else if((p.K||C.g==p)&&Ut(C),!P(v))for(ee=C.Da.g.parse(v),v=0;v<ee.length;v++){let nt=ee[v];if(C.T=nt[0],nt=nt[1],C.G==2)if(nt[0]=="c"){C.K=nt[1],C.ia=nt[2];const Sn=nt[3];Sn!=null&&(C.la=Sn,C.j.info("VER="+C.la));const Pt=nt[4];Pt!=null&&(C.Aa=Pt,C.j.info("SVER="+C.Aa));const zs=nt[5];zs!=null&&typeof zs=="number"&&0<zs&&(V=1.5*zs,C.L=V,C.j.info("backChannelRequestTimeoutMs_="+V)),V=C;const wn=p.g;if(wn){const ec=wn.g?wn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ec){var le=V.h;le.g||ec.indexOf("spdy")==-1&&ec.indexOf("quic")==-1&&ec.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(Fa(le,le.h),le.h=null))}if(V.D){const Ha=wn.g?wn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ha&&(V.ya=Ha,Ye(V.I,V.D,Ha))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-p.F,C.j.info("Handshake RTT: "+C.R+"ms")),V=C;var ve=p;if(V.qa=ff(V,V.J?V.ia:null,V.W),ve.K){pn(V.h,ve);var vt=ve,Gn=V.L;Gn&&(vt.I=Gn),vt.B&&(Uu(vt),vo(vt)),V.g=ve}else df(V);0<C.i.length&&yn(C)}else nt[0]!="stop"&&nt[0]!="close"||ft(C,7);else C.G==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?ft(C,7):Ku(C):nt[0]!="noop"&&C.l&&C.l.ta(nt),C.v=0)}}ts(4)}catch{}}var Ct=class{constructor(p,v){this.g=p,this.map=v}};function wt(p){this.l=p||10,h.PerformanceNavigationTiming?(p=h.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function st(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function $l(p){return p.h?1:p.g?p.g.size:0}function La(p,v){return p.h?p.h==v:p.g?p.g.has(v):!1}function Fa(p,v){p.g?p.g.add(v):p.h=v}function pn(p,v){p.h&&p.h==v?p.h=null:p.g&&p.g.has(v)&&p.g.delete(v)}wt.prototype.cancel=function(){if(this.i=Ri(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Ri(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let v=p.i;for(const C of p.g.values())v=v.concat(C.D);return v}return D(p.i)}function Cg(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(f(p)){for(var v=[],C=p.length,V=0;V<C;V++)v.push(p[V]);return v}v=[],C=0;for(V in p)v[C++]=p[V];return v}function ln(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(f(p)||typeof p=="string"){var v=[];p=p.length;for(var C=0;C<p;C++)v.push(C);return v}v=[],C=0;for(const V in p)v[C++]=V;return v}}}function Ni(p,v){if(p.forEach&&typeof p.forEach=="function")p.forEach(v,void 0);else if(f(p)||typeof p=="string")Array.prototype.forEach.call(p,v,void 0);else for(var C=ln(p),V=Cg(p),ee=V.length,le=0;le<ee;le++)v.call(void 0,V[le],C&&C[le],p)}var sf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Io(p,v){if(p){p=p.split("&");for(var C=0;C<p.length;C++){var V=p[C].indexOf("="),ee=null;if(0<=V){var le=p[C].substring(0,V);ee=p[C].substring(V+1)}else le=p[C];v(le,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function xt(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof xt){this.h=p.h,ne(this,p.j),this.o=p.o,this.g=p.g,U(this,p.s),this.l=p.l;var v=p.i,C=new is;C.i=v.i,v.g&&(C.g=new Map(v.g),C.h=v.h),Fe(this,C),this.m=p.m}else p&&(v=String(p).match(sf))?(this.h=!1,ne(this,v[1]||"",!0),this.o=Va(v[2]||""),this.g=Va(v[3]||"",!0),U(this,v[4]),this.l=Va(v[5]||"",!0),Fe(this,v[6]||"",!0),this.m=Va(v[7]||"")):(this.h=!1,this.i=new is(null,this.h))}xt.prototype.toString=function(){var p=[],v=this.j;v&&p.push(Us(v,Be,!0),":");var C=this.g;return(C||v=="file")&&(p.push("//"),(v=this.o)&&p.push(Us(v,Be,!0),"@"),p.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&p.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&p.push("/"),p.push(Us(C,C.charAt(0)=="/"?of:$t,!0))),(C=this.i.toString())&&p.push("?",C),(C=this.m)&&p.push("#",Us(C,zu)),p.join("")};function Ht(p){return new xt(p)}function ne(p,v,C){p.j=C?Va(v,!0):v,p.j&&(p.j=p.j.replace(/:$/,""))}function U(p,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);p.s=v}else p.s=null}function Fe(p,v,C){v instanceof is?(p.i=v,He(p.i,p.h)):(C||(v=Us(v,Sg)),p.i=new is(v,p.h))}function Ye(p,v,C){p.i.set(v,C)}function sr(p){return Ye(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Va(p,v){return p?v?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Us(p,v,C){return typeof p=="string"?(p=encodeURI(p).replace(v,Br),C&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Br(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Be=/[#\/\?@]/g,$t=/[#\?:]/g,of=/[#\?]/g,Sg=/[#\?@]/g,zu=/#/g;function is(p,v){this.h=this.g=null,this.i=p||null,this.j=!!v}function mi(p){p.g||(p.g=new Map,p.h=0,p.i&&Io(p.i,function(v,C){p.add(decodeURIComponent(v.replace(/\+/g," ")),C)}))}t=is.prototype,t.add=function(p,v){mi(this),this.i=null,p=Cr(this,p);var C=this.g.get(p);return C||this.g.set(p,C=[]),C.push(v),this.h+=1,this};function af(p,v){mi(p),v=Cr(p,v),p.g.has(v)&&(p.i=null,p.h-=p.g.get(v).length,p.g.delete(v))}function Cn(p,v){return mi(p),v=Cr(p,v),p.g.has(v)}t.forEach=function(p,v){mi(this),this.g.forEach(function(C,V){C.forEach(function(ee){p.call(v,ee,V,this)},this)},this)},t.na=function(){mi(this);const p=Array.from(this.g.values()),v=Array.from(this.g.keys()),C=[];for(let V=0;V<v.length;V++){const ee=p[V];for(let le=0;le<ee.length;le++)C.push(v[V])}return C},t.V=function(p){mi(this);let v=[];if(typeof p=="string")Cn(this,p)&&(v=v.concat(this.g.get(Cr(this,p))));else{p=Array.from(this.g.values());for(let C=0;C<p.length;C++)v=v.concat(p[C])}return v},t.set=function(p,v){return mi(this),this.i=null,p=Cr(this,p),Cn(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[v]),this.h+=1,this},t.get=function(p,v){return p?(p=this.V(p),0<p.length?String(p[0]):v):v};function Ao(p,v,C){af(p,v),0<C.length&&(p.i=null,p.g.set(Cr(p,v),D(C)),p.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],v=Array.from(this.g.keys());for(var C=0;C<v.length;C++){var V=v[C];const le=encodeURIComponent(String(V)),ve=this.V(V);for(V=0;V<ve.length;V++){var ee=le;ve[V]!==""&&(ee+="="+encodeURIComponent(String(ve[V]))),p.push(ee)}}return this.i=p.join("&")};function Cr(p,v){return v=String(v),p.j&&(v=v.toLowerCase()),v}function He(p,v){v&&!p.j&&(mi(p),p.i=null,p.g.forEach(function(C,V){var ee=V.toLowerCase();V!=ee&&(af(this,V),Ao(this,ee,C))},p)),p.j=v}function bg(p,v){const C=new kn;if(h.Image){const V=new Image;V.onload=R(Wt,C,"TestLoadImage: loaded",!0,v,V),V.onerror=R(Wt,C,"TestLoadImage: error",!1,v,V),V.onabort=R(Wt,C,"TestLoadImage: abort",!1,v,V),V.ontimeout=R(Wt,C,"TestLoadImage: timeout",!1,v,V),h.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=p}else v(!1)}function Ze(p,v){const C=new kn,V=new AbortController,ee=setTimeout(()=>{V.abort(),Wt(C,"TestPingServer: timeout",!1,v)},1e4);fetch(p,{signal:V.signal}).then(le=>{clearTimeout(ee),le.ok?Wt(C,"TestPingServer: ok",!0,v):Wt(C,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ee),Wt(C,"TestPingServer: error",!1,v)})}function Wt(p,v,C,V,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),V(C)}catch{}}function Rg(){this.g=new es}function Gu(p,v,C){const V=C||"";try{Ni(p,function(ee,le){let ve=ee;m(ee)&&(ve=pt(ee)),v.push(V+le+"="+encodeURIComponent(ve))})}catch(ee){throw v.push(V+"type="+encodeURIComponent("_badmap")),ee}}function Ba(p){this.l=p.Ub||null,this.j=p.eb||!1}B(Ba,Ma),Ba.prototype.g=function(){return new pi(this.l,this.j)},Ba.prototype.i=function(p){return function(){return p}}({});function pi(p,v){We.call(this),this.D=p,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}B(pi,We),t=pi.prototype,t.open=function(p,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=v,this.readyState=1,Di(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(v.body=p),(this.D||h).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pi(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Di(this)),this.g&&(this.readyState=3,Di(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;lf(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function lf(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var v=p.value?p.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!p.done}))&&(this.response=this.responseText+=v)}p.done?Pi(this):Di(this),this.readyState==3&&lf(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,Pi(this))},t.Qa=function(p){this.g&&(this.response=p,Pi(this))},t.ga=function(){this.g&&Pi(this)};function Pi(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Di(p)}t.setRequestHeader=function(p,v){this.u.append(p,v)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],v=this.h.entries();for(var C=v.next();!C.done;)C=C.value,p.push(C[0]+": "+C[1]),C=v.next();return p.join(`\r
`)};function Di(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function To(p){let v="";return J(p,function(C,V){v+=V,v+=":",v+=C,v+=`\r
`}),v}function Ql(p,v,C){e:{for(V in C){var V=!1;break e}V=!0}V||(C=To(C),typeof p=="string"?C!=null&&encodeURIComponent(String(C)):Ye(p,v,C))}function Mt(p){We.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}B(Mt,We);var Ua=/^https?$/i,mr=["POST","PUT"];t=Mt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,v,C,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);v=v?v.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Eo.g(),this.v=this.o?Fu(this.o):Fu(Eo),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(v,String(p),!0),this.B=!1}catch(le){Hu(this,le);return}if(p=C||"",C=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var ee in V)C.set(ee,V[ee]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const le of V.keys())C.set(le,V.get(le));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(C.keys()).find(le=>le.toLowerCase()=="content-type"),ee=h.FormData&&p instanceof h.FormData,!(0<=Array.prototype.indexOf.call(mr,v,void 0))||V||ee||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,ve]of C)this.g.setRequestHeader(le,ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{cf(this),this.u=!0,this.g.send(p),this.u=!1}catch(le){Hu(this,le)}};function Hu(p,v){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=v,p.m=5,Wu(p),Xl(p)}function Wu(p){p.A||(p.A=!0,Ge(p,"complete"),Ge(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Ge(this,"complete"),Ge(this,"abort"),Xl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xl(this,!0)),Mt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?qu(this):this.bb())},t.bb=function(){qu(this)};function qu(p){if(p.h&&typeof l<"u"&&(!p.v[1]||ki(p)!=4||p.Z()!=2)){if(p.u&&ki(p)==4)Ji(p.Ea,0,p);else if(Ge(p,"readystatechange"),ki(p)==4){p.h=!1;try{const ve=p.Z();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var C;if(!(C=v)){var V;if(V=ve===0){var ee=String(p.D).match(sf)[1]||null;!ee&&h.self&&h.self.location&&(ee=h.self.location.protocol.slice(0,-1)),V=!Ua.test(ee?ee.toLowerCase():"")}C=V}if(C)Ge(p,"complete"),Ge(p,"success");else{p.m=6;try{var le=2<ki(p)?p.g.statusText:""}catch{le=""}p.l=le+" ["+p.Z()+"]",Wu(p)}}finally{Xl(p)}}}}function Xl(p,v){if(p.g){cf(p);const C=p.g,V=p.v[0]?()=>{}:null;p.g=null,p.v=null,v||Ge(p,"ready");try{C.onreadystatechange=V}catch{}}}function cf(p){p.I&&(h.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function ki(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<ki(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var v=this.g.responseText;return p&&v.indexOf(p)==0&&(v=v.substring(p.length)),Gt(v)}};function St(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function uf(p){const v={};p=(p.g&&2<=ki(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<p.length;V++){if(P(p[V]))continue;var C=K(p[V]);const ee=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const le=v[ee]||[];v[ee]=le,le.push(C)}k(v,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ss(p,v,C){return C&&C.internalChannelParams&&C.internalChannelParams[p]||v}function Oi(p){this.Aa=0,this.i=[],this.j=new kn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ss("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ss("baseRetryDelayMs",5e3,p),this.cb=ss("retryDelaySeedMs",1e4,p),this.Wa=ss("forwardChannelMaxRetries",2,p),this.wa=ss("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new wt(p&&p.concurrentRequestLimit),this.Da=new Rg,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Oi.prototype,t.la=8,t.G=1,t.connect=function(p,v,C,V){ir(0),this.W=p,this.H=v||{},C&&V!==void 0&&(this.H.OSID=C,this.H.OAID=V),this.F=this.X,this.I=ff(this,null,this.W),yn(this)};function Ku(p){if(Je(p),p.G==3){var v=p.U++,C=Ht(p.I);if(Ye(C,"SID",p.K),Ye(C,"RID",v),Ye(C,"TYPE","terminate"),ja(p,C),v=new jn(p,p.j,v),v.L=2,v.v=sr(Ht(C)),C=!1,h.navigator&&h.navigator.sendBeacon)try{C=h.navigator.sendBeacon(v.v.toString(),"")}catch{}!C&&h.Image&&(new Image().src=v.v,C=!0),C||(v.g=Lt(v.j,null),v.g.ea(v.v)),v.F=Date.now(),vo(v)}je(p)}function se(p){p.g&&(cn(p),p.g.cancel(),p.g=null)}function Je(p){se(p),p.u&&(h.clearTimeout(p.u),p.u=null),Ut(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&h.clearTimeout(p.s),p.s=null)}function yn(p){if(!st(p.h)&&!p.s){p.s=!0;var v=p.Ga;Oe||Ue(),Ie||(Oe(),Ie=!0),Me.add(v,p),p.B=0}}function Yl(p,v){return $l(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=v.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Ls(I(p.Ga,p,v),os(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const ee=new jn(this,this.j,p);let le=this.o;if(this.S&&(le?(le=M(le),W(le,this.S)):le=this.S),this.m!==null||this.O||(ee.H=le,le=null),this.P)e:{for(var v=0,C=0;C<this.i.length;C++){t:{var V=this.i[C];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(v+=V,4096<v){v=C;break e}if(v===4096||C===this.i.length-1){v=C+1;break e}}v=1e3}else v=1e3;v=hf(this,ee,v),C=Ht(this.I),Ye(C,"RID",p),Ye(C,"CVER",22),this.D&&Ye(C,"X-HTTP-Session-Id",this.D),ja(this,C),le&&(this.O?v="headers="+encodeURIComponent(String(To(le)))+"&"+v:this.m&&Ql(C,this.m,le)),Fa(this.h,ee),this.Ua&&Ye(C,"TYPE","init"),this.P?(Ye(C,"$req",v),Ye(C,"SID","null"),ee.T=!0,zn(ee,C,null)):zn(ee,C,v),this.G=2}}else this.G==3&&(p?$u(this,p):this.i.length==0||st(this.h)||$u(this))};function $u(p,v){var C;v?C=v.l:C=p.U++;const V=Ht(p.I);Ye(V,"SID",p.K),Ye(V,"RID",C),Ye(V,"AID",p.T),ja(p,V),p.m&&p.o&&Ql(V,p.m,p.o),C=new jn(p,p.j,C,p.B+1),p.m===null&&(C.H=p.o),v&&(p.i=v.D.concat(p.i)),v=hf(p,C,1e3),C.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Fa(p.h,C),zn(C,V,v)}function ja(p,v){p.H&&J(p.H,function(C,V){Ye(v,V,C)}),p.l&&Ni({},function(C,V){Ye(v,V,C)})}function hf(p,v,C){C=Math.min(p.i.length,C);var V=p.l?I(p.l.Na,p.l,p):null;e:{var ee=p.i;let le=-1;for(;;){const ve=["count="+C];le==-1?0<C?(le=ee[0].g,ve.push("ofs="+le)):le=0:ve.push("ofs="+le);let vt=!0;for(let Gn=0;Gn<C;Gn++){let nt=ee[Gn].g;const Sn=ee[Gn].map;if(nt-=le,0>nt)le=Math.max(0,ee[Gn].g-100),vt=!1;else try{Gu(Sn,ve,"req"+nt+"_")}catch{V&&V(Sn)}}if(vt){V=ve.join("&");break e}}}return p=p.i.splice(0,C),v.D=p,V}function df(p){if(!p.g&&!p.u){p.Y=1;var v=p.Fa;Oe||Ue(),Ie||(Oe(),Ie=!0),Me.add(v,p),p.v=0}}function za(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Ls(I(p.Fa,p),os(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,Zl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Ls(I(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ir(10),se(this),Zl(this))};function cn(p){p.A!=null&&(h.clearTimeout(p.A),p.A=null)}function Zl(p){p.g=new jn(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var v=Ht(p.qa);Ye(v,"RID","rpc"),Ye(v,"SID",p.K),Ye(v,"AID",p.T),Ye(v,"CI",p.F?"0":"1"),!p.F&&p.ja&&Ye(v,"TO",p.ja),Ye(v,"TYPE","xmlhttp"),ja(p,v),p.m&&p.o&&Ql(v,p.m,p.o),p.L&&(p.g.I=p.L);var C=p.g;p=p.ia,C.L=1,C.v=sr(Ht(v)),C.m=null,C.P=!0,Bt(C,p)}t.Za=function(){this.C!=null&&(this.C=null,se(this),za(this),ir(19))};function Ut(p){p.C!=null&&(h.clearTimeout(p.C),p.C=null)}function Ga(p,v){var C=null;if(p.g==v){Ut(p),cn(p),p.g=null;var V=2}else if(La(p.h,v))C=v.D,pn(p.h,v),V=1;else return;if(p.G!=0){if(v.o)if(V==1){C=v.m?v.m.length:0,v=Date.now()-v.F;var ee=p.B;V=Tn(),Ge(V,new ns(V,C)),yn(p)}else df(p);else if(ee=v.s,ee==3||ee==0&&0<v.X||!(V==1&&Yl(p,v)||V==2&&za(p)))switch(C&&0<C.length&&(v=p.h,v.i=v.i.concat(C)),ee){case 1:ft(p,5);break;case 4:ft(p,10);break;case 3:ft(p,6);break;default:ft(p,2)}}}function os(p,v){let C=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(C*=2),C*v}function ft(p,v){if(p.j.info("Error code "+v),v==2){var C=I(p.fb,p),V=p.Xa;const ee=!V;V=new xt(V||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||ne(V,"https"),sr(V),ee?bg(V.toString(),C):Ze(V.toString(),C)}else ir(2);p.G=0,p.l&&p.l.sa(v),je(p),Je(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),ir(2)):(this.j.info("Failed to ping google.com"),ir(1))};function je(p){if(p.G=0,p.ka=[],p.l){const v=Ri(p.h);(v.length!=0||p.i.length!=0)&&(G(p.ka,v),G(p.ka,p.i),p.h.i.length=0,D(p.i),p.i.length=0),p.l.ra()}}function ff(p,v,C){var V=C instanceof xt?Ht(C):new xt(C);if(V.g!="")v&&(V.g=v+"."+V.g),U(V,V.s);else{var ee=h.location;V=ee.protocol,v=v?v+"."+ee.hostname:ee.hostname,ee=+ee.port;var le=new xt(null);V&&ne(le,V),v&&(le.g=v),ee&&U(le,ee),C&&(le.l=C),V=le}return C=p.D,v=p.ya,C&&v&&Ye(V,C,v),Ye(V,"VER",p.la),ja(p,V),V}function Lt(p,v,C){if(v&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=p.Ca&&!p.pa?new Mt(new Ba({eb:C})):new Mt(p.pa),v.Ha(p.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function as(){}t=as.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Mi(){}Mi.prototype.g=function(p,v){return new Sr(p,v)};function Sr(p,v){We.call(this),this.g=new Oi(v),this.l=p,this.h=v&&v.messageUrlParams||null,p=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(p?p["X-WebChannel-Content-Type"]=v.messageContentType:p={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(p?p["X-WebChannel-Client-Profile"]=v.va:p={"X-WebChannel-Client-Profile":v.va}),this.g.S=p,(p=v&&v.Sb)&&!P(p)&&(this.g.m=p),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!P(v)&&(this.g.D=v,p=this.h,p!==null&&v in p&&(p=this.h,v in p&&delete p[v])),this.j=new js(this)}B(Sr,We),Sr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Sr.prototype.close=function(){Ku(this.g)},Sr.prototype.o=function(p){var v=this.g;if(typeof p=="string"){var C={};C.__data__=p,p=C}else this.u&&(C={},C.__data__=pt(p),p=C);v.i.push(new Ct(v.Ya++,p)),v.G==3&&yn(v)},Sr.prototype.N=function(){this.g.l=null,delete this.j,Ku(this.g),delete this.g,Sr.aa.N.call(this)};function ei(p){Wl.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var v=p.__sm__;if(v){e:{for(const C in v){p=C;break e}p=void 0}(this.i=p)&&(p=this.i,v=v!==null&&p in v?v[p]:void 0),this.data=v}else this.data=p}B(ei,Wl);function Jl(){ql.call(this),this.status=1}B(Jl,ql);function js(p){this.g=p}B(js,as),js.prototype.ua=function(){Ge(this.g,"a")},js.prototype.ta=function(p){Ge(this.g,new ei(p))},js.prototype.sa=function(p){Ge(this.g,new Jl)},js.prototype.ra=function(){Ge(this.g,"b")},Mi.prototype.createWebChannel=Mi.prototype.g,Sr.prototype.send=Sr.prototype.o,Sr.prototype.open=Sr.prototype.m,Sr.prototype.close=Sr.prototype.close,kC=function(){return new Mi},DC=function(){return Tn()},PC=Bn,Vp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Un.NO_ERROR=0,Un.TIMEOUT=8,Un.HTTP_ERROR=6,u0=Un,Vs.COMPLETE="complete",NC=Vs,yt.EventType=Zr,Zr.OPEN="a",Zr.CLOSE="b",Zr.ERROR="c",Zr.MESSAGE="d",We.prototype.listen=We.prototype.K,yh=yt,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,RC=Mt}).apply(typeof Ff<"u"?Ff:typeof self<"u"?self:typeof window<"u"?window:{});const G2="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let er=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};er.UNAUTHENTICATED=new er(null),er.GOOGLE_CREDENTIALS=new er("google-credentials-uid"),er.FIRST_PARTY=new er("first-party-uid"),er.MOCK_USER=new er("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new ww("@firebase/firestore");function cc(){return pa.logLevel}function xV(t){pa.setLogLevel(t)}function fe(t,...e){if(pa.logLevel<=ut.DEBUG){const n=e.map(Rw);pa.debug(`Firestore (${Cu}): ${t}`,...n)}}function Rn(t,...e){if(pa.logLevel<=ut.ERROR){const n=e.map(Rw);pa.error(`Firestore (${Cu}): ${t}`,...n)}}function Ci(t,...e){if(pa.logLevel<=ut.WARN){const n=e.map(Rw);pa.warn(`Firestore (${Cu}): ${t}`,...n)}}function Rw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(t="Unexpected state"){const e=`FIRESTORE (${Cu}) INTERNAL ASSERTION FAILED: `+t;throw Rn(e),new Error(e)}function De(t,e){t||Re()}function _V(t,e){t||Re()}function Ae(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends Ns{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _O{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(er.UNAUTHENTICATED))}shutdown(){}}class EO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class vO{constructor(e){this.t=e,this.currentUser=er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){De(this.o===void 0);let r=this.i;const i=f=>this.i!==r?(r=this.i,n(f)):Promise.resolve();let s=new nr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new nr,e.enqueueRetryable(()=>i(this.currentUser))};const l=()=>{const f=s;e.enqueueRetryable(async()=>{await f.promise,await i(this.currentUser)})},h=f=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(f=>h(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new nr)}},0),l()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(De(typeof r.accessToken=="string"),new OC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string"),new er(e)}}class IO{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=er.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class AO{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new IO(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(er.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class MC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class TO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){De(this.o===void 0);const r=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const l=s.token!==this.R;return this.R=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(De(typeof n.token=="string"),this.R=n.token,new MC(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class EV{getToken(){return Promise.resolve(new MC(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=CO(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Ke(t,e){return t<e?-1:t>e?1:0}function eu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function FC(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ge(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ge(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ge(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return dn.fromMillis(Date.now())}static fromDate(e){return dn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new dn(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new dn(0,0))}static max(){return new Ve(new dn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n,r){n===void 0?n=0:n>e.length&&Re(),r===void 0?r=e.length-n:r>e.length-n&&Re(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ld.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ld?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),l=n.get(i);if(s<l)return-1;if(s>l)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ht extends ld{construct(e,n,r){return new ht(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ge(ae.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ht(n)}static emptyPath(){return new ht([])}}const SO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rn extends ld{construct(e,n,r){return new rn(e,n,r)}static isValidIdentifier(e){return SO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new rn(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ge(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if(h==="\\"){if(i+1===e.length)throw new ge(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ge(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,i+=2}else h==="`"?(l=!l,i++):h!=="."||l?(r+=h,i++):(s(),i++)}if(s(),l)throw new ge(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rn(n)}static emptyPath(){return new rn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.path=e}static fromPath(e){return new Te(ht.fromString(e))}static fromName(e){return new Te(ht.fromString(e).popFirst(5))}static empty(){return new Te(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ht.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new ht(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Bp(t){return t.fields.find(e=>e.kind===2)}function Xa(t){return t.fields.filter(e=>e.kind!==2)}function bO(t,e){let n=Ke(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=RO(t.fields[r],e.fields[r]),n!==0)return n;return Ke(t.fields.length,e.fields.length)}tu.UNKNOWN_ID=-1;class ml{constructor(e,n){this.fieldPath=e,this.kind=n}}function RO(t,e){const n=rn.comparator(t.fieldPath,e.fieldPath);return n!==0?n:Ke(t.kind,e.kind)}class nu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new nu(0,ui.min())}}function VC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ve.fromTimestamp(r===1e9?new dn(n+1,0):new dn(n,r));return new ui(i,Te.empty(),e)}function BC(t){return new ui(t.readTime,t.key,-1)}class ui{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ui(Ve.min(),Te.empty(),-1)}static max(){return new ui(Ve.max(),Te.empty(),-1)}}function Nw(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Te.comparator(t.documentKey,e.documentKey),n!==0?n:Ke(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ra(t){if(t.code!==ae.FAILED_PRECONDITION||t.message!==UC)throw t;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new te((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof te?n:te.resolve(n)}catch(n){return te.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):te.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):te.reject(n)}static resolve(e){return new te((n,r)=>{n(e)})}static reject(e){return new te((n,r)=>{r(e)})}static waitFor(e){return new te((n,r)=>{let i=0,s=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++s,l&&s===i&&n()},f=>r(f))}),l=!0,s===i&&n()})}static or(e){let n=te.resolve(!1);for(const r of e)n=n.next(i=>i?te.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new te((r,i)=>{const s=e.length,l=new Array(s);let h=0;for(let f=0;f<s;f++){const m=f;n(e[m]).next(x=>{l[m]=x,++h,h===s&&r(l)},x=>i(x))}})}static doWhile(e,n){return new te((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new nr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Ph(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Pw(r.target.error);this.V.reject(new Ph(e,i))}}static open(e,n,r,i){try{return new X1(n,e.transaction(i,r))}catch(s){throw new Ph(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(fe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new PO(n)}}class Ts{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Ts.S(Kn())===12.2&&Rn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return fe("SimpleDb","Removing database:",e),Ya(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!VT())return!1;if(Ts.v())return!0;const e=Kn(),n=Ts.S(e),r=0<n&&n<10,i=zC(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(fe("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const l=s.target.result;n(l)},i.onblocked=()=>{r(new Ph(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const l=s.target.error;l.name==="VersionError"?r(new ge(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new ge(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new Ph(e,l))},i.onupgradeneeded=s=>{fe("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const l=s.target.result;this.p.O(l,i.transaction,s.oldVersion,this.version).next(()=>{fe("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let l=0;for(;;){++l;try{this.db=await this.M(e);const h=X1.open(this.db,e,s?"readonly":"readwrite",r),f=i(h).next(m=>(h.g(),m)).catch(m=>(h.abort(m),te.reject(m))).toPromise();return f.catch(()=>{}),await h.m,f}catch(h){const f=h,m=f.name!=="FirebaseError"&&l<3;if(fe("SimpleDb","Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class NO{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ya(this.B.delete())}}class Ph extends ge{constructor(e,n){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Na(t){return t.name==="IndexedDbTransactionError"}class PO{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(fe("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(fe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ya(r)}add(e){return fe("SimpleDb","ADD",this.store.name,e,e),Ya(this.store.add(e))}get(e){return Ya(this.store.get(e)).next(n=>(n===void 0&&(n=null),fe("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return fe("SimpleDb","DELETE",this.store.name,e),Ya(this.store.delete(e))}count(){return fe("SimpleDb","COUNT",this.store.name),Ya(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new te((l,h)=>{s.onerror=f=>{h(f.target.error)},s.onsuccess=f=>{l(f.target.result)}})}{const s=this.cursor(r),l=[];return this.W(s,(h,f)=>{l.push(f)}).next(()=>l)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new te((i,s)=>{r.onerror=l=>{s(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}j(e,n){fe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,l,h)=>h.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new te((r,i)=>{n.onerror=s=>{const l=Pw(s.target.error);i(l)},n.onsuccess=s=>{const l=s.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}W(e,n){const r=[];return new te((i,s)=>{e.onerror=l=>{s(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const f=new NO(h),m=n(h.primaryKey,h.value,f);if(m instanceof te){const x=m.catch(_=>(f.done(),te.reject(_)));r.push(x)}f.isDone?i():f.K===null?h.continue():h.continue(f.K)}}).next(()=>te.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ya(t){return new te((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Pw(r.target.error);n(i)}})}let H2=!1;function Pw(t){const e=Ts.S(Kn());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ge("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return H2||(H2=!0,setTimeout(()=>{throw r},0)),r}}return t}class DO{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){fe("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{fe("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Na(n)?fe("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Ra(n)}await this.X(6e4)})}}class kO{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return te.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(l!==null&&!r.has(l))return fe("IndexBackfiller",`Processing collection: ${l}`),this.ne(e,l,i).next(h=>{i-=h,r.add(l)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const l=s.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.re(i,s)).next(h=>(fe("IndexBackfiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,n,h))).next(()=>l.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const l=BC(s);Nw(l,r)>0&&(r=l)}),new ui(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Wr.oe=-1;function Fd(t){return t==null}function cd(t){return t===0&&1/t==-1/0}function GC(t){return typeof t=="number"&&Number.isInteger(t)&&!cd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=W2(e)),e=OO(t.get(n),e);return W2(e)}function OO(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function W2(t){return t+""}function ys(t){const e=t.length;if(De(e>=2),e===2)return De(t.charAt(0)===""&&t.charAt(1)===""),ht.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const l=t.indexOf("",s);switch((l<0||l>n)&&Re(),t.charAt(l+1)){case"":const h=t.substring(s,l);let f;i.length===0?f=h:(i+=h,f=i,i=""),r.push(f);break;case"":i+=t.substring(s,l),i+="\0";break;case"":i+=t.substring(s,l+1);break;default:Re()}s=l+2}return new ht(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(t,e){return[t,Ir(e)]}function HC(t,e,n){return[t,Ir(e),n]}const MO={},LO=["prefixPath","collectionGroup","readTime","documentId"],FO=["prefixPath","collectionGroup","documentId"],VO=["collectionGroup","readTime","prefixPath","documentId"],BO=["canonicalId","targetId"],UO=["targetId","path"],jO=["path","targetId"],zO=["collectionId","parent"],GO=["indexId","uid"],HO=["uid","sequenceNumber"],WO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qO=["indexId","uid","orderedDocumentKey"],KO=["userId","collectionPath","documentId"],$O=["userId","collectionPath","largestBatchId"],QO=["userId","collectionGroup","largestBatchId"],WC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],XO=[...WC,"documentOverlays"],qC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],KC=qC,Dw=[...KC,"indexConfiguration","indexState","indexEntries"],YO=Dw,ZO=[...Dw,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up extends jC{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function $n(t,e){const n=Ae(t);return Ts.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K2(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Pa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $C(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function QC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,n){this.comparator=e,this.root=n||lr.EMPTY}insert(e,n){return new Kt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,lr.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vf(this.root,e,this.comparator,!0)}}class Vf{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class lr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??lr.RED,this.left=i??lr.EMPTY,this.right=s??lr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new lr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return lr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return lr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,lr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,lr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Re();const e=this.left.check();if(e!==this.right.check())throw Re();return e+(this.isRed()?0:1)}}lr.EMPTY=null,lr.RED=!0,lr.BLACK=!1;lr.EMPTY=new class{constructor(){this.size=0}get key(){throw Re()}get value(){throw Re()}get color(){throw Re()}get left(){throw Re()}get right(){throw Re()}copy(e,n,r,i,s){return this}insert(e,n,r){return new lr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new $2(this.data.getIterator())}getIteratorFrom(e){return new $2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ft)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ft(this.comparator);return n.data=e,n}}class $2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ic(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this.fields=e,e.sort(rn.comparator)}static empty(){return new qr([])}unionWith(e){let n=new Ft(rn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new qr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return eu(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IV(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new XC("Invalid base64 string: "+s):s}}(e);return new In(n)}static fromUint8Array(e){const n=function(i){let s="";for(let l=0;l<i.length;++l)s+=String.fromCharCode(i[l]);return s}(e);return new In(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}In.EMPTY_BYTE_STRING=new In("");const JO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(t){if(De(!!t),typeof t=="string"){let e=0;const n=JO.exec(t);if(De(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:tn(t.seconds),nanos:tn(t.nanos)}}function tn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fo(t){return typeof t=="string"?In.fromBase64String(t):In.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Z1(t){const e=t.mapValue.fields.__previous_value__;return Y1(e)?Z1(e):e}function ud(t){const e=ho(t.mapValue.fields.__local_write_time__.timestampValue);return new dn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(e,n,r,i,s,l,h,f,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=m}}class Al{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Al("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Al&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},d0={nullValue:"NULL_VALUE"};function ya(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Y1(t)?4:YC(t)?9007199254740991:J1(t)?10:11:Re()}function bs(t,e){if(t===e)return!0;const n=ya(t);if(n!==ya(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ud(t).isEqual(ud(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const l=ho(i.timestampValue),h=ho(s.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return fo(i.bytesValue).isEqual(fo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return tn(i.geoPointValue.latitude)===tn(s.geoPointValue.latitude)&&tn(i.geoPointValue.longitude)===tn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return tn(i.integerValue)===tn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const l=tn(i.doubleValue),h=tn(s.doubleValue);return l===h?cd(l)===cd(h):isNaN(l)&&isNaN(h)}return!1}(t,e);case 9:return eu(t.arrayValue.values||[],e.arrayValue.values||[],bs);case 10:case 11:return function(i,s){const l=i.mapValue.fields||{},h=s.mapValue.fields||{};if(K2(l)!==K2(h))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(h[f]===void 0||!bs(l[f],h[f])))return!1;return!0}(t,e);default:return Re()}}function hd(t,e){return(t.values||[]).find(n=>bs(n,e))!==void 0}function wa(t,e){if(t===e)return 0;const n=ya(t),r=ya(e);if(n!==r)return Ke(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ke(t.booleanValue,e.booleanValue);case 2:return function(s,l){const h=tn(s.integerValue||s.doubleValue),f=tn(l.integerValue||l.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1}(t,e);case 3:return Q2(t.timestampValue,e.timestampValue);case 4:return Q2(ud(t),ud(e));case 5:return Ke(t.stringValue,e.stringValue);case 6:return function(s,l){const h=fo(s),f=fo(l);return h.compareTo(f)}(t.bytesValue,e.bytesValue);case 7:return function(s,l){const h=s.split("/"),f=l.split("/");for(let m=0;m<h.length&&m<f.length;m++){const x=Ke(h[m],f[m]);if(x!==0)return x}return Ke(h.length,f.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,l){const h=Ke(tn(s.latitude),tn(l.latitude));return h!==0?h:Ke(tn(s.longitude),tn(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return X2(t.arrayValue,e.arrayValue);case 10:return function(s,l){var h,f,m,x;const _=s.fields||{},I=l.fields||{},R=(h=_.value)===null||h===void 0?void 0:h.arrayValue,B=(f=I.value)===null||f===void 0?void 0:f.arrayValue,D=Ke(((m=R==null?void 0:R.values)===null||m===void 0?void 0:m.length)||0,((x=B==null?void 0:B.values)===null||x===void 0?void 0:x.length)||0);return D!==0?D:X2(R,B)}(t.mapValue,e.mapValue);case 11:return function(s,l){if(s===Jo.mapValue&&l===Jo.mapValue)return 0;if(s===Jo.mapValue)return 1;if(l===Jo.mapValue)return-1;const h=s.fields||{},f=Object.keys(h),m=l.fields||{},x=Object.keys(m);f.sort(),x.sort();for(let _=0;_<f.length&&_<x.length;++_){const I=Ke(f[_],x[_]);if(I!==0)return I;const R=wa(h[f[_]],m[x[_]]);if(R!==0)return R}return Ke(f.length,x.length)}(t.mapValue,e.mapValue);default:throw Re()}}function Q2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ke(t,e);const n=ho(t),r=ho(e),i=Ke(n.seconds,r.seconds);return i!==0?i:Ke(n.nanos,r.nanos)}function X2(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=wa(n[i],r[i]);if(s)return s}return Ke(n.length,r.length)}function ru(t){return jp(t)}function jp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=ho(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return fo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=jp(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const l of r)s?s=!1:i+=",",i+=`${l}:${jp(n.fields[l])}`;return i+"}"}(t.mapValue):Re()}function f0(t){switch(ya(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Z1(t);return e?16+f0(e):16;case 5:return 2*t.stringValue.length;case 6:return fo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+f0(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return Pa(r.fields,(s,l)=>{i+=s.length+f0(l)}),i}(t.mapValue);default:throw Re()}}function Tl(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function zp(t){return!!t&&"integerValue"in t}function dd(t){return!!t&&"arrayValue"in t}function Y2(t){return!!t&&"nullValue"in t}function Z2(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function g0(t){return!!t&&"mapValue"in t}function J1(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Dh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Pa(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Dh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Dh(t.arrayValue.values[n]);return e}return Object.assign({},t)}function YC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const ZC={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function t5(t){return"nullValue"in t?d0:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Tl(Al.empty(),Te.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?J1(t)?ZC:{mapValue:{}}:Re()}function n5(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Tl(Al.empty(),Te.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?ZC:"mapValue"in t?J1(t)?{mapValue:{}}:Jo:Re()}function J2(t,e){const n=wa(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function eE(t,e){const n=wa(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.value=e}static empty(){return new cr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!g0(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dh(n)}setAll(e){let n=rn.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!n.isImmediateParentOf(h)){const f=this.getFieldsMap(n);this.applyChanges(f,r,i),r={},i=[],n=h.popLast()}l?r[h.lastSegment()]=Dh(l):i.push(h.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());g0(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bs(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];g0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Pa(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new cr(Dh(this.value))}}function JC(t){const e=[];return Pa(t.fields,(n,r)=>{const i=new rn([n]);if(g0(r)){const s=JC(r.mapValue).fields;if(s.length===0)e.push(i);else for(const l of s)e.push(i.child(l))}else e.push(i)}),new qr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e,n,r,i,s,l,h){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=l,this.documentState=h}static newInvalidDocument(e){return new Yt(e,0,Ve.min(),Ve.min(),Ve.min(),cr.empty(),0)}static newFoundDocument(e,n,r,i){return new Yt(e,1,n,Ve.min(),r,i,0)}static newNoDocument(e,n){return new Yt(e,2,n,Ve.min(),Ve.min(),cr.empty(),0)}static newUnknownDocument(e,n){return new Yt(e,3,n,Ve.min(),Ve.min(),cr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,n){this.position=e,this.inclusive=n}}function tE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],l=t.position[i];if(s.field.isKeyField()?r=Te.comparator(Te.fromName(l.referenceValue),n.key):r=wa(l,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function nE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bs(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,n="asc"){this.field=e,this.dir=n}}function r5(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{}class dt extends eS{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new i5(e,n,r):n==="array-contains"?new a5(e,r):n==="in"?new oS(e,r):n==="not-in"?new l5(e,r):n==="array-contains-any"?new c5(e,r):new dt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new s5(e,r):new o5(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(wa(n,this.value)):n!==null&&ya(this.value)===ya(n)&&this.matchesComparison(wa(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dt extends eS{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Dt(e,n)}matches(e){return iu(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function iu(t){return t.op==="and"}function Gp(t){return t.op==="or"}function kw(t){return tS(t)&&iu(t)}function tS(t){for(const e of t.filters)if(e instanceof Dt)return!1;return!0}function Hp(t){if(t instanceof dt)return t.field.canonicalString()+t.op.toString()+ru(t.value);if(kw(t))return t.filters.map(e=>Hp(e)).join(",");{const e=t.filters.map(n=>Hp(n)).join(",");return`${t.op}(${e})`}}function nS(t,e){return t instanceof dt?function(r,i){return i instanceof dt&&r.op===i.op&&r.field.isEqual(i.field)&&bs(r.value,i.value)}(t,e):t instanceof Dt?function(r,i){return i instanceof Dt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,l,h)=>s&&nS(l,i.filters[h]),!0):!1}(t,e):void Re()}function rS(t,e){const n=t.filters.concat(e);return Dt.create(n,t.op)}function iS(t){return t instanceof dt?function(n){return`${n.field.canonicalString()} ${n.op} ${ru(n.value)}`}(t):t instanceof Dt?function(n){return n.op.toString()+" {"+n.getFilters().map(iS).join(" ,")+"}"}(t):"Filter"}class i5 extends dt{constructor(e,n,r){super(e,n,r),this.key=Te.fromName(r.referenceValue)}matches(e){const n=Te.comparator(e.key,this.key);return this.matchesComparison(n)}}class s5 extends dt{constructor(e,n){super(e,"in",n),this.keys=sS("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class o5 extends dt{constructor(e,n){super(e,"not-in",n),this.keys=sS("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function sS(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Te.fromName(r.referenceValue))}class a5 extends dt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return dd(n)&&hd(n.arrayValue,this.value)}}class oS extends dt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&hd(this.value.arrayValue,n)}}class l5 extends dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(hd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!hd(this.value.arrayValue,n)}}class c5 extends dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!dd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>hd(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{constructor(e,n=null,r=[],i=[],s=null,l=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=l,this.endAt=h,this.ue=null}}function Wp(t,e=null,n=[],r=[],i=null,s=null,l=null){return new u5(t,e,n,r,i,s,l)}function Cl(t){const e=Ae(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Hp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Fd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ru(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ru(r)).join(",")),e.ue=n}return e.ue}function Vd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!r5(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!nS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nE(t.startAt,e.startAt)&&nE(t.endAt,e.endAt)}function t1(t){return Te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function n1(t,e){return t.filters.filter(n=>n instanceof dt&&n.field.isEqual(e))}function rE(t,e,n){let r=d0,i=!0;for(const s of n1(t,e)){let l=d0,h=!0;switch(s.op){case"<":case"<=":l=t5(s.value);break;case"==":case"in":case">=":l=s.value;break;case">":l=s.value,h=!1;break;case"!=":case"not-in":l=d0}J2({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const l=n.position[s];J2({value:r,inclusive:i},{value:l,inclusive:n.inclusive})<0&&(r=l,i=n.inclusive);break}}return{value:r,inclusive:i}}function iE(t,e,n){let r=Jo,i=!0;for(const s of n1(t,e)){let l=Jo,h=!0;switch(s.op){case">=":case">":l=n5(s.value),h=!1;break;case"==":case"in":case"<=":l=s.value;break;case"<":l=s.value,h=!1;break;case"!=":case"not-in":l=Jo}eE({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const l=n.position[s];eE({value:r,inclusive:i},{value:l,inclusive:n.inclusive})>0&&(r=l,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n=null,r=[],i=[],s=null,l="F",h=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=l,this.startAt=h,this.endAt=f,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function aS(t,e,n,r,i,s,l,h){return new po(t,e,n,r,i,s,l,h)}function Su(t){return new po(t)}function sE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ow(t){return t.collectionGroup!==null}function Fc(t){const e=Ae(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new Ft(rn.comparator);return l.filters.forEach(f=>{f.getFlattenedFilters().forEach(m=>{m.isInequality()&&(h=h.add(m.field))})}),h})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new fd(s,r))}),n.has(rn.keyField().canonicalString())||e.ce.push(new fd(rn.keyField(),r))}return e.ce}function Ar(t){const e=Ae(t);return e.le||(e.le=cS(e,Fc(t))),e.le}function lS(t){const e=Ae(t);return e.he||(e.he=cS(e,t.explicitOrderBy)),e.he}function cS(t,e){if(t.limitType==="F")return Wp(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new fd(i.field,s)});const n=t.endAt?new xa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new xa(t.startAt.position,t.startAt.inclusive):null;return Wp(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function qp(t,e){const n=t.filters.concat([e]);return new po(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function r1(t,e,n){return new po(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Bd(t,e){return Vd(Ar(t),Ar(e))&&t.limitType===e.limitType}function uS(t){return`${Cl(Ar(t))}|lt:${t.limitType}`}function uc(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>iS(i)).join(", ")}]`),Fd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ru(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ru(i)).join(",")),`Target(${r})`}(Ar(t))}; limitType=${t.limitType})`}function Ud(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Te.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Fc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(l,h,f){const m=tE(l,h,f);return l.inclusive?m<=0:m<0}(r.startAt,Fc(r),i)||r.endAt&&!function(l,h,f){const m=tE(l,h,f);return l.inclusive?m>=0:m>0}(r.endAt,Fc(r),i))}(t,e)}function hS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function dS(t){return(e,n)=>{let r=!1;for(const i of Fc(t)){const s=h5(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function h5(t,e,n){const r=t.field.isKeyField()?Te.comparator(e.key,n.key):function(s,l,h){const f=l.data.field(s),m=h.data.field(s);return f!==null&&m!==null?wa(f,m):Re()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Pa(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return QC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5=new Kt(Te.comparator);function Kr(){return d5}const fS=new Kt(Te.comparator);function wh(...t){let e=fS;for(const n of t)e=e.insert(n.key,n);return e}function gS(t){let e=fS;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ws(){return kh()}function mS(){return kh()}function kh(){return new yo(t=>t.toString(),(t,e)=>t.isEqual(e))}const f5=new Kt(Te.comparator),g5=new Ft(Te.comparator);function tt(...t){let e=g5;for(const n of t)e=e.add(n);return e}const m5=new Ft(Ke);function Mw(){return m5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cd(e)?"-0":e}}function pS(t){return{integerValue:""+t}}function yS(t,e){return GC(e)?pS(e):Lw(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(){this._=void 0}}function p5(t,e,n){return t instanceof su?function(i,s){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Y1(s)&&(s=Z1(s)),s&&(l.fields.__previous_value__=s),{mapValue:l}}(n,e):t instanceof Sl?xS(t,e):t instanceof bl?_S(t,e):function(i,s){const l=wS(i,s),h=oE(l)+oE(i.Pe);return zp(l)&&zp(i.Pe)?pS(h):Lw(i.serializer,h)}(t,e)}function y5(t,e,n){return t instanceof Sl?xS(t,e):t instanceof bl?_S(t,e):n}function wS(t,e){return t instanceof ou?function(r){return zp(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class su extends eg{}class Sl extends eg{constructor(e){super(),this.elements=e}}function xS(t,e){const n=ES(e);for(const r of t.elements)n.some(i=>bs(i,r))||n.push(r);return{arrayValue:{values:n}}}class bl extends eg{constructor(e){super(),this.elements=e}}function _S(t,e){let n=ES(e);for(const r of t.elements)n=n.filter(i=>!bs(i,r));return{arrayValue:{values:n}}}class ou extends eg{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function oE(t){return tn(t.integerValue||t.doubleValue)}function ES(t){return dd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,n){this.field=e,this.transform=n}}function w5(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Sl&&i instanceof Sl||r instanceof bl&&i instanceof bl?eu(r.elements,i.elements,bs):r instanceof ou&&i instanceof ou?bs(r.Pe,i.Pe):r instanceof su&&i instanceof su}(t.transform,e.transform)}class x5{constructor(e,n){this.version=e,this.transformResults=n}}class sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new sn}static exists(e){return new sn(void 0,e)}static updateTime(e){return new sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function m0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class tg{}function vS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ru(t.key,sn.none()):new bu(t.key,t.data,sn.none());{const n=t.data,r=cr.empty();let i=new Ft(rn.comparator);for(let s of e.fields)if(!i.has(s)){let l=n.field(s);l===null&&s.length>1&&(s=s.popLast(),l=n.field(s)),l===null?r.delete(s):r.set(s,l),i=i.add(s)}return new wo(t.key,r,new qr(i.toArray()),sn.none())}}function _5(t,e,n){t instanceof bu?function(i,s,l){const h=i.value.clone(),f=lE(i.fieldTransforms,s,l.transformResults);h.setAll(f),s.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(t,e,n):t instanceof wo?function(i,s,l){if(!m0(i.precondition,s))return void s.convertToUnknownDocument(l.version);const h=lE(i.fieldTransforms,s,l.transformResults),f=s.data;f.setAll(IS(i)),f.setAll(h),s.convertToFoundDocument(l.version,f).setHasCommittedMutations()}(t,e,n):function(i,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,n)}function Oh(t,e,n,r){return t instanceof bu?function(s,l,h,f){if(!m0(s.precondition,l))return h;const m=s.value.clone(),x=cE(s.fieldTransforms,f,l);return m.setAll(x),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(t,e,n,r):t instanceof wo?function(s,l,h,f){if(!m0(s.precondition,l))return h;const m=cE(s.fieldTransforms,f,l),x=l.data;return x.setAll(IS(s)),x.setAll(m),l.convertToFoundDocument(l.version,x).setHasLocalMutations(),h===null?null:h.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(_=>_.field))}(t,e,n,r):function(s,l,h){return m0(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(t,e,n)}function E5(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=wS(r.transform,i||null);s!=null&&(n===null&&(n=cr.empty()),n.set(r.field,s))}return n||null}function aE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&eu(r,i,(s,l)=>w5(s,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class bu extends tg{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class wo extends tg{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function IS(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function lE(t,e,n){const r=new Map;De(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],l=s.transform,h=e.data.field(s.field);r.set(s.field,y5(l,h,n[i]))}return r}function cE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,l=n.data.field(i.field);r.set(i.field,p5(s,l,e))}return r}class Ru extends tg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Fw extends tg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&_5(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Oh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Oh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=mS();return this.mutations.forEach(i=>{const s=e.get(i.key),l=s.overlayedDocument;let h=this.applyToLocalView(l,s.mutatedFields);h=n.has(i.key)?null:h;const f=vS(l,h);f!==null&&r.set(i.key,f),l.isValidDocument()||l.convertToNoDocument(Ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),tt())}isEqual(e){return this.batchId===e.batchId&&eu(this.mutations,e.mutations,(n,r)=>aE(n,r))&&eu(this.baseMutations,e.baseMutations,(n,r)=>aE(n,r))}}class Bw{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){De(e.mutations.length===r.length);let i=function(){return f5}();const s=e.mutations;for(let l=0;l<s.length;l++)i=i.insert(s[l].key,r[l].version);return new Bw(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mn,_t;function TS(t){switch(t){default:return Re();case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0}}function CS(t){if(t===void 0)return Rn("GRPC error has no .code"),ae.UNKNOWN;switch(t){case Mn.OK:return ae.OK;case Mn.CANCELLED:return ae.CANCELLED;case Mn.UNKNOWN:return ae.UNKNOWN;case Mn.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Mn.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Mn.INTERNAL:return ae.INTERNAL;case Mn.UNAVAILABLE:return ae.UNAVAILABLE;case Mn.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Mn.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Mn.NOT_FOUND:return ae.NOT_FOUND;case Mn.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Mn.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Mn.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Mn.ABORTED:return ae.ABORTED;case Mn.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Mn.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Mn.DATA_LOSS:return ae.DATA_LOSS;default:return Re()}}(_t=Mn||(Mn={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let i1=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I5=new gl([4294967295,4294967295],0);function uE(t){const e=SS().encode(t),n=new bC;return n.update(e),new Uint8Array(n.digest())}function hE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new gl([n,r],0),new gl([i,s],0)]}class jw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new xh(`Invalid padding: ${n}`);if(r<0)throw new xh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new xh(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new xh(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=gl.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(gl.fromNumber(r)));return i.compare(I5)===1&&(i=new gl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=uE(e),[r,i]=hE(n);for(let s=0;s<this.hashCount;s++){const l=this.Ee(r,i,s);if(!this.de(l))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new jw(s,i,n);return r.forEach(h=>l.insert(h)),l}insert(e){if(this.Ie===0)return;const n=uE(e),[r,i]=hE(n);for(let s=0;s<this.hashCount;s++){const l=this.Ee(r,i,s);this.Ae(l)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class xh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Gd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new zd(Ve.min(),i,new Kt(Ke),Kr(),tt())}}class Gd{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Gd(r,n,tt(),tt(),tt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class bS{constructor(e,n){this.targetId=e,this.me=n}}class RS{constructor(e,n,r=In.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class dE{constructor(){this.fe=0,this.ge=gE(),this.pe=In.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=tt(),n=tt(),r=tt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Re()}}),new Gd(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=gE()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,De(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class A5{constructor(e){this.Le=e,this.Be=new Map,this.ke=Kr(),this.qe=fE(),this.Qe=new Kt(Ke)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Re()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(t1(s))if(r===0){const l=new Te(s.path);this.Ue(n,l,Yt.newNoDocument(l,Ve.min()))}else De(r===1);else{const l=this.Ye(n);if(l!==r){const h=this.Ze(e),f=h?this.Xe(h,e,l):1;if(f!==0){this.je(n);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,m)}i1==null||i1.et(function(x,_,I,R,B){var D,G,F,P,N,H;const Y={localCacheCount:x,existenceFilterCount:_.count,databaseId:I.database,projectId:I.projectId},J=_.unchangedNames;return J&&(Y.bloomFilter={applied:B===0,hashCount:(D=J==null?void 0:J.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(P=(F=(G=J==null?void 0:J.bits)===null||G===void 0?void 0:G.bitmap)===null||F===void 0?void 0:F.length)!==null&&P!==void 0?P:0,padding:(H=(N=J==null?void 0:J.bits)===null||N===void 0?void 0:N.padding)!==null&&H!==void 0?H:0,mightContain:k=>{var M;return(M=R==null?void 0:R.mightContain(k))!==null&&M!==void 0&&M}}),Y}(l,e.me,this.Le.tt(),h,f))}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let l,h;try{l=fo(r).toUint8Array()}catch(f){if(f instanceof XC)return Ci("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new jw(l,i,s)}catch(f){return Ci(f instanceof xh?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.Ie===0?null:h}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const l=this.Le.tt(),h=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(h)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,l)=>{const h=this.Je(l);if(h){if(s.current&&t1(h.target)){const f=new Te(h.target.path);this.ke.get(f)!==null||this.it(l,f)||this.Ue(l,f,Yt.newNoDocument(f,e))}s.be&&(n.set(l,s.ve()),s.Ce())}});let r=tt();this.qe.forEach((s,l)=>{let h=!0;l.forEachWhile(f=>{const m=this.Je(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(r=r.add(s))}),this.ke.forEach((s,l)=>l.setReadTime(e));const i=new zd(e,n,this.Qe,this.ke,r);return this.ke=Kr(),this.qe=fE(),this.Qe=new Kt(Ke),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new dE,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ft(Ke),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||fe("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new dE),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function fE(){return new Kt(Te.comparator)}function gE(){return new Kt(Te.comparator)}const T5=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),C5=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),S5=(()=>({and:"AND",or:"OR"}))();class b5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Kp(t,e){return t.useProto3Json||Fd(e)?e:{value:e}}function au(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function R5(t,e){return au(t,e.toTimestamp())}function Pn(t){return De(!!t),Ve.fromTimestamp(function(n){const r=ho(n);return new dn(r.seconds,r.nanos)}(t))}function zw(t,e){return $p(t,e).canonicalString()}function $p(t,e){const n=function(i){return new ht(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function PS(t){const e=ht.fromString(t);return De(jS(e)),e}function gd(t,e){return zw(t.databaseId,e.path)}function Cs(t,e){const n=PS(e);if(n.get(1)!==t.databaseId.projectId)throw new ge(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ge(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Te(OS(n))}function DS(t,e){return zw(t.databaseId,e)}function kS(t){const e=PS(t);return e.length===4?ht.emptyPath():OS(e)}function Qp(t){return new ht(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function OS(t){return De(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function mE(t,e,n){return{name:gd(t,e),fields:n.value.mapValue.fields}}function MS(t,e,n){const r=Cs(t,e.name),i=Pn(e.updateTime),s=e.createTime?Pn(e.createTime):Ve.min(),l=new cr({mapValue:{fields:e.fields}}),h=Yt.newFoundDocument(r,i,s,l);return n&&h.setHasCommittedMutations(),n?h.setHasCommittedMutations():h}function N5(t,e){return"found"in e?function(r,i){De(!!i.found),i.found.name,i.found.updateTime;const s=Cs(r,i.found.name),l=Pn(i.found.updateTime),h=i.found.createTime?Pn(i.found.createTime):Ve.min(),f=new cr({mapValue:{fields:i.found.fields}});return Yt.newFoundDocument(s,l,h,f)}(t,e):"missing"in e?function(r,i){De(!!i.missing),De(!!i.readTime);const s=Cs(r,i.missing),l=Pn(i.readTime);return Yt.newNoDocument(s,l)}(t,e):Re()}function P5(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Re()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(m,x){return m.useProto3Json?(De(x===void 0||typeof x=="string"),In.fromBase64String(x||"")):(De(x===void 0||x instanceof Buffer||x instanceof Uint8Array),In.fromUint8Array(x||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){const x=m.code===void 0?ae.UNKNOWN:CS(m.code);return new ge(x,m.message||"")}(l);n=new RS(r,i,s,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Cs(t,r.document.name),s=Pn(r.document.updateTime),l=r.document.createTime?Pn(r.document.createTime):Ve.min(),h=new cr({mapValue:{fields:r.document.fields}}),f=Yt.newFoundDocument(i,s,l,h),m=r.targetIds||[],x=r.removedTargetIds||[];n=new p0(m,x,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Cs(t,r.document),s=r.readTime?Pn(r.readTime):Ve.min(),l=Yt.newNoDocument(i,s),h=r.removedTargetIds||[];n=new p0([],h,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Cs(t,r.document),s=r.removedTargetIds||[];n=new p0([],s,i,null)}else{if(!("filter"in e))return Re();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,l=new v5(i,s),h=r.targetId;n=new bS(h,l)}}return n}function md(t,e){let n;if(e instanceof bu)n={update:mE(t,e.key,e.value)};else if(e instanceof Ru)n={delete:gd(t,e.key)};else if(e instanceof wo)n={update:mE(t,e.key,e.data),updateMask:F5(e.fieldMask)};else{if(!(e instanceof Fw))return Re();n={verify:gd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,l){const h=l.transform;if(h instanceof su)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Sl)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof bl)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof ou)return{fieldPath:l.field.canonicalString(),increment:h.Pe};throw Re()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:R5(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re()}(t,e.precondition)),n}function Xp(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?sn.updateTime(Pn(s.updateTime)):s.exists!==void 0?sn.exists(s.exists):sn.none()}(e.currentDocument):sn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(l,h){let f=null;if("setToServerValue"in h)De(h.setToServerValue==="REQUEST_TIME"),f=new su;else if("appendMissingElements"in h){const x=h.appendMissingElements.values||[];f=new Sl(x)}else if("removeAllFromArray"in h){const x=h.removeAllFromArray.values||[];f=new bl(x)}else"increment"in h?f=new ou(l,h.increment):Re();const m=rn.fromServerFormat(h.fieldPath);return new jd(m,f)}(t,i)):[];if(e.update){e.update.name;const i=Cs(t,e.update.name),s=new cr({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=function(f){const m=f.fieldPaths||[];return new qr(m.map(x=>rn.fromServerFormat(x)))}(e.updateMask);return new wo(i,s,l,n,r)}return new bu(i,s,n,r)}if(e.delete){const i=Cs(t,e.delete);return new Ru(i,n)}if(e.verify){const i=Cs(t,e.verify);return new Fw(i,n)}return Re()}function D5(t,e){return t&&t.length>0?(De(e!==void 0),t.map(n=>function(i,s){let l=i.updateTime?Pn(i.updateTime):Pn(s);return l.isEqual(Ve.min())&&(l=Pn(s)),new x5(l,i.transformResults||[])}(n,e))):[]}function LS(t,e){return{documents:[DS(t,e.path)]}}function ng(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=DS(t,i);const s=function(m){if(m.length!==0)return US(Dt.create(m,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const l=function(m){if(m.length!==0)return m.map(x=>function(I){return{field:Uo(I.field),direction:O5(I.dir)}}(x))}(e.orderBy);l&&(n.structuredQuery.orderBy=l);const h=Kp(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{_t:n,parent:i}}function FS(t,e,n,r){const{_t:i,parent:s}=ng(t,e),l={},h=[];let f=0;return n.forEach(m=>{const x=r?m.alias:"aggregate_"+f++;l[x]=m.alias,m.aggregateType==="count"?h.push({alias:x,count:{}}):m.aggregateType==="avg"?h.push({alias:x,avg:{field:Uo(m.fieldPath)}}):m.aggregateType==="sum"&&h.push({alias:x,sum:{field:Uo(m.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:i.structuredQuery},parent:i.parent},ut:l,parent:s}}function VS(t){let e=kS(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){De(r===1);const x=n.from[0];x.allDescendants?i=x.collectionId:e=e.child(x.collectionId)}let s=[];n.where&&(s=function(_){const I=BS(_);return I instanceof Dt&&kw(I)?I.getFilters():[I]}(n.where));let l=[];n.orderBy&&(l=function(_){return _.map(I=>function(B){return new fd(hc(B.field),function(G){switch(G){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(B.direction))}(I))}(n.orderBy));let h=null;n.limit&&(h=function(_){let I;return I=typeof _=="object"?_.value:_,Fd(I)?null:I}(n.limit));let f=null;n.startAt&&(f=function(_){const I=!!_.before,R=_.values||[];return new xa(R,I)}(n.startAt));let m=null;return n.endAt&&(m=function(_){const I=!_.before,R=_.values||[];return new xa(R,I)}(n.endAt)),aS(e,i,l,s,h,"F",f,m)}function k5(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function BS(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=hc(n.unaryFilter.field);return dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=hc(n.unaryFilter.field);return dt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=hc(n.unaryFilter.field);return dt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=hc(n.unaryFilter.field);return dt.create(l,"!=",{nullValue:"NULL_VALUE"});default:return Re()}}(t):t.fieldFilter!==void 0?function(n){return dt.create(hc(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Re()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Dt.create(n.compositeFilter.filters.map(r=>BS(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Re()}}(n.compositeFilter.op))}(t):Re()}function O5(t){return T5[t]}function M5(t){return C5[t]}function L5(t){return S5[t]}function Uo(t){return{fieldPath:t.canonicalString()}}function hc(t){return rn.fromServerFormat(t.fieldPath)}function US(t){return t instanceof dt?function(n){if(n.op==="=="){if(Z2(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NAN"}};if(Y2(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Z2(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NOT_NAN"}};if(Y2(n.value))return{unaryFilter:{field:Uo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uo(n.field),op:M5(n.op),value:n.value}}}(t):t instanceof Dt?function(n){const r=n.getFilters().map(i=>US(i));return r.length===1?r[0]:{compositeFilter:{op:L5(n.op),filters:r}}}(t):Re()}function F5(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function jS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,n,r,i,s=Ve.min(),l=Ve.min(),h=In.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new to(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e){this.ct=e}}function V5(t,e){let n;if(e.document)n=MS(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Te.fromSegments(e.noDocument.path),i=Nl(e.noDocument.readTime);n=Yt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Re();{const r=Te.fromSegments(e.unknownDocument.path),i=Nl(e.unknownDocument.version);n=Yt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new dn(i[0],i[1]);return Ve.fromTimestamp(s)}(e.readTime)),n}function pE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:s1(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,l){return{name:gd(s,l.key),fields:l.data.value.mapValue.fields,updateTime:au(s,l.version.toTimestamp()),createTime:au(s,l.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Rl(e.version)};else{if(!e.isUnknownDocument())return Re();r.unknownDocument={path:n.path.toArray(),version:Rl(e.version)}}return r}function s1(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Rl(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Nl(t){const e=new dn(t.seconds,t.nanoseconds);return Ve.fromTimestamp(e)}function Za(t,e){const n=(e.baseMutations||[]).map(s=>Xp(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const l=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const h=e.mutations[s+1];l.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Xp(t.ct,s)),i=dn.fromMillis(e.localWriteTimeMs);return new Vw(e.batchId,i,n,r)}function _h(t){const e=Nl(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Nl(t.lastLimboFreeSnapshotVersion):Ve.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return De(s.documents.length===1),Ar(Su(kS(s.documents[0])))}(t.query):function(s){return Ar(VS(s))}(t.query),new to(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,In.fromBase64String(t.resumeToken))}function GS(t,e){const n=Rl(e.snapshotVersion),r=Rl(e.lastLimboFreeSnapshotVersion);let i;i=t1(e.target)?LS(t.ct,e.target):ng(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Cl(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Gw(t){const e=VS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?r1(e,e.limit,"L"):e}function fm(t,e){return new Uw(e.largestBatchId,Xp(t.ct,e.overlayMutation))}function yE(t,e){const n=e.path.lastSegment();return[t,Ir(e.path.popLast()),n]}function wE(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Rl(r.readTime),documentKey:Ir(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{getBundleMetadata(e,n){return xE(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Nl(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return xE(e).put(function(i){return{bundleId:i.id,createTime:Rl(Pn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return _E(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:Gw(s.bundledQuery),readTime:Nl(s.readTime)}}(r)})}saveNamedQuery(e,n){return _E(e).put(function(i){return{name:i.name,readTime:Rl(Pn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function xE(t){return $n(t,"bundles")}function _E(t){return $n(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new rg(e,r)}getOverlay(e,n){return sh(e).get(yE(this.userId,n)).next(r=>r?fm(this.serializer,r):null)}getOverlays(e,n){const r=ws();return te.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,l)=>{const h=new Uw(n,l);i.push(this.ht(e,h))}),te.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(l=>i.add(Ir(l.getCollectionPath())));const s=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);s.push(sh(e).j("collectionPathOverlayIndex",h))}),te.waitFor(s)}getOverlaysForCollection(e,n,r){const i=ws(),s=Ir(n),l=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return sh(e).U("collectionPathOverlayIndex",l).next(h=>{for(const f of h){const m=fm(this.serializer,f);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=ws();let l;const h=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return sh(e).J({index:"collectionGroupOverlayIndex",range:h},(f,m,x)=>{const _=fm(this.serializer,m);s.size()<i||_.largestBatchId===l?(s.set(_.getKey(),_),l=_.largestBatchId):x.done()}).next(()=>s)}ht(e,n){return sh(e).put(function(i,s,l){const[h,f,m]=yE(s,l.mutation.key);return{userId:s,collectionPath:f,documentId:m,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:md(i.ct,l.mutation)}}(this.serializer,this.userId,n))}}function sh(t){return $n(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U5{Pt(e){return $n(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?In.fromUint8Array(r):In.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(tn(e.integerValue));else if("doubleValue"in e){const r=tn(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),cd(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=ho(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(fo(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?YC(e)?this.dt(n,Number.MAX_SAFE_INTEGER):J1(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Re()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const l="value",h=((i=(r=s[l].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(tn(h)),this.Vt(l,n),this.Tt(s[l],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),Te.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Ja.vt=new Ja;function j5(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function EE(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const l=j5(255&r[s]);if(i+=l,l!==8)break}return i}(t);return Math.ceil(e/8)}class z5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=EE(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=EE(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,s,!1),new Uint8Array(l.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class G5{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class H5{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class oh{constructor(){this.jt=new z5,this.Ht=new G5(this.jt),this.Jt=new H5(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new el(this.indexId,this.documentKey,this.arrayValue,r)}}function bo(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=vE(t.arrayValue,e.arrayValue),n!==0?n:(n=vE(t.directionalValue,e.directionalValue),n!==0?n:Te.comparator(t.documentKey,e.documentKey)))}function vE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e){this.Xt=new Ft((n,r)=>rn.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(De(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Bp(e);if(n!==void 0&&!this.sn(n))return!1;const r=Xa(e);let i=new Set,s=0,l=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const h=this.Xt.getIterator().getNext();if(!i.has(h.field.canonicalString())){const f=r[s];if(!this.on(h,f)||!this._n(this.en[l++],f))return!1}++s}for(;s<r.length;++s){const h=r[s];if(l>=this.en.length||!this._n(this.en[l++],h))return!1}return!0}an(){if(this.nn)return null;let e=new Ft(rn.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new ml(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new ml(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new ml(r.field,r.dir==="asc"?0:1)));return new tu(tu.UNKNOWN_ID,this.collectionId,n,nu.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(t){var e,n;if(De(t instanceof dt||t instanceof Dt),t instanceof dt){if(t instanceof oS){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>dt.create(t.field,"==",s)))||[];return Dt.create(i,"or")}return t}const r=t.filters.map(i=>HS(i));return Dt.create(r,t.op)}function W5(t){if(t.getFilters().length===0)return[];const e=Jp(HS(t));return De(WS(e)),Yp(e)||Zp(e)?[e]:e.getFilters()}function Yp(t){return t instanceof dt}function Zp(t){return t instanceof Dt&&kw(t)}function WS(t){return Yp(t)||Zp(t)||function(n){if(n instanceof Dt&&Gp(n)){for(const r of n.getFilters())if(!Yp(r)&&!Zp(r))return!1;return!0}return!1}(t)}function Jp(t){if(De(t instanceof dt||t instanceof Dt),t instanceof dt)return t;if(t.filters.length===1)return Jp(t.filters[0]);const e=t.filters.map(r=>Jp(r));let n=Dt.create(e,t.op);return n=o1(n),WS(n)?n:(De(n instanceof Dt),De(iu(n)),De(n.filters.length>1),n.filters.reduce((r,i)=>Hw(r,i)))}function Hw(t,e){let n;return De(t instanceof dt||t instanceof Dt),De(e instanceof dt||e instanceof Dt),n=t instanceof dt?e instanceof dt?function(i,s){return Dt.create([i,s],"and")}(t,e):AE(t,e):e instanceof dt?AE(e,t):function(i,s){if(De(i.filters.length>0&&s.filters.length>0),iu(i)&&iu(s))return rS(i,s.getFilters());const l=Gp(i)?i:s,h=Gp(i)?s:i,f=l.filters.map(m=>Hw(m,h));return Dt.create(f,"or")}(t,e),o1(n)}function AE(t,e){if(iu(e))return rS(e,t.getFilters());{const n=e.filters.map(r=>Hw(t,r));return Dt.create(n,"or")}}function o1(t){if(De(t instanceof dt||t instanceof Dt),t instanceof dt)return t;const e=t.getFilters();if(e.length===1)return o1(e[0]);if(tS(t))return t;const n=e.map(i=>o1(i)),r=[];return n.forEach(i=>{i instanceof dt?r.push(i):i instanceof Dt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Dt.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q5{constructor(){this.un=new Ww}addToCollectionParentIndex(e,n){return this.un.add(n),te.resolve()}getCollectionParents(e,n){return te.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return te.resolve()}deleteFieldIndex(e,n){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,n){return te.resolve()}getDocumentsMatchingTarget(e,n){return te.resolve(null)}getIndexType(e,n){return te.resolve(0)}getFieldIndexes(e,n){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,n){return te.resolve(ui.min())}getMinOffsetFromCollectionGroup(e,n){return te.resolve(ui.min())}updateCollectionGroup(e,n,r){return te.resolve()}updateIndexEntries(e,n){return te.resolve()}}class Ww{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ft(ht.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ft(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf=new Uint8Array(0);class K5{constructor(e,n){this.databaseId=n,this.cn=new Ww,this.ln=new yo(r=>Cl(r),(r,i)=>Vd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:Ir(i)};return TE(e).put(s)}return te.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[FC(n),""],!1,!0);return TE(e).U(i).next(s=>{for(const l of s){if(l.collectionId!==n)break;r.push(ys(l.parent))}return r})}addFieldIndex(e,n){const r=ah(e),i=function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map(f=>[f.fieldPath.canonicalString(),f.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const l=oc(e);return s.next(h=>{l.put(wE(h,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=ah(e),i=oc(e),s=sc(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ah(e),r=sc(e),i=oc(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return te.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new IE(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=sc(e);let i=!0;const s=new Map;return te.forEach(this.hn(n),l=>this.Pn(e,l).next(h=>{i&&(i=!!h),s.set(l,h)})).next(()=>{if(i){let l=tt();const h=[];return te.forEach(s,(f,m)=>{fe("IndexedDbIndexManager",`Using index ${function(N){return`id=${N.indexId}|cg=${N.collectionGroup}|f=${N.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(f)} to execute ${Cl(n)}`);const x=function(N,H){const Y=Bp(H);if(Y===void 0)return null;for(const J of n1(N,Y.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(m,f),_=function(N,H){const Y=new Map;for(const J of Xa(H))for(const k of n1(N,J.fieldPath))switch(k.op){case"==":case"in":Y.set(J.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return Y.set(J.fieldPath.canonicalString(),k.value),Array.from(Y.values())}return null}(m,f),I=function(N,H){const Y=[];let J=!0;for(const k of Xa(H)){const M=k.kind===0?rE(N,k.fieldPath,N.startAt):iE(N,k.fieldPath,N.startAt);Y.push(M.value),J&&(J=M.inclusive)}return new xa(Y,J)}(m,f),R=function(N,H){const Y=[];let J=!0;for(const k of Xa(H)){const M=k.kind===0?iE(N,k.fieldPath,N.endAt):rE(N,k.fieldPath,N.endAt);Y.push(M.value),J&&(J=M.inclusive)}return new xa(Y,J)}(m,f),B=this.In(f,m,I),D=this.In(f,m,R),G=this.Tn(f,m,_),F=this.En(f.indexId,x,B,I.inclusive,D,R.inclusive,G);return te.forEach(F,P=>r.G(P,n.limit).next(N=>{N.forEach(H=>{const Y=Te.fromSegments(H.documentKey);l.has(Y)||(l=l.add(Y),h.push(Y))})}))}).next(()=>h)}return te.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=W5(Dt.create(e.filters,"and")).map(r=>Wp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,l,h){const f=(n!=null?n.length:1)*Math.max(r.length,s.length),m=f/(n!=null?n.length:1),x=[];for(let _=0;_<f;++_){const I=n?this.dn(n[_/m]):Bf,R=this.An(e,I,r[_%m],i),B=this.Rn(e,I,s[_%m],l),D=h.map(G=>this.An(e,I,G,!0));x.push(...this.createRange(R,B,D))}return x}An(e,n,r,i){const s=new el(e,Te.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new el(e,Te.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new IE(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let l=null;for(const h of s)r.rn(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,n){let r=2;const i=this.hn(n);return te.forEach(i,s=>this.Pn(e,s).next(l=>{l?r!==0&&l.fields.length<function(f){let m=new Ft(rn.comparator),x=!1;for(const _ of f.filters)for(const I of _.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?x=!0:m=m.add(I.field));for(const _ of f.orderBy)_.field.isKeyField()||(m=m.add(_.field));return m.size+(x?1:0)}(s)&&(r=1):r=0})).next(()=>function(l){return l.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new oh;for(const i of Xa(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const l=r.Yt(i.kind);Ja.vt.It(s,l)}return r.zt()}dn(e){const n=new oh;return Ja.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new oh;return Ja.vt.It(Tl(this.databaseId,n),r.Yt(function(s){const l=Xa(s);return l.length===0?0:l[l.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new oh);let s=0;for(const l of Xa(e)){const h=r[s++];for(const f of i)if(this.fn(n,l.fieldPath)&&dd(h))i=this.gn(i,l,h);else{const m=f.Yt(l.kind);Ja.vt.It(h,m)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const l of r.arrayValue.values||[])for(const h of i){const f=new oh;f.seed(h.zt()),Ja.vt.It(l,f.Yt(n.kind)),s.push(f)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof dt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ah(e),i=oc(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const l=[];return te.forEach(s,h=>i.get([h.indexId,this.uid]).next(f=>{l.push(function(x,_){const I=_?new nu(_.sequenceNumber,new ui(Nl(_.readTime),new Te(ys(_.documentKey)),_.largestBatchId)):nu.empty(),R=x.fields.map(([B,D])=>new ml(rn.fromServerFormat(B),D));return new tu(x.indexId,x.collectionGroup,R,I)}(h,f))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Ke(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ah(e),s=oc(e);return this.yn(e).next(l=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(h=>te.forEach(h,f=>s.put(wE(f.indexId,this.uid,l,r)))))}updateIndexEntries(e,n){const r=new Map;return te.forEach(n,(i,s)=>{const l=r.get(i.collectionGroup);return(l?te.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),te.forEach(h,f=>this.wn(e,i,f).next(m=>{const x=this.Sn(s,f);return m.isEqual(x)?te.resolve():this.bn(e,s,f,m,x)}))))})}Dn(e,n,r,i){return sc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return sc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=sc(e);let s=new Ft(bo);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(l,h)=>{s=s.add(new el(r.indexId,n,h.arrayValue,h.directionalValue))}).next(()=>s)}Sn(e,n){let r=new Ft(bo);const i=this.Vn(n,e);if(i==null)return r;const s=Bp(n);if(s!=null){const l=e.data.field(s.fieldPath);if(dd(l))for(const h of l.arrayValue.values||[])r=r.add(new el(n.indexId,e.key,this.dn(h),i))}else r=r.add(new el(n.indexId,e.key,Bf,i));return r}bn(e,n,r,i,s){fe("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const l=[];return function(f,m,x,_,I){const R=f.getIterator(),B=m.getIterator();let D=ic(R),G=ic(B);for(;D||G;){let F=!1,P=!1;if(D&&G){const N=x(D,G);N<0?P=!0:N>0&&(F=!0)}else D!=null?P=!0:F=!0;F?(_(G),G=ic(B)):P?(I(D),D=ic(R)):(D=ic(R),G=ic(B))}}(i,s,bo,h=>{l.push(this.Dn(e,n,r,h))},h=>{l.push(this.vn(e,n,r,h))}),te.waitFor(l)}yn(e){let n=1;return oc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((l,h)=>bo(l,h)).filter((l,h,f)=>!h||bo(l,f[h-1])!==0);const i=[];i.push(e);for(const l of r){const h=bo(l,e),f=bo(l,n);if(h===0)i[0]=e.Zt();else if(h>0&&f<0)i.push(l),i.push(l.Zt());else if(f>0)break}i.push(n);const s=[];for(let l=0;l<i.length;l+=2){if(this.Cn(i[l],i[l+1]))return[];const h=[i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,Bf,[]],f=[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,Bf,[]];s.push(IDBKeyRange.bound(h,f))}return s}Cn(e,n){return bo(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(CE)}getMinOffset(e,n){return te.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||Re())).next(CE)}}function TE(t){return $n(t,"collectionParents")}function sc(t){return $n(t,"indexEntries")}function ah(t){return $n(t,"indexConfiguration")}function oc(t){return $n(t,"indexState")}function CE(t){De(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Nw(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new ui(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Er{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Er(e,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],l=IDBKeyRange.only(n.batchId);let h=0;const f=r.J({range:l},(x,_,I)=>(h++,I.delete()));s.push(f.next(()=>{De(h===1)}));const m=[];for(const x of n.mutations){const _=HC(e,x.key.path,n.batchId);s.push(i.delete(_)),m.push(x.key)}return te.waitFor(s).next(()=>m)}function a1(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Re();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er.DEFAULT_COLLECTION_PERCENTILE=10,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Er.DEFAULT=new Er(41943040,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Er.DISABLED=new Er(-1,0,0);class ig{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){De(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new ig(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ro(e).J({index:"userMutationsIndex",range:r},(i,s,l)=>{n=!1,l.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=dc(e),l=Ro(e);return l.add({}).next(h=>{De(typeof h=="number");const f=new Vw(h,n,r,i),m=function(R,B,D){const G=D.baseMutations.map(P=>md(R.ct,P)),F=D.mutations.map(P=>md(R.ct,P));return{userId:B,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:G,mutations:F}}(this.serializer,this.userId,f),x=[];let _=new Ft((I,R)=>Ke(I.canonicalString(),R.canonicalString()));for(const I of i){const R=HC(this.userId,I.key.path,h);_=_.add(I.key.path.popLast()),x.push(l.put(m)),x.push(s.put(R,MO))}return _.forEach(I=>{x.push(this.indexManager.addToCollectionParentIndex(e,I))}),e.addOnCommittedListener(()=>{this.Fn[h]=f.keys()}),te.waitFor(x).next(()=>f)})}lookupMutationBatch(e,n){return Ro(e).get(n).next(r=>r?(De(r.userId===this.userId),Za(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?te.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ro(e).J({index:"userMutationsIndex",range:i},(l,h,f)=>{h.userId===this.userId&&(De(h.batchId>=r),s=Za(this.serializer,h)),f.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ro(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,l)=>{r=s.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ro(e).U("userMutationsIndex",n).next(r=>r.map(i=>Za(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=h0(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return dc(e).J({range:i},(l,h,f)=>{const[m,x,_]=l,I=ys(x);if(m===this.userId&&n.path.isEqual(I))return Ro(e).get(_).next(R=>{if(!R)throw Re();De(R.userId===this.userId),s.push(Za(this.serializer,R))});f.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ft(Ke);const i=[];return n.forEach(s=>{const l=h0(this.userId,s.path),h=IDBKeyRange.lowerBound(l),f=dc(e).J({range:h},(m,x,_)=>{const[I,R,B]=m,D=ys(R);I===this.userId&&s.path.isEqual(D)?r=r.add(B):_.done()});i.push(f)}),te.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=h0(this.userId,r),l=IDBKeyRange.lowerBound(s);let h=new Ft(Ke);return dc(e).J({range:l},(f,m,x)=>{const[_,I,R]=f,B=ys(I);_===this.userId&&r.isPrefixOf(B)?B.length===i&&(h=h.add(R)):x.done()}).next(()=>this.xn(e,h))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ro(e).get(s).next(l=>{if(l===null)throw Re();De(l.userId===this.userId),r.push(Za(this.serializer,l))}))}),te.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return qS(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),te.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return te.resolve();const r=IDBKeyRange.lowerBound(function(l){return[l]}(this.userId)),i=[];return dc(e).J({range:r},(s,l,h)=>{if(s[0]===this.userId){const f=ys(s[1]);i.push(f)}else h.done()}).next(()=>{De(i.length===0)})})}containsKey(e,n){return KS(e,this.userId,n)}Nn(e){return $S(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function KS(t,e,n){const r=h0(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let l=!1;return dc(t).J({range:s,H:!0},(h,f,m)=>{const[x,_,I]=h;x===e&&_===i&&(l=!0),m.done()}).next(()=>l)}function Ro(t){return $n(t,"mutations")}function dc(t){return $n(t,"documentMutations")}function $S(t){return $n(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Pl(0)}static kn(){return new Pl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new Pl(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Ve.fromTimestamp(new dn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>ac(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(De(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return ac(e).J((l,h)=>{const f=_h(h);f.sequenceNumber<=n&&r.get(f.targetId)===null&&(i++,s.push(this.removeTargetData(e,f)))}).next(()=>te.waitFor(s)).next(()=>i)}forEachTarget(e,n){return ac(e).J((r,i)=>{const s=_h(i);n(s)})}qn(e){return bE(e).get("targetGlobalKey").next(n=>(De(n!==null),n))}Qn(e,n){return bE(e).put("targetGlobalKey",n)}Kn(e,n){return ac(e).put(GS(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Cl(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ac(e).J({range:i,index:"queryTargetsIndex"},(l,h,f)=>{const m=_h(h);Vd(n,m.target)&&(s=m,f.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=jo(e);return n.forEach(l=>{const h=Ir(l.path);i.push(s.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),te.waitFor(i)}removeMatchingKeys(e,n,r){const i=jo(e);return te.forEach(n,s=>{const l=Ir(s.path);return te.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=jo(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=jo(e);let s=tt();return i.J({range:r,H:!0},(l,h,f)=>{const m=ys(l[1]),x=new Te(m);s=s.add(x)}).next(()=>s)}containsKey(e,n){const r=Ir(n.path),i=IDBKeyRange.bound([r],[FC(r)],!1,!0);let s=0;return jo(e).J({index:"documentTargetsIndex",H:!0,range:i},([l,h],f,m)=>{l!==0&&(s++,m.done())}).next(()=>s>0)}ot(e,n){return ac(e).get(n).next(r=>r?_h(r):null)}}function ac(t){return $n(t,"targets")}function bE(t){return $n(t,"targetGlobal")}function jo(t){return $n(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE([t,e],[n,r]){const i=Ke(t,n);return i===0?Ke(e,r):i}class Q5{constructor(e){this.Un=e,this.buffer=new Ft(RE),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();RE(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class QS{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){fe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Na(n)?fe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Ra(n)}await this.Hn(3e5)})}}class X5{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return te.resolve(Wr.oe);const r=new Q5(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(SE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),SE):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,l,h,f,m;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,l=Date.now(),this.nthSequenceNumber(e,i))).next(_=>(r=_,h=Date.now(),this.removeTargets(e,r,n))).next(_=>(s=_,f=Date.now(),this.removeOrphanedDocuments(e,r))).next(_=>(m=Date.now(),cc()<=ut.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-x}ms
	Determined least recently used ${i} in `+(h-l)+`ms
	Removed ${s} targets in `+(f-h)+`ms
	Removed ${_} documents in `+(m-f)+`ms
Total Duration: ${m-x}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:_})))}}function XS(t,e){return new X5(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(e,n){this.db=e,this.garbageCollector=XS(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return Uf(e,r)}removeReference(e,n,r){return Uf(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Uf(e,n)}nr(e,n){return function(i,s){let l=!1;return $S(i).Y(h=>KS(i,h,s).next(f=>(f&&(l=!0),te.resolve(!f)))).next(()=>l)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(l,h)=>{if(h<=n){const f=this.nr(e,l).next(m=>{if(!m)return s++,r.getEntry(e,l).next(()=>(r.removeEntry(l,Ve.min()),jo(e).delete(function(_){return[0,Ir(_.path)]}(l))))});i.push(f)}}).next(()=>te.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Uf(e,n)}tr(e,n){const r=jo(e);let i,s=Wr.oe;return r.J({index:"documentTargetsIndex"},([l,h],{path:f,sequenceNumber:m})=>{l===0?(s!==Wr.oe&&n(new Te(ys(i)),s),s=m,i=f):s=Wr.oe}).next(()=>{s!==Wr.oe&&n(new Te(ys(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Uf(t,e){return jo(t).put(function(r,i){return{targetId:0,path:Ir(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(){this.changes=new yo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Yt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?te.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Wa(e).put(r)}removeEntry(e,n,r){return Wa(e).delete(function(s,l){const h=s.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],s1(l),h[h.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Yt.newInvalidDocument(n);return Wa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(lh(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:Yt.newInvalidDocument(n)};return Wa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(lh(n))},(i,s)=>{r={document:this.ir(n,s),size:a1(s)}}).next(()=>r)}getEntries(e,n){let r=Kr();return this._r(e,n,(i,s)=>{const l=this.ir(i,s);r=r.insert(i,l)}).next(()=>r)}ar(e,n){let r=Kr(),i=new Kt(Te.comparator);return this._r(e,n,(s,l)=>{const h=this.ir(s,l);r=r.insert(s,h),i=i.insert(s,a1(l))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return te.resolve();let i=new Ft(DE);n.forEach(f=>i=i.add(f));const s=IDBKeyRange.bound(lh(i.first()),lh(i.last())),l=i.getIterator();let h=l.getNext();return Wa(e).J({index:"documentKeyIndex",range:s},(f,m,x)=>{const _=Te.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&DE(h,_)<0;)r(h,null),h=l.getNext();h&&h.isEqual(_)&&(r(h,m),h=l.hasNext()?l.getNext():null),h?x.$(lh(h)):x.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const l=n.path,h=[l.popLast().toArray(),l.lastSegment(),s1(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Wa(e).U(IDBKeyRange.bound(h,f,!0)).next(m=>{s==null||s.incrementDocumentReadCount(m.length);let x=Kr();for(const _ of m){const I=this.ir(Te.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);I.isFoundDocument()&&(Ud(n,I)||i.has(I.key))&&(x=x.insert(I.key,I))}return x})}getAllFromCollectionGroup(e,n,r,i){let s=Kr();const l=PE(n,r),h=PE(n,ui.max());return Wa(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(f,m,x)=>{const _=this.ir(Te.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(_.key,_),s.size===i&&x.done()}).next(()=>s)}newChangeBuffer(e){return new J5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return NE(e).get("remoteDocumentGlobalKey").next(n=>(De(!!n),n))}rr(e,n){return NE(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=V5(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Ve.min())))return r}return Yt.newInvalidDocument(e)}}function ZS(t){return new Z5(t)}class J5 extends YS{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new yo(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ft((s,l)=>Ke(s.canonicalString(),l.canonicalString()));return this.changes.forEach((s,l)=>{const h=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,h.readTime)),l.isValidDocument()){const f=pE(this.cr.serializer,l);i=i.add(s.path.popLast());const m=a1(f);r+=m-h.size,n.push(this.cr.addEntry(e,s,f))}else if(r-=h.size,this.trackRemovals){const f=pE(this.cr.serializer,l.convertToNoDocument(Ve.min()));n.push(this.cr.addEntry(e,s,f))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),te.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,l)=>{this.lr.set(s,{size:l,readTime:r.get(s).readTime})}),r))}}function NE(t){return $n(t,"remoteDocumentGlobal")}function Wa(t){return $n(t,"remoteDocumentsV14")}function lh(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function PE(t,e){const n=e.documentKey.path.toArray();return[t,s1(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function DE(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ke(n[s],r[s]),i)return i;return i=Ke(n.length,r.length),i||(i=Ke(n[n.length-2],r[r.length-2]),i||Ke(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Oh(r.mutation,i,qr.empty(),dn.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,tt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=tt()){const i=ws();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let l=wh();return s.forEach((h,f)=>{l=l.insert(h,f.overlayedDocument)}),l}))}getOverlayedDocuments(e,n){const r=ws();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,tt()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((l,h)=>{n.set(l,h)})})}computeViews(e,n,r,i){let s=Kr();const l=kh(),h=function(){return kh()}();return n.forEach((f,m)=>{const x=r.get(m.key);i.has(m.key)&&(x===void 0||x.mutation instanceof wo)?s=s.insert(m.key,m):x!==void 0?(l.set(m.key,x.mutation.getFieldMask()),Oh(x.mutation,m,x.mutation.getFieldMask(),dn.now())):l.set(m.key,qr.empty())}),this.recalculateAndSaveOverlays(e,s).next(f=>(f.forEach((m,x)=>l.set(m,x)),n.forEach((m,x)=>{var _;return h.set(m,new eM(x,(_=l.get(m))!==null&&_!==void 0?_:null))}),h))}recalculateAndSaveOverlays(e,n){const r=kh();let i=new Kt((l,h)=>l-h),s=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(l=>{for(const h of l)h.keys().forEach(f=>{const m=n.get(f);if(m===null)return;let x=r.get(f)||qr.empty();x=h.applyToLocalView(m,x),r.set(f,x);const _=(i.get(h.batchId)||tt()).add(f);i=i.insert(h.batchId,_)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),m=f.key,x=f.value,_=mS();x.forEach(I=>{if(!s.has(I)){const R=vS(n.get(I),r.get(I));R!==null&&_.set(I,R),s=s.add(I)}}),l.push(this.documentOverlayCache.saveOverlays(e,m,_))}return te.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(l){return Te.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ow(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const l=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):te.resolve(ws());let h=-1,f=s;return l.next(m=>te.forEach(m,(x,_)=>(h<_.largestBatchId&&(h=_.largestBatchId),s.get(x)?te.resolve():this.remoteDocumentCache.getEntry(e,x).next(I=>{f=f.insert(x,I)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,f,m,tt())).next(x=>({batchId:h,changes:gS(x)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Te(n)).next(r=>{let i=wh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let l=wh();return this.indexManager.getCollectionParents(e,s).next(h=>te.forEach(h,f=>{const m=function(_,I){return new po(I,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(n,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,m,r,i).next(x=>{x.forEach((_,I)=>{l=l.insert(_,I)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(l=>{s.forEach((f,m)=>{const x=m.getKey();l.get(x)===null&&(l=l.insert(x,Yt.newInvalidDocument(x)))});let h=wh();return l.forEach((f,m)=>{const x=s.get(f);x!==void 0&&Oh(x.mutation,m,qr.empty(),dn.now()),Ud(n,m)&&(h=h.insert(f,m))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return te.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Pn(i.createTime)}}(n)),te.resolve()}getNamedQuery(e,n){return te.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:Gw(i.bundledQuery),readTime:Pn(i.readTime)}}(n)),te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(){this.overlays=new Kt(Te.comparator),this.Ir=new Map}getOverlay(e,n){return te.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ws();return te.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),te.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),te.resolve()}getOverlaysForCollection(e,n,r){const i=ws(),s=n.length+1,l=new Te(n.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const f=h.getNext().value,m=f.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===s&&f.largestBatchId>r&&i.set(f.getKey(),f)}return te.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Kt((m,x)=>m-x);const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>r){let x=s.get(m.largestBatchId);x===null&&(x=ws(),s=s.insert(m.largestBatchId,x)),x.set(m.getKey(),m)}}const h=ws(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((m,x)=>h.set(m,x)),!(h.size()>=i)););return te.resolve(h)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const l=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Uw(n,r));let s=this.Ir.get(n);s===void 0&&(s=tt(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(){this.sessionToken=In.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(){this.Tr=new Ft(Zn.Er),this.dr=new Ft(Zn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Zn(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Zn(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Te(new ht([])),r=new Zn(n,e),i=new Zn(n,e+1),s=[];return this.dr.forEachInRange([r,i],l=>{this.Vr(l),s.push(l.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Te(new ht([])),r=new Zn(n,e),i=new Zn(n,e+1);let s=tt();return this.dr.forEachInRange([r,i],l=>{s=s.add(l.key)}),s}containsKey(e){const n=new Zn(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Zn{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Te.comparator(e.key,n.key)||Ke(e.wr,n.wr)}static Ar(e,n){return Ke(e.wr,n.wr)||Te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ft(Zn.Er)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Vw(s,n,r,i);this.mutationQueue.push(l);for(const h of i)this.br=this.br.add(new Zn(h.key,s)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return te.resolve(l)}lookupMutationBatch(e,n){return te.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return te.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Zn(n,0),i=new Zn(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],l=>{const h=this.Dr(l.wr);s.push(h)}),te.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ft(Ke);return n.forEach(i=>{const s=new Zn(i,0),l=new Zn(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,l],h=>{r=r.add(h.wr)})}),te.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Te.isDocumentKey(s)||(s=s.child(""));const l=new Zn(new Te(s),0);let h=new Ft(Ke);return this.br.forEachWhile(f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(f.wr)),!0)},l),te.resolve(this.Cr(h))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){De(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return te.forEach(n.mutations,i=>{const s=new Zn(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Zn(n,0),i=this.br.firstAfterOrEqual(r);return te.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(e){this.Mr=e,this.docs=function(){return new Kt(Te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,l=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return te.resolve(r?r.document.mutableCopy():Yt.newInvalidDocument(n))}getEntries(e,n){let r=Kr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Yt.newInvalidDocument(i))}),te.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Kr();const l=n.path,h=new Te(l.child("")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:m,value:{document:x}}=f.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||Nw(BC(x),r)<=0||(i.has(x.key)||Ud(n,x))&&(s=s.insert(x.key,x.mutableCopy()))}return te.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Re()}Or(e,n){return te.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new oM(this)}getSize(e){return te.resolve(this.size)}}class oM extends YS{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),te.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(e){this.persistence=e,this.Nr=new yo(n=>Cl(n),Vd),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new qw,this.targetCount=0,this.kr=Pl.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),te.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Pl(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,te.resolve()}updateTargetData(e,n){return this.Kn(n),te.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((l,h)=>{h.sequenceNumber<=n&&r.get(h.targetId)===null&&(this.Nr.delete(l),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),te.waitFor(s).next(()=>i)}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return te.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),te.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(l=>{s.push(i.markPotentiallyOrphaned(e,l))}),te.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),te.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return te.resolve(r)}containsKey(e,n){return te.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Wr(0),this.Kr=!1,this.Kr=!0,this.$r=new rM,this.referenceDelegate=e(this),this.Ur=new aM(this),this.indexManager=new q5,this.remoteDocumentCache=function(i){return new sM(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new zS(n),this.Gr=new tM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new nM,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new iM(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){fe("MemoryPersistence","Starting transaction:",e);const i=new lM(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return te.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class lM extends jC{constructor(e){super(),this.currentSequenceNumber=e}}class sg{constructor(e){this.persistence=e,this.Jr=new qw,this.Yr=null}static Zr(e){return new sg(e)}get Xr(){if(this.Yr)return this.Yr;throw Re()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),te.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),te.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),te.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.Xr,r=>{const i=Te.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,Ve.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return te.or([()=>te.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}class l1{constructor(e,n){this.persistence=e,this.ti=new yo(r=>Ir(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=XS(this,n)}static Zr(e,n){return new l1(e,n)}zr(){}jr(e){return te.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Yn(e){const n=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}Zn(e,n){return te.forEach(this.ti,(r,i)=>this.nr(e,r,i).next(s=>s?te.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Or(e,l=>this.nr(e,l,n).next(h=>{h||(r++,s.removeEntry(l,Ve.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ti.set(n,e.currentSequenceNumber),te.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),te.resolve()}removeReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),te.resolve()}updateLimboDocument(e,n){return this.ti.set(n,e.currentSequenceNumber),te.resolve()}Wr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=f0(e.data.value)),n}nr(e,n,r){return te.or([()=>this.persistence.Hr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.ti.get(n);return te.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e){this.serializer=e}O(e,n,r,i){const s=new X1("createOrUpgrade",n);r<1&&i>=1&&(function(f){f.createObjectStore("owner")}(e),function(f){f.createObjectStore("mutationQueues",{keyPath:"userId"}),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",q2,{unique:!0}),f.createObjectStore("documentMutations")}(e),kE(e),function(f){f.createObjectStore("remoteDocuments")}(e));let l=te.resolve();return r<3&&i>=3&&(r!==0&&(function(f){f.deleteObjectStore("targetDocuments"),f.deleteObjectStore("targets"),f.deleteObjectStore("targetGlobal")}(e),kE(e)),l=l.next(()=>function(f){const m=f.store("targetGlobal"),x={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ve.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",x)}(s))),r<4&&i>=4&&(r!==0&&(l=l.next(()=>function(f,m){return m.store("mutations").U().next(x=>{f.deleteObjectStore("mutations"),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",q2,{unique:!0});const _=m.store("mutations"),I=x.map(R=>_.put(R));return te.waitFor(I)})}(e,s))),l=l.next(()=>{(function(f){f.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(l=l.next(()=>this.ni(s))),r<6&&i>=6&&(l=l.next(()=>(function(f){f.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(l=l.next(()=>this.ii(s))),r<8&&i>=8&&(l=l.next(()=>this.si(e,s))),r<9&&i>=9&&(l=l.next(()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(l=l.next(()=>this.oi(s))),r<11&&i>=11&&(l=l.next(()=>{(function(f){f.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(f){f.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{(function(f){const m=f.createObjectStore("documentOverlays",{keyPath:KO});m.createIndex("collectionPathOverlayIndex",$O,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",QO,{unique:!1})})(e)})),r<13&&i>=13&&(l=l.next(()=>function(f){const m=f.createObjectStore("remoteDocumentsV14",{keyPath:LO});m.createIndex("documentKeyIndex",FO),m.createIndex("collectionGroupIndex",VO)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.ai(e,s))),r<15&&i>=15&&(l=l.next(()=>function(f){f.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),f.createObjectStore("indexState",{keyPath:GO}).createIndex("sequenceNumberIndex",HO,{unique:!1}),f.createObjectStore("indexEntries",{keyPath:WO}).createIndex("documentKeyIndex",qO,{unique:!1})}(e))),r<16&&i>=16&&(l=l.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(l=l.next(()=>{(function(f){f.createObjectStore("globals",{keyPath:"name"})})(e)})),l}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=a1(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>te.forEach(i,s=>{const l=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",l).next(h=>te.forEach(h,f=>{De(f.userId===s.userId);const m=Za(this.serializer,f);return qS(e,s.userId,m).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((l,h)=>{const f=new ht(l),m=function(_){return[0,Ir(_)]}(f);s.push(n.get(m).next(x=>x?te.resolve():(_=>n.put({targetId:0,path:Ir(_),sequenceNumber:i.highestListenSequenceNumber}))(f)))}).next(()=>te.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:zO});const r=n.store("collectionParents"),i=new Ww,s=l=>{if(i.add(l)){const h=l.lastSegment(),f=l.popLast();return r.put({collectionId:h,parent:Ir(f)})}};return n.store("remoteDocuments").J({H:!0},(l,h)=>{const f=new ht(l);return s(f.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([l,h,f],m)=>{const x=ys(h);return s(x.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=_h(i),l=GS(this.serializer,s);return n.put(l)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,l)=>{const h=n.store("remoteDocumentsV14"),f=function(_){return _.document?new Te(ht.fromString(_.document.name).popFirst(5)):_.noDocument?Te.fromSegments(_.noDocument.path):_.unknownDocument?Te.fromSegments(_.unknownDocument.path):Re()}(l).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(m))}).next(()=>te.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=ZS(this.serializer),s=new Kw(sg.Zr,this.serializer.ct);return r.U().next(l=>{const h=new Map;return l.forEach(f=>{var m;let x=(m=h.get(f.userId))!==null&&m!==void 0?m:tt();Za(this.serializer,f).keys().forEach(_=>x=x.add(_)),h.set(f.userId,x)}),te.forEach(h,(f,m)=>{const x=new er(m),_=rg.lt(this.serializer,x),I=s.getIndexManager(x),R=ig.lt(x,this.serializer,I,s.referenceDelegate);return new JS(i,R,_,I).recalculateAndSaveOverlaysForDocumentKeys(new Up(n,Wr.oe),f).next()})})}}function kE(t){t.createObjectStore("targetDocuments",{keyPath:UO}).createIndex("documentTargetsIndex",jO,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",BO,{unique:!0}),t.createObjectStore("targetGlobal")}const gm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class $w{constructor(e,n,r,i,s,l,h,f,m,x,_=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=l,this.document=h,this.ci=m,this.li=x,this.hi=_,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=I=>Promise.resolve(),!$w.D())throw new ge(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Y5(this,i),this.Ai=n+"main",this.serializer=new zS(f),this.Ri=new Ts(this.Ai,this.hi,new cM(this.serializer)),this.$r=new U5,this.Ur=new $5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ZS(this.serializer),this.Gr=new B5,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,x===!1&&Rn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ge(ae.FAILED_PRECONDITION,gm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Wr(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Na(e))return fe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ch(e).get("owner").next(n=>te.resolve(this.vi(n)))}Ci(e){return jf(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=$n(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),l=i.filter(h=>s.indexOf(h)===-1);return te.forEach(l,h=>r.delete(h.clientId)).next(()=>l)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?te.resolve(!0):ch(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ge(ae.FAILED_PRECONDITION,gm);return!1}}return!(!this.networkEnabled||!this.inForeground)||jf(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,l=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(s||l&&h)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&fe("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Up(e,Wr.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>jf(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return ig.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new K5(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return rg.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){fe("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(f){return f===17?ZO:f===16?YO:f===15?Dw:f===14?KC:f===13?qC:f===12?XO:f===11?WC:void Re()}(this.hi);let l;return this.Ri.runTransaction(e,i,s,h=>(l=new Up(h,this.Qr?this.Qr.next():Wr.oe),n==="readwrite-primary"?this.wi(l).next(f=>!!f||this.Si(l)).next(f=>{if(!f)throw Rn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ge(ae.FAILED_PRECONDITION,UC);return r(l)}).next(f=>this.Di(l).next(()=>f)):this.Ki(l).next(()=>r(l)))).then(h=>(l.raiseOnCommittedEvent(),h))}Ki(e){return ch(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ge(ae.FAILED_PRECONDITION,gm)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ch(e).put("owner",n)}static D(){return Ts.D()}bi(e){const n=ch(e);return n.get("owner").next(r=>this.vi(r)?(fe("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):te.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Rn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;FT()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return fe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Rn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Rn("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ch(t){return $n(t,"owner")}function jf(t){return $n(t,"clientMetadata")}function Qw(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=tt(),i=tt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Xw(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return FT()?8:zC(Kn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(l=>{s.result=l}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(l=>{s.result=l})}).next(()=>{if(s.result)return;const l=new uM;return this.Xi(e,n,l).next(h=>{if(s.result=h,this.zi)return this.es(e,n,l,h.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(cc()<=ut.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",uc(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),te.resolve()):(cc()<=ut.DEBUG&&fe("QueryEngine","Query:",uc(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(cc()<=ut.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",uc(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ar(n))):te.resolve())}Yi(e,n){if(sE(n))return te.resolve(null);let r=Ar(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=r1(n,null,"F"),r=Ar(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const l=tt(...s);return this.Ji.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(f=>{const m=this.ts(n,h);return this.ns(n,m,l,f.readTime)?this.Yi(e,r1(n,null,"F")):this.rs(e,m,n,f)}))})))}Zi(e,n,r,i){return sE(n)||i.isEqual(Ve.min())?te.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const l=this.ts(n,s);return this.ns(n,l,r,i)?te.resolve(null):(cc()<=ut.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),uc(n)),this.rs(e,l,n,VC(i,-1)).next(h=>h))})}ts(e,n){let r=new Ft(dS(e));return n.forEach((i,s)=>{Ud(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return cc()<=ut.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",uc(n)),this.Ji.getDocumentsMatchingQuery(e,n,ui.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(l=>{s=s.insert(l.key,l)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Kt(Ke),this._s=new yo(s=>Cl(s),Vd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JS(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function tb(t,e,n,r){return new hM(t,e,n,r)}async function nb(t,e){const n=Ae(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const l=[],h=[];let f=tt();for(const m of i){l.push(m.batchId);for(const x of m.mutations)f=f.add(x.key)}for(const m of s){h.push(m.batchId);for(const x of m.mutations)f=f.add(x.key)}return n.localDocuments.getDocuments(r,f).next(m=>({hs:m,removedBatchIds:l,addedBatchIds:h}))})})}function dM(t,e){const n=Ae(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(h,f,m,x){const _=m.batch,I=_.keys();let R=te.resolve();return I.forEach(B=>{R=R.next(()=>x.getEntry(f,B)).next(D=>{const G=m.docVersions.get(B);De(G!==null),D.version.compareTo(G)<0&&(_.applyToRemoteDocument(D,m),D.isValidDocument()&&(D.setReadTime(m.commitVersion),x.addEntry(D)))})}),R.next(()=>h.mutationQueue.removeMutationBatch(f,_))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let f=tt();for(let m=0;m<h.mutationResults.length;++m)h.mutationResults[m].transformResults.length>0&&(f=f.add(h.batch.mutations[m].key));return f}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function rb(t){const e=Ae(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function fM(t,e){const n=Ae(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const l=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const h=[];e.targetChanges.forEach((x,_)=>{const I=i.get(_);if(!I)return;h.push(n.Ur.removeMatchingKeys(s,x.removedDocuments,_).next(()=>n.Ur.addMatchingKeys(s,x.addedDocuments,_)));let R=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(_)!==null?R=R.withResumeToken(In.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):x.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(x.resumeToken,r)),i=i.insert(_,R),function(D,G,F){return D.resumeToken.approximateByteSize()===0||G.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0}(I,R,x)&&h.push(n.Ur.updateTargetData(s,R))});let f=Kr(),m=tt();if(e.documentUpdates.forEach(x=>{e.resolvedLimboDocuments.has(x)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(s,x))}),h.push(ib(s,l,e.documentUpdates).next(x=>{f=x.Ps,m=x.Is})),!r.isEqual(Ve.min())){const x=n.Ur.getLastRemoteSnapshotVersion(s).next(_=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));h.push(x)}return te.waitFor(h).next(()=>l.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,f,m)).next(()=>f)}).then(s=>(n.os=i,s))}function ib(t,e,n){let r=tt(),i=tt();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let l=Kr();return n.forEach((h,f)=>{const m=s.get(h);f.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(Ve.min())?(e.removeEntry(h,f.readTime),l=l.insert(h,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),l=l.insert(h,f)):fe("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",f.version)}),{Ps:l,Is:i}})}function gM(t,e){const n=Ae(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function lu(t,e){const n=Ae(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,te.resolve(i)):n.Ur.allocateTargetId(r).next(l=>(i=new to(e,l,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function cu(t,e,n){const r=Ae(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,l=>r.persistence.referenceDelegate.removeTarget(l,i))}catch(l){if(!Na(l))throw l;fe("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function c1(t,e,n){const r=Ae(t);let i=Ve.min(),s=tt();return r.persistence.runTransaction("Execute query","readwrite",l=>function(f,m,x){const _=Ae(f),I=_._s.get(x);return I!==void 0?te.resolve(_.os.get(I)):_.Ur.getTargetData(m,x)}(r,l,Ar(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(l,h.targetId).next(f=>{s=f})}).next(()=>r.ss.getDocumentsMatchingQuery(l,e,n?i:Ve.min(),n?s:tt())).next(h=>(ab(r,hS(e),h),{documents:h,Ts:s})))}function sb(t,e){const n=Ae(t),r=Ae(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(l=>l?l.target:null))}function ob(t,e){const n=Ae(t),r=n.us.get(e)||Ve.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,VC(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(ab(n,e,i),i))}function ab(t,e,n){let r=t.us.get(e)||Ve.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}async function mM(t,e,n,r){const i=Ae(t);let s=tt(),l=Kr();for(const m of n){const x=e.Es(m.metadata.name);m.document&&(s=s.add(x));const _=e.ds(m);_.setReadTime(e.As(m.metadata.readTime)),l=l.insert(x,_)}const h=i.cs.newChangeBuffer({trackRemovals:!0}),f=await lu(i,function(x){return Ar(Su(ht.fromString(`__bundle__/docs/${x}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",m=>ib(m,h,l).next(x=>(h.apply(m),x)).next(x=>i.Ur.removeMatchingKeysForTargetId(m,f.targetId).next(()=>i.Ur.addMatchingKeys(m,s,f.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(m,x.Ps,x.Is)).next(()=>x.Ps)))}async function pM(t,e,n=tt()){const r=await lu(t,Ar(Gw(e.bundledQuery))),i=Ae(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const l=Pn(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Gr.saveNamedQuery(s,e);const h=r.withResumeToken(In.EMPTY_BYTE_STRING,l);return i.os=i.os.insert(h.targetId,h),i.Ur.updateTargetData(s,h).next(()=>i.Ur.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Ur.addMatchingKeys(s,n,r.targetId)).next(()=>i.Gr.saveNamedQuery(s,e))})}function OE(t,e){return`firestore_clients_${t}_${e}`}function ME(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function mm(t,e){return`firestore_targets_${t}_${e}`}class u1{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let s,l=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return l&&i.error&&(l=typeof i.error.message=="string"&&typeof i.error.code=="string",l&&(s=new ge(i.error.code,i.error.message))),l?new u1(e,n,i.state,s):(Rn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Mh{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new ge(r.error.code,r.error.message))),s?new Mh(e,r.state,i):(Rn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class h1{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Mw();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=GC(r.activeTargetIds[l]),s=s.add(r.activeTargetIds[l]);return i?new h1(e,s):(Rn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Yw{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Yw(n.clientId,n.onlineState):(Rn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ey{constructor(){this.activeTargetIds=Mw()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pm{constructor(e,n,r,i,s){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Kt(Ke),this.started=!1,this.bs=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=OE(this.persistenceKey,this.ps),this.vs=function(f){return`firestore_sequence_number_${f}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ey),this.Cs=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.xs=function(f){return`firestore_online_state_${f}`}(this.persistenceKey),this.Os=function(f){return`firestore_bundle_loaded_v2_${f}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(OE(this.persistenceKey,r));if(i){const s=h1.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(mm(this.persistenceKey,e));if(i){const s=Mh.Rs(e,i);s&&(r=s.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(mm(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return fe("SharedClientState","READ",e,n),n}setItem(e,n){fe("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){fe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(fe("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void Rn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(s){let l=Wr.oe;if(s!=null)try{const h=JSON.parse(s);De(typeof h=="number"),l=h}catch(h){Rn("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(n.newValue);r!==Wr.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new u1(this.currentUser,e,n,r),s=ME(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const n=ME(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=mm(this.persistenceKey,e),s=new Mh(e,n,r);this.setItem(i,s.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return h1.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return u1.Rs(new er(s),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return Mh.Rs(i,n)}Ls(e){return Yw.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);fe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),l=[],h=[];return s.forEach(f=>{i.has(f)||l.push(f)}),i.forEach(f=>{s.has(f)||h.push(f)}),this.syncEngine.io(l,h).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=Mw();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class lb{constructor(){this.so=new ey,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ey,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){fe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){fe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zf=null;function ym(){return zf===null?zf=function(){return 268435456+Math.round(2147483648*Math.random())}():zf++,"0x"+zf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr="WebChannelConnection";class _M extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,l){const h=ym(),f=this.xo(n,r.toUriEncodedString());fe("RestConnection",`Sending RPC '${n}' ${h}:`,f,i);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,s,l),this.No(n,f,m,i).then(x=>(fe("RestConnection",`Received RPC '${n}' ${h}: `,x),x),x=>{throw Ci("RestConnection",`RPC '${n}' ${h} failed with error: `,x,"url: ",f,"request:",i),x})}Lo(n,r,i,s,l,h){return this.Mo(n,r,i,s,l)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Cu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,l)=>n[l]=s),i&&i.headers.forEach((s,l)=>n[l]=s)}xo(n,r){const i=wM[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=ym();return new Promise((l,h)=>{const f=new RC;f.setWithCredentials(!0),f.listenOnce(NC.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case u0.NO_ERROR:const x=f.getResponseJson();fe(xr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(x)),l(x);break;case u0.TIMEOUT:fe(xr,`RPC '${e}' ${s} timed out`),h(new ge(ae.DEADLINE_EXCEEDED,"Request time out"));break;case u0.HTTP_ERROR:const _=f.getStatus();if(fe(xr,`RPC '${e}' ${s} failed with status:`,_,"response text:",f.getResponseText()),_>0){let I=f.getResponseJson();Array.isArray(I)&&(I=I[0]);const R=I==null?void 0:I.error;if(R&&R.status&&R.message){const B=function(G){const F=G.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(F)>=0?F:ae.UNKNOWN}(R.status);h(new ge(B,R.message))}else h(new ge(ae.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new ge(ae.UNAVAILABLE,"Connection failed."));break;default:Re()}}finally{fe(xr,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(i);fe(xr,`RPC '${e}' ${s} sending request:`,i),f.send(n,"POST",m,r,15)})}Bo(e,n,r){const i=ym(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=kC(),h=DC(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Oo(f.initMessageHeaders,n,r),f.encodeInitMessageHeaders=!0;const x=s.join("");fe(xr,`Creating RPC '${e}' stream ${i}: ${x}`,f);const _=l.createWebChannel(x,f);let I=!1,R=!1;const B=new xM({Io:G=>{R?fe(xr,`Not sending because RPC '${e}' stream ${i} is closed:`,G):(I||(fe(xr,`Opening RPC '${e}' stream ${i} transport.`),_.open(),I=!0),fe(xr,`RPC '${e}' stream ${i} sending:`,G),_.send(G))},To:()=>_.close()}),D=(G,F,P)=>{G.listen(F,N=>{try{P(N)}catch(H){setTimeout(()=>{throw H},0)}})};return D(_,yh.EventType.OPEN,()=>{R||(fe(xr,`RPC '${e}' stream ${i} transport opened.`),B.yo())}),D(_,yh.EventType.CLOSE,()=>{R||(R=!0,fe(xr,`RPC '${e}' stream ${i} transport closed`),B.So())}),D(_,yh.EventType.ERROR,G=>{R||(R=!0,Ci(xr,`RPC '${e}' stream ${i} transport errored:`,G),B.So(new ge(ae.UNAVAILABLE,"The operation could not be completed")))}),D(_,yh.EventType.MESSAGE,G=>{var F;if(!R){const P=G.data[0];De(!!P);const N=P,H=N.error||((F=N[0])===null||F===void 0?void 0:F.error);if(H){fe(xr,`RPC '${e}' stream ${i} received error:`,H);const Y=H.status;let J=function(L){const W=Mn[L];if(W!==void 0)return CS(W)}(Y),k=H.message;J===void 0&&(J=ae.INTERNAL,k="Unknown error status: "+Y+" with message "+H.message),R=!0,B.So(new ge(J,k)),_.close()}else fe(xr,`RPC '${e}' stream ${i} received:`,P),B.bo(P)}}),D(h,PC.STAT_EVENT,G=>{G.stat===Vp.PROXY?fe(xr,`RPC '${e}' stream ${i} detected buffering proxy`):G.stat===Vp.NOPROXY&&fe(xr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{B.wo()},0),B}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(){return typeof window<"u"?window:null}function y0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(t){return new b5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,n,r,i,s,l,h,f){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Zw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===ae.RESOURCE_EXHAUSTED?(Rn(n.toString()),Rn("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ge(ae.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return fe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(fe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class EM extends ub{constructor(e,n,r,i,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,l),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=P5(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ve.min();const l=s.targetChange;return l.targetIds&&l.targetIds.length?Ve.min():l.readTime?Pn(l.readTime):Ve.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Qp(this.serializer),n.addTarget=function(s,l){let h;const f=l.target;if(h=t1(f)?{documents:LS(s,f)}:{query:ng(s,f)._t},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=NS(s,l.resumeToken);const m=Kp(s,l.expectedCount);m!==null&&(h.expectedCount=m)}else if(l.snapshotVersion.compareTo(Ve.min())>0){h.readTime=au(s,l.snapshotVersion.toTimestamp());const m=Kp(s,l.expectedCount);m!==null&&(h.expectedCount=m)}return h}(this.serializer,e);const r=k5(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Qp(this.serializer),n.removeTarget=e,this.a_(n)}}class vM extends ub{constructor(e,n,r,i,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,l),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return De(!!e.streamToken),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){De(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=D5(e.writeResults,e.commitTime),r=Pn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Qp(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>md(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ge(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Mo(e,$p(n,r),i,s,l)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ge(ae.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Lo(e,$p(n,r),i,l,h,s)).catch(l=>{throw l.name==="FirebaseError"?(l.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ge(ae.UNKNOWN,l.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class AM{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Rn(n),this.D_=!1):fe("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(l=>{r.enqueueAndForget(async()=>{Da(this)&&(fe("RemoteStore","Restarting streams for network reachability change."),await async function(f){const m=Ae(f);m.L_.add(4),await Nu(m),m.q_.set("Unknown"),m.L_.delete(4),await Wd(m)}(this))})}),this.q_=new AM(r,i)}}async function Wd(t){if(Da(t))for(const e of t.B_)await e(!0)}async function Nu(t){for(const e of t.B_)await e(!1)}function og(t,e){const n=Ae(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),tx(n)?ex(n):Du(n).r_()&&Jw(n,e))}function uu(t,e){const n=Ae(t),r=Du(n);n.N_.delete(e),r.r_()&&hb(n,e),n.N_.size===0&&(r.r_()?r.o_():Da(n)&&n.q_.set("Unknown"))}function Jw(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Du(t).A_(e)}function hb(t,e){t.Q_.xe(e),Du(t).R_(e)}function ex(t){t.Q_=new A5({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Du(t).start(),t.q_.v_()}function tx(t){return Da(t)&&!Du(t).n_()&&t.N_.size>0}function Da(t){return Ae(t).L_.size===0}function db(t){t.Q_=void 0}async function CM(t){t.q_.set("Online")}async function SM(t){t.N_.forEach((e,n)=>{Jw(t,e)})}async function bM(t,e){db(t),tx(t)?(t.q_.M_(e),ex(t)):t.q_.set("Unknown")}async function RM(t,e,n){if(t.q_.set("Online"),e instanceof RS&&e.state===2&&e.cause)try{await async function(i,s){const l=s.cause;for(const h of s.targetIds)i.N_.has(h)&&(await i.remoteSyncer.rejectListen(h,l),i.N_.delete(h),i.Q_.removeTarget(h))}(t,e)}catch(r){fe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await d1(t,r)}else if(e instanceof p0?t.Q_.Ke(e):e instanceof bS?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Ve.min()))try{const r=await rb(t.localStore);n.compareTo(r)>=0&&await function(s,l){const h=s.Q_.rt(l);return h.targetChanges.forEach((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const x=s.N_.get(m);x&&s.N_.set(m,x.withResumeToken(f.resumeToken,l))}}),h.targetMismatches.forEach((f,m)=>{const x=s.N_.get(f);if(!x)return;s.N_.set(f,x.withResumeToken(In.EMPTY_BYTE_STRING,x.snapshotVersion)),hb(s,f);const _=new to(x.target,f,m,x.sequenceNumber);Jw(s,_)}),s.remoteSyncer.applyRemoteEvent(h)}(t,n)}catch(r){fe("RemoteStore","Failed to raise snapshot:",r),await d1(t,r)}}async function d1(t,e,n){if(!Na(e))throw e;t.L_.add(1),await Nu(t),t.q_.set("Offline"),n||(n=()=>rb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{fe("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Wd(t)})}function fb(t,e){return e().catch(n=>d1(t,n,e))}async function Pu(t){const e=Ae(t),n=_a(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;NM(e);)try{const i=await gM(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,PM(e,i)}catch(i){await d1(e,i)}gb(e)&&mb(e)}function NM(t){return Da(t)&&t.O_.length<10}function PM(t,e){t.O_.push(e);const n=_a(t);n.r_()&&n.V_&&n.m_(e.mutations)}function gb(t){return Da(t)&&!_a(t).n_()&&t.O_.length>0}function mb(t){_a(t).start()}async function DM(t){_a(t).p_()}async function kM(t){const e=_a(t);for(const n of t.O_)e.m_(n.mutations)}async function OM(t,e,n){const r=t.O_.shift(),i=Bw.from(r,e,n);await fb(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Pu(t)}async function MM(t,e){e&&_a(t).V_&&await async function(r,i){if(function(l){return TS(l)&&l!==ae.ABORTED}(i.code)){const s=r.O_.shift();_a(r).s_(),await fb(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Pu(r)}}(t,e),gb(t)&&mb(t)}async function FE(t,e){const n=Ae(t);n.asyncQueue.verifyOperationInProgress(),fe("RemoteStore","RemoteStore received new credentials");const r=Da(n);n.L_.add(3),await Nu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Wd(n)}async function ty(t,e){const n=Ae(t);e?(n.L_.delete(2),await Wd(n)):e||(n.L_.add(2),await Nu(n),n.q_.set("Unknown"))}function Du(t){return t.K_||(t.K_=function(n,r,i){const s=Ae(n);return s.w_(),new EM(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:CM.bind(null,t),Ro:SM.bind(null,t),mo:bM.bind(null,t),d_:RM.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),tx(t)?ex(t):t.q_.set("Unknown")):(await t.K_.stop(),db(t))})),t.K_}function _a(t){return t.U_||(t.U_=function(n,r,i){const s=Ae(n);return s.w_(),new vM(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:DM.bind(null,t),mo:MM.bind(null,t),f_:kM.bind(null,t),g_:OM.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Pu(t)):(await t.U_.stop(),t.O_.length>0&&(fe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new nr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const l=Date.now()+r,h=new nx(e,n,l,i,s);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ku(t,e){if(Rn("AsyncQueue",`${e}: ${t}`),Na(t))return new ge(ae.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Te.comparator(n.key,r.key):(n,r)=>Te.comparator(n.key,r.key),this.keyedMap=wh(),this.sortedSet=new Kt(this.comparator)}static emptySet(e){return new Vc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Vc)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Vc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.W_=new Kt(Te.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Re():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class hu{constructor(e,n,r,i,s,l,h,f,m){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,n,r,i,s){const l=[];return n.forEach(h=>{l.push({type:0,doc:h})}),new hu(e,n,Vc.emptySet(n),l,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Bd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class FM{constructor(){this.queries=BE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=Ae(n),s=i.queries;i.queries=BE(),s.forEach((l,h)=>{for(const f of h.j_)f.onError(r)})})(this,new ge(ae.ABORTED,"Firestore shutting down"))}}function BE(){return new yo(t=>uS(t),Bd)}async function rx(t,e){const n=Ae(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new LM,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(l){const h=ku(l,`Initialization of query '${uc(e.query)}' failed`);return void e.onError(h)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&sx(n)}async function ix(t,e){const n=Ae(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const l=s.j_.indexOf(e);l>=0&&(s.j_.splice(l,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function VM(t,e){const n=Ae(t);let r=!1;for(const i of e){const s=i.query,l=n.queries.get(s);if(l){for(const h of l.j_)h.X_(i)&&(r=!0);l.z_=i}}r&&sx(n)}function BM(t,e,n){const r=Ae(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function sx(t){t.Y_.forEach(e=>{e.next()})}var ny,UE;(UE=ny||(ny={})).ea="default",UE.Cache="cache";class ox{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new hu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=hu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ny.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(e,n){this.aa=e,this.byteLength=n}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e){this.serializer=e}Es(e){return Cs(this.serializer,e)}ds(e){return e.metadata.exists?MS(this.serializer,e.document,!1):Yt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Pn(e)}}class jM{constructor(e,n,r){this.ca=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=pb(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++n;const r=ht.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ha(e){const n=new Map,r=new jE(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Es(i.metadata.name);for(const l of i.metadata.queries){const h=(n.get(l)||tt()).add(s);n.set(l,h)}}return n}async complete(){const e=await mM(this.localStore,new jE(this.serializer),this.documents,this.ca.id),n=this.ha(this.documents);for(const r of this.queries)await pM(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function pb(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e){this.key=e}}class wb{constructor(e){this.key=e}}class xb{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=tt(),this.mutatedKeys=tt(),this.Aa=dS(e),this.Ra=new Vc(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new VE,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,l=i,h=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,m=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((x,_)=>{const I=i.get(x),R=Ud(this.query,_)?_:null,B=!!I&&this.mutatedKeys.has(I.key),D=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let G=!1;I&&R?I.data.isEqual(R.data)?B!==D&&(r.track({type:3,doc:R}),G=!0):this.ga(I,R)||(r.track({type:2,doc:R}),G=!0,(f&&this.Aa(R,f)>0||m&&this.Aa(R,m)<0)&&(h=!0)):!I&&R?(r.track({type:0,doc:R}),G=!0):I&&!R&&(r.track({type:1,doc:I}),G=!0,(f||m)&&(h=!0)),G&&(R?(l=l.add(R),s=D?s.add(x):s.delete(x)):(l=l.delete(x),s=s.delete(x)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const x=this.query.limitType==="F"?l.last():l.first();l=l.delete(x.key),s=s.delete(x.key),r.track({type:1,doc:x})}return{Ra:l,fa:r,ns:h,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const l=e.fa.G_();l.sort((x,_)=>function(R,B){const D=G=>{switch(G){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re()}};return D(R)-D(B)}(x.type,_.type)||this.Aa(x.doc,_.doc)),this.pa(r),i=i!=null&&i;const h=n&&!i?this.ya():[],f=this.da.size===0&&this.current&&!i?1:0,m=f!==this.Ea;return this.Ea=f,l.length!==0||m?{snapshot:new hu(this.query,e.Ra,s,l,e.mutatedKeys,f===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new VE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=tt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new wb(r))}),this.da.forEach(r=>{e.has(r)||n.push(new yb(r))}),n}ba(e){this.Ta=e.Ts,this.da=tt();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return hu.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class zM{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class GM{constructor(e){this.key=e,this.va=!1}}class HM{constructor(e,n,r,i,s,l){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Ca={},this.Fa=new yo(h=>uS(h),Bd),this.Ma=new Map,this.xa=new Set,this.Oa=new Kt(Te.comparator),this.Na=new Map,this.La=new qw,this.Ba={},this.ka=new Map,this.qa=Pl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function WM(t,e,n=!0){const r=ag(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await _b(r,e,n,!0),i}async function qM(t,e){const n=ag(t);await _b(n,e,!0,!1)}async function _b(t,e,n,r){const i=await lu(t.localStore,Ar(e)),s=i.targetId,l=t.sharedClientState.addLocalQueryTarget(s,n);let h;return r&&(h=await ax(t,e,s,l==="current",i.resumeToken)),t.isPrimaryClient&&n&&og(t.remoteStore,i),h}async function ax(t,e,n,r,i){t.Ka=(_,I,R)=>async function(D,G,F,P){let N=G.view.ma(F);N.ns&&(N=await c1(D.localStore,G.query,!1).then(({documents:k})=>G.view.ma(k,N)));const H=P&&P.targetChanges.get(G.targetId),Y=P&&P.targetMismatches.get(G.targetId)!=null,J=G.view.applyChanges(N,D.isPrimaryClient,H,Y);return ry(D,G.targetId,J.wa),J.snapshot}(t,_,I,R);const s=await c1(t.localStore,e,!0),l=new xb(e,s.Ts),h=l.ma(s.documents),f=Gd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),m=l.applyChanges(h,t.isPrimaryClient,f);ry(t,n,m.wa);const x=new zM(e,n,l);return t.Fa.set(e,x),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),m.snapshot}async function KM(t,e,n){const r=Ae(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(l=>!Bd(l,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await cu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&uu(r.remoteStore,i.targetId),du(r,i.targetId)}).catch(Ra)):(du(r,i.targetId),await cu(r.localStore,i.targetId,!0))}async function $M(t,e){const n=Ae(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),uu(n.remoteStore,r.targetId))}async function QM(t,e,n){const r=hx(t);try{const i=await function(l,h){const f=Ae(l),m=dn.now(),x=h.reduce((R,B)=>R.add(B.key),tt());let _,I;return f.persistence.runTransaction("Locally write mutations","readwrite",R=>{let B=Kr(),D=tt();return f.cs.getEntries(R,x).next(G=>{B=G,B.forEach((F,P)=>{P.isValidDocument()||(D=D.add(F))})}).next(()=>f.localDocuments.getOverlayedDocuments(R,B)).next(G=>{_=G;const F=[];for(const P of h){const N=E5(P,_.get(P.key).overlayedDocument);N!=null&&F.push(new wo(P.key,N,JC(N.value.mapValue),sn.exists(!0)))}return f.mutationQueue.addMutationBatch(R,m,F,h)}).next(G=>{I=G;const F=G.applyToLocalDocumentSet(_,D);return f.documentOverlayCache.saveOverlays(R,G.batchId,F)})}).then(()=>({batchId:I.batchId,changes:gS(_)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(l,h,f){let m=l.Ba[l.currentUser.toKey()];m||(m=new Kt(Ke)),m=m.insert(h,f),l.Ba[l.currentUser.toKey()]=m}(r,i.batchId,n),await xo(r,i.changes),await Pu(r.remoteStore)}catch(i){const s=ku(i,"Failed to persist write");n.reject(s)}}async function Eb(t,e){const n=Ae(t);try{const r=await fM(n.localStore,e);e.targetChanges.forEach((i,s)=>{const l=n.Na.get(s);l&&(De(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.va=!0:i.modifiedDocuments.size>0?De(l.va):i.removedDocuments.size>0&&(De(l.va),l.va=!1))}),await xo(n,r,e)}catch(r){await Ra(r)}}function zE(t,e,n){const r=Ae(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,l)=>{const h=l.view.Z_(e);h.snapshot&&i.push(h.snapshot)}),function(l,h){const f=Ae(l);f.onlineState=h;let m=!1;f.queries.forEach((x,_)=>{for(const I of _.j_)I.Z_(h)&&(m=!0)}),m&&sx(f)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function XM(t,e,n){const r=Ae(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let l=new Kt(Te.comparator);l=l.insert(s,Yt.newNoDocument(s,Ve.min()));const h=tt().add(s),f=new zd(Ve.min(),new Map,new Kt(Ke),l,h);await Eb(r,f),r.Oa=r.Oa.remove(s),r.Na.delete(e),ux(r)}else await cu(r.localStore,e,!1).then(()=>du(r,e,n)).catch(Ra)}async function YM(t,e){const n=Ae(t),r=e.batch.batchId;try{const i=await dM(n.localStore,e);cx(n,r,null),lx(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await xo(n,i)}catch(i){await Ra(i)}}async function ZM(t,e,n){const r=Ae(t);try{const i=await function(l,h){const f=Ae(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let x;return f.mutationQueue.lookupMutationBatch(m,h).next(_=>(De(_!==null),x=_.keys(),f.mutationQueue.removeMutationBatch(m,_))).next(()=>f.mutationQueue.performConsistencyCheck(m)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(m,x,h)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,x)).next(()=>f.localDocuments.getDocuments(m,x))})}(r.localStore,e);cx(r,e,n),lx(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await xo(r,i)}catch(i){await Ra(i)}}async function JM(t,e){const n=Ae(t);Da(n.remoteStore)||fe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(l){const h=Ae(l);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",f=>h.mutationQueue.getHighestUnacknowledgedBatchId(f))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ka.get(r)||[];i.push(e),n.ka.set(r,i)}catch(r){const i=ku(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function lx(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function cx(t,e,n){const r=Ae(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function du(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||vb(t,r)})}function vb(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(uu(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),ux(t))}function ry(t,e,n){for(const r of n)r instanceof yb?(t.La.addReference(r.key,e),e9(t,r)):r instanceof wb?(fe("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||vb(t,r.key)):Re()}function e9(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(fe("SyncEngine","New document in limbo: "+n),t.xa.add(r),ux(t))}function ux(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Te(ht.fromString(e)),r=t.qa.next();t.Na.set(r,new GM(n)),t.Oa=t.Oa.insert(n,r),og(t.remoteStore,new to(Ar(Su(n.path)),r,"TargetPurposeLimboResolution",Wr.oe))}}async function xo(t,e,n){const r=Ae(t),i=[],s=[],l=[];r.Fa.isEmpty()||(r.Fa.forEach((h,f)=>{l.push(r.Ka(f,e,n).then(m=>{var x;if((m||n)&&r.isPrimaryClient){const _=m?!m.fromCache:(x=n==null?void 0:n.targetChanges.get(f.targetId))===null||x===void 0?void 0:x.current;r.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(m){i.push(m);const _=Xw.Wi(f.targetId,m);s.push(_)}}))}),await Promise.all(l),r.Ca.d_(i),await async function(f,m){const x=Ae(f);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>te.forEach(m,I=>te.forEach(I.$i,R=>x.persistence.referenceDelegate.addReference(_,I.targetId,R)).next(()=>te.forEach(I.Ui,R=>x.persistence.referenceDelegate.removeReference(_,I.targetId,R)))))}catch(_){if(!Na(_))throw _;fe("LocalStore","Failed to update sequence numbers: "+_)}for(const _ of m){const I=_.targetId;if(!_.fromCache){const R=x.os.get(I),B=R.snapshotVersion,D=R.withLastLimboFreeSnapshotVersion(B);x.os=x.os.insert(I,D)}}}(r.localStore,s))}async function t9(t,e){const n=Ae(t);if(!n.currentUser.isEqual(e)){fe("SyncEngine","User change. New user:",e.toKey());const r=await nb(n.localStore,e);n.currentUser=e,function(s,l){s.ka.forEach(h=>{h.forEach(f=>{f.reject(new ge(ae.CANCELLED,l))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await xo(n,r.hs)}}function n9(t,e){const n=Ae(t),r=n.Na.get(e);if(r&&r.va)return tt().add(r.key);{let i=tt();const s=n.Ma.get(e);if(!s)return i;for(const l of s){const h=n.Fa.get(l);i=i.unionWith(h.view.Va)}return i}}async function r9(t,e){const n=Ae(t),r=await c1(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&ry(n,e.targetId,i.wa),i}async function i9(t,e){const n=Ae(t);return ob(n.localStore,e).then(r=>xo(n,r))}async function s9(t,e,n,r){const i=Ae(t),s=await function(h,f){const m=Ae(h),x=Ae(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",_=>x.Mn(_,f).next(I=>I?m.localDocuments.getDocuments(_,I):te.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Pu(i.remoteStore):n==="acknowledged"||n==="rejected"?(cx(i,e,r||null),lx(i,e),function(h,f){Ae(Ae(h).mutationQueue).On(f)}(i.localStore,e)):Re(),await xo(i,s)):fe("SyncEngine","Cannot apply mutation batch with id: "+e)}async function o9(t,e){const n=Ae(t);if(ag(n),hx(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await GE(n,r.toArray());n.Qa=!0,await ty(n.remoteStore,!0);for(const s of i)og(n.remoteStore,s)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((s,l)=>{n.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(du(n,l),cu(n.localStore,l,!0))),uu(n.remoteStore,l)}),await i,await GE(n,r),function(l){const h=Ae(l);h.Na.forEach((f,m)=>{uu(h.remoteStore,m)}),h.La.pr(),h.Na=new Map,h.Oa=new Kt(Te.comparator)}(n),n.Qa=!1,await ty(n.remoteStore,!1)}}async function GE(t,e,n){const r=Ae(t),i=[],s=[];for(const l of e){let h;const f=r.Ma.get(l);if(f&&f.length!==0){h=await lu(r.localStore,Ar(f[0]));for(const m of f){const x=r.Fa.get(m),_=await r9(r,x);_.snapshot&&s.push(_.snapshot)}}else{const m=await sb(r.localStore,l);h=await lu(r.localStore,m),await ax(r,Ib(m),l,!1,h.resumeToken)}i.push(h)}return r.Ca.d_(s),i}function Ib(t){return aS(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function a9(t){return function(n){return Ae(Ae(n).persistence).Qi()}(Ae(t).localStore)}async function l9(t,e,n,r){const i=Ae(t);if(i.Qa)return void fe("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const l=await ob(i.localStore,hS(s[0])),h=zd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",In.EMPTY_BYTE_STRING);await xo(i,l,h);break}case"rejected":await cu(i.localStore,e,!0),du(i,e,r);break;default:Re()}}async function c9(t,e,n){const r=ag(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){fe("SyncEngine","Adding an already active target "+i);continue}const s=await sb(r.localStore,i),l=await lu(r.localStore,s);await ax(r,Ib(s),l.targetId,!1,l.resumeToken),og(r.remoteStore,l)}for(const i of n)r.Ma.has(i)&&await cu(r.localStore,i,!1).then(()=>{uu(r.remoteStore,i),du(r,i)}).catch(Ra)}}function ag(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Eb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=n9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XM.bind(null,e),e.Ca.d_=VM.bind(null,e.eventManager),e.Ca.$a=BM.bind(null,e.eventManager),e}function hx(t){const e=Ae(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=YM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ZM.bind(null,e),e}function u9(t,e,n){const r=Ae(t);(async function(s,l,h){try{const f=await l.getMetadata();if(await function(R,B){const D=Ae(R),G=Pn(B.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",F=>D.Gr.getBundleMetadata(F,B.id)).then(F=>!!F&&F.createTime.compareTo(G)>=0)}(s.localStore,f))return await l.close(),h._completeWith(function(R){return{taskState:"Success",documentsLoaded:R.totalDocuments,bytesLoaded:R.totalBytes,totalDocuments:R.totalDocuments,totalBytes:R.totalBytes}}(f)),Promise.resolve(new Set);h._updateProgress(pb(f));const m=new jM(f,s.localStore,l.serializer);let x=await l.Ua();for(;x;){const I=await m.la(x);I&&h._updateProgress(I),x=await l.Ua()}const _=await m.complete();return await xo(s,_.Ia,void 0),await function(R,B){const D=Ae(R);return D.persistence.runTransaction("Save bundle","readwrite",G=>D.Gr.saveBundleMetadata(G,B))}(s.localStore,f),h._completeWith(_.progress),Promise.resolve(_.Pa)}catch(f){return Ci("SyncEngine",`Loading bundle failed with ${f}`),h._failWith(f),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Ea{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return tb(this.persistence,new eb,e.initialUser,this.serializer)}Ga(e){return new Kw(sg.Zr,this.serializer)}Wa(e){return new lb}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ea.provider={build:()=>new Ea};class h9 extends Ea{constructor(e){super(),this.cacheSizeBytes=e}ja(e,n){De(this.persistence.referenceDelegate instanceof l1);const r=this.persistence.referenceDelegate.garbageCollector;return new QS(r,e.asyncQueue,n)}Ga(e){const n=this.cacheSizeBytes!==void 0?Er.withCacheSize(this.cacheSizeBytes):Er.DEFAULT;return new Kw(r=>l1.Zr(r,n),this.serializer)}}class dx extends Ea{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await hx(this.Ja.syncEngine),await Pu(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return tb(this.persistence,new eb,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new QS(r,e.asyncQueue,n)}Ha(e,n){const r=new kO(n,this.persistence);return new DO(e.asyncQueue,r)}Ga(e){const n=Qw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Er.withCacheSize(this.cacheSizeBytes):Er.DEFAULT;return new $w(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,cb(),y0(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new lb}}class Ab extends dx{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof pm&&(this.sharedClientState.syncEngine={no:s9.bind(null,n),ro:l9.bind(null,n),io:c9.bind(null,n),Qi:a9.bind(null,n),eo:i9.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await o9(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=cb();if(!pm.D(n))throw new ge(ae.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Qw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class va{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=t9.bind(null,this.syncEngine),await ty(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new FM}()}createDatastore(e){const n=Hd(e.databaseInfo.databaseId),r=function(s){return new _M(s)}(e.databaseInfo);return function(s,l,h,f){return new IM(s,l,h,f)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,l,h){return new TM(r,i,s,l,h)}(this.localStore,this.datastore,e.asyncQueue,n=>zE(this.syncEngine,n,0),function(){return LE.D()?new LE:new yM}())}createSyncEngine(e,n){return function(i,s,l,h,f,m,x){const _=new HM(i,s,l,h,f,m);return x&&(_.Qa=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ae(i);fe("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Nu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}va.provider={build:()=>new va};function HE(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Rn("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e,n){this.Xa=e,this.serializer=n,this.metadata=new nr,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const n=this.eu.decode(e),r=Number(n);isNaN(r)&&this.ru(`length string (${n}) is not valid number`);const i=await this.iu(r);return new UM(JSON.parse(i),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const n=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ge(ae.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const l=Ae(i),h={documents:s.map(_=>gd(l.serializer,_))},f=await l.Lo("BatchGetDocuments",l.serializer.databaseId,ht.emptyPath(),h,s.length),m=new Map;f.forEach(_=>{const I=N5(l.serializer,_);m.set(I.key.toString(),I)});const x=[];return s.forEach(_=>{const I=m.get(_.toString());De(!!I),x.push(I)}),x}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ru(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=Te.fromPath(r);this.mutations.push(new Fw(i,this.precondition(i)))}),await async function(r,i){const s=Ae(r),l={writes:i.map(h=>md(s.serializer,h))};await s.Mo("Commit",s.serializer.databaseId,ht.emptyPath(),l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Re();n=Ve.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new ge(ae.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Ve.min())?sn.exists(!1):sn.updateTime(n):sn.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Ve.min()))throw new ge(ae.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return sn.updateTime(n)}return sn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new Zw(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new f9(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!Fd(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!TS(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m9{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=er.UNAUTHENTICATED,this.clientId=LC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async l=>{fe("FirestoreClient","Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(r,l=>(fe("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new nr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ku(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function wm(t,e){t.asyncQueue.verifyOperationInProgress(),fe("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await nb(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function WE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fx(t);fe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>FE(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>FE(e.remoteStore,i)),t._onlineComponents=e}async function fx(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){fe("FirestoreClient","Using user provided OfflineComponentProvider");try{await wm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===ae.FAILED_PRECONDITION||i.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Ci("Error using user provided cache. Falling back to memory cache: "+n),await wm(t,new Ea)}}else fe("FirestoreClient","Using default OfflineComponentProvider"),await wm(t,new Ea);return t._offlineComponents}async function cg(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(fe("FirestoreClient","Using user provided OnlineComponentProvider"),await WE(t,t._uninitializedComponentsProvider._online)):(fe("FirestoreClient","Using default OnlineComponentProvider"),await WE(t,new va))),t._onlineComponents}function Tb(t){return fx(t).then(e=>e.persistence)}function Ou(t){return fx(t).then(e=>e.localStore)}function Cb(t){return cg(t).then(e=>e.remoteStore)}function gx(t){return cg(t).then(e=>e.syncEngine)}function Sb(t){return cg(t).then(e=>e.datastore)}async function fu(t){const e=await cg(t),n=e.eventManager;return n.onListen=WM.bind(null,e.syncEngine),n.onUnlisten=KM.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=qM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=$M.bind(null,e.syncEngine),n}function p9(t){return t.asyncQueue.enqueue(async()=>{const e=await Tb(t),n=await Cb(t);return e.setNetworkEnabled(!0),function(i){const s=Ae(i);return s.L_.delete(0),Wd(s)}(n)})}function y9(t){return t.asyncQueue.enqueue(async()=>{const e=await Tb(t),n=await Cb(t);return e.setNetworkEnabled(!1),async function(i){const s=Ae(i);s.L_.add(0),await Nu(s),s.q_.set("Offline")}(n)})}function w9(t,e){const n=new nr;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,l){try{const h=await function(m,x){const _=Ae(m);return _.persistence.runTransaction("read document","readonly",I=>_.localDocuments.getDocument(I,x))}(i,s);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new ge(ae.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const f=ku(h,`Failed to get document '${s} from cache`);l.reject(f)}}(await Ou(t),e,n)),n.promise}function bb(t,e,n={}){const r=new nr;return t.asyncQueue.enqueueAndForget(async()=>function(s,l,h,f,m){const x=new lg({next:I=>{x.Za(),l.enqueueAndForget(()=>ix(s,_));const R=I.docs.has(h);!R&&I.fromCache?m.reject(new ge(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&I.fromCache&&f&&f.source==="server"?m.reject(new ge(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(I)},error:I=>m.reject(I)}),_=new ox(Su(h.path),x,{includeMetadataChanges:!0,_a:!0});return rx(s,_)}(await fu(t),t.asyncQueue,e,n,r)),r.promise}function x9(t,e){const n=new nr;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,l){try{const h=await c1(i,s,!0),f=new xb(s,h.Ts),m=f.ma(h.documents),x=f.applyChanges(m,!1);l.resolve(x.snapshot)}catch(h){const f=ku(h,`Failed to execute query '${s} against cache`);l.reject(f)}}(await Ou(t),e,n)),n.promise}function Rb(t,e,n={}){const r=new nr;return t.asyncQueue.enqueueAndForget(async()=>function(s,l,h,f,m){const x=new lg({next:I=>{x.Za(),l.enqueueAndForget(()=>ix(s,_)),I.fromCache&&f.source==="server"?m.reject(new ge(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(I)},error:I=>m.reject(I)}),_=new ox(h,x,{includeMetadataChanges:!0,_a:!0});return rx(s,_)}(await fu(t),t.asyncQueue,e,n,r)),r.promise}function _9(t,e,n){const r=new nr;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await Sb(t);r.resolve(async function(l,h,f){var m;const x=Ae(l),{request:_,ut:I,parent:R}=FS(x.serializer,lS(h),f);x.connection.Fo||delete _.parent;const B=(await x.Lo("RunAggregationQuery",x.serializer.databaseId,R,_,1)).filter(G=>!!G.result);De(B.length===1);const D=(m=B[0].result)===null||m===void 0?void 0:m.aggregateFields;return Object.keys(D).reduce((G,F)=>(G[I[F]]=D[F],G),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}function E9(t,e){const n=new lg(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){Ae(i).Y_.add(s),s.next()}(await fu(t),n)),()=>{n.Za(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){Ae(i).Y_.delete(s)}(await fu(t),n))}}function v9(t,e,n,r){const i=function(l,h){let f;return f=typeof l=="string"?SS().encode(l):l,function(x,_){return new d9(x,_)}(function(x,_){if(x instanceof Uint8Array)return HE(x,_);if(x instanceof ArrayBuffer)return HE(new Uint8Array(x),_);if(x instanceof ReadableStream)return x.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(f),h)}(n,Hd(e));t.asyncQueue.enqueueAndForget(async()=>{u9(await gx(t),i,r)})}function I9(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=Ae(r);return s.persistence.runTransaction("Get named query","readonly",l=>s.Gr.getNamedQuery(l,i))}(await Ou(t),e))}function A9(t,e){return t.asyncQueue.enqueue(async()=>async function(r,i){const s=Ae(r),l=s.indexManager,h=[];return s.persistence.runTransaction("Configure indexes","readwrite",f=>l.getFieldIndexes(f).next(m=>function(_,I,R,B,D){_=[..._],I=[...I],_.sort(R),I.sort(R);const G=_.length,F=I.length;let P=0,N=0;for(;P<F&&N<G;){const H=R(_[N],I[P]);H<0?D(_[N++]):H>0?B(I[P++]):(P++,N++)}for(;P<F;)B(I[P++]);for(;N<G;)D(_[N++])}(m,i,bO,x=>{h.push(l.addFieldIndex(f,x))},x=>{h.push(l.deleteFieldIndex(f,x))})).next(()=>te.waitFor(h)))}(await Ou(t),e))}function T9(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){Ae(r).ss.zi=i}(await Ou(t),e))}function C9(t){return t.asyncQueue.enqueue(async()=>function(n){const r=Ae(n),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",s=>i.deleteAllFieldIndexes(s))}(await Ou(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(t,e,n){if(!n)throw new ge(ae.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function S9(t,e,n,r){if(e===!0&&r===!0)throw new ge(ae.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function KE(t){if(!Te.isDocumentKey(t))throw new ge(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $E(t){if(Te.isDocumentKey(t))throw new ge(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ug(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Re()}function at(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ge(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ug(t);throw new ge(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Pb(t,e){if(e<=0)throw new ge(ae.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}S9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Nb((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ge(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ge(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ge(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qd{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new QE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new QE(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new _O;switch(r.type){case"firstParty":return new AO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ge(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=qE.get(n);r&&(fe("ComponentProvider","Removing Datastore"),qE.delete(n),r.terminate())}(this),Promise.resolve()}}function b9(t,e,n,r={}){var i;const s=(t=at(t,qd))._getSettings(),l=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==l&&Ci("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:l,ssl:!1})),r.mockUserToken){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=er.MOCK_USER;else{h=LT(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new ge(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new er(m)}t._authCredentials=new EO(new OC(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new dr(this.firestore,e,this._query)}}class Dn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ss(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dn(this.firestore,e,this._key)}}class Ss extends dr{constructor(e,n,r){super(e,n,Su(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dn(this.firestore,null,new Te(e))}withConverter(e){return new Ss(this.firestore,e,this._path)}}function Db(t,e,...n){if(t=mt(t),mx("collection","path",e),t instanceof qd){const r=ht.fromString(e,...n);return $E(r),new Ss(t,null,r)}{if(!(t instanceof Dn||t instanceof Ss))throw new ge(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ht.fromString(e,...n));return $E(r),new Ss(t.firestore,null,r)}}function CV(t,e){if(t=at(t,qd),mx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ge(ae.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new dr(t,null,function(r){return new po(ht.emptyPath(),r)}(e))}function xs(t,e,...n){if(t=mt(t),arguments.length===1&&(e=LC.newId()),mx("doc","path",e),t instanceof qd){const r=ht.fromString(e,...n);return KE(r),new Dn(t,null,new Te(r))}{if(!(t instanceof Dn||t instanceof Ss))throw new ge(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ht.fromString(e,...n));return KE(r),new Dn(t.firestore,t instanceof Ss?t.converter:null,new Te(r))}}function SV(t,e){return t=mt(t),e=mt(e),(t instanceof Dn||t instanceof Ss)&&(e instanceof Dn||e instanceof Ss)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function kb(t,e){return t=mt(t),e=mt(e),t instanceof dr&&e instanceof dr&&t.firestore===e.firestore&&Bd(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Zw(this,"async_queue_retry"),this.Vu=()=>{const r=y0();r&&fe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=y0();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=y0();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new nr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Na(e))throw e;fe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(r);throw Rn("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=nx.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Re()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function iy(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class R9{constructor(){this._progressObserver={},this._taskCompletionResolver=new nr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bV=-1;class zt extends qd{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new XE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new XE(e),this._firestoreClient=void 0,await e}}}function RV(t,e,n){n||(n="(default)");const r=Ll(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(ga(s,e))return i;throw new ge(ae.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ge(ae.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ge(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function N9(t,e){const n=typeof t=="object"?t:q1(),r=typeof t=="string"?t:e||"(default)",i=Ll(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=yw("firestore");s&&b9(i,...s)}return i}function gn(t){if(t._terminated)throw new ge(ae.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Ob(t),t._firestoreClient}function Ob(t){var e,n,r;const i=t._freezeSettings(),s=function(h,f,m,x){return new e5(h,f,m,x.host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,Nb(x.experimentalLongPollingOptions),x.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new m9(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(h){const f=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(f),_online:f}}(t._componentsProvider))}function NV(t,e){Ci("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return Mb(t,va.provider,{build:r=>new dx(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function PV(t){Ci("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();Mb(t,va.provider,{build:n=>new Ab(n,e.cacheSizeBytes)})}function Mb(t,e,n){if((t=at(t,zt))._firestoreClient||t._terminated)throw new ge(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ge(ae.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Ob(t)}function DV(t){if(t._initialized&&!t._terminated)throw new ge(ae.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new nr;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Ts.D())return Promise.resolve();const i=r+"main";await Ts.delete(i)}(Qw(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function kV(t){return function(n){const r=new nr;return n.asyncQueue.enqueueAndForget(async()=>JM(await gx(n),r)),r.promise}(gn(t=at(t,zt)))}function OV(t){return p9(gn(t=at(t,zt)))}function MV(t){return y9(gn(t=at(t,zt)))}function LV(t){return WD(t.app,"firestore",t._databaseId.database),t._delete()}function FV(t,e){const n=gn(t=at(t,zt)),r=new R9;return v9(n,t._databaseId,e,r),r}function VV(t,e){return I9(gn(t=at(t,zt)),e).then(n=>n?new dr(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class P9{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dl(In.fromBase64String(e))}catch(n){throw new ge(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Dl(In.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ge(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function BV(){return new Ul("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ge(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ge(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=/^__.*__$/;class k9{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new wo(e,this.data,this.fieldMask,n,this.fieldTransforms):new bu(e,this.data,n,this.fieldTransforms)}}class Lb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new wo(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Fb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re()}}class dg{constructor(e,n,r,i,s,l){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new dg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return f1(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Fb(this.Cu)&&D9.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class O9{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Hd(e)}Qu(e,n,r,i=!1){return new dg({Cu:e,methodName:n,qu:r,path:rn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zl(t){const e=t._freezeSettings(),n=Hd(t._databaseId);return new O9(t._databaseId,!!e.ignoreUndefinedProperties,n)}function fg(t,e,n,r,i,s={}){const l=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);Ix("Data must be an object, but it was:",l,r);const h=Ub(r,l);let f,m;if(s.merge)f=new qr(l.fieldMask),m=l.fieldTransforms;else if(s.mergeFields){const x=[];for(const _ of s.mergeFields){const I=yd(e,_,n);if(!l.contains(I))throw new ge(ae.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);zb(x,I)||x.push(I)}f=new qr(x),m=l.fieldTransforms.filter(_=>f.covers(_.field))}else f=null,m=l.fieldTransforms;return new k9(new cr(h),f,m)}class Kd extends jl{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kd}}function Vb(t,e,n){return new dg({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class yx extends jl{_toFieldTransform(e){return new jd(e.path,new su)}isEqual(e){return e instanceof yx}}class wx extends jl{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=Vb(this,e,!0),r=this.Ku.map(s=>Gl(s,n)),i=new Sl(r);return new jd(e.path,i)}isEqual(e){return e instanceof wx&&ga(this.Ku,e.Ku)}}class xx extends jl{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=Vb(this,e,!0),r=this.Ku.map(s=>Gl(s,n)),i=new bl(r);return new jd(e.path,i)}isEqual(e){return e instanceof xx&&ga(this.Ku,e.Ku)}}class _x extends jl{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new ou(e.serializer,yS(e.serializer,this.$u));return new jd(e.path,n)}isEqual(e){return e instanceof _x&&this.$u===e.$u}}function Ex(t,e,n,r){const i=t.Qu(1,e,n);Ix("Data must be an object, but it was:",i,r);const s=[],l=cr.empty();Pa(r,(f,m)=>{const x=gg(e,f,n);m=mt(m);const _=i.Nu(x);if(m instanceof Kd)s.push(x);else{const I=Gl(m,_);I!=null&&(s.push(x),l.set(x,I))}});const h=new qr(s);return new Lb(l,h,i.fieldTransforms)}function vx(t,e,n,r,i,s){const l=t.Qu(1,e,n),h=[yd(e,r,n)],f=[i];if(s.length%2!=0)throw new ge(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)h.push(yd(e,s[I])),f.push(s[I+1]);const m=[],x=cr.empty();for(let I=h.length-1;I>=0;--I)if(!zb(m,h[I])){const R=h[I];let B=f[I];B=mt(B);const D=l.Nu(R);if(B instanceof Kd)m.push(R);else{const G=Gl(B,D);G!=null&&(m.push(R),x.set(R,G))}}const _=new qr(m);return new Lb(x,_,l.fieldTransforms)}function Bb(t,e,n,r=!1){return Gl(n,t.Qu(r?4:3,e))}function Gl(t,e){if(jb(t=mt(t)))return Ix("Unsupported field value:",e,t),Ub(t,e);if(t instanceof jl)return function(r,i){if(!Fb(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let l=0;for(const h of r){let f=Gl(h,i.Lu(l));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),l++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=mt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return yS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=dn.fromDate(r);return{timestampValue:au(i.serializer,s)}}if(r instanceof dn){const s=new dn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:au(i.serializer,s)}}if(r instanceof px)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Dl)return{bytesValue:NS(i.serializer,r._byteString)};if(r instanceof Dn){const s=i.databaseId,l=r.firestore._databaseId;if(!l.isEqual(s))throw i.Bu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof hg)return function(l,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:l.toArray().map(f=>{if(typeof f!="number")throw h.Bu("VectorValues must only contain numeric values.");return Lw(h.serializer,f)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${ug(r)}`)}(t,e)}function Ub(t,e){const n={};return QC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pa(t,(r,i)=>{const s=Gl(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function jb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof dn||t instanceof px||t instanceof Dl||t instanceof Dn||t instanceof jl||t instanceof hg)}function Ix(t,e,n){if(!jb(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=ug(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function yd(t,e,n){if((e=mt(e))instanceof Ul)return e._internalPath;if(typeof e=="string")return gg(t,e);throw f1("Field path arguments must be of type string or ",t,!1,void 0,n)}const M9=new RegExp("[~\\*/\\[\\]]");function gg(t,e,n){if(e.search(M9)>=0)throw f1(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ul(...e.split("."))._internalPath}catch{throw f1(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function f1(t,e,n,r,i){const s=r&&!r.isEmpty(),l=i!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(s||l)&&(f+=" (found",s&&(f+=` in field ${r}`),l&&(f+=` in document ${i}`),f+=")"),new ge(ae.INVALID_ARGUMENT,h+t+f)}function zb(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new L9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(mg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class L9 extends wd{data(){return super.data()}}function mg(t,e){return typeof e=="string"?gg(t,e):e instanceof Ul?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ge(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ax{}class $d extends Ax{}function F9(t,e,...n){let r=[];e instanceof Ax&&r.push(e),r=r.concat(n),function(s){const l=s.filter(f=>f instanceof Mu).length,h=s.filter(f=>f instanceof Qd).length;if(l>1||l>0&&h>0)throw new ge(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Qd extends $d{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Qd(e,n,r)}_apply(e){const n=this._parse(e);return Wb(e._query,n),new dr(e.firestore,e.converter,qp(e._query,n))}_parse(e){const n=zl(e.firestore);return function(s,l,h,f,m,x,_){let I;if(m.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new ge(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){ZE(_,x);const R=[];for(const B of _)R.push(YE(f,s,B));I={arrayValue:{values:R}}}else I=YE(f,s,_)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||ZE(_,x),I=Bb(h,l,_,x==="in"||x==="not-in");return dt.create(m,x,I)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function V9(t,e,n){const r=e,i=mg("where",t);return Qd._create(i,r,n)}class Mu extends Ax{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Mu(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Dt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let l=i;const h=s.getFlattenedFilters();for(const f of h)Wb(l,f),l=qp(l,f)}(e._query,n),new dr(e.firestore,e.converter,qp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function UV(...t){return t.forEach(e=>qb("or",e)),Mu._create("or",t)}function jV(...t){return t.forEach(e=>qb("and",e)),Mu._create("and",t)}class Tx extends $d{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Tx(e,n)}_apply(e){const n=function(i,s,l){if(i.startAt!==null)throw new ge(ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ge(ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fd(s,l)}(e._query,this._field,this._direction);return new dr(e.firestore,e.converter,function(i,s){const l=i.explicitOrderBy.concat([s]);return new po(i.path,i.collectionGroup,l,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function zV(t,e="asc"){const n=e,r=mg("orderBy",t);return Tx._create(r,n)}class pg extends $d{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new pg(e,n,r)}_apply(e){return new dr(e.firestore,e.converter,r1(e._query,this._limit,this._limitType))}}function GV(t){return Pb("limit",t),pg._create("limit",t,"F")}function HV(t){return Pb("limitToLast",t),pg._create("limitToLast",t,"L")}class yg extends $d{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new yg(e,n,r)}_apply(e){const n=Hb(e,this.type,this._docOrFields,this._inclusive);return new dr(e.firestore,e.converter,function(i,s){return new po(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function WV(...t){return yg._create("startAt",t,!0)}function qV(...t){return yg._create("startAfter",t,!1)}class wg extends $d{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new wg(e,n,r)}_apply(e){const n=Hb(e,this.type,this._docOrFields,this._inclusive);return new dr(e.firestore,e.converter,function(i,s){return new po(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function KV(...t){return wg._create("endBefore",t,!1)}function $V(...t){return wg._create("endAt",t,!0)}function Hb(t,e,n,r){if(n[0]=mt(n[0]),n[0]instanceof wd)return function(s,l,h,f,m){if(!f)throw new ge(ae.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const x=[];for(const _ of Fc(s))if(_.field.isKeyField())x.push(Tl(l,f.key));else{const I=f.data.field(_.field);if(Y1(I))throw new ge(ae.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+_.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const R=_.field.canonicalString();throw new ge(ae.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${R}' (used as the orderBy) does not exist.`)}x.push(I)}return new xa(x,m)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=zl(t.firestore);return function(l,h,f,m,x,_){const I=l.explicitOrderBy;if(x.length>I.length)throw new ge(ae.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const R=[];for(let B=0;B<x.length;B++){const D=x[B];if(I[B].field.isKeyField()){if(typeof D!="string")throw new ge(ae.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof D}`);if(!Ow(l)&&D.indexOf("/")!==-1)throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${D}' contains a slash.`);const G=l.path.child(ht.fromString(D));if(!Te.isDocumentKey(G))throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${G}' is not because it contains an odd number of segments.`);const F=new Te(G);R.push(Tl(h,F))}else{const G=Bb(f,m,D);R.push(G)}}return new xa(R,_)}(t._query,t.firestore._databaseId,i,e,n,r)}}function YE(t,e,n){if(typeof(n=mt(n))=="string"){if(n==="")throw new ge(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ow(e)&&n.indexOf("/")!==-1)throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ht.fromString(n));if(!Te.isDocumentKey(r))throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Tl(t,new Te(r))}if(n instanceof Dn)return Tl(t,n._key);throw new ge(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ug(n)}.`)}function ZE(t,e){if(!Array.isArray(t)||t.length===0)throw new ge(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Wb(t,e){const n=function(i,s){for(const l of i)for(const h of l.getFlattenedFilters())if(s.indexOf(h.op)>=0)return h.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ge(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function qb(t,e){if(!(e instanceof Qd||e instanceof Mu))throw new ge(ae.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Kb{convertValue(e,n="none"){switch(ya(e)){case 0:return null;case 1:return e.booleanValue;case 2:return tn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(fo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Re()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Pa(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(l=>tn(l.doubleValue));return new hg(s)}convertGeoPoint(e){return new px(tn(e.latitude),tn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Z1(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ud(e));default:return null}}convertTimestamp(e){const n=ho(e);return new dn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ht.fromString(e);De(jS(r));const i=new Al(r.get(1),r.get(3)),s=new Te(r.popFirst(5));return i.isEqual(n)||Rn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class B9 extends Kb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Dn(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(t){return new pd("sum",yd("sum",t))}function XV(t){return new pd("avg",yd("average",t))}function U9(){return new pd("count")}function YV(t,e){var n,r;return t instanceof pd&&e instanceof pd&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)===null||n===void 0?void 0:n.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function ZV(t,e){return kb(t.query,e.query)&&ga(t.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class gu extends wd{constructor(e,n,r,i,s,l){super(e,n,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new w0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(mg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class w0 extends gu{data(e={}){return super.data(e)}}class mu{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new il(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new w0(this._firestore,this._userDataWriter,r.key,r,new il(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ge(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map(h=>{const f=new w0(i._firestore,i._userDataWriter,h.doc.key,h.doc,new il(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}})}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(h=>s||h.type!==3).map(h=>{const f=new w0(i._firestore,i._userDataWriter,h.doc.key,h.doc,new il(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let m=-1,x=-1;return h.type!==0&&(m=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),x=l.indexOf(h.doc.key)),{type:j9(h.type),doc:f,oldIndex:m,newIndex:x}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function j9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re()}}function JV(t,e){return t instanceof gu&&e instanceof gu?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof mu&&e instanceof mu&&t._firestore===e._firestore&&kb(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(t){t=at(t,Dn);const e=at(t.firestore,zt);return bb(gn(e),t._key).then(n=>Sx(e,t,n))}class ka extends Kb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Dn(this.firestore,null,n)}}function eB(t){t=at(t,Dn);const e=at(t.firestore,zt),n=gn(e),r=new ka(e);return w9(n,t._key).then(i=>new gu(e,r,t._key,i,new il(i!==null&&i.hasLocalMutations,!0),t.converter))}function tB(t){t=at(t,Dn);const e=at(t.firestore,zt);return bb(gn(e),t._key,{source:"server"}).then(n=>Sx(e,t,n))}function z9(t){t=at(t,dr);const e=at(t.firestore,zt),n=gn(e),r=new ka(e);return Gb(t._query),Rb(n,t._query).then(i=>new mu(e,r,t,i))}function nB(t){t=at(t,dr);const e=at(t.firestore,zt),n=gn(e),r=new ka(e);return x9(n,t._query).then(i=>new mu(e,r,t,i))}function rB(t){t=at(t,dr);const e=at(t.firestore,zt),n=gn(e),r=new ka(e);return Rb(n,t._query,{source:"server"}).then(i=>new mu(e,r,t,i))}function xm(t,e,n){t=at(t,Dn);const r=at(t.firestore,zt),i=xg(t.converter,e,n);return Xd(r,[fg(zl(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,sn.none())])}function _g(t,e,n,...r){t=at(t,Dn);const i=at(t.firestore,zt),s=zl(i);let l;return l=typeof(e=mt(e))=="string"||e instanceof Ul?vx(s,"updateDoc",t._key,e,n,r):Ex(s,"updateDoc",t._key,e),Xd(i,[l.toMutation(t._key,sn.exists(!0))])}function iB(t){return Xd(at(t.firestore,zt),[new Ru(t._key,sn.none())])}function G9(t,e){const n=at(t.firestore,zt),r=xs(t),i=xg(t.converter,e);return Xd(n,[fg(zl(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,sn.exists(!1))]).then(()=>r)}function sB(t,...e){var n,r,i;t=mt(t);let s={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||iy(e[l])||(s=e[l],l++);const h={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(iy(e[l])){const _=e[l];e[l]=(n=_.next)===null||n===void 0?void 0:n.bind(_),e[l+1]=(r=_.error)===null||r===void 0?void 0:r.bind(_),e[l+2]=(i=_.complete)===null||i===void 0?void 0:i.bind(_)}let f,m,x;if(t instanceof Dn)m=at(t.firestore,zt),x=Su(t._key.path),f={next:_=>{e[l]&&e[l](Sx(m,t,_))},error:e[l+1],complete:e[l+2]};else{const _=at(t,dr);m=at(_.firestore,zt),x=_._query;const I=new ka(m);f={next:R=>{e[l]&&e[l](new mu(m,I,_,R))},error:e[l+1],complete:e[l+2]},Gb(t._query)}return function(I,R,B,D){const G=new lg(D),F=new ox(R,G,B);return I.asyncQueue.enqueueAndForget(async()=>rx(await fu(I),F)),()=>{G.Za(),I.asyncQueue.enqueueAndForget(async()=>ix(await fu(I),F))}}(gn(m),x,h,f)}function oB(t,e){return E9(gn(t=at(t,zt)),iy(e)?e:{next:e})}function Xd(t,e){return function(r,i){const s=new nr;return r.asyncQueue.enqueueAndForget(async()=>QM(await gx(r),i,s)),s.promise}(gn(t),e)}function Sx(t,e,n){const r=n.docs.get(e._key),i=new ka(t);return new gu(t,i,e._key,r,new il(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aB(t){return H9(t,{count:U9()})}function H9(t,e){const n=at(t.firestore,zt),r=gn(n),i=$C(e,(s,l)=>new AS(l,s.aggregateType,s._internalFieldPath));return _9(r,t._query,i).then(s=>function(h,f,m){const x=new ka(h);return new P9(f,x,m)}(n,t,s))}class W9{constructor(e){this.kind="memory",this._onlineComponentProvider=va.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=Ea.provider}toJSON(){return{kind:this.kind}}}class q9{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=Y9(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class K9{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Ea.provider}toJSON(){return{kind:this.kind}}}class $9{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new h9(e)}}toJSON(){return{kind:this.kind}}}function lB(){return new K9}function cB(t){return new $9(t==null?void 0:t.cacheSizeBytes)}function uB(t){return new W9(t)}function hB(t){return new q9(t)}class Q9{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=va.provider,this._offlineComponentProvider={build:n=>new dx(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class X9{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=va.provider,this._offlineComponentProvider={build:n=>new Ab(n,e==null?void 0:e.cacheSizeBytes)}}}function Y9(t){return new Q9(t==null?void 0:t.forceOwnership)}function dB(){return new X9}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z9={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J9{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=zl(e)}set(e,n,r){this._verifyNotCommitted();const i=zo(e,this._firestore),s=xg(i.converter,n,r),l=fg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(l.toMutation(i._key,sn.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=zo(e,this._firestore);let l;return l=typeof(n=mt(n))=="string"||n instanceof Ul?vx(this._dataReader,"WriteBatch.update",s._key,n,r,i):Ex(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(l.toMutation(s._key,sn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=zo(e,this._firestore);return this._mutations=this._mutations.concat(new Ru(n._key,sn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ge(ae.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zo(t,e){if((t=mt(t)).firestore!==e)throw new ge(ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=zl(n)}get(n){const r=zo(n,this._firestore),i=new B9(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return Re();const l=s[0];if(l.isFoundDocument())return new wd(this._firestore,i,l.key,l,r.converter);if(l.isNoDocument())return new wd(this._firestore,i,r._key,null,r.converter);throw Re()})}set(n,r,i){const s=zo(n,this._firestore),l=xg(s.converter,r,i),h=fg(this._dataReader,"Transaction.set",s._key,l,s.converter!==null,i);return this._transaction.set(s._key,h),this}update(n,r,i,...s){const l=zo(n,this._firestore);let h;return h=typeof(r=mt(r))=="string"||r instanceof Ul?vx(this._dataReader,"Transaction.update",l._key,r,i,s):Ex(this._dataReader,"Transaction.update",l._key,r),this._transaction.update(l._key,h),this}delete(n){const r=zo(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=zo(e,this._firestore),r=new ka(this._firestore);return super.get(e).then(i=>new gu(this._firestore,r,n._key,i._document,new il(!1,!1),n.converter))}}function gB(t,e,n){t=at(t,zt);const r=Object.assign(Object.assign({},Z9),n);return function(s){if(s.maxAttempts<1)throw new ge(ae.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,l,h){const f=new nr;return s.asyncQueue.enqueueAndForget(async()=>{const m=await Sb(s);new g9(s.asyncQueue,m,h,l,f).au()}),f.promise}(gn(t),i=>e(new eL(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(){return new Kd("deleteField")}function xd(){return new yx("serverTimestamp")}function pB(...t){return new wx("arrayUnion",t)}function yB(...t){return new xx("arrayRemove",t)}function wB(t){return new _x("increment",t)}function xB(t){return new hg(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _B(t){return gn(t=at(t,zt)),new J9(t,e=>Xd(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EB(t,e){const n=gn(t=at(t,zt));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return Ci("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(s){const l=typeof s=="string"?function(m){try{return JSON.parse(m)}catch(x){throw new ge(ae.INVALID_ARGUMENT,"Failed to parse JSON: "+(x==null?void 0:x.message))}}(s):s,h=[];if(Array.isArray(l.indexes))for(const f of l.indexes){const m=JE(f,"collectionGroup"),x=[];if(Array.isArray(f.fields))for(const _ of f.fields){const I=gg("setIndexConfiguration",JE(_,"fieldPath"));_.arrayConfig==="CONTAINS"?x.push(new ml(I,2)):_.order==="ASCENDING"?x.push(new ml(I,0)):_.order==="DESCENDING"&&x.push(new ml(I,1))}h.push(new tu(tu.UNKNOWN_ID,m,x,nu.empty()))}return h}(e);return A9(n,r)}function JE(t,e){if(typeof t[e]!="string")throw new ge(ae.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function vB(t){var e;t=at(t,zt);const n=ev.get(t);if(n)return n;if(((e=gn(t)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new tL(t);return ev.set(t,r),r}function IB(t){$b(t,!0)}function AB(t){$b(t,!1)}function TB(t){C9(gn(t._firestore)).then(e=>fe("deleting all persistent cache indexes succeeded")).catch(e=>Ci("deleting all persistent cache indexes failed",e))}function $b(t,e){T9(gn(t._firestore),e).then(n=>fe(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>Ci(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const ev=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(t){var e;const n=(e=gn(at(t.firestore,zt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return n===void 0?null:ng(n,Ar(t._query))._t}function SB(t,e){var n;const r=$C(e,(s,l)=>new AS(l,s.aggregateType,s._internalFieldPath)),i=(n=gn(at(t.firestore,zt))._onlineComponents)===null||n===void 0?void 0:n.datastore.serializer;return i===void 0?null:FS(i,lS(t._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return bx.instance.onExistenceFilterMismatch(e)}}class bx{constructor(){this.Uu=new Map}static get instance(){return Gf||(Gf=new bx,function(n){if(i1)throw new Error("a TestingHooksSpi instance is already set");i1=n}(Gf)),Gf}et(e){this.Uu.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Uu;return r.set(n,e),()=>r.delete(n)}}let Gf=null;(function(e,n=!0){(function(i){Cu=i})(Fl),ma(new lo("firestore",(r,{instanceIdentifier:i,options:s})=>{const l=r.getProvider("app").getImmediate(),h=new zt(new vO(r.getProvider("auth-internal")),new TO(r.getProvider("app-check-internal")),function(m,x){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ge(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Al(m.options.projectId,x)}(l,i),l);return s=Object.assign({useFetchStreams:n},s),h._setSettings(s),h},"PUBLIC").setMultipleInstances(!0)),Ii(G2,"4.7.3",e),Ii(G2,"4.7.3","esm2017")})();var nL="firebase",rL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ii(nL,rL,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb="firebasestorage.googleapis.com",iL="storageBucket",sL=2*60*1e3,oL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends Ns{constructor(e,n,r=0){super(_m(e),`Firebase Storage: ${n} (${_m(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return _m(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rs;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rs||(Rs={}));function _m(t){return"storage/"+t}function aL(){const t="An unknown error occurred, please check the error payload for server response.";return new Ds(Rs.UNKNOWN,t)}function lL(){return new Ds(Rs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function cL(){return new Ds(Rs.CANCELED,"User canceled the upload/download.")}function uL(t){return new Ds(Rs.INVALID_URL,"Invalid URL '"+t+"'.")}function hL(t){return new Ds(Rs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function tv(t){return new Ds(Rs.INVALID_ARGUMENT,t)}function Xb(){return new Ds(Rs.APP_DELETED,"The Firebase app was deleted.")}function dL(t){return new Ds(Rs.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ki.makeFromUrl(e,n)}catch{return new Ki(e,"")}if(r.path==="")return r;throw hL(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(H){H.path.charAt(H.path.length-1)==="/"&&(H.path_=H.path_.slice(0,-1))}const l="(/(.*))?$",h=new RegExp("^gs://"+i+l,"i"),f={bucket:1,path:3};function m(H){H.path_=decodeURIComponent(H.path)}const x="v[A-Za-z0-9_]+",_=n.replace(/[.]/g,"\\."),I="(/([^?#]*).*)?$",R=new RegExp(`^https?://${_}/${x}/b/${i}/o${I}`,"i"),B={bucket:1,path:3},D=n===Qb?"(?:storage.googleapis.com|storage.cloud.google.com)":n,G="([^?#]*)",F=new RegExp(`^https?://${D}/${i}/${G}`,"i"),N=[{regex:h,indices:f,postModify:s},{regex:R,indices:B,postModify:m},{regex:F,indices:{bucket:1,path:2},postModify:m}];for(let H=0;H<N.length;H++){const Y=N[H],J=Y.regex.exec(e);if(J){const k=J[Y.indices.bucket];let M=J[Y.indices.path];M||(M=""),r=new Ki(k,M),Y.postModify(r);break}}if(r==null)throw uL(e);return r}}class fL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gL(t,e,n){let r=1,i=null,s=null,l=!1,h=0;function f(){return h===2}let m=!1;function x(...G){m||(m=!0,e.apply(null,G))}function _(G){i=setTimeout(()=>{i=null,t(R,f())},G)}function I(){s&&clearTimeout(s)}function R(G,...F){if(m){I();return}if(G){I(),x.call(null,G,...F);return}if(f()||l){I(),x.call(null,G,...F);return}r<64&&(r*=2);let N;h===1?(h=2,N=0):N=(r+Math.random())*1e3,_(N)}let B=!1;function D(G){B||(B=!0,I(),!m&&(i!==null?(G||(h=2),clearTimeout(i),_(0)):G||(h=1)))}return _(0),s=setTimeout(()=>{l=!0,D(!0)},n),D}function mL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(t){return t!==void 0}function nv(t,e,n,r){if(r<e)throw tv(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw tv(`Invalid value for '${t}'. Expected ${n} or less.`)}function yL(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var g1;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(g1||(g1={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wL(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xL{constructor(e,n,r,i,s,l,h,f,m,x,_,I=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=f,this.timeout_=m,this.progressCallback_=x,this.connectionFactory_=_,this.retry=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((R,B)=>{this.resolve_=R,this.reject_=B,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new Hf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const l=h=>{const f=h.loaded,m=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,m)};this.progressCallback_!==null&&s.addUploadProgressListener(l),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(l),this.pendingConnection_=null;const h=s.getErrorCode()===g1.NO_ERROR,f=s.getStatus();if(!h||wL(f,this.additionalRetryCodes_)&&this.retry){const x=s.getErrorCode()===g1.ABORT;r(!1,new Hf(!1,null,x));return}const m=this.successCodes_.indexOf(f)!==-1;r(!0,new Hf(m,s))})},n=(r,i)=>{const s=this.resolve_,l=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());pL(f)?s(f):s()}catch(f){l(f)}else if(h!==null){const f=aL();f.serverResponse=h.getErrorText(),this.errorCallback_?l(this.errorCallback_(h,f)):l(f)}else if(i.canceled){const f=this.appDelete_?Xb():cL();l(f)}else{const f=lL();l(f)}};this.canceled_?n(!1,new Hf(!1,null,!0)):this.backoffId_=gL(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&mL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Hf{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function _L(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function EL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function IL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function AL(t,e,n,r,i,s,l=!0){const h=yL(t.urlParams),f=t.url+h,m=Object.assign({},t.headers);return vL(m,e),_L(m,n),EL(m,s),IL(m,r),new xL(f,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function CL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,n){this._service=e,n instanceof Ki?this._location=n:this._location=Ki.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new m1(e,n)}get root(){const e=new Ki(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return CL(this._location.path)}get storage(){return this._service}get parent(){const e=TL(this._location.path);if(e===null)return null;const n=new Ki(this._location.bucket,e);return new m1(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw dL(e)}}function rv(t,e){const n=e==null?void 0:e[iL];return n==null?null:Ki.makeFromBucketSpec(n,t)}function SL(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:LT(i,t.app.options.projectId))}class bL{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=Qb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=sL,this._maxUploadRetryTime=oL,this._requests=new Set,i!=null?this._bucket=Ki.makeFromBucketSpec(i,this._host):this._bucket=rv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ki.makeFromBucketSpec(this._url,e):this._bucket=rv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new m1(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new fL(Xb());{const l=AL(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const iv="@firebase/storage",sv="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb="storage";function RL(t=q1(),e){t=mt(t);const r=Ll(t,Yb).getImmediate({identifier:e}),i=yw("storage");return i&&NL(r,...i),r}function NL(t,e,n,r={}){SL(t,e,n,r)}function PL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new bL(n,r,i,e,Fl)}function DL(){ma(new lo(Yb,PL,"PUBLIC").setMultipleInstances(!0)),Ii(iv,sv,""),Ii(iv,sv,"esm2017")}DL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy="us-central1";class OL{constructor(e,n,r,i,s=sy,l){this.app=e,this.fetchImpl=l,this.emulatorOrigin=null,this.contextProvider=new kL(n,r,i),this.cancelAllRequests=new Promise(h=>{this.deleteService=()=>Promise.resolve(h())});try{const h=new URL(s);this.customDomain=h.origin+(h.pathname==="/"?"":h.pathname),this.region=sy}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function ML(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const ov="@firebase/functions",av="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL="auth-internal",FL="app-check-internal",VL="messaging-internal";function BL(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),l=r.getProvider(LL),h=r.getProvider(VL),f=r.getProvider(FL);return new OL(s,l,h,f,i,t)};ma(new lo(Zb,n,"PUBLIC").setMultipleInstances(!0)),Ii(ov,av,e),Ii(ov,av,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(t=q1(),e=sy){const r=Ll(mt(t),Zb).getImmediate({identifier:e}),i=yw("functions");return i&&jL(r,...i),r}function jL(t,e,n){ML(mt(t),e,n)}BL(fetch.bind(self));const zL={apiKey:"AIzaSyBhwyN85XAMKQmZqT6NqCBKeGq7c7niou8",authDomain:"eshaan-createch.firebaseapp.com",projectId:"eshaan-createch",storageBucket:"eshaan-createch.firebasestorage.app",messagingSenderId:"770507129209",appId:"1:770507129209:web:37a251e0b652911988afa8",measurementId:"G-Q837NJ8KC2"},Yd=jT(zL),vn=wO(Yd),Ei=N9(Yd),GL=RL(Yd),HL=UL(Yd);console.log(" Using production Firebase services");const WL=Object.freeze(Object.defineProperty({__proto__:null,auth:vn,db:Ei,default:Yd,functions:HL,storage:GL},Symbol.toStringTag,{value:"Module"}));class qL{constructor(){Pg(this,"currentUser",null);Pg(this,"authStateListeners",[]);ok(vn,async e=>{e?this.currentUser=await this.getUserProfile(e.uid):this.currentUser=null,this.authStateListeners.forEach(n=>n(this.currentUser))})}async login(e){try{const n=await ek(vn,e.email,e.password),r=await this.getUserProfile(n.user.uid),i=await n.user.getIdToken();return{user:r,token:i,expiresIn:"3600"}}catch(n){throw this.handleAuthError(n)}}async register(e){try{const n=await J6(vn,e.email,e.password);await mC(n.user,{displayName:e.displayName||e.username});const r={id:n.user.uid,email:e.email,username:e.username,role:e.role,displayName:e.displayName,createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString(),isActive:!0};await xm(xs(Ei,"users",r.id),r);const i=await n.user.getIdToken();return{user:r,token:i}}catch(n){throw this.handleAuthError(n)}}async logout(){try{await yC(vn)}catch(e){throw this.handleAuthError(e)}}async getCurrentUser(){return this.currentUser}async getUserProfile(e){var n;try{const r=await Cx(xs(Ei,"users",e));if(!r.exists()){const i=vn.currentUser;if(i){const s={id:i.uid,email:i.email||"",username:i.displayName||((n=i.email)==null?void 0:n.split("@")[0])||"user",role:"researcher",displayName:i.displayName||void 0,createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString(),isActive:!0};return await xm(xs(Ei,"users",e),s),s}throw new Error("User profile not found and could not create one")}return r.data()}catch(r){throw this.handleAuthError(r)}}async updateUserProfile(e,n){try{const r=xs(Ei,"users",e);await xm(r,n,{merge:!0});const i=await this.getUserProfile(e);return this.currentUser=i,i}catch(r){throw this.handleAuthError(r)}}async refreshToken(){try{const e=vn.currentUser;if(!e)throw new Error("No authenticated user");return await e.getIdToken(!0)}catch(e){throw this.handleAuthError(e)}}onAuthStateChange(e){return this.authStateListeners.push(e),()=>{const n=this.authStateListeners.indexOf(e);n>-1&&this.authStateListeners.splice(n,1)}}isAuthenticated(){return this.currentUser!==null}hasRole(e){var n;return((n=this.currentUser)==null?void 0:n.role)===e}hasAnyRole(e){return this.currentUser?e.includes(this.currentUser.role):!1}handleAuthError(e){let n="AUTHENTICATION_ERROR",r="An authentication error occurred";switch(e.code){case"auth/user-not-found":n="USER_NOT_FOUND",r="No user found with this email address";break;case"auth/wrong-password":n="INVALID_CREDENTIALS",r="Invalid email or password";break;case"auth/email-already-in-use":n="EMAIL_ALREADY_EXISTS",r="An account with this email already exists";break;case"auth/weak-password":n="WEAK_PASSWORD",r="Password should be at least 6 characters";break;case"auth/invalid-email":n="INVALID_EMAIL",r="Invalid email address";break;case"auth/too-many-requests":n="TOO_MANY_REQUESTS",r="Too many failed attempts. Please try again later";break;case"auth/network-request-failed":n="NETWORK_ERROR",r="Network error. Please check your connection";break;default:r=e.message||r}return{code:n,message:r,details:{originalError:e.code,timestamp:new Date().toISOString()}}}}const qa=new qL,KL=t=>{switch(t){case"admin":return{canCreateArtifacts:!0,canEditArtifacts:!0,canDeleteArtifacts:!0,canUploadPhotos:!0,canDeletePhotos:!0,canManageUsers:!0};case"archaeologist":return{canCreateArtifacts:!0,canEditArtifacts:!0,canDeleteArtifacts:!1,canUploadPhotos:!0,canDeletePhotos:!1,canManageUsers:!1};case"researcher":return{canCreateArtifacts:!1,canEditArtifacts:!1,canDeleteArtifacts:!1,canUploadPhotos:!1,canDeletePhotos:!1,canManageUsers:!1};default:return{canCreateArtifacts:!1,canEditArtifacts:!1,canDeleteArtifacts:!1,canUploadPhotos:!1,canDeletePhotos:!1,canManageUsers:!1}}},ks=()=>{const[t,e]=oe.useState(null),[n,r]=oe.useState(!0),[i,s]=oe.useState(null),l=oe.useCallback(()=>{s(null)},[]),h=oe.useCallback(async B=>{try{r(!0),s(null);const D=await qa.login(B);e(D.user)}catch(D){throw s(D),D}finally{r(!1)}},[]),f=oe.useCallback(async B=>{try{r(!0),s(null);const D=await qa.register(B);e(D.user)}catch(D){throw s(D),D}finally{r(!1)}},[]),m=oe.useCallback(async()=>{try{r(!0),s(null),await qa.logout(),e(null)}catch(B){throw s(B),B}finally{r(!1)}},[]),x=oe.useCallback(async B=>{if(!t)throw new Error("No authenticated user");try{r(!0),s(null);const D=await qa.updateUserProfile(t.id,B);e(D)}catch(D){throw s(D),D}finally{r(!1)}},[t]),_=oe.useCallback(async()=>{try{return s(null),await qa.refreshToken()}catch(B){throw s(B),B}},[]),I=t!==null,R=t?KL(t.role):null;return oe.useEffect(()=>{const B=qa.onAuthStateChange(G=>{e(G),r(!1)});return(async()=>{try{const G=await qa.getCurrentUser();e(G)}catch{e(null)}finally{r(!1)}})(),B},[]),{user:t,loading:n,error:i,login:h,register:f,logout:m,updateProfile:x,refreshToken:_,isAuthenticated:I,permissions:R,clearError:l}};var Zd=t=>t.type==="checkbox",sl=t=>t instanceof Date,Nr=t=>t==null;const Jb=t=>typeof t=="object";var Vn=t=>!Nr(t)&&!Array.isArray(t)&&Jb(t)&&!sl(t),$L=t=>Vn(t)&&t.target?Zd(t.target)?t.target.checked:t.target.value:t,QL=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,XL=(t,e)=>t.has(QL(e)),YL=t=>{const e=t.constructor&&t.constructor.prototype;return Vn(e)&&e.hasOwnProperty("isPrototypeOf")},Rx=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Xn(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(Rx&&(t instanceof Blob||r))&&(n||Vn(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!YL(t))e=t;else for(const i in t)t.hasOwnProperty(i)&&(e[i]=Xn(t[i]));else return t;return e}var Eg=t=>/^\w*$/.test(t),Ln=t=>t===void 0,Nx=t=>Array.isArray(t)?t.filter(Boolean):[],Px=t=>Nx(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Le=(t,e,n)=>{if(!e||!Vn(t))return n;const r=(Eg(e)?[e]:Px(e)).reduce((i,s)=>Nr(i)?i:i[s],t);return Ln(r)||r===t?Ln(t[e])?n:t[e]:r},hs=t=>typeof t=="boolean",en=(t,e,n)=>{let r=-1;const i=Eg(e)?[e]:Px(e),s=i.length,l=s-1;for(;++r<s;){const h=i[r];let f=n;if(r!==l){const m=t[h];f=Vn(m)||Array.isArray(m)?m:isNaN(+i[r+1])?{}:[]}if(h==="__proto__"||h==="constructor"||h==="prototype")return;t[h]=f,t=t[h]}};const lv={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Hi={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Hs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},ZL=_r.createContext(null);ZL.displayName="HookFormContext";var JL=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const l=s;return e._proxyFormState[l]!==Hi.all&&(e._proxyFormState[l]=!r||Hi.all),n&&(n[l]=!0),t[l]}});return i};const e7=typeof window<"u"?_r.useLayoutEffect:_r.useEffect;var oi=t=>typeof t=="string",t7=(t,e,n,r,i)=>oi(t)?(r&&e.watch.add(t),Le(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),Le(n,s))):(r&&(e.watchAll=!0),n),oy=t=>Nr(t)||!Jb(t);function Go(t,e,n=new WeakSet){if(oy(t)||oy(e))return t===e;if(sl(t)&&sl(e))return t.getTime()===e.getTime();const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const s of r){const l=t[s];if(!i.includes(s))return!1;if(s!=="ref"){const h=e[s];if(sl(l)&&sl(h)||Vn(l)&&Vn(h)||Array.isArray(l)&&Array.isArray(h)?!Go(l,h,n):l!==h)return!1}}return!0}var n7=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},Lh=t=>Array.isArray(t)?t:[t],cv=()=>{let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}};function e3(t,e){const n={};for(const r in t)if(t.hasOwnProperty(r)){const i=t[r],s=e[r];if(i&&Vn(i)&&s){const l=e3(i,s);Vn(l)&&(n[r]=l)}else t[r]&&(n[r]=s)}return n}var zr=t=>Vn(t)&&!Object.keys(t).length,Dx=t=>t.type==="file",Wi=t=>typeof t=="function",p1=t=>{if(!Rx)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},t3=t=>t.type==="select-multiple",kx=t=>t.type==="radio",r7=t=>kx(t)||Zd(t),Em=t=>p1(t)&&t.isConnected;function i7(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=Ln(t)?r++:t[e[r++]];return t}function s7(t){for(const e in t)if(t.hasOwnProperty(e)&&!Ln(t[e]))return!1;return!0}function On(t,e){const n=Array.isArray(e)?e:Eg(e)?[e]:Px(e),r=n.length===1?t:i7(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(Vn(r)&&zr(r)||Array.isArray(r)&&s7(r))&&On(t,n.slice(0,-1)),t}var o7=t=>{for(const e in t)if(Wi(t[e]))return!0;return!1};function n3(t){return Array.isArray(t)||Vn(t)&&!o7(t)}function ay(t,e={}){for(const n in t)n3(t[n])?(e[n]=Array.isArray(t[n])?[]:{},ay(t[n],e[n])):Nr(t[n])||(e[n]=!0);return e}function fc(t,e,n){n||(n=ay(e));for(const r in t)n3(t[r])?Ln(e)||oy(n[r])?n[r]=ay(t[r],Array.isArray(t[r])?[]:{}):fc(t[r],Nr(e)?{}:e[r],n[r]):n[r]=!Go(t[r],e[r]);return n}const uv={value:!1,isValid:!1},hv={value:!0,isValid:!0};var r3=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Ln(t[0].attributes.value)?Ln(t[0].value)||t[0].value===""?hv:{value:t[0].value,isValid:!0}:hv:uv}return uv},i3=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>Ln(t)?t:e?t===""?NaN:t&&+t:n&&oi(t)?new Date(t):r?r(t):t;const dv={isValid:!1,value:null};var s3=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,dv):dv;function fv(t){const e=t.ref;return Dx(e)?e.files:kx(e)?s3(t.refs).value:t3(e)?[...e.selectedOptions].map(({value:n})=>n):Zd(e)?r3(t.refs).value:i3(Ln(e.value)?t.ref.value:e.value,t)}var a7=(t,e,n,r)=>{const i={};for(const s of t){const l=Le(e,s);l&&en(i,s,l._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},y1=t=>t instanceof RegExp,uh=t=>Ln(t)?t:y1(t)?t.source:Vn(t)?y1(t.value)?t.value.source:t.value:t,gv=t=>({isOnSubmit:!t||t===Hi.onSubmit,isOnBlur:t===Hi.onBlur,isOnChange:t===Hi.onChange,isOnAll:t===Hi.all,isOnTouch:t===Hi.onTouched});const mv="AsyncFunction";var l7=t=>!!t&&!!t.validate&&!!(Wi(t.validate)&&t.validate.constructor.name===mv||Vn(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===mv)),c7=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),pv=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const Fh=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=Le(t,i);if(s){const{_f:l,...h}=s;if(l){if(l.refs&&l.refs[0]&&e(l.refs[0],i)&&!r)return!0;if(l.ref&&e(l.ref,l.name)&&!r)return!0;if(Fh(h,e))break}else if(Vn(h)&&Fh(h,e))break}}};function yv(t,e,n){const r=Le(t,n);if(r||Eg(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),l=Le(e,s),h=Le(t,s);if(l&&!Array.isArray(l)&&n!==s)return{name:n};if(h&&h.type)return{name:s,error:h};if(h&&h.root&&h.root.type)return{name:`${s}.root`,error:h.root};i.pop()}return{name:n}}var u7=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return zr(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(l=>e[l]===(!r||Hi.all))},h7=(t,e,n)=>!t||!e||t===e||Lh(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),d7=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,f7=(t,e)=>!Nx(Le(t,e)).length&&On(t,e),g7=(t,e,n)=>{const r=Lh(Le(t,n));return en(r,"root",e[n]),en(t,n,r),t};function wv(t,e,n="validate"){if(oi(t)||Array.isArray(t)&&t.every(oi)||hs(t)&&!t)return{type:n,message:oi(t)?t:"",ref:e}}var lc=t=>Vn(t)&&!y1(t)?t:{value:t,message:""},xv=async(t,e,n,r,i,s)=>{const{ref:l,refs:h,required:f,maxLength:m,minLength:x,min:_,max:I,pattern:R,validate:B,name:D,valueAsNumber:G,mount:F}=t._f,P=Le(n,D);if(!F||e.has(D))return{};const N=h?h[0]:l,H=q=>{i&&N.reportValidity&&(N.setCustomValidity(hs(q)?"":q||""),N.reportValidity())},Y={},J=kx(l),k=Zd(l),M=J||k,L=(G||Dx(l))&&Ln(l.value)&&Ln(P)||p1(l)&&l.value===""||P===""||Array.isArray(P)&&!P.length,W=n7.bind(null,D,r,Y),K=(q,j,ze,ie=Hs.maxLength,rt=Hs.minLength)=>{const Oe=q?j:ze;Y[D]={type:q?ie:rt,message:Oe,ref:l,...W(q?ie:rt,Oe)}};if(s?!Array.isArray(P)||!P.length:f&&(!M&&(L||Nr(P))||hs(P)&&!P||k&&!r3(h).isValid||J&&!s3(h).isValid)){const{value:q,message:j}=oi(f)?{value:!!f,message:f}:lc(f);if(q&&(Y[D]={type:Hs.required,message:j,ref:N,...W(Hs.required,j)},!r))return H(j),Y}if(!L&&(!Nr(_)||!Nr(I))){let q,j;const ze=lc(I),ie=lc(_);if(!Nr(P)&&!isNaN(P)){const rt=l.valueAsNumber||P&&+P;Nr(ze.value)||(q=rt>ze.value),Nr(ie.value)||(j=rt<ie.value)}else{const rt=l.valueAsDate||new Date(P),Oe=Ue=>new Date(new Date().toDateString()+" "+Ue),Ie=l.type=="time",Me=l.type=="week";oi(ze.value)&&P&&(q=Ie?Oe(P)>Oe(ze.value):Me?P>ze.value:rt>new Date(ze.value)),oi(ie.value)&&P&&(j=Ie?Oe(P)<Oe(ie.value):Me?P<ie.value:rt<new Date(ie.value))}if((q||j)&&(K(!!q,ze.message,ie.message,Hs.max,Hs.min),!r))return H(Y[D].message),Y}if((m||x)&&!L&&(oi(P)||s&&Array.isArray(P))){const q=lc(m),j=lc(x),ze=!Nr(q.value)&&P.length>+q.value,ie=!Nr(j.value)&&P.length<+j.value;if((ze||ie)&&(K(ze,q.message,j.message),!r))return H(Y[D].message),Y}if(R&&!L&&oi(P)){const{value:q,message:j}=lc(R);if(y1(q)&&!P.match(q)&&(Y[D]={type:Hs.pattern,message:j,ref:l,...W(Hs.pattern,j)},!r))return H(j),Y}if(B){if(Wi(B)){const q=await B(P,n),j=wv(q,N);if(j&&(Y[D]={...j,...W(Hs.validate,j.message)},!r))return H(j.message),Y}else if(Vn(B)){let q={};for(const j in B){if(!zr(q)&&!r)break;const ze=wv(await B[j](P,n),N,j);ze&&(q={...ze,...W(j,ze.message)},H(ze.message),r&&(Y[D]=q))}if(!zr(q)&&(Y[D]={ref:N,...q},!r))return Y}}return H(!0),Y};const m7={mode:Hi.onSubmit,reValidateMode:Hi.onChange,shouldFocusError:!0};function p7(t={}){let e={...m7,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Wi(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},i=Vn(e.defaultValues)||Vn(e.values)?Xn(e.defaultValues||e.values)||{}:{},s=e.shouldUnregister?{}:Xn(i),l={action:!1,mount:!1,watch:!1},h={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},f,m=0;const x={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let _={...x};const I={array:cv(),state:cv()},R=e.criteriaMode===Hi.all,B=$=>Q=>{clearTimeout(m),m=setTimeout($,Q)},D=async $=>{if(!e.disabled&&(x.isValid||_.isValid||$)){const Q=e.resolver?zr((await k()).errors):await L(r,!0);Q!==n.isValid&&I.state.next({isValid:Q})}},G=($,Q)=>{!e.disabled&&(x.isValidating||x.validatingFields||_.isValidating||_.validatingFields)&&(($||Array.from(h.mount)).forEach(ue=>{ue&&(Q?en(n.validatingFields,ue,Q):On(n.validatingFields,ue))}),I.state.next({validatingFields:n.validatingFields,isValidating:!zr(n.validatingFields)}))},F=($,Q=[],ue,Ce,we=!0,pe=!0)=>{if(Ce&&ue&&!e.disabled){if(l.action=!0,pe&&Array.isArray(Le(r,$))){const be=ue(Le(r,$),Ce.argA,Ce.argB);we&&en(r,$,be)}if(pe&&Array.isArray(Le(n.errors,$))){const be=ue(Le(n.errors,$),Ce.argA,Ce.argB);we&&en(n.errors,$,be),f7(n.errors,$)}if((x.touchedFields||_.touchedFields)&&pe&&Array.isArray(Le(n.touchedFields,$))){const be=ue(Le(n.touchedFields,$),Ce.argA,Ce.argB);we&&en(n.touchedFields,$,be)}(x.dirtyFields||_.dirtyFields)&&(n.dirtyFields=fc(i,s)),I.state.next({name:$,isDirty:K($,Q),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else en(s,$,Q)},P=($,Q)=>{en(n.errors,$,Q),I.state.next({errors:n.errors})},N=$=>{n.errors=$,I.state.next({errors:n.errors,isValid:!1})},H=($,Q,ue,Ce)=>{const we=Le(r,$);if(we){const pe=Le(s,$,Ln(ue)?Le(i,$):ue);Ln(pe)||Ce&&Ce.defaultChecked||Q?en(s,$,Q?pe:fv(we._f)):ze($,pe),l.mount&&D()}},Y=($,Q,ue,Ce,we)=>{let pe=!1,be=!1;const We={name:$};if(!e.disabled){if(!ue||Ce){(x.isDirty||_.isDirty)&&(be=n.isDirty,n.isDirty=We.isDirty=K(),pe=be!==We.isDirty);const Ge=Go(Le(i,$),Q);be=!!Le(n.dirtyFields,$),Ge?On(n.dirtyFields,$):en(n.dirtyFields,$,!0),We.dirtyFields=n.dirtyFields,pe=pe||(x.dirtyFields||_.dirtyFields)&&be!==!Ge}if(ue){const Ge=Le(n.touchedFields,$);Ge||(en(n.touchedFields,$,ue),We.touchedFields=n.touchedFields,pe=pe||(x.touchedFields||_.touchedFields)&&Ge!==ue)}pe&&we&&I.state.next(We)}return pe?We:{}},J=($,Q,ue,Ce)=>{const we=Le(n.errors,$),pe=(x.isValid||_.isValid)&&hs(Q)&&n.isValid!==Q;if(e.delayError&&ue?(f=B(()=>P($,ue)),f(e.delayError)):(clearTimeout(m),f=null,ue?en(n.errors,$,ue):On(n.errors,$)),(ue?!Go(we,ue):we)||!zr(Ce)||pe){const be={...Ce,...pe&&hs(Q)?{isValid:Q}:{},errors:n.errors,name:$};n={...n,...be},I.state.next(be)}},k=async $=>{G($,!0);const Q=await e.resolver(s,e.context,a7($||h.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return G($),Q},M=async $=>{const{errors:Q}=await k($);if($)for(const ue of $){const Ce=Le(Q,ue);Ce?en(n.errors,ue,Ce):On(n.errors,ue)}else n.errors=Q;return Q},L=async($,Q,ue={valid:!0})=>{for(const Ce in $){const we=$[Ce];if(we){const{_f:pe,...be}=we;if(pe){const We=h.array.has(pe.name),Ge=we._f&&l7(we._f);Ge&&x.validatingFields&&G([pe.name],!0);const Et=await xv(we,h.disabled,s,R,e.shouldUseNativeValidation&&!Q,We);if(Ge&&x.validatingFields&&G([pe.name]),Et[pe.name]&&(ue.valid=!1,Q))break;!Q&&(Le(Et,pe.name)?We?g7(n.errors,Et,pe.name):en(n.errors,pe.name,Et[pe.name]):On(n.errors,pe.name))}!zr(be)&&await L(be,Q,ue)}}return ue.valid},W=()=>{for(const $ of h.unMount){const Q=Le(r,$);Q&&(Q._f.refs?Q._f.refs.every(ue=>!Em(ue)):!Em(Q._f.ref))&&Qn($)}h.unMount=new Set},K=($,Q)=>!e.disabled&&($&&Q&&en(s,$,Q),!Go(Ue(),i)),q=($,Q,ue)=>t7($,h,{...l.mount?s:Ln(Q)?i:oi($)?{[$]:Q}:Q},ue,Q),j=$=>Nx(Le(l.mount?s:i,$,e.shouldUnregister?Le(i,$,[]):[])),ze=($,Q,ue={})=>{const Ce=Le(r,$);let we=Q;if(Ce){const pe=Ce._f;pe&&(!pe.disabled&&en(s,$,i3(Q,pe)),we=p1(pe.ref)&&Nr(Q)?"":Q,t3(pe.ref)?[...pe.ref.options].forEach(be=>be.selected=we.includes(be.value)):pe.refs?Zd(pe.ref)?pe.refs.forEach(be=>{(!be.defaultChecked||!be.disabled)&&(Array.isArray(we)?be.checked=!!we.find(We=>We===be.value):be.checked=we===be.value||!!we)}):pe.refs.forEach(be=>be.checked=be.value===we):Dx(pe.ref)?pe.ref.value="":(pe.ref.value=we,pe.ref.type||I.state.next({name:$,values:Xn(s)})))}(ue.shouldDirty||ue.shouldTouch)&&Y($,we,ue.shouldTouch,ue.shouldDirty,!0),ue.shouldValidate&&Me($)},ie=($,Q,ue)=>{for(const Ce in Q){if(!Q.hasOwnProperty(Ce))return;const we=Q[Ce],pe=$+"."+Ce,be=Le(r,pe);(h.array.has($)||Vn(we)||be&&!be._f)&&!sl(we)?ie(pe,we,ue):ze(pe,we,ue)}},rt=($,Q,ue={})=>{const Ce=Le(r,$),we=h.array.has($),pe=Xn(Q);en(s,$,pe),we?(I.array.next({name:$,values:Xn(s)}),(x.isDirty||x.dirtyFields||_.isDirty||_.dirtyFields)&&ue.shouldDirty&&I.state.next({name:$,dirtyFields:fc(i,s),isDirty:K($,pe)})):Ce&&!Ce._f&&!Nr(pe)?ie($,pe,ue):ze($,pe,ue),pv($,h)&&I.state.next({...n,name:$}),I.state.next({name:l.mount?$:void 0,values:Xn(s)})},Oe=async $=>{l.mount=!0;const Q=$.target;let ue=Q.name,Ce=!0;const we=Le(r,ue),pe=Ge=>{Ce=Number.isNaN(Ge)||sl(Ge)&&isNaN(Ge.getTime())||Go(Ge,Le(s,ue,Ge))},be=gv(e.mode),We=gv(e.reValidateMode);if(we){let Ge,Et;const Ji=Q.type?fv(we._f):$L($),gr=$.type===lv.BLUR||$.type===lv.FOCUS_OUT,Lu=!c7(we._f)&&!e.resolver&&!Le(n.errors,ue)&&!we._f.deps||d7(gr,Le(n.touchedFields,ue),n.isSubmitted,We,be),bt=pv(ue,h,gr);en(s,ue,Ji),gr?(!Q||!Q.readOnly)&&(we._f.onBlur&&we._f.onBlur($),f&&f(0)):we._f.onChange&&we._f.onChange($);const Ee=Y(ue,Ji,gr),Jt=!zr(Ee)||bt;if(!gr&&I.state.next({name:ue,type:$.type,values:Xn(s)}),Lu)return(x.isValid||_.isValid)&&(e.mode==="onBlur"?gr&&D():gr||D()),Jt&&I.state.next({name:ue,...bt?{}:Ee});if(!gr&&bt&&I.state.next({...n}),e.resolver){const{errors:pt}=await k([ue]);if(pe(Ji),Ce){const Gt=yv(n.errors,r,ue),es=yv(pt,r,Gt.name||ue);Ge=es.error,ue=es.name,Et=zr(pt)}}else G([ue],!0),Ge=(await xv(we,h.disabled,s,R,e.shouldUseNativeValidation))[ue],G([ue]),pe(Ji),Ce&&(Ge?Et=!1:(x.isValid||_.isValid)&&(Et=await L(r,!0)));Ce&&(we._f.deps&&(!Array.isArray(we._f.deps)||we._f.deps.length>0)&&Me(we._f.deps),J(ue,Et,Ge,Ee))}},Ie=($,Q)=>{if(Le(n.errors,Q)&&$.focus)return $.focus(),1},Me=async($,Q={})=>{let ue,Ce;const we=Lh($);if(e.resolver){const pe=await M(Ln($)?$:we);ue=zr(pe),Ce=$?!we.some(be=>Le(pe,be)):ue}else $?(Ce=(await Promise.all(we.map(async pe=>{const be=Le(r,pe);return await L(be&&be._f?{[pe]:be}:be)}))).every(Boolean),!(!Ce&&!n.isValid)&&D()):Ce=ue=await L(r);return I.state.next({...!oi($)||(x.isValid||_.isValid)&&ue!==n.isValid?{}:{name:$},...e.resolver||!$?{isValid:ue}:{},errors:n.errors}),Q.shouldFocus&&!Ce&&Fh(r,Ie,$?we:h.mount),Ce},Ue=($,Q)=>{let ue={...l.mount?s:i};return Q&&(ue=e3(Q.dirtyFields?n.dirtyFields:n.touchedFields,ue)),Ln($)?ue:oi($)?Le(ue,$):$.map(Ce=>Le(ue,Ce))},Rt=($,Q)=>({invalid:!!Le((Q||n).errors,$),isDirty:!!Le((Q||n).dirtyFields,$),error:Le((Q||n).errors,$),isValidating:!!Le(n.validatingFields,$),isTouched:!!Le((Q||n).touchedFields,$)}),Xe=$=>{$&&Lh($).forEach(Q=>On(n.errors,Q)),I.state.next({errors:$?n.errors:{}})},Tt=($,Q,ue)=>{const Ce=(Le(r,$,{_f:{}})._f||{}).ref,we=Le(n.errors,$)||{},{ref:pe,message:be,type:We,...Ge}=we;en(n.errors,$,{...Ge,...Q,ref:Ce}),I.state.next({name:$,errors:n.errors,isValid:!1}),ue&&ue.shouldFocus&&Ce&&Ce.focus&&Ce.focus()},Vt=($,Q)=>Wi($)?I.state.subscribe({next:ue=>"values"in ue&&$(q(void 0,Q),ue)}):q($,Q,!0),fr=$=>I.state.subscribe({next:Q=>{h7($.name,Q.name,$.exact)&&u7(Q,$.formState||x,mn,$.reRenderRoot)&&$.callback({values:{...s},...n,...Q,defaultValues:i})}}).unsubscribe,ke=$=>(l.mount=!0,_={..._,...$.formState},fr({...$,formState:_})),Qn=($,Q={})=>{for(const ue of $?Lh($):h.mount)h.mount.delete(ue),h.array.delete(ue),Q.keepValue||(On(r,ue),On(s,ue)),!Q.keepError&&On(n.errors,ue),!Q.keepDirty&&On(n.dirtyFields,ue),!Q.keepTouched&&On(n.touchedFields,ue),!Q.keepIsValidating&&On(n.validatingFields,ue),!e.shouldUnregister&&!Q.keepDefaultValue&&On(i,ue);I.state.next({values:Xn(s)}),I.state.next({...n,...Q.keepDirty?{isDirty:K()}:{}}),!Q.keepIsValid&&D()},an=({disabled:$,name:Q})=>{(hs($)&&l.mount||$||h.disabled.has(Q))&&($?h.disabled.add(Q):h.disabled.delete(Q))},Si=($,Q={})=>{let ue=Le(r,$);const Ce=hs(Q.disabled)||hs(e.disabled);return en(r,$,{...ue||{},_f:{...ue&&ue._f?ue._f:{ref:{name:$}},name:$,mount:!0,...Q}}),h.mount.add($),ue?an({disabled:hs(Q.disabled)?Q.disabled:e.disabled,name:$}):H($,!0,Q.value),{...Ce?{disabled:Q.disabled||e.disabled}:{},...e.progressive?{required:!!Q.required,min:uh(Q.min),max:uh(Q.max),minLength:uh(Q.minLength),maxLength:uh(Q.maxLength),pattern:uh(Q.pattern)}:{},name:$,onChange:Oe,onBlur:Oe,ref:we=>{if(we){Si($,Q),ue=Le(r,$);const pe=Ln(we.value)&&we.querySelectorAll&&we.querySelectorAll("input,select,textarea")[0]||we,be=r7(pe),We=ue._f.refs||[];if(be?We.find(Ge=>Ge===pe):pe===ue._f.ref)return;en(r,$,{_f:{...ue._f,...be?{refs:[...We.filter(Em),pe,...Array.isArray(Le(i,$))?[{}]:[]],ref:{type:pe.type,name:$}}:{ref:pe}}}),H($,!1,void 0,pe)}else ue=Le(r,$,{}),ue._f&&(ue._f.mount=!1),(e.shouldUnregister||Q.shouldUnregister)&&!(XL(h.array,$)&&l.action)&&h.unMount.add($)}}},Mr=()=>e.shouldFocusError&&Fh(r,Ie,h.mount),An=$=>{hs($)&&(I.state.next({disabled:$}),Fh(r,(Q,ue)=>{const Ce=Le(r,ue);Ce&&(Q.disabled=Ce._f.disabled||$,Array.isArray(Ce._f.refs)&&Ce._f.refs.forEach(we=>{we.disabled=Ce._f.disabled||$}))},0,!1))},bi=($,Q)=>async ue=>{let Ce;ue&&(ue.preventDefault&&ue.preventDefault(),ue.persist&&ue.persist());let we=Xn(s);if(I.state.next({isSubmitting:!0}),e.resolver){const{errors:pe,values:be}=await k();n.errors=pe,we=Xn(be)}else await L(r);if(h.disabled.size)for(const pe of h.disabled)On(we,pe);if(On(n.errors,"root"),zr(n.errors)){I.state.next({errors:{}});try{await $(we,ue)}catch(pe){Ce=pe}}else Q&&await Q({...n.errors},ue),Mr(),setTimeout(Mr);if(I.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:zr(n.errors)&&!Ce,submitCount:n.submitCount+1,errors:n.errors}),Ce)throw Ce},ot=($,Q={})=>{Le(r,$)&&(Ln(Q.defaultValue)?rt($,Xn(Le(i,$))):(rt($,Q.defaultValue),en(i,$,Xn(Q.defaultValue))),Q.keepTouched||On(n.touchedFields,$),Q.keepDirty||(On(n.dirtyFields,$),n.isDirty=Q.defaultValue?K($,Xn(Le(i,$))):K()),Q.keepError||(On(n.errors,$),x.isValid&&D()),I.state.next({...n}))},Yr=($,Q={})=>{const ue=$?Xn($):i,Ce=Xn(ue),we=zr($),pe=we?i:Ce;if(Q.keepDefaultValues||(i=ue),!Q.keepValues){if(Q.keepDirtyValues){const be=new Set([...h.mount,...Object.keys(fc(i,s))]);for(const We of Array.from(be))Le(n.dirtyFields,We)?en(pe,We,Le(s,We)):rt(We,Le(pe,We))}else{if(Rx&&Ln($))for(const be of h.mount){const We=Le(r,be);if(We&&We._f){const Ge=Array.isArray(We._f.refs)?We._f.refs[0]:We._f.ref;if(p1(Ge)){const Et=Ge.closest("form");if(Et){Et.reset();break}}}}if(Q.keepFieldsRef)for(const be of h.mount)rt(be,Le(pe,be));else r={}}s=e.shouldUnregister?Q.keepDefaultValues?Xn(i):{}:Xn(pe),I.array.next({values:{...pe}}),I.state.next({values:{...pe}})}h={mount:Q.keepDirtyValues?h.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},l.mount=!x.isValid||!!Q.keepIsValid||!!Q.keepDirtyValues,l.watch=!!e.shouldUnregister,I.state.next({submitCount:Q.keepSubmitCount?n.submitCount:0,isDirty:we?!1:Q.keepDirty?n.isDirty:!!(Q.keepDefaultValues&&!Go($,i)),isSubmitted:Q.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:we?{}:Q.keepDirtyValues?Q.keepDefaultValues&&s?fc(i,s):n.dirtyFields:Q.keepDefaultValues&&$?fc(i,$):Q.keepDirty?n.dirtyFields:{},touchedFields:Q.keepTouched?n.touchedFields:{},errors:Q.keepErrors?n.errors:{},isSubmitSuccessful:Q.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},rr=($,Q)=>Yr(Wi($)?$(s):$,Q),Zi=($,Q={})=>{const ue=Le(r,$),Ce=ue&&ue._f;if(Ce){const we=Ce.refs?Ce.refs[0]:Ce.ref;we.focus&&(we.focus(),Q.shouldSelect&&Wi(we.select)&&we.select())}},mn=$=>{n={...n,...$}},it={control:{register:Si,unregister:Qn,getFieldState:Rt,handleSubmit:bi,setError:Tt,_subscribe:fr,_runSchema:k,_focusError:Mr,_getWatch:q,_getDirty:K,_setValid:D,_setFieldArray:F,_setDisabledField:an,_setErrors:N,_getFieldArray:j,_reset:Yr,_resetDefaultValues:()=>Wi(e.defaultValues)&&e.defaultValues().then($=>{rr($,e.resetOptions),I.state.next({isLoading:!1})}),_removeUnmounted:W,_disableForm:An,_subjects:I,_proxyFormState:x,get _fields(){return r},get _formValues(){return s},get _state(){return l},set _state($){l=$},get _defaultValues(){return i},get _names(){return h},set _names($){h=$},get _formState(){return n},get _options(){return e},set _options($){e={...e,...$}}},subscribe:ke,trigger:Me,register:Si,handleSubmit:bi,watch:Vt,setValue:rt,getValues:Ue,reset:rr,resetField:ot,clearErrors:Xe,unregister:Qn,setError:Tt,setFocus:Zi,getFieldState:Rt};return{...it,formControl:it}}function Jd(t={}){const e=_r.useRef(void 0),n=_r.useRef(void 0),[r,i]=_r.useState({isDirty:!1,isValidating:!1,isLoading:Wi(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Wi(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!Wi(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:l,...h}=p7(t);e.current={...h,formState:r}}const s=e.current.control;return s._options=t,e7(()=>{const l=s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0});return i(h=>({...h,isReady:!0})),s._formState.isReady=!0,l},[s]),_r.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),_r.useEffect(()=>{t.mode&&(s._options.mode=t.mode),t.reValidateMode&&(s._options.reValidateMode=t.reValidateMode)},[s,t.mode,t.reValidateMode]),_r.useEffect(()=>{t.errors&&(s._setErrors(t.errors),s._focusError())},[s,t.errors]),_r.useEffect(()=>{t.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,t.shouldUnregister]),_r.useEffect(()=>{if(s._proxyFormState.isDirty){const l=s._getDirty();l!==r.isDirty&&s._subjects.state.next({isDirty:l})}},[s,r.isDirty]),_r.useEffect(()=>{t.values&&!Go(t.values,n.current)?(s._reset(t.values,{keepFieldsRef:!0,...s._options.resetOptions}),n.current=t.values,i(l=>({...l}))):s._resetDefaultValues()},[s,t.values]),_r.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=JL(r,s),e.current}const y7=({onSuccess:t,onSwitchToRegister:e})=>{const{login:n,loading:r,error:i,clearError:s}=ks(),[l,h]=oe.useState(!1),{register:f,handleSubmit:m,formState:{errors:x},watch:_}=Jd(),I=async R=>{try{h(!0),s(),await n(R),Qe.success("Login successful!"),t==null||t()}catch(B){Qe.error(B.message||"Login failed")}finally{h(!1)}};return A.jsx("div",{className:"w-full max-w-md mx-auto",children:A.jsxs("div",{className:"card",children:[A.jsxs("div",{className:"card-header",children:[A.jsx("h2",{className:"text-2xl font-bold text-center",children:"Sign In"}),A.jsx("p",{className:"text-center text-secondary-600 mt-2",children:"Sign in to your archaeological artifacts account"})]}),A.jsxs("form",{onSubmit:m(I),className:"card-content space-y-4",children:[i&&A.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:A.jsx("p",{className:"text-red-800 text-sm",children:i.message})}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Email Address"}),A.jsx("input",{...f("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),type:"email",id:"email",className:"input",placeholder:"archaeologist@university.edu"}),x.email&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.email.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Password"}),A.jsx("input",{...f("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",id:"password",className:"input",placeholder:"Enter your password"}),x.password&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.password.message})]}),A.jsx("button",{type:"submit",disabled:l||r,className:"btn btn-primary btn-md w-full",children:l?"Signing In...":"Sign In"})]}),A.jsx("div",{className:"card-footer",children:A.jsxs("p",{className:"text-center text-sm text-secondary-600",children:["Don't have an account?"," ",A.jsx("button",{type:"button",onClick:e,className:"text-primary-600 hover:text-primary-700 font-medium",children:"Register here"})]})})]})})},w7=({onSuccess:t,onSwitchToLogin:e})=>{const{register:n,loading:r,error:i,clearError:s}=ks(),[l,h]=oe.useState(!1),{register:f,handleSubmit:m,formState:{errors:x},watch:_}=Jd(),I=_("password"),R=async D=>{try{h(!0),s();const{confirmPassword:G,...F}=D;await n(F),Qe.success("Registration successful!"),t==null||t()}catch(G){Qe.error(G.message||"Registration failed")}finally{h(!1)}},B=[{value:"researcher",label:"Researcher",description:"Read-only access to artifacts"},{value:"archaeologist",label:"Archaeologist",description:"Create and edit artifacts"},{value:"admin",label:"Administrator",description:"Full system access"}];return A.jsx("div",{className:"w-full max-w-md mx-auto",children:A.jsxs("div",{className:"card",children:[A.jsxs("div",{className:"card-header",children:[A.jsx("h2",{className:"text-2xl font-bold text-center",children:"Create Account"}),A.jsx("p",{className:"text-center text-secondary-600 mt-2",children:"Join the archaeological artifacts management system"})]}),A.jsxs("form",{onSubmit:m(R),className:"card-content space-y-4",children:[i&&A.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:A.jsx("p",{className:"text-red-800 text-sm",children:i.message})}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Email Address"}),A.jsx("input",{...f("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),type:"email",id:"email",className:"input",placeholder:"archaeologist@university.edu"}),x.email&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.email.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Username"}),A.jsx("input",{...f("username",{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"},maxLength:{value:50,message:"Username must be less than 50 characters"},pattern:{value:/^[a-zA-Z0-9_]+$/,message:"Username can only contain letters, numbers, and underscores"}}),type:"text",id:"username",className:"input",placeholder:"archaeologist_jane"}),x.username&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.username.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Display Name (Optional)"}),A.jsx("input",{...f("displayName",{maxLength:{value:100,message:"Display name must be less than 100 characters"}}),type:"text",id:"displayName",className:"input",placeholder:"Dr. Jane Smith"}),x.displayName&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.displayName.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Role"}),A.jsxs("select",{...f("role",{required:"Role is required"}),id:"role",className:"input",children:[A.jsx("option",{value:"",children:"Select a role"}),B.map(D=>A.jsxs("option",{value:D.value,children:[D.label," - ",D.description]},D.value))]}),x.role&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.role.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Password"}),A.jsx("input",{...f("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",id:"password",className:"input",placeholder:"Enter your password"}),x.password&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.password.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-secondary-700 mb-1",children:"Confirm Password"}),A.jsx("input",{...f("confirmPassword",{required:"Please confirm your password",validate:D=>D===I||"Passwords do not match"}),type:"password",id:"confirmPassword",className:"input",placeholder:"Confirm your password"}),x.confirmPassword&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:x.confirmPassword.message})]}),A.jsx("button",{type:"submit",disabled:l||r,className:"btn btn-primary btn-md w-full",children:l?"Creating Account...":"Create Account"})]}),A.jsx("div",{className:"card-footer",children:A.jsxs("p",{className:"text-center text-sm text-secondary-600",children:["Already have an account?"," ",A.jsx("button",{type:"button",onClick:e,className:"text-primary-600 hover:text-primary-700 font-medium",children:"Sign in here"})]})})]})})},x7=()=>{const{isAuthenticated:t}=ks(),[e,n]=oe.useState(!0);return t?A.jsx(ni,{to:"/dashboard",replace:!0}):A.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:A.jsxs("div",{className:"max-w-md w-full space-y-8",children:[A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-primary-100",children:A.jsx("svg",{className:"h-8 w-8 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),A.jsx("h1",{className:"mt-6 text-3xl font-extrabold text-secondary-900",children:"Archaeological Artifacts Scanner"}),A.jsx("p",{className:"mt-2 text-sm text-secondary-600",children:"Manage and scan archaeological artifacts with QR codes"})]}),e?A.jsx(y7,{onSwitchToRegister:()=>n(!1)}):A.jsx(w7,{onSwitchToLogin:()=>n(!0)}),A.jsx("div",{className:"mt-8 text-center",children:A.jsxs("div",{className:"text-xs text-secondary-500",children:[A.jsx("p",{children:"Demo Credentials:"}),A.jsxs("p",{className:"mt-1",children:[A.jsx("strong",{children:"Admin:"})," admin@university.edu / admin123"]}),A.jsxs("p",{children:[A.jsx("strong",{children:"Archaeologist:"})," archaeologist@university.edu / archaeologist123"]}),A.jsxs("p",{children:[A.jsx("strong",{children:"Researcher:"})," researcher@university.edu / researcher123"]})]})})]})})},ef=({size:t="md",className:e="",text:n})=>{const r={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return A.jsxs("div",{className:`flex flex-col items-center justify-center ${e}`,children:[A.jsx("div",{className:`animate-spin rounded-full border-2 border-primary-200 border-t-primary-600 ${r[t]}`}),n&&A.jsx("p",{className:"mt-2 text-sm text-secondary-600",children:n})]})},_7=()=>{const{user:t,loading:e}=ks(),n=fi();return e?A.jsx(ef,{text:"Loading dashboard..."}):A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("div",{className:"mb-8",children:[A.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",(t==null?void 0:t.displayName)||(t==null?void 0:t.username),"!"]}),A.jsx("p",{className:"mt-2 text-gray-600",children:"Manage your archaeological artifacts and discoveries"})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Total Artifacts"}),A.jsx("p",{className:"text-3xl font-bold text-primary-600",children:"0"}),A.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Artifacts in your collection"})]})}),A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Recent Discoveries"}),A.jsx("p",{className:"text-3xl font-bold text-green-600",children:"0"}),A.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This month"})]})}),A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Photos Uploaded"}),A.jsx("p",{className:"text-3xl font-bold text-blue-600",children:"0"}),A.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Total photos"})]})})]}),A.jsxs("div",{className:"mt-8",children:[A.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Quick Actions"}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[A.jsx("button",{onClick:()=>n("/artifacts/new"),className:"btn btn-primary btn-lg",children:"Add New Artifact"}),A.jsx("button",{onClick:()=>n("/scanner"),className:"btn btn-outline btn-lg",children:"Scan QR Code"}),A.jsx("button",{onClick:()=>n("/artifacts"),className:"btn btn-outline btn-lg",children:"View All Artifacts"}),A.jsx("button",{onClick:()=>alert("Photo upload will be available soon!"),className:"btn btn-outline btn-lg",children:"Upload Photos"})]})]})]})})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v7=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),on=(t,e)=>{const n=oe.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:h="",children:f,...m},x)=>oe.createElement("svg",{ref:x,...E7,width:i,height:i,stroke:r,strokeWidth:l?Number(s)*24/Number(i):s,className:["lucide",`lucide-${v7(t)}`,h].join(" "),...m},[...e.map(([_,I])=>oe.createElement(_,I)),...Array.isArray(f)?f:[f]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=on("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I7=on("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=on("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=on("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=on("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A7=on("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T7=on("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C7=on("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=on("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S7=on("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=on("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=on("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=on("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b7=on("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vv=on("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R7=on("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N7=on("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=on("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P7=on("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D7=on("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=on("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=on("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=on("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k7=on("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var kl={},O7=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},h3={},gi={};let Mx;const M7=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];gi.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};gi.getSymbolTotalCodewords=function(e){return M7[e]};gi.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};gi.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Mx=e};gi.isKanjiModeEnabled=function(){return typeof Mx<"u"};gi.toSJIS=function(e){return Mx(e)};var vg={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+n)}}t.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},t.from=function(r,i){if(t.isValid(r))return r;try{return e(r)}catch{return i}}})(vg);function d3(){this.buffer=[],this.length=0}d3.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let n=0;n<e;n++)this.putBit((t>>>e-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var L7=d3;function tf(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}tf.prototype.set=function(t,e,n,r){const i=t*this.size+e;this.data[i]=n,r&&(this.reservedBit[i]=!0)};tf.prototype.get=function(t,e){return this.data[t*this.size+e]};tf.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n};tf.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var F7=tf,f3={};(function(t){const e=gi.getSymbolSize;t.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,s=e(r),l=s===145?26:Math.ceil((s-13)/(2*i-2))*2,h=[s-7];for(let f=1;f<i-1;f++)h[f]=h[f-1]-l;return h.push(6),h.reverse()},t.getPositions=function(r){const i=[],s=t.getRowColCoords(r),l=s.length;for(let h=0;h<l;h++)for(let f=0;f<l;f++)h===0&&f===0||h===0&&f===l-1||h===l-1&&f===0||i.push([s[h],s[f]]);return i}})(f3);var g3={};const V7=gi.getSymbolSize,Iv=7;g3.getPositions=function(e){const n=V7(e);return[[0,0],[n-Iv,0],[0,n-Iv]]};var m3={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},t.from=function(i){return t.isValid(i)?parseInt(i,10):void 0},t.getPenaltyN1=function(i){const s=i.size;let l=0,h=0,f=0,m=null,x=null;for(let _=0;_<s;_++){h=f=0,m=x=null;for(let I=0;I<s;I++){let R=i.get(_,I);R===m?h++:(h>=5&&(l+=e.N1+(h-5)),m=R,h=1),R=i.get(I,_),R===x?f++:(f>=5&&(l+=e.N1+(f-5)),x=R,f=1)}h>=5&&(l+=e.N1+(h-5)),f>=5&&(l+=e.N1+(f-5))}return l},t.getPenaltyN2=function(i){const s=i.size;let l=0;for(let h=0;h<s-1;h++)for(let f=0;f<s-1;f++){const m=i.get(h,f)+i.get(h,f+1)+i.get(h+1,f)+i.get(h+1,f+1);(m===4||m===0)&&l++}return l*e.N2},t.getPenaltyN3=function(i){const s=i.size;let l=0,h=0,f=0;for(let m=0;m<s;m++){h=f=0;for(let x=0;x<s;x++)h=h<<1&2047|i.get(m,x),x>=10&&(h===1488||h===93)&&l++,f=f<<1&2047|i.get(x,m),x>=10&&(f===1488||f===93)&&l++}return l*e.N3},t.getPenaltyN4=function(i){let s=0;const l=i.data.length;for(let f=0;f<l;f++)s+=i.data[f];return Math.abs(Math.ceil(s*100/l/5)-10)*e.N4};function n(r,i,s){switch(r){case t.Patterns.PATTERN000:return(i+s)%2===0;case t.Patterns.PATTERN001:return i%2===0;case t.Patterns.PATTERN010:return s%3===0;case t.Patterns.PATTERN011:return(i+s)%3===0;case t.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(s/3))%2===0;case t.Patterns.PATTERN101:return i*s%2+i*s%3===0;case t.Patterns.PATTERN110:return(i*s%2+i*s%3)%2===0;case t.Patterns.PATTERN111:return(i*s%3+(i+s)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}t.applyMask=function(i,s){const l=s.size;for(let h=0;h<l;h++)for(let f=0;f<l;f++)s.isReserved(f,h)||s.xor(f,h,n(i,f,h))},t.getBestMask=function(i,s){const l=Object.keys(t.Patterns).length;let h=0,f=1/0;for(let m=0;m<l;m++){s(m),t.applyMask(m,i);const x=t.getPenaltyN1(i)+t.getPenaltyN2(i)+t.getPenaltyN3(i)+t.getPenaltyN4(i);t.applyMask(m,i),x<f&&(f=x,h=m)}return h}})(m3);var Ig={};const ea=vg,Wf=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],qf=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Ig.getBlocksCount=function(e,n){switch(n){case ea.L:return Wf[(e-1)*4+0];case ea.M:return Wf[(e-1)*4+1];case ea.Q:return Wf[(e-1)*4+2];case ea.H:return Wf[(e-1)*4+3];default:return}};Ig.getTotalCodewordsCount=function(e,n){switch(n){case ea.L:return qf[(e-1)*4+0];case ea.M:return qf[(e-1)*4+1];case ea.Q:return qf[(e-1)*4+2];case ea.H:return qf[(e-1)*4+3];default:return}};var p3={},Ag={};const Vh=new Uint8Array(512),x1=new Uint8Array(256);(function(){let e=1;for(let n=0;n<255;n++)Vh[n]=e,x1[e]=n,e<<=1,e&256&&(e^=285);for(let n=255;n<512;n++)Vh[n]=Vh[n-255]})();Ag.log=function(e){if(e<1)throw new Error("log("+e+")");return x1[e]};Ag.exp=function(e){return Vh[e]};Ag.mul=function(e,n){return e===0||n===0?0:Vh[x1[e]+x1[n]]};(function(t){const e=Ag;t.mul=function(r,i){const s=new Uint8Array(r.length+i.length-1);for(let l=0;l<r.length;l++)for(let h=0;h<i.length;h++)s[l+h]^=e.mul(r[l],i[h]);return s},t.mod=function(r,i){let s=new Uint8Array(r);for(;s.length-i.length>=0;){const l=s[0];for(let f=0;f<i.length;f++)s[f]^=e.mul(i[f],l);let h=0;for(;h<s.length&&s[h]===0;)h++;s=s.slice(h)}return s},t.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let s=0;s<r;s++)i=t.mul(i,new Uint8Array([1,e.exp(s)]));return i}})(p3);const y3=p3;function Lx(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}Lx.prototype.initialize=function(e){this.degree=e,this.genPoly=y3.generateECPolynomial(this.degree)};Lx.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const n=new Uint8Array(e.length+this.degree);n.set(e);const r=y3.mod(n,this.genPoly),i=this.degree-r.length;if(i>0){const s=new Uint8Array(this.degree);return s.set(r,i),s}return r};var B7=Lx,w3={},Oa={},Fx={};Fx.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var Os={};const x3="[0-9]+",U7="[A-Z $%*+\\-./:]+";let _d="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";_d=_d.replace(/u/g,"\\u");const j7="(?:(?![A-Z0-9 $%*+\\-./:]|"+_d+`)(?:.|[\r
]))+`;Os.KANJI=new RegExp(_d,"g");Os.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Os.BYTE=new RegExp(j7,"g");Os.NUMERIC=new RegExp(x3,"g");Os.ALPHANUMERIC=new RegExp(U7,"g");const z7=new RegExp("^"+_d+"$"),G7=new RegExp("^"+x3+"$"),H7=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Os.testKanji=function(e){return z7.test(e)};Os.testNumeric=function(e){return G7.test(e)};Os.testAlphanumeric=function(e){return H7.test(e)};(function(t){const e=Fx,n=Os;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(s,l){if(!s.ccBits)throw new Error("Invalid mode: "+s);if(!e.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?s.ccBits[0]:l<27?s.ccBits[1]:s.ccBits[2]},t.getBestModeForData=function(s){return n.testNumeric(s)?t.NUMERIC:n.testAlphanumeric(s)?t.ALPHANUMERIC:n.testKanji(s)?t.KANJI:t.BYTE},t.toString=function(s){if(s&&s.id)return s.id;throw new Error("Invalid mode")},t.isValid=function(s){return s&&s.bit&&s.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+i)}}t.from=function(s,l){if(t.isValid(s))return s;try{return r(s)}catch{return l}}})(Oa);(function(t){const e=gi,n=Ig,r=vg,i=Oa,s=Fx,l=7973,h=e.getBCHDigit(l);function f(I,R,B){for(let D=1;D<=40;D++)if(R<=t.getCapacity(D,B,I))return D}function m(I,R){return i.getCharCountIndicator(I,R)+4}function x(I,R){let B=0;return I.forEach(function(D){const G=m(D.mode,R);B+=G+D.getBitsLength()}),B}function _(I,R){for(let B=1;B<=40;B++)if(x(I,B)<=t.getCapacity(B,R,i.MIXED))return B}t.from=function(R,B){return s.isValid(R)?parseInt(R,10):B},t.getCapacity=function(R,B,D){if(!s.isValid(R))throw new Error("Invalid QR Code version");typeof D>"u"&&(D=i.BYTE);const G=e.getSymbolTotalCodewords(R),F=n.getTotalCodewordsCount(R,B),P=(G-F)*8;if(D===i.MIXED)return P;const N=P-m(D,R);switch(D){case i.NUMERIC:return Math.floor(N/10*3);case i.ALPHANUMERIC:return Math.floor(N/11*2);case i.KANJI:return Math.floor(N/13);case i.BYTE:default:return Math.floor(N/8)}},t.getBestVersionForData=function(R,B){let D;const G=r.from(B,r.M);if(Array.isArray(R)){if(R.length>1)return _(R,G);if(R.length===0)return 1;D=R[0]}else D=R;return f(D.mode,D.getLength(),G)},t.getEncodedBits=function(R){if(!s.isValid(R)||R<7)throw new Error("Invalid QR Code version");let B=R<<12;for(;e.getBCHDigit(B)-h>=0;)B^=l<<e.getBCHDigit(B)-h;return R<<12|B}})(w3);var _3={};const cy=gi,E3=1335,W7=21522,Av=cy.getBCHDigit(E3);_3.getEncodedBits=function(e,n){const r=e.bit<<3|n;let i=r<<10;for(;cy.getBCHDigit(i)-Av>=0;)i^=E3<<cy.getBCHDigit(i)-Av;return(r<<10|i)^W7};var v3={};const q7=Oa;function pu(t){this.mode=q7.NUMERIC,this.data=t.toString()}pu.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};pu.prototype.getLength=function(){return this.data.length};pu.prototype.getBitsLength=function(){return pu.getBitsLength(this.data.length)};pu.prototype.write=function(e){let n,r,i;for(n=0;n+3<=this.data.length;n+=3)r=this.data.substr(n,3),i=parseInt(r,10),e.put(i,10);const s=this.data.length-n;s>0&&(r=this.data.substr(n),i=parseInt(r,10),e.put(i,s*3+1))};var K7=pu;const $7=Oa,Im=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function yu(t){this.mode=$7.ALPHANUMERIC,this.data=t}yu.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};yu.prototype.getLength=function(){return this.data.length};yu.prototype.getBitsLength=function(){return yu.getBitsLength(this.data.length)};yu.prototype.write=function(e){let n;for(n=0;n+2<=this.data.length;n+=2){let r=Im.indexOf(this.data[n])*45;r+=Im.indexOf(this.data[n+1]),e.put(r,11)}this.data.length%2&&e.put(Im.indexOf(this.data[n]),6)};var Q7=yu;const X7=Oa;function wu(t){this.mode=X7.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}wu.getBitsLength=function(e){return e*8};wu.prototype.getLength=function(){return this.data.length};wu.prototype.getBitsLength=function(){return wu.getBitsLength(this.data.length)};wu.prototype.write=function(t){for(let e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)};var Y7=wu;const Z7=Oa,J7=gi;function xu(t){this.mode=Z7.KANJI,this.data=t}xu.getBitsLength=function(e){return e*13};xu.prototype.getLength=function(){return this.data.length};xu.prototype.getBitsLength=function(){return xu.getBitsLength(this.data.length)};xu.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let n=J7.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),t.put(n,13)}};var eF=xu,I3={exports:{}};(function(t){var e={single_source_shortest_paths:function(n,r,i){var s={},l={};l[r]=0;var h=e.PriorityQueue.make();h.push(r,0);for(var f,m,x,_,I,R,B,D,G;!h.empty();){f=h.pop(),m=f.value,_=f.cost,I=n[m]||{};for(x in I)I.hasOwnProperty(x)&&(R=I[x],B=_+R,D=l[x],G=typeof l[x]>"u",(G||D>B)&&(l[x]=B,h.push(x,B),s[x]=m))}if(typeof i<"u"&&typeof l[i]>"u"){var F=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(F)}return s},extract_shortest_path_from_predecessor_list:function(n,r){for(var i=[],s=r;s;)i.push(s),n[s],s=n[s];return i.reverse(),i},find_path:function(n,r,i){var s=e.single_source_shortest_paths(n,r,i);return e.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(n){var r=e.PriorityQueue,i={},s;n=n||{};for(s in r)r.hasOwnProperty(s)&&(i[s]=r[s]);return i.queue=[],i.sorter=n.sorter||r.default_sorter,i},default_sorter:function(n,r){return n.cost-r.cost},push:function(n,r){var i={value:n,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(I3);var tF=I3.exports;(function(t){const e=Oa,n=K7,r=Q7,i=Y7,s=eF,l=Os,h=gi,f=tF;function m(F){return unescape(encodeURIComponent(F)).length}function x(F,P,N){const H=[];let Y;for(;(Y=F.exec(N))!==null;)H.push({data:Y[0],index:Y.index,mode:P,length:Y[0].length});return H}function _(F){const P=x(l.NUMERIC,e.NUMERIC,F),N=x(l.ALPHANUMERIC,e.ALPHANUMERIC,F);let H,Y;return h.isKanjiModeEnabled()?(H=x(l.BYTE,e.BYTE,F),Y=x(l.KANJI,e.KANJI,F)):(H=x(l.BYTE_KANJI,e.BYTE,F),Y=[]),P.concat(N,H,Y).sort(function(k,M){return k.index-M.index}).map(function(k){return{data:k.data,mode:k.mode,length:k.length}})}function I(F,P){switch(P){case e.NUMERIC:return n.getBitsLength(F);case e.ALPHANUMERIC:return r.getBitsLength(F);case e.KANJI:return s.getBitsLength(F);case e.BYTE:return i.getBitsLength(F)}}function R(F){return F.reduce(function(P,N){const H=P.length-1>=0?P[P.length-1]:null;return H&&H.mode===N.mode?(P[P.length-1].data+=N.data,P):(P.push(N),P)},[])}function B(F){const P=[];for(let N=0;N<F.length;N++){const H=F[N];switch(H.mode){case e.NUMERIC:P.push([H,{data:H.data,mode:e.ALPHANUMERIC,length:H.length},{data:H.data,mode:e.BYTE,length:H.length}]);break;case e.ALPHANUMERIC:P.push([H,{data:H.data,mode:e.BYTE,length:H.length}]);break;case e.KANJI:P.push([H,{data:H.data,mode:e.BYTE,length:m(H.data)}]);break;case e.BYTE:P.push([{data:H.data,mode:e.BYTE,length:m(H.data)}])}}return P}function D(F,P){const N={},H={start:{}};let Y=["start"];for(let J=0;J<F.length;J++){const k=F[J],M=[];for(let L=0;L<k.length;L++){const W=k[L],K=""+J+L;M.push(K),N[K]={node:W,lastCount:0},H[K]={};for(let q=0;q<Y.length;q++){const j=Y[q];N[j]&&N[j].node.mode===W.mode?(H[j][K]=I(N[j].lastCount+W.length,W.mode)-I(N[j].lastCount,W.mode),N[j].lastCount+=W.length):(N[j]&&(N[j].lastCount=W.length),H[j][K]=I(W.length,W.mode)+4+e.getCharCountIndicator(W.mode,P))}}Y=M}for(let J=0;J<Y.length;J++)H[Y[J]].end=0;return{map:H,table:N}}function G(F,P){let N;const H=e.getBestModeForData(F);if(N=e.from(P,H),N!==e.BYTE&&N.bit<H.bit)throw new Error('"'+F+'" cannot be encoded with mode '+e.toString(N)+`.
 Suggested mode is: `+e.toString(H));switch(N===e.KANJI&&!h.isKanjiModeEnabled()&&(N=e.BYTE),N){case e.NUMERIC:return new n(F);case e.ALPHANUMERIC:return new r(F);case e.KANJI:return new s(F);case e.BYTE:return new i(F)}}t.fromArray=function(P){return P.reduce(function(N,H){return typeof H=="string"?N.push(G(H,null)):H.data&&N.push(G(H.data,H.mode)),N},[])},t.fromString=function(P,N){const H=_(P,h.isKanjiModeEnabled()),Y=B(H),J=D(Y,N),k=f.find_path(J.map,"start","end"),M=[];for(let L=1;L<k.length-1;L++)M.push(J.table[k[L]].node);return t.fromArray(R(M))},t.rawSplit=function(P){return t.fromArray(_(P,h.isKanjiModeEnabled()))}})(v3);const Tg=gi,Am=vg,nF=L7,rF=F7,iF=f3,sF=g3,uy=m3,hy=Ig,oF=B7,_1=w3,aF=_3,lF=Oa,Tm=v3;function cF(t,e){const n=t.size,r=sF.getPositions(e);for(let i=0;i<r.length;i++){const s=r[i][0],l=r[i][1];for(let h=-1;h<=7;h++)if(!(s+h<=-1||n<=s+h))for(let f=-1;f<=7;f++)l+f<=-1||n<=l+f||(h>=0&&h<=6&&(f===0||f===6)||f>=0&&f<=6&&(h===0||h===6)||h>=2&&h<=4&&f>=2&&f<=4?t.set(s+h,l+f,!0,!0):t.set(s+h,l+f,!1,!0))}}function uF(t){const e=t.size;for(let n=8;n<e-8;n++){const r=n%2===0;t.set(n,6,r,!0),t.set(6,n,r,!0)}}function hF(t,e){const n=iF.getPositions(e);for(let r=0;r<n.length;r++){const i=n[r][0],s=n[r][1];for(let l=-2;l<=2;l++)for(let h=-2;h<=2;h++)l===-2||l===2||h===-2||h===2||l===0&&h===0?t.set(i+l,s+h,!0,!0):t.set(i+l,s+h,!1,!0)}}function dF(t,e){const n=t.size,r=_1.getEncodedBits(e);let i,s,l;for(let h=0;h<18;h++)i=Math.floor(h/3),s=h%3+n-8-3,l=(r>>h&1)===1,t.set(i,s,l,!0),t.set(s,i,l,!0)}function Cm(t,e,n){const r=t.size,i=aF.getEncodedBits(e,n);let s,l;for(s=0;s<15;s++)l=(i>>s&1)===1,s<6?t.set(s,8,l,!0):s<8?t.set(s+1,8,l,!0):t.set(r-15+s,8,l,!0),s<8?t.set(8,r-s-1,l,!0):s<9?t.set(8,15-s-1+1,l,!0):t.set(8,15-s-1,l,!0);t.set(r-8,8,1,!0)}function fF(t,e){const n=t.size;let r=-1,i=n-1,s=7,l=0;for(let h=n-1;h>0;h-=2)for(h===6&&h--;;){for(let f=0;f<2;f++)if(!t.isReserved(i,h-f)){let m=!1;l<e.length&&(m=(e[l]>>>s&1)===1),t.set(i,h-f,m),s--,s===-1&&(l++,s=7)}if(i+=r,i<0||n<=i){i-=r,r=-r;break}}}function gF(t,e,n){const r=new nF;n.forEach(function(f){r.put(f.mode.bit,4),r.put(f.getLength(),lF.getCharCountIndicator(f.mode,t)),f.write(r)});const i=Tg.getSymbolTotalCodewords(t),s=hy.getTotalCodewordsCount(t,e),l=(i-s)*8;for(r.getLengthInBits()+4<=l&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const h=(l-r.getLengthInBits())/8;for(let f=0;f<h;f++)r.put(f%2?17:236,8);return mF(r,t,e)}function mF(t,e,n){const r=Tg.getSymbolTotalCodewords(e),i=hy.getTotalCodewordsCount(e,n),s=r-i,l=hy.getBlocksCount(e,n),h=r%l,f=l-h,m=Math.floor(r/l),x=Math.floor(s/l),_=x+1,I=m-x,R=new oF(I);let B=0;const D=new Array(l),G=new Array(l);let F=0;const P=new Uint8Array(t.buffer);for(let k=0;k<l;k++){const M=k<f?x:_;D[k]=P.slice(B,B+M),G[k]=R.encode(D[k]),B+=M,F=Math.max(F,M)}const N=new Uint8Array(r);let H=0,Y,J;for(Y=0;Y<F;Y++)for(J=0;J<l;J++)Y<D[J].length&&(N[H++]=D[J][Y]);for(Y=0;Y<I;Y++)for(J=0;J<l;J++)N[H++]=G[J][Y];return N}function pF(t,e,n,r){let i;if(Array.isArray(t))i=Tm.fromArray(t);else if(typeof t=="string"){let m=e;if(!m){const x=Tm.rawSplit(t);m=_1.getBestVersionForData(x,n)}i=Tm.fromString(t,m||40)}else throw new Error("Invalid data");const s=_1.getBestVersionForData(i,n);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=s;else if(e<s)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+s+`.
`);const l=gF(e,n,i),h=Tg.getSymbolSize(e),f=new rF(h);return cF(f,e),uF(f),hF(f,e),Cm(f,n,0),e>=7&&dF(f,e),fF(f,l),isNaN(r)&&(r=uy.getBestMask(f,Cm.bind(null,f,n))),uy.applyMask(r,f),Cm(f,n,r),{modules:f,version:e,errorCorrectionLevel:n,maskPattern:r,segments:i}}h3.create=function(e,n){if(typeof e>"u"||e==="")throw new Error("No input text");let r=Am.M,i,s;return typeof n<"u"&&(r=Am.from(n.errorCorrectionLevel,Am.M),i=_1.from(n.version),s=uy.from(n.maskPattern),n.toSJISFunc&&Tg.setToSJISFunction(n.toSJISFunc)),pF(e,i,r,s)};var A3={},Vx={};(function(t){function e(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let r=n.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+n);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(s){return[s,s]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}t.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,s=r.width&&r.width>=21?r.width:void 0,l=r.scale||4;return{width:s,scale:s?4:l,margin:i,color:{dark:e(r.color.dark||"#000000ff"),light:e(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},t.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},t.getImageWidth=function(r,i){const s=t.getScale(r,i);return Math.floor((r+i.margin*2)*s)},t.qrToImageData=function(r,i,s){const l=i.modules.size,h=i.modules.data,f=t.getScale(l,s),m=Math.floor((l+s.margin*2)*f),x=s.margin*f,_=[s.color.light,s.color.dark];for(let I=0;I<m;I++)for(let R=0;R<m;R++){let B=(I*m+R)*4,D=s.color.light;if(I>=x&&R>=x&&I<m-x&&R<m-x){const G=Math.floor((I-x)/f),F=Math.floor((R-x)/f);D=_[h[G*l+F]?1:0]}r[B++]=D.r,r[B++]=D.g,r[B++]=D.b,r[B]=D.a}}})(Vx);(function(t){const e=Vx;function n(i,s,l){i.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=l,s.width=l,s.style.height=l+"px",s.style.width=l+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(s,l,h){let f=h,m=l;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),l||(m=r()),f=e.getOptions(f);const x=e.getImageWidth(s.modules.size,f),_=m.getContext("2d"),I=_.createImageData(x,x);return e.qrToImageData(I.data,s,f),n(_,m,x),_.putImageData(I,0,0),m},t.renderToDataURL=function(s,l,h){let f=h;typeof f>"u"&&(!l||!l.getContext)&&(f=l,l=void 0),f||(f={});const m=t.render(s,l,f),x=f.type||"image/png",_=f.rendererOpts||{};return m.toDataURL(x,_.quality)}})(A3);var T3={};const yF=Vx;function Tv(t,e){const n=t.a/255,r=e+'="'+t.hex+'"';return n<1?r+" "+e+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function Sm(t,e,n){let r=t+e;return typeof n<"u"&&(r+=" "+n),r}function wF(t,e,n){let r="",i=0,s=!1,l=0;for(let h=0;h<t.length;h++){const f=Math.floor(h%e),m=Math.floor(h/e);!f&&!s&&(s=!0),t[h]?(l++,h>0&&f>0&&t[h-1]||(r+=s?Sm("M",f+n,.5+m+n):Sm("m",i,0),i=0,s=!1),f+1<e&&t[h+1]||(r+=Sm("h",l),l=0)):i++}return r}T3.render=function(e,n,r){const i=yF.getOptions(n),s=e.modules.size,l=e.modules.data,h=s+i.margin*2,f=i.color.light.a?"<path "+Tv(i.color.light,"fill")+' d="M0 0h'+h+"v"+h+'H0z"/>':"",m="<path "+Tv(i.color.dark,"stroke")+' d="'+wF(l,s,i.margin)+'"/>',x='viewBox="0 0 '+h+" "+h+'"',I='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+x+' shape-rendering="crispEdges">'+f+m+`</svg>
`;return typeof r=="function"&&r(null,I),I};const xF=O7,dy=h3,C3=A3,_F=T3;function Bx(t,e,n,r,i){const s=[].slice.call(arguments,1),l=s.length,h=typeof s[l-1]=="function";if(!h&&!xF())throw new Error("Callback required as last argument");if(h){if(l<2)throw new Error("Too few arguments provided");l===2?(i=n,n=e,e=r=void 0):l===3&&(e.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=n,n=e,e=void 0))}else{if(l<1)throw new Error("Too few arguments provided");return l===1?(n=e,e=r=void 0):l===2&&!e.getContext&&(r=n,n=e,e=void 0),new Promise(function(f,m){try{const x=dy.create(n,r);f(t(x,e,r))}catch(x){m(x)}})}try{const f=dy.create(n,r);i(null,t(f,e,r))}catch(f){i(f)}}kl.create=dy.create;kl.toCanvas=Bx.bind(null,C3.render);kl.toDataURL=Bx.bind(null,C3.renderToDataURL);kl.toString=Bx.bind(null,function(t,e,n){return _F.render(t,n)});const _u="artifacts",EF=async t=>{try{const e=`${window.location.origin}/artifacts/${t}`;return await kl.toDataURL(e,{width:512,margin:2,color:{dark:"#1e293b",light:"#ffffff"}})}catch(e){return console.error("Error generating QR code:",e),""}},vF=async t=>{try{const e=vn.currentUser;if(!e)throw new Error("User must be authenticated to create artifacts");const n={...t,createdBy:e.uid,createdAt:xd(),updatedAt:xd(),isDeleted:!1,version:1,qrCodeUrl:null,photoCount:0},r=await G9(Db(Ei,_u),n);console.log(" Artifact created successfully with ID:",r.id);try{const i=await EF(r.id);i&&(await _g(xs(Ei,_u,r.id),{qrCodeUrl:i}),console.log(" QR code generated and stored"))}catch(i){console.warn(" QR code generation failed, but artifact was created:",i)}return r.id}catch(e){throw console.error(" Error creating artifact:",e),e}},S3=async t=>{var e,n,r,i;try{const s=xs(Ei,_u,t),l=await Cx(s);if(!l.exists())return null;const h=l.data();return{id:l.id,...h,createdAt:((n=(e=h.createdAt)==null?void 0:e.toDate)==null?void 0:n.call(e))||new Date,updatedAt:((i=(r=h.updatedAt)==null?void 0:r.toDate)==null?void 0:i.call(r))||new Date}}catch(s){throw console.error(" Error getting artifact:",s),s}},IF=async()=>{try{const t=F9(Db(Ei,_u),V9("isDeleted","==",!1)),e=await z9(t),n=[];return e.forEach(r=>{var s,l,h,f;const i=r.data();n.push({id:r.id,...i,createdAt:((l=(s=i.createdAt)==null?void 0:s.toDate)==null?void 0:l.call(s))||new Date,updatedAt:((f=(h=i.updatedAt)==null?void 0:h.toDate)==null?void 0:f.call(h))||new Date})}),n.sort((r,i)=>i.createdAt.getTime()-r.createdAt.getTime()),n}catch(t){throw console.error(" Error getting artifacts:",t),t}},AF=async(t,e)=>{try{const n=vn.currentUser;if(!n)throw new Error("User must be authenticated to update artifacts");const r=xs(Ei,_u,t),i=await Cx(r);if(!i.exists())throw new Error("Artifact not found");const s=i.data().version||1,l=Object.fromEntries(Object.entries(e).filter(([h,f])=>f!==void 0));await _g(r,{...l,updatedAt:xd(),updatedBy:n.uid,version:s+1}),console.log(" Artifact updated successfully:",t)}catch(n){throw console.error(" Error updating artifact:",n),n}},TF=async t=>{try{const e=vn.currentUser;if(!e)throw new Error("User must be authenticated to delete artifacts");const n=xs(Ei,_u,t);await _g(n,{isDeleted:!0,deletedAt:xd(),deletedBy:e.uid,updatedAt:xd()}),console.log(" Artifact deleted successfully:",t)}catch(e){throw console.error(" Error deleting artifact:",e),e}},CF=()=>{const t=fi(),[e,n]=oe.useState([]),[r,i]=oe.useState(!0),[s,l]=oe.useState("");oe.useEffect(()=>{h()},[]);const h=async()=>{try{i(!0);const m=await IF();n(m),console.log(" Loaded artifacts:",m.length)}catch(m){console.error("Error loading artifacts:",m),Qe.error("Failed to load artifacts")}finally{i(!1)}},f=e.filter(m=>m.name.toLowerCase().includes(s.toLowerCase())||m.artifactType.toLowerCase().includes(s.toLowerCase())||m.discoverySite.toLowerCase().includes(s.toLowerCase()));return r?A.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:A.jsx(ef,{text:"Loading artifacts..."})}):A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("div",{className:"mb-8 flex justify-between items-start",children:[A.jsxs("div",{children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Artifacts"}),A.jsx("p",{className:"mt-2 text-gray-600",children:"Browse and manage your archaeological artifacts"})]}),A.jsxs("button",{onClick:()=>t("/artifacts/new"),className:"btn btn-primary flex items-center gap-2",children:[A.jsx(vv,{className:"w-4 h-4"}),"Add New Artifact"]})]}),A.jsx("div",{className:"mb-6",children:A.jsxs("div",{className:"relative",children:[A.jsx(ly,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),A.jsx("input",{type:"text",placeholder:"Search artifacts by name, type, or site...",value:s,onChange:m=>l(m.target.value),className:"input pl-10 w-full"})]})}),f.length===0?A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content text-center py-12",children:[A.jsx(Ox,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),A.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s?"No artifacts found":"No artifacts yet"}),A.jsx("p",{className:"text-gray-600 mb-6",children:s?"Try adjusting your search criteria":"Get started by adding your first artifact"}),!s&&A.jsxs("button",{onClick:()=>t("/artifacts/new"),className:"btn btn-primary",children:[A.jsx(vv,{className:"w-4 h-4 mr-2"}),"Add New Artifact"]})]})}):A.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(m=>A.jsx("div",{onClick:()=>t(`/artifacts/${m.id}`),className:"card hover:shadow-lg transition-shadow cursor-pointer",children:A.jsxs("div",{className:"card-content",children:[A.jsx("div",{className:"flex justify-between items-start mb-3",children:A.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2",children:m.name})}),A.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800 mb-3",children:m.artifactType}),m.description&&A.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:m.description}),A.jsxs("div",{className:"space-y-1 text-sm text-gray-500",children:[A.jsxs("p",{children:[A.jsx("span",{className:"font-medium",children:"Site:"})," ",m.discoverySite]}),A.jsxs("p",{children:[A.jsx("span",{className:"font-medium",children:"Date:"})," ",m.discoveryDate]}),A.jsxs("p",{children:[A.jsx("span",{className:"font-medium",children:"Location:"})," ",m.location]})]}),A.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 text-xs text-gray-400",children:["Added ",new Date(m.createdAt).toLocaleDateString()]})]})},m.id))}),f.length>0&&A.jsxs("div",{className:"mt-6 text-center text-sm text-gray-500",children:["Showing ",f.length," of ",e.length," artifact",e.length!==1?"s":""]})]})})},SF=[{id:"pottery",name:"Pottery",description:"Ceramic vessels and containers",icon:"",color:"#8B4513"},{id:"tool",name:"Tool",description:"Stone, metal, or bone tools",icon:"",color:"#696969"},{id:"jewelry",name:"Jewelry",description:"Personal ornaments and adornments",icon:"",color:"#FFD700"},{id:"weapon",name:"Weapon",description:"Swords, spears, arrows, and other weapons",icon:"",color:"#B22222"},{id:"coin",name:"Coin",description:"Ancient coins and currency",icon:"",color:"#CD7F32"},{id:"sculpture",name:"Sculpture",description:"Carved or molded figures",icon:"",color:"#D2B48C"},{id:"textile",name:"Textile",description:"Fabric, clothing, and woven materials",icon:"",color:"#DEB887"},{id:"other",name:"Other",description:"Miscellaneous artifacts",icon:"",color:"#808080"}],b3=({onSubmit:t,loading:e=!1,initialData:n})=>{const{register:r,handleSubmit:i,formState:{errors:s}}=Jd({defaultValues:n});return A.jsxs("form",{onSubmit:i(t),className:"space-y-6",children:[A.jsxs("div",{children:[A.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Artifact Name *"}),A.jsx("input",{...r("name",{required:"Artifact name is required",maxLength:{value:200,message:"Name must be less than 200 characters"}}),type:"text",id:"name",className:"input",placeholder:"Enter artifact name"}),s.name&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.name.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),A.jsx("textarea",{...r("description",{maxLength:{value:2e3,message:"Description must be less than 2000 characters"}}),id:"description",rows:4,className:"input",placeholder:"Enter artifact description"}),s.description&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.description.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"artifactType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Artifact Type *"}),A.jsxs("select",{...r("artifactType",{required:"Artifact type is required"}),id:"artifactType",className:"input",children:[A.jsx("option",{value:"",children:"Select artifact type"}),SF.map(l=>A.jsxs("option",{value:l.id,children:[l.icon," ",l.name]},l.id))]}),s.artifactType&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.artifactType.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"discoveryDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discovery Date *"}),A.jsx("input",{...r("discoveryDate",{required:"Discovery date is required"}),type:"date",id:"discoveryDate",className:"input"}),s.discoveryDate&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.discoveryDate.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"discoverySite",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discovery Site *"}),A.jsx("input",{...r("discoverySite",{required:"Discovery site is required",maxLength:{value:200,message:"Discovery site must be less than 200 characters"}}),type:"text",id:"discoverySite",className:"input",placeholder:"Enter discovery site"}),s.discoverySite&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.discoverySite.message})]}),A.jsxs("div",{children:[A.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Location *"}),A.jsx("input",{...r("location",{required:"Current location is required",maxLength:{value:200,message:"Location must be less than 200 characters"}}),type:"text",id:"location",className:"input",placeholder:"Enter current location"}),s.location&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.location.message})]}),A.jsxs("div",{className:"flex justify-end space-x-4",children:[A.jsx("button",{type:"button",className:"btn btn-secondary btn-md",children:"Cancel"}),A.jsx("button",{type:"submit",disabled:e,className:"btn btn-primary btn-md",children:e?"Saving...":"Save Artifact"})]})]})},bF=()=>{const t=fi(),[e,n]=_r.useState(!1),r=async i=>{n(!0);try{console.log("Creating artifact:",i);const s=await vF(i);Qe.success("Artifact created successfully!",{duration:3e3,icon:""}),t(`/artifacts/${s}`)}catch(s){console.error("Error creating artifact:",s),Qe.error(s.message||"Failed to create artifact. Please try again.",{duration:4e3,icon:""})}finally{n(!1)}};return A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("button",{onClick:()=>t("/dashboard"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[A.jsx(Hl,{className:"w-4 h-4"}),"Back to Dashboard"]}),A.jsxs("div",{className:"mb-8",children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Add New Artifact"}),A.jsx("p",{className:"mt-2 text-gray-600",children:"Record a new archaeological artifact in your collection"})]}),A.jsx("div",{className:"card",children:A.jsx("div",{className:"card-content",children:A.jsx(b3,{onSubmit:r,loading:e})})})]})})},RF=()=>{const{id:t}=xT(),e=fi(),[n,r]=oe.useState(!0),[i,s]=oe.useState(!1),[l,h]=oe.useState();oe.useEffect(()=>{(async()=>{if(!t){e("/artifacts");return}try{r(!0);const x=await S3(t);if(!x){Qe.error("Artifact not found"),e("/artifacts");return}h({name:x.name,description:x.description||"",artifactType:x.artifactType,discoveryDate:x.discoveryDate,discoverySite:x.discoverySite,location:x.location,gpsCoordinates:x.gpsCoordinates,dimensions:x.dimensions,material:x.material,condition:x.condition,notes:x.notes||""})}catch(x){console.error("Error loading artifact:",x),Qe.error("Failed to load artifact"),e("/artifacts")}finally{r(!1)}})()},[t,e]);const f=async m=>{if(t){s(!0);try{console.log("Updating artifact:",t,m),await AF(t,m),Qe.success("Artifact updated successfully!",{duration:3e3,icon:""}),e(`/artifacts/${t}`)}catch(x){console.error("Error updating artifact:",x),Qe.error(x.message||"Failed to update artifact. Please try again.",{duration:4e3,icon:""})}finally{s(!1)}}};return n?A.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:A.jsx(ef,{text:"Loading artifact..."})}):l?A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("button",{onClick:()=>e(`/artifacts/${t}`),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[A.jsx(Hl,{className:"w-4 h-4"}),"Back to Artifact"]}),A.jsxs("div",{className:"mb-8",children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Artifact"}),A.jsx("p",{className:"mt-2 text-gray-600",children:"Update the details of your archaeological artifact"})]}),A.jsx("div",{className:"card",children:A.jsx("div",{className:"card-content",children:A.jsx(b3,{onSubmit:f,loading:i,initialData:l})})})]})}):A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:A.jsx("p",{className:"text-gray-600",children:"Artifact not found"})})})},NF=({artifactId:t,artifactName:e,size:n=256})=>{const r=oe.useRef(null),[i,s]=oe.useState("");oe.useEffect(()=>{l()},[t]);const l=async()=>{if(r.current)try{const x=`${window.location.origin}/artifacts/${t}`;await kl.toCanvas(r.current,x,{width:n,margin:2,color:{dark:"#1e293b",light:"#ffffff"}});const _=await kl.toDataURL(x,{width:n,margin:2});s(_)}catch(x){console.error("Error generating QR code:",x),Qe.error("Failed to generate QR code")}},h=()=>{if(!i)return;const x=document.createElement("a");x.download=`${e.replace(/[^a-z0-9]/gi,"-").toLowerCase()}-qr-code.png`,x.href=i,document.body.appendChild(x),x.click(),document.body.removeChild(x),Qe.success("QR code downloaded!")},f=()=>{if(!i)return;const x=window.open("","_blank");if(!x){Qe.error("Please allow pop-ups to print");return}x.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Print QR Code - ${e}</title>
          <style>
            body {
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              min-height: 100vh;
              margin: 0;
              padding: 20px;
              font-family: Arial, sans-serif;
            }
            .qr-container {
              text-align: center;
              page-break-inside: avoid;
            }
            h1 {
              font-size: 24px;
              margin-bottom: 10px;
            }
            p {
              color: #666;
              margin-bottom: 20px;
            }
            img {
              border: 2px solid #ccc;
              padding: 10px;
              background: white;
            }
            .footer {
              margin-top: 20px;
              font-size: 12px;
              color: #999;
            }
            @media print {
              body {
                padding: 0;
              }
            }
          </style>
        </head>
        <body>
          <div class="qr-container">
            <h1>${e}</h1>
            <p>Scan to view artifact details</p>
            <img src="${i}" alt="QR Code" />
            <div class="footer">
              <p>Archaeological Artifacts Scanner</p>
              <p>Artifact ID: ${t}</p>
            </div>
          </div>
          <script>
            window.onload = function() {
              window.print();
              setTimeout(function() { window.close(); }, 100);
            }
          <\/script>
        </body>
      </html>
    `),x.document.close()},m=async()=>{const x=`${window.location.origin}/artifacts/${t}`;if(navigator.share)try{await navigator.share({title:e,text:`Check out this artifact: ${e}`,url:x}),Qe.success("Shared successfully!")}catch{}else try{await navigator.clipboard.writeText(x),Qe.success("Link copied to clipboard!")}catch{Qe.error("Failed to copy link")}};return A.jsxs("div",{className:"space-y-4",children:[A.jsx("div",{className:"flex justify-center",children:A.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-gray-200 inline-block",children:A.jsx("canvas",{ref:r})})}),A.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[A.jsxs("button",{onClick:h,className:"btn btn-outline btn-sm flex items-center gap-2",title:"Download QR Code",children:[A.jsx(C7,{className:"w-4 h-4"}),"Download"]}),A.jsxs("button",{onClick:f,className:"btn btn-outline btn-sm flex items-center gap-2",title:"Print QR Code",children:[A.jsx(R7,{className:"w-4 h-4"}),"Print"]}),A.jsxs("button",{onClick:m,className:"btn btn-outline btn-sm flex items-center gap-2",title:"Share Link",children:[A.jsx(D7,{className:"w-4 h-4"}),"Share"]})]}),A.jsxs("div",{className:"text-center",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Scan this QR code to view artifact details"}),A.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["ID: ",t]})]})]})},PF=()=>{const{id:t}=xT(),e=fi(),[n,r]=oe.useState(null),[i,s]=oe.useState(!0),[l,h]=oe.useState(!1),[f,m]=oe.useState(!1);oe.useEffect(()=>{(async()=>{if(t)try{s(!0);const I=await S3(t);I?r(I):(Qe.error("Artifact not found"),e("/artifacts"))}catch(I){console.error("Error loading artifact:",I),Qe.error("Failed to load artifact")}finally{s(!1)}})()},[t,e]);const x=async()=>{if(!(!t||!n||!window.confirm(`Are you sure you want to delete "${n.name}"? This action cannot be undone.`)))try{h(!0),await TF(t),Qe.success("Artifact deleted successfully"),e("/artifacts")}catch(I){console.error("Error deleting artifact:",I),Qe.error(I.message||"Failed to delete artifact")}finally{h(!1)}};return i?A.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:A.jsx(ef,{text:"Loading artifact..."})}):n?A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("button",{onClick:()=>e("/artifacts"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[A.jsx(Hl,{className:"w-4 h-4"}),"Back to Artifacts"]}),A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content",children:[A.jsxs("div",{className:"flex justify-between items-start mb-6",children:[A.jsxs("div",{children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n.name}),A.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-800",children:n.artifactType})]}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("button",{onClick:()=>m(!f),className:"btn btn-outline btn-sm",title:"Show QR Code",children:A.jsx(N7,{className:"w-4 h-4"})}),A.jsx("button",{onClick:()=>e(`/artifacts/${t}/edit`),className:"btn btn-outline btn-sm",title:"Edit artifact",children:A.jsx(b7,{className:"w-4 h-4"})}),A.jsx("button",{onClick:x,disabled:l,className:"btn btn-danger btn-sm",title:"Delete artifact",children:l?A.jsx("span",{className:"animate-spin",children:""}):A.jsx(u3,{className:"w-4 h-4"})})]})]}),f&&A.jsxs("div",{className:"mb-6 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[A.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 text-center",children:"QR Code"}),A.jsx(NF,{artifactId:t,artifactName:n.name})]}),n.description&&A.jsxs("div",{className:"mb-6",children:[A.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Description"}),A.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.description})]}),A.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[A.jsxs("div",{className:"flex items-start gap-3",children:[A.jsx(a3,{className:"w-5 h-5 text-gray-400 mt-1"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Discovery Date"}),A.jsx("p",{className:"text-gray-900",children:n.discoveryDate})]})]}),A.jsxs("div",{className:"flex items-start gap-3",children:[A.jsx(Ev,{className:"w-5 h-5 text-gray-400 mt-1"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Discovery Site"}),A.jsx("p",{className:"text-gray-900",children:n.discoverySite})]})]}),A.jsxs("div",{className:"flex items-start gap-3",children:[A.jsx(Ox,{className:"w-5 h-5 text-gray-400 mt-1"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Current Location"}),A.jsx("p",{className:"text-gray-900",children:n.location})]})]}),n.gpsCoordinates&&A.jsxs("div",{className:"flex items-start gap-3",children:[A.jsx(Ev,{className:"w-5 h-5 text-gray-400 mt-1"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"GPS Coordinates"}),A.jsxs("p",{className:"text-gray-900",children:[n.gpsCoordinates.latitude,", ",n.gpsCoordinates.longitude]})]})]})]}),n.notes&&A.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[A.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Notes"}),A.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:n.notes})]}),A.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 text-sm text-gray-500",children:[A.jsxs("p",{children:["Created: ",new Date(n.createdAt).toLocaleString()]}),A.jsxs("p",{children:["Last updated: ",new Date(n.updatedAt).toLocaleString()]})]})]})})]})}):A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:A.jsx("p",{className:"text-gray-600",children:"Artifact not found"})})})};var Ne;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ne||(Ne={}));var Cv=new Map([[Ne.QR_CODE,"QR_CODE"],[Ne.AZTEC,"AZTEC"],[Ne.CODABAR,"CODABAR"],[Ne.CODE_39,"CODE_39"],[Ne.CODE_93,"CODE_93"],[Ne.CODE_128,"CODE_128"],[Ne.DATA_MATRIX,"DATA_MATRIX"],[Ne.MAXICODE,"MAXICODE"],[Ne.ITF,"ITF"],[Ne.EAN_13,"EAN_13"],[Ne.EAN_8,"EAN_8"],[Ne.PDF_417,"PDF_417"],[Ne.RSS_14,"RSS_14"],[Ne.RSS_EXPANDED,"RSS_EXPANDED"],[Ne.UPC_A,"UPC_A"],[Ne.UPC_E,"UPC_E"],[Ne.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Sv;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(Sv||(Sv={}));function DF(t){return Object.values(Ne).includes(t)}var E1;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(E1||(E1={}));var kF=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[E1.SCAN_TYPE_CAMERA,E1.SCAN_TYPE_FILE],t}(),R3=function(){function t(e,n){this.format=e,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(e){if(!Cv.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new t(e,Cv.get(e))},t}(),bv=function(){function t(){}return t.createFromText=function(e){var n={text:e};return{decodedText:e,result:n}},t.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},t}(),fy;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(fy||(fy={}));var OF=function(){function t(){}return t.createFrom=function(e){return{errorMessage:e,type:fy.UNKWOWN_ERROR}},t}(),MF=function(){function t(e){this.verbose=e}return t.prototype.log=function(e){this.verbose&&console.log(e)},t.prototype.warn=function(e){this.verbose&&console.warn(e)},t.prototype.logError=function(e,n){(this.verbose||n===!0)&&console.error(e)},t.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},t}();function qs(t){return typeof t>"u"||t===null}var Sc=function(){function t(){}return t.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},t.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),N3=function(){function t(){}return t.isMediaStreamConstraintsValid=function(e,n){if(typeof e!="object"){var r=typeof e;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],s=new Set(i),l=Object.keys(e),h=0,f=l;h<f.length;h++){var m=f[h];if(s.has(m))return n.logError("".concat(m," is not supported videoConstaints."),!0),!1}return!0},t}(),gy={exports:{}};(function(t,e){(function(n,r){r(e)})(Xu,function(n){function r(S){return S==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,o){S.__proto__=o}||function(S,o){for(var a in o)o.hasOwnProperty(a)&&(S[a]=o[a])};function s(S,o){i(S,o);function a(){this.constructor=S}S.prototype=o===null?Object.create(o):(a.prototype=o.prototype,new a)}function l(S,o){var a=Object.setPrototypeOf;a?a(S,o):S.__proto__=o}function h(S,o){o===void 0&&(o=S.constructor);var a=Error.captureStackTrace;a&&a(S,o)}var f=function(S){s(o,S);function o(a){var c=this.constructor,u=S.call(this,a)||this;return Object.defineProperty(u,"name",{value:c.name,enumerable:!1}),l(u,c.prototype),h(u),u}return o}(Error);class m extends f{constructor(o=void 0){super(o),this.message=o}getKind(){return this.constructor.kind}}m.kind="Exception";class x extends m{}x.kind="ArgumentException";class _ extends m{}_.kind="IllegalArgumentException";class I{constructor(o){if(this.binarizer=o,o===null)throw new _("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(o,a){return this.binarizer.getBlackRow(o,a)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(o,a,c,u){const d=this.binarizer.getLuminanceSource().crop(o,a,c,u);return new I(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const o=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new I(this.binarizer.createBinarizer(o))}rotateCounterClockwise45(){const o=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new I(this.binarizer.createBinarizer(o))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class R extends m{static getChecksumInstance(){return new R}}R.kind="ChecksumException";class B{constructor(o){this.source=o}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class D{static arraycopy(o,a,c,u,d){for(;d--;)c[u++]=o[a++]}static currentTimeMillis(){return Date.now()}}class G extends m{}G.kind="IndexOutOfBoundsException";class F extends G{constructor(o=void 0,a=void 0){super(a),this.index=o,this.message=a}}F.kind="ArrayIndexOutOfBoundsException";class P{static fill(o,a){for(let c=0,u=o.length;c<u;c++)o[c]=a}static fillWithin(o,a,c,u){P.rangeCheck(o.length,a,c);for(let d=a;d<c;d++)o[d]=u}static rangeCheck(o,a,c){if(a>c)throw new _("fromIndex("+a+") > toIndex("+c+")");if(a<0)throw new F(a);if(c>o)throw new F(c)}static asList(...o){return o}static create(o,a,c){return Array.from({length:o}).map(d=>Array.from({length:a}).fill(c))}static createInt32Array(o,a,c){return Array.from({length:o}).map(d=>Int32Array.from({length:a}).fill(c))}static equals(o,a){if(!o||!a||!o.length||!a.length||o.length!==a.length)return!1;for(let c=0,u=o.length;c<u;c++)if(o[c]!==a[c])return!1;return!0}static hashCode(o){if(o===null)return 0;let a=1;for(const c of o)a=31*a+c;return a}static fillUint8Array(o,a){for(let c=0;c!==o.length;c++)o[c]=a}static copyOf(o,a){return o.slice(0,a)}static copyOfUint8Array(o,a){if(o.length<=a){const c=new Uint8Array(a);return c.set(o),c}return o.slice(0,a)}static copyOfRange(o,a,c){const u=c-a,d=new Int32Array(u);return D.arraycopy(o,a,d,0,u),d}static binarySearch(o,a,c){c===void 0&&(c=P.numberComparator);let u=0,d=o.length-1;for(;u<=d;){const g=d+u>>1,y=c(a,o[g]);if(y>0)u=g+1;else if(y<0)d=g-1;else return g}return-u-1}static numberComparator(o,a){return o-a}}class N{static numberOfTrailingZeros(o){let a;if(o===0)return 32;let c=31;return a=o<<16,a!==0&&(c-=16,o=a),a=o<<8,a!==0&&(c-=8,o=a),a=o<<4,a!==0&&(c-=4,o=a),a=o<<2,a!==0&&(c-=2,o=a),c-(o<<1>>>31)}static numberOfLeadingZeros(o){if(o===0)return 32;let a=1;return o>>>16||(a+=16,o<<=16),o>>>24||(a+=8,o<<=8),o>>>28||(a+=4,o<<=4),o>>>30||(a+=2,o<<=2),a-=o>>>31,a}static toHexString(o){return o.toString(16)}static toBinaryString(o){return String(parseInt(String(o),2))}static bitCount(o){return o=o-(o>>>1&1431655765),o=(o&858993459)+(o>>>2&858993459),o=o+(o>>>4)&252645135,o=o+(o>>>8),o=o+(o>>>16),o&63}static truncDivision(o,a){return Math.trunc(o/a)}static parseInt(o,a=void 0){return parseInt(o,a)}}N.MIN_VALUE_32_BITS=-2147483648,N.MAX_VALUE=Number.MAX_SAFE_INTEGER;class H{constructor(o,a){o===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=o,a==null?this.bits=H.makeArray(o):this.bits=a)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(o){if(o>this.bits.length*32){const a=H.makeArray(o);D.arraycopy(this.bits,0,a,0,this.bits.length),this.bits=a}}get(o){return(this.bits[Math.floor(o/32)]&1<<(o&31))!==0}set(o){this.bits[Math.floor(o/32)]|=1<<(o&31)}flip(o){this.bits[Math.floor(o/32)]^=1<<(o&31)}getNextSet(o){const a=this.size;if(o>=a)return a;const c=this.bits;let u=Math.floor(o/32),d=c[u];d&=~((1<<(o&31))-1);const g=c.length;for(;d===0;){if(++u===g)return a;d=c[u]}const y=u*32+N.numberOfTrailingZeros(d);return y>a?a:y}getNextUnset(o){const a=this.size;if(o>=a)return a;const c=this.bits;let u=Math.floor(o/32),d=~c[u];d&=~((1<<(o&31))-1);const g=c.length;for(;d===0;){if(++u===g)return a;d=~c[u]}const y=u*32+N.numberOfTrailingZeros(d);return y>a?a:y}setBulk(o,a){this.bits[Math.floor(o/32)]=a}setRange(o,a){if(a<o||o<0||a>this.size)throw new _;if(a===o)return;a--;const c=Math.floor(o/32),u=Math.floor(a/32),d=this.bits;for(let g=c;g<=u;g++){const y=g>c?0:o&31,E=(2<<(g<u?31:a&31))-(1<<y);d[g]|=E}}clear(){const o=this.bits.length,a=this.bits;for(let c=0;c<o;c++)a[c]=0}isRange(o,a,c){if(a<o||o<0||a>this.size)throw new _;if(a===o)return!0;a--;const u=Math.floor(o/32),d=Math.floor(a/32),g=this.bits;for(let y=u;y<=d;y++){const w=y>u?0:o&31,T=(2<<(y<d?31:a&31))-(1<<w)&4294967295;if((g[y]&T)!==(c?T:0))return!1}return!0}appendBit(o){this.ensureCapacity(this.size+1),o&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(o,a){if(a<0||a>32)throw new _("Num bits must be between 0 and 32");this.ensureCapacity(this.size+a);for(let c=a;c>0;c--)this.appendBit((o>>c-1&1)===1)}appendBitArray(o){const a=o.size;this.ensureCapacity(this.size+a);for(let c=0;c<a;c++)this.appendBit(o.get(c))}xor(o){if(this.size!==o.size)throw new _("Sizes don't match");const a=this.bits;for(let c=0,u=a.length;c<u;c++)a[c]^=o.bits[c]}toBytes(o,a,c,u){for(let d=0;d<u;d++){let g=0;for(let y=0;y<8;y++)this.get(o)&&(g|=1<<7-y),o++;a[c+d]=g}}getBitArray(){return this.bits}reverse(){const o=new Int32Array(this.bits.length),a=Math.floor((this.size-1)/32),c=a+1,u=this.bits;for(let d=0;d<c;d++){let g=u[d];g=g>>1&1431655765|(g&1431655765)<<1,g=g>>2&858993459|(g&858993459)<<2,g=g>>4&252645135|(g&252645135)<<4,g=g>>8&16711935|(g&16711935)<<8,g=g>>16&65535|(g&65535)<<16,o[a-d]=g}if(this.size!==c*32){const d=c*32-this.size;let g=o[0]>>>d;for(let y=1;y<c;y++){const w=o[y];g|=w<<32-d,o[y-1]=g,g=w>>>d}o[c-1]=g}this.bits=o}static makeArray(o){return new Int32Array(Math.floor((o+31)/32))}equals(o){if(!(o instanceof H))return!1;const a=o;return this.size===a.size&&P.equals(this.bits,a.bits)}hashCode(){return 31*this.size+P.hashCode(this.bits)}toString(){let o="";for(let a=0,c=this.size;a<c;a++)a&7||(o+=" "),o+=this.get(a)?"X":".";return o}clone(){return new H(this.size,this.bits.slice())}}var Y;(function(S){S[S.OTHER=0]="OTHER",S[S.PURE_BARCODE=1]="PURE_BARCODE",S[S.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",S[S.TRY_HARDER=3]="TRY_HARDER",S[S.CHARACTER_SET=4]="CHARACTER_SET",S[S.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",S[S.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",S[S.ASSUME_GS1=7]="ASSUME_GS1",S[S.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",S[S.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",S[S.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Y||(Y={}));var J=Y;class k extends m{static getFormatInstance(){return new k}}k.kind="FormatException";var M;(function(S){S[S.Cp437=0]="Cp437",S[S.ISO8859_1=1]="ISO8859_1",S[S.ISO8859_2=2]="ISO8859_2",S[S.ISO8859_3=3]="ISO8859_3",S[S.ISO8859_4=4]="ISO8859_4",S[S.ISO8859_5=5]="ISO8859_5",S[S.ISO8859_6=6]="ISO8859_6",S[S.ISO8859_7=7]="ISO8859_7",S[S.ISO8859_8=8]="ISO8859_8",S[S.ISO8859_9=9]="ISO8859_9",S[S.ISO8859_10=10]="ISO8859_10",S[S.ISO8859_11=11]="ISO8859_11",S[S.ISO8859_13=12]="ISO8859_13",S[S.ISO8859_14=13]="ISO8859_14",S[S.ISO8859_15=14]="ISO8859_15",S[S.ISO8859_16=15]="ISO8859_16",S[S.SJIS=16]="SJIS",S[S.Cp1250=17]="Cp1250",S[S.Cp1251=18]="Cp1251",S[S.Cp1252=19]="Cp1252",S[S.Cp1256=20]="Cp1256",S[S.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",S[S.UTF8=22]="UTF8",S[S.ASCII=23]="ASCII",S[S.Big5=24]="Big5",S[S.GB18030=25]="GB18030",S[S.EUC_KR=26]="EUC_KR"})(M||(M={}));class L{constructor(o,a,c,...u){this.valueIdentifier=o,this.name=c,typeof a=="number"?this.values=Int32Array.from([a]):this.values=a,this.otherEncodingNames=u,L.VALUE_IDENTIFIER_TO_ECI.set(o,this),L.NAME_TO_ECI.set(c,this);const d=this.values;for(let g=0,y=d.length;g!==y;g++){const w=d[g];L.VALUES_TO_ECI.set(w,this)}for(const g of u)L.NAME_TO_ECI.set(g,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(o){if(o<0||o>=900)throw new k("incorect value");const a=L.VALUES_TO_ECI.get(o);if(a===void 0)throw new k("incorect value");return a}static getCharacterSetECIByName(o){const a=L.NAME_TO_ECI.get(o);if(a===void 0)throw new k("incorect value");return a}equals(o){if(!(o instanceof L))return!1;const a=o;return this.getName()===a.getName()}}L.VALUE_IDENTIFIER_TO_ECI=new Map,L.VALUES_TO_ECI=new Map,L.NAME_TO_ECI=new Map,L.Cp437=new L(M.Cp437,Int32Array.from([0,2]),"Cp437"),L.ISO8859_1=new L(M.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),L.ISO8859_2=new L(M.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),L.ISO8859_3=new L(M.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),L.ISO8859_4=new L(M.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),L.ISO8859_5=new L(M.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),L.ISO8859_6=new L(M.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),L.ISO8859_7=new L(M.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),L.ISO8859_8=new L(M.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),L.ISO8859_9=new L(M.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),L.ISO8859_10=new L(M.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),L.ISO8859_11=new L(M.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),L.ISO8859_13=new L(M.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),L.ISO8859_14=new L(M.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),L.ISO8859_15=new L(M.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),L.ISO8859_16=new L(M.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),L.SJIS=new L(M.SJIS,20,"SJIS","Shift_JIS"),L.Cp1250=new L(M.Cp1250,21,"Cp1250","windows-1250"),L.Cp1251=new L(M.Cp1251,22,"Cp1251","windows-1251"),L.Cp1252=new L(M.Cp1252,23,"Cp1252","windows-1252"),L.Cp1256=new L(M.Cp1256,24,"Cp1256","windows-1256"),L.UnicodeBigUnmarked=new L(M.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),L.UTF8=new L(M.UTF8,26,"UTF8","UTF-8"),L.ASCII=new L(M.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),L.Big5=new L(M.Big5,28,"Big5"),L.GB18030=new L(M.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),L.EUC_KR=new L(M.EUC_KR,30,"EUC_KR","EUC-KR");class W extends m{}W.kind="UnsupportedOperationException";class K{static decode(o,a){const c=this.encodingName(a);return this.customDecoder?this.customDecoder(o,c):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(c)?this.decodeFallback(o,c):new TextDecoder(c).decode(o)}static shouldDecodeOnFallback(o){return!K.isBrowser()&&o==="ISO-8859-1"}static encode(o,a){const c=this.encodingName(a);return this.customEncoder?this.customEncoder(o,c):typeof TextEncoder>"u"?this.encodeFallback(o):new TextEncoder().encode(o)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(o){return typeof o=="string"?o:o.getName()}static encodingCharacterSet(o){return o instanceof L?o:L.getCharacterSetECIByName(o)}static decodeFallback(o,a){const c=this.encodingCharacterSet(a);if(K.isDecodeFallbackSupported(c)){let u="";for(let d=0,g=o.length;d<g;d++){let y=o[d].toString(16);y.length<2&&(y="0"+y),u+="%"+y}return decodeURIComponent(u)}if(c.equals(L.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(o.buffer));throw new W(`Encoding ${this.encodingName(a)} not supported by fallback.`)}static isDecodeFallbackSupported(o){return o.equals(L.UTF8)||o.equals(L.ISO8859_1)||o.equals(L.ASCII)}static encodeFallback(o){const c=btoa(unescape(encodeURIComponent(o))).split(""),u=[];for(let d=0;d<c.length;d++)u.push(c[d].charCodeAt(0));return new Uint8Array(u)}}class q{static castAsNonUtf8Char(o,a=null){const c=a?a.getName():this.ISO88591;return K.decode(new Uint8Array([o]),c)}static guessEncoding(o,a){if(a!=null&&a.get(J.CHARACTER_SET)!==void 0)return a.get(J.CHARACTER_SET).toString();const c=o.length;let u=!0,d=!0,g=!0,y=0,w=0,E=0,T=0,b=0,O=0,z=0,X=0,Z=0,re=0,ce=0;const xe=o.length>3&&o[0]===239&&o[1]===187&&o[2]===191;for(let _e=0;_e<c&&(u||d||g);_e++){const me=o[_e]&255;g&&(y>0?me&128?y--:g=!1:me&128&&(me&64?(y++,me&32?(y++,me&16?(y++,me&8?g=!1:T++):E++):w++):g=!1)),u&&(me>127&&me<160?u=!1:me>159&&(me<192||me===215||me===247)&&ce++),d&&(b>0?me<64||me===127||me>252?d=!1:b--:me===128||me===160||me>239?d=!1:me>160&&me<224?(O++,X=0,z++,z>Z&&(Z=z)):me>127?(b++,z=0,X++,X>re&&(re=X)):(z=0,X=0))}return g&&y>0&&(g=!1),d&&b>0&&(d=!1),g&&(xe||w+E+T>0)?q.UTF8:d&&(q.ASSUME_SHIFT_JIS||Z>=3||re>=3)?q.SHIFT_JIS:u&&d?Z===2&&O===2||ce*10>=c?q.SHIFT_JIS:q.ISO88591:u?q.ISO88591:d?q.SHIFT_JIS:g?q.UTF8:q.PLATFORM_DEFAULT_ENCODING}static format(o,...a){let c=-1;function u(g,y,w,E,T,b){if(g==="%%")return"%";if(a[++c]===void 0)return;g=E?parseInt(E.substr(1)):void 0;let O=T?parseInt(T.substr(1)):void 0,z;switch(b){case"s":z=a[c];break;case"c":z=a[c][0];break;case"f":z=parseFloat(a[c]).toFixed(g);break;case"p":z=parseFloat(a[c]).toPrecision(g);break;case"e":z=parseFloat(a[c]).toExponential(g);break;case"x":z=parseInt(a[c]).toString(O||16);break;case"d":z=parseFloat(parseInt(a[c],O||10).toPrecision(g)).toFixed(0);break}z=typeof z=="object"?JSON.stringify(z):(+z).toString(O);let X=parseInt(w),Z=w&&w[0]+""=="0"?"0":" ";for(;z.length<X;)z=y!==void 0?z+Z:Z+z;return z}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return o.replace(d,u)}static getBytes(o,a){return K.encode(o,a)}static getCharCode(o,a=0){return o.charCodeAt(a)}static getCharAt(o){return String.fromCharCode(o)}}q.SHIFT_JIS=L.SJIS.getName(),q.GB2312="GB2312",q.ISO88591=L.ISO8859_1.getName(),q.EUC_JP="EUC_JP",q.UTF8=L.UTF8.getName(),q.PLATFORM_DEFAULT_ENCODING=q.UTF8,q.ASSUME_SHIFT_JIS=!1;class j{constructor(o=""){this.value=o}enableDecoding(o){return this.encoding=o,this}append(o){return typeof o=="string"?this.value+=o.toString():this.encoding?this.value+=q.castAsNonUtf8Char(o,this.encoding):this.value+=String.fromCharCode(o),this}appendChars(o,a,c){for(let u=a;a<a+c;u++)this.append(o[u]);return this}length(){return this.value.length}charAt(o){return this.value.charAt(o)}deleteCharAt(o){this.value=this.value.substr(0,o)+this.value.substring(o+1)}setCharAt(o,a){this.value=this.value.substr(0,o)+a+this.value.substr(o+1)}substring(o,a){return this.value.substring(o,a)}setLengthToZero(){this.value=""}toString(){return this.value}insert(o,a){this.value=this.value.substr(0,o)+a+this.value.substr(o+a.length)}}class ze{constructor(o,a,c,u){if(this.width=o,this.height=a,this.rowSize=c,this.bits=u,a==null&&(a=o),this.height=a,o<1||a<1)throw new _("Both dimensions must be greater than 0");c==null&&(c=Math.floor((o+31)/32)),this.rowSize=c,u==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(o){const a=o.length,c=o[0].length,u=new ze(c,a);for(let d=0;d<a;d++){const g=o[d];for(let y=0;y<c;y++)g[y]&&u.set(y,d)}return u}static parseFromString(o,a,c){if(o===null)throw new _("stringRepresentation cannot be null");const u=new Array(o.length);let d=0,g=0,y=-1,w=0,E=0;for(;E<o.length;)if(o.charAt(E)===`
`||o.charAt(E)==="\r"){if(d>g){if(y===-1)y=d-g;else if(d-g!==y)throw new _("row lengths do not match");g=d,w++}E++}else if(o.substring(E,E+a.length)===a)E+=a.length,u[d]=!0,d++;else if(o.substring(E,E+c.length)===c)E+=c.length,u[d]=!1,d++;else throw new _("illegal character encountered: "+o.substring(E));if(d>g){if(y===-1)y=d-g;else if(d-g!==y)throw new _("row lengths do not match");w++}const T=new ze(y,w);for(let b=0;b<d;b++)u[b]&&T.set(Math.floor(b%y),Math.floor(b/y));return T}get(o,a){const c=a*this.rowSize+Math.floor(o/32);return(this.bits[c]>>>(o&31)&1)!==0}set(o,a){const c=a*this.rowSize+Math.floor(o/32);this.bits[c]|=1<<(o&31)&4294967295}unset(o,a){const c=a*this.rowSize+Math.floor(o/32);this.bits[c]&=~(1<<(o&31)&4294967295)}flip(o,a){const c=a*this.rowSize+Math.floor(o/32);this.bits[c]^=1<<(o&31)&4294967295}xor(o){if(this.width!==o.getWidth()||this.height!==o.getHeight()||this.rowSize!==o.getRowSize())throw new _("input matrix dimensions do not match");const a=new H(Math.floor(this.width/32)+1),c=this.rowSize,u=this.bits;for(let d=0,g=this.height;d<g;d++){const y=d*c,w=o.getRow(d,a).getBitArray();for(let E=0;E<c;E++)u[y+E]^=w[E]}}clear(){const o=this.bits,a=o.length;for(let c=0;c<a;c++)o[c]=0}setRegion(o,a,c,u){if(a<0||o<0)throw new _("Left and top must be nonnegative");if(u<1||c<1)throw new _("Height and width must be at least 1");const d=o+c,g=a+u;if(g>this.height||d>this.width)throw new _("The region must fit inside the matrix");const y=this.rowSize,w=this.bits;for(let E=a;E<g;E++){const T=E*y;for(let b=o;b<d;b++)w[T+Math.floor(b/32)]|=1<<(b&31)&4294967295}}getRow(o,a){a==null||a.getSize()<this.width?a=new H(this.width):a.clear();const c=this.rowSize,u=this.bits,d=o*c;for(let g=0;g<c;g++)a.setBulk(g*32,u[d+g]);return a}setRow(o,a){D.arraycopy(a.getBitArray(),0,this.bits,o*this.rowSize,this.rowSize)}rotate180(){const o=this.getWidth(),a=this.getHeight();let c=new H(o),u=new H(o);for(let d=0,g=Math.floor((a+1)/2);d<g;d++)c=this.getRow(d,c),u=this.getRow(a-1-d,u),c.reverse(),u.reverse(),this.setRow(d,u),this.setRow(a-1-d,c)}getEnclosingRectangle(){const o=this.width,a=this.height,c=this.rowSize,u=this.bits;let d=o,g=a,y=-1,w=-1;for(let E=0;E<a;E++)for(let T=0;T<c;T++){const b=u[E*c+T];if(b!==0){if(E<g&&(g=E),E>w&&(w=E),T*32<d){let O=0;for(;!(b<<31-O&4294967295);)O++;T*32+O<d&&(d=T*32+O)}if(T*32+31>y){let O=31;for(;!(b>>>O);)O--;T*32+O>y&&(y=T*32+O)}}}return y<d||w<g?null:Int32Array.from([d,g,y-d+1,w-g+1])}getTopLeftOnBit(){const o=this.rowSize,a=this.bits;let c=0;for(;c<a.length&&a[c]===0;)c++;if(c===a.length)return null;const u=c/o;let d=c%o*32;const g=a[c];let y=0;for(;!(g<<31-y&4294967295);)y++;return d+=y,Int32Array.from([d,u])}getBottomRightOnBit(){const o=this.rowSize,a=this.bits;let c=a.length-1;for(;c>=0&&a[c]===0;)c--;if(c<0)return null;const u=Math.floor(c/o);let d=Math.floor(c%o)*32;const g=a[c];let y=31;for(;!(g>>>y);)y--;return d+=y,Int32Array.from([d,u])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(o){if(!(o instanceof ze))return!1;const a=o;return this.width===a.width&&this.height===a.height&&this.rowSize===a.rowSize&&P.equals(this.bits,a.bits)}hashCode(){let o=this.width;return o=31*o+this.width,o=31*o+this.height,o=31*o+this.rowSize,o=31*o+P.hashCode(this.bits),o}toString(o="X ",a="  ",c=`
`){return this.buildToString(o,a,c)}buildToString(o,a,c){let u=new j;for(let d=0,g=this.height;d<g;d++){for(let y=0,w=this.width;y<w;y++)u.append(this.get(y,d)?o:a);u.append(c)}return u.toString()}clone(){return new ze(this.width,this.height,this.rowSize,this.bits.slice())}}class ie extends m{static getNotFoundInstance(){return new ie}}ie.kind="NotFoundException";class rt extends B{constructor(o){super(o),this.luminances=rt.EMPTY,this.buckets=new Int32Array(rt.LUMINANCE_BUCKETS)}getBlackRow(o,a){const c=this.getLuminanceSource(),u=c.getWidth();a==null||a.getSize()<u?a=new H(u):a.clear(),this.initArrays(u);const d=c.getRow(o,this.luminances),g=this.buckets;for(let w=0;w<u;w++)g[(d[w]&255)>>rt.LUMINANCE_SHIFT]++;const y=rt.estimateBlackPoint(g);if(u<3)for(let w=0;w<u;w++)(d[w]&255)<y&&a.set(w);else{let w=d[0]&255,E=d[1]&255;for(let T=1;T<u-1;T++){const b=d[T+1]&255;(E*4-w-b)/2<y&&a.set(T),w=E,E=b}}return a}getBlackMatrix(){const o=this.getLuminanceSource(),a=o.getWidth(),c=o.getHeight(),u=new ze(a,c);this.initArrays(a);const d=this.buckets;for(let w=1;w<5;w++){const E=Math.floor(c*w/5),T=o.getRow(E,this.luminances),b=Math.floor(a*4/5);for(let O=Math.floor(a/5);O<b;O++){const z=T[O]&255;d[z>>rt.LUMINANCE_SHIFT]++}}const g=rt.estimateBlackPoint(d),y=o.getMatrix();for(let w=0;w<c;w++){const E=w*a;for(let T=0;T<a;T++)(y[E+T]&255)<g&&u.set(T,w)}return u}createBinarizer(o){return new rt(o)}initArrays(o){this.luminances.length<o&&(this.luminances=new Uint8ClampedArray(o));const a=this.buckets;for(let c=0;c<rt.LUMINANCE_BUCKETS;c++)a[c]=0}static estimateBlackPoint(o){const a=o.length;let c=0,u=0,d=0;for(let T=0;T<a;T++)o[T]>d&&(u=T,d=o[T]),o[T]>c&&(c=o[T]);let g=0,y=0;for(let T=0;T<a;T++){const b=T-u,O=o[T]*b*b;O>y&&(g=T,y=O)}if(u>g){const T=u;u=g,g=T}if(g-u<=a/16)throw new ie;let w=g-1,E=-1;for(let T=g-1;T>u;T--){const b=T-u,O=b*b*(g-T)*(c-o[T]);O>E&&(w=T,E=O)}return w<<rt.LUMINANCE_SHIFT}}rt.LUMINANCE_BITS=5,rt.LUMINANCE_SHIFT=8-rt.LUMINANCE_BITS,rt.LUMINANCE_BUCKETS=1<<rt.LUMINANCE_BITS,rt.EMPTY=Uint8ClampedArray.from([0]);class Oe extends rt{constructor(o){super(o),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const o=this.getLuminanceSource(),a=o.getWidth(),c=o.getHeight();if(a>=Oe.MINIMUM_DIMENSION&&c>=Oe.MINIMUM_DIMENSION){const u=o.getMatrix();let d=a>>Oe.BLOCK_SIZE_POWER;a&Oe.BLOCK_SIZE_MASK&&d++;let g=c>>Oe.BLOCK_SIZE_POWER;c&Oe.BLOCK_SIZE_MASK&&g++;const y=Oe.calculateBlackPoints(u,d,g,a,c),w=new ze(a,c);Oe.calculateThresholdForBlock(u,d,g,a,c,y,w),this.matrix=w}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(o){return new Oe(o)}static calculateThresholdForBlock(o,a,c,u,d,g,y){const w=d-Oe.BLOCK_SIZE,E=u-Oe.BLOCK_SIZE;for(let T=0;T<c;T++){let b=T<<Oe.BLOCK_SIZE_POWER;b>w&&(b=w);const O=Oe.cap(T,2,c-3);for(let z=0;z<a;z++){let X=z<<Oe.BLOCK_SIZE_POWER;X>E&&(X=E);const Z=Oe.cap(z,2,a-3);let re=0;for(let xe=-2;xe<=2;xe++){const _e=g[O+xe];re+=_e[Z-2]+_e[Z-1]+_e[Z]+_e[Z+1]+_e[Z+2]}const ce=re/25;Oe.thresholdBlock(o,X,b,ce,u,y)}}}static cap(o,a,c){return o<a?a:o>c?c:o}static thresholdBlock(o,a,c,u,d,g){for(let y=0,w=c*d+a;y<Oe.BLOCK_SIZE;y++,w+=d)for(let E=0;E<Oe.BLOCK_SIZE;E++)(o[w+E]&255)<=u&&g.set(a+E,c+y)}static calculateBlackPoints(o,a,c,u,d){const g=d-Oe.BLOCK_SIZE,y=u-Oe.BLOCK_SIZE,w=new Array(c);for(let E=0;E<c;E++){w[E]=new Int32Array(a);let T=E<<Oe.BLOCK_SIZE_POWER;T>g&&(T=g);for(let b=0;b<a;b++){let O=b<<Oe.BLOCK_SIZE_POWER;O>y&&(O=y);let z=0,X=255,Z=0;for(let ce=0,xe=T*u+O;ce<Oe.BLOCK_SIZE;ce++,xe+=u){for(let _e=0;_e<Oe.BLOCK_SIZE;_e++){const me=o[xe+_e]&255;z+=me,me<X&&(X=me),me>Z&&(Z=me)}if(Z-X>Oe.MIN_DYNAMIC_RANGE)for(ce++,xe+=u;ce<Oe.BLOCK_SIZE;ce++,xe+=u)for(let _e=0;_e<Oe.BLOCK_SIZE;_e++)z+=o[xe+_e]&255}let re=z>>Oe.BLOCK_SIZE_POWER*2;if(Z-X<=Oe.MIN_DYNAMIC_RANGE&&(re=X/2,E>0&&b>0)){const ce=(w[E-1][b]+2*w[E][b-1]+w[E-1][b-1])/4;X<ce&&(re=ce)}w[E][b]=re}}return w}}Oe.BLOCK_SIZE_POWER=3,Oe.BLOCK_SIZE=1<<Oe.BLOCK_SIZE_POWER,Oe.BLOCK_SIZE_MASK=Oe.BLOCK_SIZE-1,Oe.MINIMUM_DIMENSION=Oe.BLOCK_SIZE*5,Oe.MIN_DYNAMIC_RANGE=24;class Ie{constructor(o,a){this.width=o,this.height=a}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(o,a,c,u){throw new W("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new W("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new W("This luminance source does not support rotation by 45 degrees.")}toString(){const o=new Uint8ClampedArray(this.width);let a=new j;for(let c=0;c<this.height;c++){const u=this.getRow(c,o);for(let d=0;d<this.width;d++){const g=u[d]&255;let y;g<64?y="#":g<128?y="+":g<192?y=".":y=" ",a.append(y)}a.append(`
`)}return a.toString()}}class Me extends Ie{constructor(o){super(o.getWidth(),o.getHeight()),this.delegate=o}getRow(o,a){const c=this.delegate.getRow(o,a),u=this.getWidth();for(let d=0;d<u;d++)c[d]=255-(c[d]&255);return c}getMatrix(){const o=this.delegate.getMatrix(),a=this.getWidth()*this.getHeight(),c=new Uint8ClampedArray(a);for(let u=0;u<a;u++)c[u]=255-(o[u]&255);return c}isCropSupported(){return this.delegate.isCropSupported()}crop(o,a,c,u){return new Me(this.delegate.crop(o,a,c,u))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Me(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Me(this.delegate.rotateCounterClockwise45())}}class Ue extends Ie{constructor(o){super(o.width,o.height),this.canvas=o,this.tempCanvasElement=null,this.buffer=Ue.makeBufferFromCanvasImageData(o)}static makeBufferFromCanvasImageData(o){const a=o.getContext("2d").getImageData(0,0,o.width,o.height);return Ue.toGrayscaleBuffer(a.data,o.width,o.height)}static toGrayscaleBuffer(o,a,c){const u=new Uint8ClampedArray(a*c);for(let d=0,g=0,y=o.length;d<y;d+=4,g++){let w;if(o[d+3]===0)w=255;else{const T=o[d],b=o[d+1],O=o[d+2];w=306*T+601*b+117*O+512>>10}u[g]=w}return u}getRow(o,a){if(o<0||o>=this.getHeight())throw new _("Requested row is outside the image: "+o);const c=this.getWidth(),u=o*c;return a===null?a=this.buffer.slice(u,u+c):(a.length<c&&(a=new Uint8ClampedArray(c)),a.set(this.buffer.slice(u,u+c))),a}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(o,a,c,u){return super.crop(o,a,c,u),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const o=this.canvas.ownerDocument.createElement("canvas");o.width=this.canvas.width,o.height=this.canvas.height,this.tempCanvasElement=o}return this.tempCanvasElement}rotate(o){const a=this.getTempCanvasElement(),c=a.getContext("2d"),u=o*Ue.DEGREE_TO_RADIANS,d=this.canvas.width,g=this.canvas.height,y=Math.ceil(Math.abs(Math.cos(u))*d+Math.abs(Math.sin(u))*g),w=Math.ceil(Math.abs(Math.sin(u))*d+Math.abs(Math.cos(u))*g);return a.width=y,a.height=w,c.translate(y/2,w/2),c.rotate(u),c.drawImage(this.canvas,d/-2,g/-2),this.buffer=Ue.makeBufferFromCanvasImageData(a),this}invert(){return new Me(this)}}Ue.DEGREE_TO_RADIANS=Math.PI/180;class Rt{constructor(o,a,c){this.deviceId=o,this.label=a,this.kind="videoinput",this.groupId=c||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Xe=(globalThis||Xu||self||window||void 0)&&(globalThis||Xu||self||window||void 0).__awaiter||function(S,o,a,c){function u(d){return d instanceof a?d:new a(function(g){g(d)})}return new(a||(a=Promise))(function(d,g){function y(T){try{E(c.next(T))}catch(b){g(b)}}function w(T){try{E(c.throw(T))}catch(b){g(b)}}function E(T){T.done?d(T.value):u(T.value).then(y,w)}E((c=c.apply(S,o||[])).next())})};class Tt{constructor(o,a=500,c){this.reader=o,this.timeBetweenScansMillis=a,this._hints=c,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(o){this._timeBetweenDecodingAttempts=o<0?0:o}set hints(o){this._hints=o||null}get hints(){return this._hints}listVideoInputDevices(){return Xe(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const o=yield navigator.mediaDevices.enumerateDevices(),a=[];for(const c of o){const u=c.kind==="video"?"videoinput":c.kind;if(u!=="videoinput")continue;const d=c.deviceId||c.id,g=c.label||`Video device ${a.length+1}`,y=c.groupId,w={deviceId:d,label:g,kind:u,groupId:y};a.push(w)}return a})}getVideoInputDevices(){return Xe(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(a=>new Rt(a.deviceId,a.label))})}findDeviceById(o){return Xe(this,void 0,void 0,function*(){const a=yield this.listVideoInputDevices();return a?a.find(c=>c.deviceId===o):null})}decodeFromInputVideoDevice(o,a){return Xe(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(o,a)})}decodeOnceFromVideoDevice(o,a){return Xe(this,void 0,void 0,function*(){this.reset();let c;o?c={deviceId:{exact:o}}:c={facingMode:"environment"};const u={video:c};return yield this.decodeOnceFromConstraints(u,a)})}decodeOnceFromConstraints(o,a){return Xe(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(o);return yield this.decodeOnceFromStream(c,a)})}decodeOnceFromStream(o,a){return Xe(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(o,a);return yield this.decodeOnce(c)})}decodeFromInputVideoDeviceContinuously(o,a,c){return Xe(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(o,a,c)})}decodeFromVideoDevice(o,a,c){return Xe(this,void 0,void 0,function*(){let u;o?u={deviceId:{exact:o}}:u={facingMode:"environment"};const d={video:u};return yield this.decodeFromConstraints(d,a,c)})}decodeFromConstraints(o,a,c){return Xe(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(o);return yield this.decodeFromStream(u,a,c)})}decodeFromStream(o,a,c){return Xe(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(o,a);return yield this.decodeContinuously(u,c)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(o,a){return Xe(this,void 0,void 0,function*(){const c=this.prepareVideoElement(a);return this.addVideoSource(c,o),this.videoElement=c,this.stream=o,yield this.playVideoOnLoadAsync(c),c})}playVideoOnLoadAsync(o){return new Promise((a,c)=>this.playVideoOnLoad(o,()=>a()))}playVideoOnLoad(o,a){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(o),o.addEventListener("ended",this.videoEndedListener),o.addEventListener("canplay",this.videoCanPlayListener),o.addEventListener("playing",a),this.tryPlayVideo(o)}isVideoPlaying(o){return o.currentTime>0&&!o.paused&&!o.ended&&o.readyState>2}tryPlayVideo(o){return Xe(this,void 0,void 0,function*(){if(this.isVideoPlaying(o)){console.warn("Trying to play video that is already playing.");return}try{yield o.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(o,a){const c=document.getElementById(o);if(!c)throw new x(`element with id '${o}' not found`);if(c.nodeName.toLowerCase()!==a.toLowerCase())throw new x(`element with id '${o}' must be an ${a} element`);return c}decodeFromImage(o,a){if(!o&&!a)throw new x("either imageElement with a src set or an url must be provided");return a&&!o?this.decodeFromImageUrl(a):this.decodeFromImageElement(o)}decodeFromVideo(o,a){if(!o&&!a)throw new x("Either an element with a src set or an URL must be provided");return a&&!o?this.decodeFromVideoUrl(a):this.decodeFromVideoElement(o)}decodeFromVideoContinuously(o,a,c){if(o===void 0&&a===void 0)throw new x("Either an element with a src set or an URL must be provided");return a&&!o?this.decodeFromVideoUrlContinuously(a,c):this.decodeFromVideoElementContinuously(o,c)}decodeFromImageElement(o){if(!o)throw new x("An image element must be provided.");this.reset();const a=this.prepareImageElement(o);this.imageElement=a;let c;return this.isImageLoaded(a)?c=this.decodeOnce(a,!1,!0):c=this._decodeOnLoadImage(a),c}decodeFromVideoElement(o){const a=this._decodeFromVideoElementSetup(o);return this._decodeOnLoadVideo(a)}decodeFromVideoElementContinuously(o,a){const c=this._decodeFromVideoElementSetup(o);return this._decodeOnLoadVideoContinuously(c,a)}_decodeFromVideoElementSetup(o){if(!o)throw new x("A video element must be provided.");this.reset();const a=this.prepareVideoElement(o);return this.videoElement=a,a}decodeFromImageUrl(o){if(!o)throw new x("An URL must be provided.");this.reset();const a=this.prepareImageElement();this.imageElement=a;const c=this._decodeOnLoadImage(a);return a.src=o,c}decodeFromVideoUrl(o){if(!o)throw new x("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),c=this.decodeFromVideoElement(a);return a.src=o,c}decodeFromVideoUrlContinuously(o,a){if(!o)throw new x("An URL must be provided.");this.reset();const c=this.prepareVideoElement(),u=this.decodeFromVideoElementContinuously(c,a);return c.src=o,u}_decodeOnLoadImage(o){return new Promise((a,c)=>{this.imageLoadedListener=()=>this.decodeOnce(o,!1,!0).then(a,c),o.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(o){return Xe(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(o),yield this.decodeOnce(o)})}_decodeOnLoadVideoContinuously(o,a){return Xe(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(o),this.decodeContinuously(o,a)})}isImageLoaded(o){return!(!o.complete||o.naturalWidth===0)}prepareImageElement(o){let a;return typeof o>"u"&&(a=document.createElement("img"),a.width=200,a.height=200),typeof o=="string"&&(a=this.getMediaElement(o,"img")),o instanceof HTMLImageElement&&(a=o),a}prepareVideoElement(o){let a;return!o&&typeof document<"u"&&(a=document.createElement("video"),a.width=200,a.height=200),typeof o=="string"&&(a=this.getMediaElement(o,"video")),o instanceof HTMLVideoElement&&(a=o),a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),a.setAttribute("playsinline","true"),a}decodeOnce(o,a=!0,c=!0){this._stopAsyncDecode=!1;const u=(d,g)=>{if(this._stopAsyncDecode){g(new ie("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const y=this.decode(o);d(y)}catch(y){const w=a&&y instanceof ie,T=(y instanceof R||y instanceof k)&&c;if(w||T)return setTimeout(u,this._timeBetweenDecodingAttempts,d,g);g(y)}};return new Promise((d,g)=>u(d,g))}decodeContinuously(o,a){this._stopContinuousDecode=!1;const c=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const u=this.decode(o);a(u,null),setTimeout(c,this.timeBetweenScansMillis)}catch(u){a(null,u);const d=u instanceof R||u instanceof k,g=u instanceof ie;(d||g)&&setTimeout(c,this._timeBetweenDecodingAttempts)}};c()}decode(o){const a=this.createBinaryBitmap(o);return this.decodeBitmap(a)}_isHTMLVideoElement(o){return o.videoWidth!==0}drawFrameOnCanvas(o,a,c){a||(a={sx:0,sy:0,sWidth:o.videoWidth,sHeight:o.videoHeight,dx:0,dy:0,dWidth:o.videoWidth,dHeight:o.videoHeight}),c||(c=this.captureCanvasContext),c.drawImage(o,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}drawImageOnCanvas(o,a,c=this.captureCanvasContext){a||(a={sx:0,sy:0,sWidth:o.naturalWidth,sHeight:o.naturalHeight,dx:0,dy:0,dWidth:o.naturalWidth,dHeight:o.naturalHeight}),c||(c=this.captureCanvasContext),c.drawImage(o,a.sx,a.sy,a.sWidth,a.sHeight,a.dx,a.dy,a.dWidth,a.dHeight)}createBinaryBitmap(o){this.getCaptureCanvasContext(o),this._isHTMLVideoElement(o)?this.drawFrameOnCanvas(o):this.drawImageOnCanvas(o);const a=this.getCaptureCanvas(o),c=new Ue(a),u=new Oe(c);return new I(u)}getCaptureCanvasContext(o){if(!this.captureCanvasContext){const c=this.getCaptureCanvas(o).getContext("2d");this.captureCanvasContext=c}return this.captureCanvasContext}getCaptureCanvas(o){if(!this.captureCanvas){const a=this.createCaptureCanvas(o);this.captureCanvas=a}return this.captureCanvas}decodeBitmap(o){return this.reader.decode(o,this._hints)}createCaptureCanvas(o){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const a=document.createElement("canvas");let c,u;return typeof o<"u"&&(o instanceof HTMLVideoElement?(c=o.videoWidth,u=o.videoHeight):o instanceof HTMLImageElement&&(c=o.naturalWidth||o.width,u=o.naturalHeight||o.height)),a.style.width=c+"px",a.style.height=u+"px",a.width=c,a.height=u,a}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(o=>o.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(o,a){try{o.srcObject=a}catch{o.src=URL.createObjectURL(a)}}cleanVideoSource(o){try{o.srcObject=null}catch{o.src=""}this.videoElement.removeAttribute("src")}}class Vt{constructor(o,a,c=a==null?0:8*a.length,u,d,g=D.currentTimeMillis()){this.text=o,this.rawBytes=a,this.numBits=c,this.resultPoints=u,this.format=d,this.timestamp=g,this.text=o,this.rawBytes=a,c==null?this.numBits=a==null?0:8*a.length:this.numBits=c,this.resultPoints=u,this.format=d,this.resultMetadata=null,g==null?this.timestamp=D.currentTimeMillis():this.timestamp=g}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(o,a){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(o,a)}putAllMetadata(o){o!==null&&(this.resultMetadata===null?this.resultMetadata=o:this.resultMetadata=new Map(o))}addResultPoints(o){const a=this.resultPoints;if(a===null)this.resultPoints=o;else if(o!==null&&o.length>0){const c=new Array(a.length+o.length);D.arraycopy(a,0,c,0,a.length),D.arraycopy(o,0,c,a.length,o.length),this.resultPoints=c}}getTimestamp(){return this.timestamp}toString(){return this.text}}var fr;(function(S){S[S.AZTEC=0]="AZTEC",S[S.CODABAR=1]="CODABAR",S[S.CODE_39=2]="CODE_39",S[S.CODE_93=3]="CODE_93",S[S.CODE_128=4]="CODE_128",S[S.DATA_MATRIX=5]="DATA_MATRIX",S[S.EAN_8=6]="EAN_8",S[S.EAN_13=7]="EAN_13",S[S.ITF=8]="ITF",S[S.MAXICODE=9]="MAXICODE",S[S.PDF_417=10]="PDF_417",S[S.QR_CODE=11]="QR_CODE",S[S.RSS_14=12]="RSS_14",S[S.RSS_EXPANDED=13]="RSS_EXPANDED",S[S.UPC_A=14]="UPC_A",S[S.UPC_E=15]="UPC_E",S[S.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(fr||(fr={}));var ke=fr,Qn;(function(S){S[S.OTHER=0]="OTHER",S[S.ORIENTATION=1]="ORIENTATION",S[S.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",S[S.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",S[S.ISSUE_NUMBER=4]="ISSUE_NUMBER",S[S.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",S[S.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",S[S.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",S[S.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",S[S.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",S[S.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Qn||(Qn={}));var an=Qn;class Si{constructor(o,a,c,u,d=-1,g=-1){this.rawBytes=o,this.text=a,this.byteSegments=c,this.ecLevel=u,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=g,this.numBits=o==null?0:8*o.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(o){this.numBits=o}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(o){this.errorsCorrected=o}getErasures(){return this.erasures}setErasures(o){this.erasures=o}getOther(){return this.other}setOther(o){this.other=o}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Mr{exp(o){return this.expTable[o]}log(o){if(o===0)throw new _;return this.logTable[o]}static addOrSubtract(o,a){return o^a}}class An{constructor(o,a){if(a.length===0)throw new _;this.field=o;const c=a.length;if(c>1&&a[0]===0){let u=1;for(;u<c&&a[u]===0;)u++;u===c?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(c-u),D.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(o){return this.coefficients[this.coefficients.length-1-o]}evaluateAt(o){if(o===0)return this.getCoefficient(0);const a=this.coefficients;let c;if(o===1){c=0;for(let g=0,y=a.length;g!==y;g++){const w=a[g];c=Mr.addOrSubtract(c,w)}return c}c=a[0];const u=a.length,d=this.field;for(let g=1;g<u;g++)c=Mr.addOrSubtract(d.multiply(o,c),a[g]);return c}addOrSubtract(o){if(!this.field.equals(o.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero())return o;if(o.isZero())return this;let a=this.coefficients,c=o.coefficients;if(a.length>c.length){const g=a;a=c,c=g}let u=new Int32Array(c.length);const d=c.length-a.length;D.arraycopy(c,0,u,0,d);for(let g=d;g<c.length;g++)u[g]=Mr.addOrSubtract(a[g-d],c[g]);return new An(this.field,u)}multiply(o){if(!this.field.equals(o.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero()||o.isZero())return this.field.getZero();const a=this.coefficients,c=a.length,u=o.coefficients,d=u.length,g=new Int32Array(c+d-1),y=this.field;for(let w=0;w<c;w++){const E=a[w];for(let T=0;T<d;T++)g[w+T]=Mr.addOrSubtract(g[w+T],y.multiply(E,u[T]))}return new An(y,g)}multiplyScalar(o){if(o===0)return this.field.getZero();if(o===1)return this;const a=this.coefficients.length,c=this.field,u=new Int32Array(a),d=this.coefficients;for(let g=0;g<a;g++)u[g]=c.multiply(d[g],o);return new An(c,u)}multiplyByMonomial(o,a){if(o<0)throw new _;if(a===0)return this.field.getZero();const c=this.coefficients,u=c.length,d=new Int32Array(u+o),g=this.field;for(let y=0;y<u;y++)d[y]=g.multiply(c[y],a);return new An(g,d)}divide(o){if(!this.field.equals(o.field))throw new _("GenericGFPolys do not have same GenericGF field");if(o.isZero())throw new _("Divide by 0");const a=this.field;let c=a.getZero(),u=this;const d=o.getCoefficient(o.getDegree()),g=a.inverse(d);for(;u.getDegree()>=o.getDegree()&&!u.isZero();){const y=u.getDegree()-o.getDegree(),w=a.multiply(u.getCoefficient(u.getDegree()),g),E=o.multiplyByMonomial(y,w),T=a.buildMonomial(y,w);c=c.addOrSubtract(T),u=u.addOrSubtract(E)}return[c,u]}toString(){let o="";for(let a=this.getDegree();a>=0;a--){let c=this.getCoefficient(a);if(c!==0){if(c<0?(o+=" - ",c=-c):o.length>0&&(o+=" + "),a===0||c!==1){const u=this.field.log(c);u===0?o+="1":u===1?o+="a":(o+="a^",o+=u)}a!==0&&(a===1?o+="x":(o+="x^",o+=a))}}return o}}class bi extends m{}bi.kind="ArithmeticException";class ot extends Mr{constructor(o,a,c){super(),this.primitive=o,this.size=a,this.generatorBase=c;const u=new Int32Array(a);let d=1;for(let y=0;y<a;y++)u[y]=d,d*=2,d>=a&&(d^=o,d&=a-1);this.expTable=u;const g=new Int32Array(a);for(let y=0;y<a-1;y++)g[u[y]]=y;this.logTable=g,this.zero=new An(this,Int32Array.from([0])),this.one=new An(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(o,a){if(o<0)throw new _;if(a===0)return this.zero;const c=new Int32Array(o+1);return c[0]=a,new An(this,c)}inverse(o){if(o===0)throw new bi;return this.expTable[this.size-this.logTable[o]-1]}multiply(o,a){return o===0||a===0?0:this.expTable[(this.logTable[o]+this.logTable[a])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+N.toHexString(this.primitive)+","+this.size+")"}equals(o){return o===this}}ot.AZTEC_DATA_12=new ot(4201,4096,1),ot.AZTEC_DATA_10=new ot(1033,1024,1),ot.AZTEC_DATA_6=new ot(67,64,1),ot.AZTEC_PARAM=new ot(19,16,1),ot.QR_CODE_FIELD_256=new ot(285,256,0),ot.DATA_MATRIX_FIELD_256=new ot(301,256,1),ot.AZTEC_DATA_8=ot.DATA_MATRIX_FIELD_256,ot.MAXICODE_FIELD_64=ot.AZTEC_DATA_6;class Yr extends m{}Yr.kind="ReedSolomonException";class rr extends m{}rr.kind="IllegalStateException";class Zi{constructor(o){this.field=o}decode(o,a){const c=this.field,u=new An(c,o),d=new Int32Array(a);let g=!0;for(let z=0;z<a;z++){const X=u.evaluateAt(c.exp(z+c.getGeneratorBase()));d[d.length-1-z]=X,X!==0&&(g=!1)}if(g)return;const y=new An(c,d),w=this.runEuclideanAlgorithm(c.buildMonomial(a,1),y,a),E=w[0],T=w[1],b=this.findErrorLocations(E),O=this.findErrorMagnitudes(T,b);for(let z=0;z<b.length;z++){const X=o.length-1-c.log(b[z]);if(X<0)throw new Yr("Bad error location");o[X]=ot.addOrSubtract(o[X],O[z])}}runEuclideanAlgorithm(o,a,c){if(o.getDegree()<a.getDegree()){const z=o;o=a,a=z}const u=this.field;let d=o,g=a,y=u.getZero(),w=u.getOne();for(;g.getDegree()>=(c/2|0);){let z=d,X=y;if(d=g,y=w,d.isZero())throw new Yr("r_{i-1} was zero");g=z;let Z=u.getZero();const re=d.getCoefficient(d.getDegree()),ce=u.inverse(re);for(;g.getDegree()>=d.getDegree()&&!g.isZero();){const xe=g.getDegree()-d.getDegree(),_e=u.multiply(g.getCoefficient(g.getDegree()),ce);Z=Z.addOrSubtract(u.buildMonomial(xe,_e)),g=g.addOrSubtract(d.multiplyByMonomial(xe,_e))}if(w=Z.multiply(y).addOrSubtract(X),g.getDegree()>=d.getDegree())throw new rr("Division algorithm failed to reduce polynomial?")}const E=w.getCoefficient(0);if(E===0)throw new Yr("sigmaTilde(0) was zero");const T=u.inverse(E),b=w.multiplyScalar(T),O=g.multiplyScalar(T);return[b,O]}findErrorLocations(o){const a=o.getDegree();if(a===1)return Int32Array.from([o.getCoefficient(1)]);const c=new Int32Array(a);let u=0;const d=this.field;for(let g=1;g<d.getSize()&&u<a;g++)o.evaluateAt(g)===0&&(c[u]=d.inverse(g),u++);if(u!==a)throw new Yr("Error locator degree does not match number of roots");return c}findErrorMagnitudes(o,a){const c=a.length,u=new Int32Array(c),d=this.field;for(let g=0;g<c;g++){const y=d.inverse(a[g]);let w=1;for(let E=0;E<c;E++)if(g!==E){const T=d.multiply(a[E],y),b=T&1?T&-2:T|1;w=d.multiply(w,b)}u[g]=d.multiply(o.evaluateAt(y),d.inverse(w)),d.getGeneratorBase()!==0&&(u[g]=d.multiply(u[g],y))}return u}}var mn;(function(S){S[S.UPPER=0]="UPPER",S[S.LOWER=1]="LOWER",S[S.MIXED=2]="MIXED",S[S.DIGIT=3]="DIGIT",S[S.PUNCT=4]="PUNCT",S[S.BINARY=5]="BINARY"})(mn||(mn={}));class Nt{decode(o){this.ddata=o;let a=o.getBits(),c=this.extractBits(a),u=this.correctBits(c),d=Nt.convertBoolArrayToByteArray(u),g=Nt.getEncodedData(u),y=new Si(d,g,null,null);return y.setNumBits(u.length),y}static highLevelDecode(o){return this.getEncodedData(o)}static getEncodedData(o){let a=o.length,c=mn.UPPER,u=mn.UPPER,d="",g=0;for(;g<a;)if(u===mn.BINARY){if(a-g<5)break;let y=Nt.readCode(o,g,5);if(g+=5,y===0){if(a-g<11)break;y=Nt.readCode(o,g,11)+31,g+=11}for(let w=0;w<y;w++){if(a-g<8){g=a;break}const E=Nt.readCode(o,g,8);d+=q.castAsNonUtf8Char(E),g+=8}u=c}else{let y=u===mn.DIGIT?4:5;if(a-g<y)break;let w=Nt.readCode(o,g,y);g+=y;let E=Nt.getCharacter(u,w);E.startsWith("CTRL_")?(c=u,u=Nt.getTable(E.charAt(5)),E.charAt(6)==="L"&&(c=u)):(d+=E,u=c)}return d}static getTable(o){switch(o){case"L":return mn.LOWER;case"P":return mn.PUNCT;case"M":return mn.MIXED;case"D":return mn.DIGIT;case"B":return mn.BINARY;case"U":default:return mn.UPPER}}static getCharacter(o,a){switch(o){case mn.UPPER:return Nt.UPPER_TABLE[a];case mn.LOWER:return Nt.LOWER_TABLE[a];case mn.MIXED:return Nt.MIXED_TABLE[a];case mn.PUNCT:return Nt.PUNCT_TABLE[a];case mn.DIGIT:return Nt.DIGIT_TABLE[a];default:throw new rr("Bad table")}}correctBits(o){let a,c;this.ddata.getNbLayers()<=2?(c=6,a=ot.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(c=8,a=ot.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(c=10,a=ot.AZTEC_DATA_10):(c=12,a=ot.AZTEC_DATA_12);let u=this.ddata.getNbDatablocks(),d=o.length/c;if(d<u)throw new k;let g=o.length%c,y=new Int32Array(d);for(let O=0;O<d;O++,g+=c)y[O]=Nt.readCode(o,g,c);try{new Zi(a).decode(y,d-u)}catch(O){throw new k(O)}let w=(1<<c)-1,E=0;for(let O=0;O<u;O++){let z=y[O];if(z===0||z===w)throw new k;(z===1||z===w-1)&&E++}let T=new Array(u*c-E),b=0;for(let O=0;O<u;O++){let z=y[O];if(z===1||z===w-1)T.fill(z>1,b,b+c-1),b+=c-1;else for(let X=c-1;X>=0;--X)T[b++]=(z&1<<X)!==0}return T}extractBits(o){let a=this.ddata.isCompact(),c=this.ddata.getNbLayers(),u=(a?11:14)+c*4,d=new Int32Array(u),g=new Array(this.totalBitsInLayer(c,a));if(a)for(let y=0;y<d.length;y++)d[y]=y;else{let y=u+1+2*N.truncDivision(N.truncDivision(u,2)-1,15),w=u/2,E=N.truncDivision(y,2);for(let T=0;T<w;T++){let b=T+N.truncDivision(T,15);d[w-T-1]=E-b-1,d[w+T]=E+b+1}}for(let y=0,w=0;y<c;y++){let E=(c-y)*4+(a?9:12),T=y*2,b=u-1-T;for(let O=0;O<E;O++){let z=O*2;for(let X=0;X<2;X++)g[w+z+X]=o.get(d[T+X],d[T+O]),g[w+2*E+z+X]=o.get(d[T+O],d[b-X]),g[w+4*E+z+X]=o.get(d[b-X],d[b-O]),g[w+6*E+z+X]=o.get(d[b-O],d[T+X])}w+=E*8}return g}static readCode(o,a,c){let u=0;for(let d=a;d<a+c;d++)u<<=1,o[d]&&(u|=1);return u}static readByte(o,a){let c=o.length-a;return c>=8?Nt.readCode(o,a,8):Nt.readCode(o,a,c)<<8-c}static convertBoolArrayToByteArray(o){let a=new Uint8Array((o.length+7)/8);for(let c=0;c<a.length;c++)a[c]=Nt.readByte(o,8*c);return a}totalBitsInLayer(o,a){return((a?88:112)+16*o)*o}}Nt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Nt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Nt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class it{constructor(){}static round(o){return o===NaN?0:o<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:o>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:o+(o<0?-.5:.5)|0}static distance(o,a,c,u){const d=o-c,g=a-u;return Math.sqrt(d*d+g*g)}static sum(o){let a=0;for(let c=0,u=o.length;c!==u;c++){const d=o[c];a+=d}return a}}class ${static floatToIntBits(o){return o}}$.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Q{constructor(o,a){this.x=o,this.y=a}getX(){return this.x}getY(){return this.y}equals(o){if(o instanceof Q){const a=o;return this.x===a.x&&this.y===a.y}return!1}hashCode(){return 31*$.floatToIntBits(this.x)+$.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(o){const a=this.distance(o[0],o[1]),c=this.distance(o[1],o[2]),u=this.distance(o[0],o[2]);let d,g,y;if(c>=a&&c>=u?(g=o[0],d=o[1],y=o[2]):u>=c&&u>=a?(g=o[1],d=o[0],y=o[2]):(g=o[2],d=o[0],y=o[1]),this.crossProductZ(d,g,y)<0){const w=d;d=y,y=w}o[0]=d,o[1]=g,o[2]=y}static distance(o,a){return it.distance(o.x,o.y,a.x,a.y)}static crossProductZ(o,a,c){const u=a.x,d=a.y;return(c.x-u)*(o.y-d)-(c.y-d)*(o.x-u)}}class ue{constructor(o,a){this.bits=o,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class Ce extends ue{constructor(o,a,c,u,d){super(o,a),this.compact=c,this.nbDatablocks=u,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class we{constructor(o,a,c,u){this.image=o,this.height=o.getHeight(),this.width=o.getWidth(),a==null&&(a=we.INIT_SIZE),c==null&&(c=o.getWidth()/2|0),u==null&&(u=o.getHeight()/2|0);const d=a/2|0;if(this.leftInit=c-d,this.rightInit=c+d,this.upInit=u-d,this.downInit=u+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ie}detect(){let o=this.leftInit,a=this.rightInit,c=this.upInit,u=this.downInit,d=!1,g=!0,y=!1,w=!1,E=!1,T=!1,b=!1;const O=this.width,z=this.height;for(;g;){g=!1;let X=!0;for(;(X||!w)&&a<O;)X=this.containsBlackPoint(c,u,a,!1),X?(a++,g=!0,w=!0):w||a++;if(a>=O){d=!0;break}let Z=!0;for(;(Z||!E)&&u<z;)Z=this.containsBlackPoint(o,a,u,!0),Z?(u++,g=!0,E=!0):E||u++;if(u>=z){d=!0;break}let re=!0;for(;(re||!T)&&o>=0;)re=this.containsBlackPoint(c,u,o,!1),re?(o--,g=!0,T=!0):T||o--;if(o<0){d=!0;break}let ce=!0;for(;(ce||!b)&&c>=0;)ce=this.containsBlackPoint(o,a,c,!0),ce?(c--,g=!0,b=!0):b||c--;if(c<0){d=!0;break}g&&(y=!0)}if(!d&&y){const X=a-o;let Z=null;for(let _e=1;Z===null&&_e<X;_e++)Z=this.getBlackPointOnSegment(o,u-_e,o+_e,u);if(Z==null)throw new ie;let re=null;for(let _e=1;re===null&&_e<X;_e++)re=this.getBlackPointOnSegment(o,c+_e,o+_e,c);if(re==null)throw new ie;let ce=null;for(let _e=1;ce===null&&_e<X;_e++)ce=this.getBlackPointOnSegment(a,c+_e,a-_e,c);if(ce==null)throw new ie;let xe=null;for(let _e=1;xe===null&&_e<X;_e++)xe=this.getBlackPointOnSegment(a,u-_e,a-_e,u);if(xe==null)throw new ie;return this.centerEdges(xe,Z,ce,re)}else throw new ie}getBlackPointOnSegment(o,a,c,u){const d=it.round(it.distance(o,a,c,u)),g=(c-o)/d,y=(u-a)/d,w=this.image;for(let E=0;E<d;E++){const T=it.round(o+E*g),b=it.round(a+E*y);if(w.get(T,b))return new Q(T,b)}return null}centerEdges(o,a,c,u){const d=o.getX(),g=o.getY(),y=a.getX(),w=a.getY(),E=c.getX(),T=c.getY(),b=u.getX(),O=u.getY(),z=we.CORR;return d<this.width/2?[new Q(b-z,O+z),new Q(y+z,w+z),new Q(E-z,T-z),new Q(d+z,g-z)]:[new Q(b+z,O+z),new Q(y+z,w-z),new Q(E-z,T+z),new Q(d-z,g-z)]}containsBlackPoint(o,a,c,u){const d=this.image;if(u){for(let g=o;g<=a;g++)if(d.get(g,c))return!0}else for(let g=o;g<=a;g++)if(d.get(c,g))return!0;return!1}}we.INIT_SIZE=10,we.CORR=1;class pe{static checkAndNudgePoints(o,a){const c=o.getWidth(),u=o.getHeight();let d=!0;for(let g=0;g<a.length&&d;g+=2){const y=Math.floor(a[g]),w=Math.floor(a[g+1]);if(y<-1||y>c||w<-1||w>u)throw new ie;d=!1,y===-1?(a[g]=0,d=!0):y===c&&(a[g]=c-1,d=!0),w===-1?(a[g+1]=0,d=!0):w===u&&(a[g+1]=u-1,d=!0)}d=!0;for(let g=a.length-2;g>=0&&d;g-=2){const y=Math.floor(a[g]),w=Math.floor(a[g+1]);if(y<-1||y>c||w<-1||w>u)throw new ie;d=!1,y===-1?(a[g]=0,d=!0):y===c&&(a[g]=c-1,d=!0),w===-1?(a[g+1]=0,d=!0):w===u&&(a[g+1]=u-1,d=!0)}}}class be{constructor(o,a,c,u,d,g,y,w,E){this.a11=o,this.a21=a,this.a31=c,this.a12=u,this.a22=d,this.a32=g,this.a13=y,this.a23=w,this.a33=E}static quadrilateralToQuadrilateral(o,a,c,u,d,g,y,w,E,T,b,O,z,X,Z,re){const ce=be.quadrilateralToSquare(o,a,c,u,d,g,y,w);return be.squareToQuadrilateral(E,T,b,O,z,X,Z,re).times(ce)}transformPoints(o){const a=o.length,c=this.a11,u=this.a12,d=this.a13,g=this.a21,y=this.a22,w=this.a23,E=this.a31,T=this.a32,b=this.a33;for(let O=0;O<a;O+=2){const z=o[O],X=o[O+1],Z=d*z+w*X+b;o[O]=(c*z+g*X+E)/Z,o[O+1]=(u*z+y*X+T)/Z}}transformPointsWithValues(o,a){const c=this.a11,u=this.a12,d=this.a13,g=this.a21,y=this.a22,w=this.a23,E=this.a31,T=this.a32,b=this.a33,O=o.length;for(let z=0;z<O;z++){const X=o[z],Z=a[z],re=d*X+w*Z+b;o[z]=(c*X+g*Z+E)/re,a[z]=(u*X+y*Z+T)/re}}static squareToQuadrilateral(o,a,c,u,d,g,y,w){const E=o-c+d-y,T=a-u+g-w;if(E===0&&T===0)return new be(c-o,d-c,o,u-a,g-u,a,0,0,1);{const b=c-d,O=y-d,z=u-g,X=w-g,Z=b*X-O*z,re=(E*X-O*T)/Z,ce=(b*T-E*z)/Z;return new be(c-o+re*c,y-o+ce*y,o,u-a+re*u,w-a+ce*w,a,re,ce,1)}}static quadrilateralToSquare(o,a,c,u,d,g,y,w){return be.squareToQuadrilateral(o,a,c,u,d,g,y,w).buildAdjoint()}buildAdjoint(){return new be(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(o){return new be(this.a11*o.a11+this.a21*o.a12+this.a31*o.a13,this.a11*o.a21+this.a21*o.a22+this.a31*o.a23,this.a11*o.a31+this.a21*o.a32+this.a31*o.a33,this.a12*o.a11+this.a22*o.a12+this.a32*o.a13,this.a12*o.a21+this.a22*o.a22+this.a32*o.a23,this.a12*o.a31+this.a22*o.a32+this.a32*o.a33,this.a13*o.a11+this.a23*o.a12+this.a33*o.a13,this.a13*o.a21+this.a23*o.a22+this.a33*o.a23,this.a13*o.a31+this.a23*o.a32+this.a33*o.a33)}}class We extends pe{sampleGrid(o,a,c,u,d,g,y,w,E,T,b,O,z,X,Z,re,ce,xe,_e){const me=be.quadrilateralToQuadrilateral(u,d,g,y,w,E,T,b,O,z,X,Z,re,ce,xe,_e);return this.sampleGridWithTransform(o,a,c,me)}sampleGridWithTransform(o,a,c,u){if(a<=0||c<=0)throw new ie;const d=new ze(a,c),g=new Float32Array(2*a);for(let y=0;y<c;y++){const w=g.length,E=y+.5;for(let T=0;T<w;T+=2)g[T]=T/2+.5,g[T+1]=E;u.transformPoints(g),pe.checkAndNudgePoints(o,g);try{for(let T=0;T<w;T+=2)o.get(Math.floor(g[T]),Math.floor(g[T+1]))&&d.set(T/2,y)}catch{throw new ie}}return d}}class Ge{static setGridSampler(o){Ge.gridSampler=o}static getInstance(){return Ge.gridSampler}}Ge.gridSampler=new We;class Et{constructor(o,a){this.x=o,this.y=a}toResultPoint(){return new Q(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Ji{constructor(o){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=o}detect(){return this.detectMirror(!1)}detectMirror(o){let a=this.getMatrixCenter(),c=this.getBullsEyeCorners(a);if(o){let g=c[0];c[0]=c[2],c[2]=g}this.extractParameters(c);let u=this.sampleGrid(this.image,c[this.shift%4],c[(this.shift+1)%4],c[(this.shift+2)%4],c[(this.shift+3)%4]),d=this.getMatrixCornerPoints(c);return new Ce(u,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(o){if(!this.isValidPoint(o[0])||!this.isValidPoint(o[1])||!this.isValidPoint(o[2])||!this.isValidPoint(o[3]))throw new ie;let a=2*this.nbCenterLayers,c=new Int32Array([this.sampleLine(o[0],o[1],a),this.sampleLine(o[1],o[2],a),this.sampleLine(o[2],o[3],a),this.sampleLine(o[3],o[0],a)]);this.shift=this.getRotation(c,a);let u=0;for(let g=0;g<4;g++){let y=c[(this.shift+g)%4];this.compact?(u<<=7,u+=y>>1&127):(u<<=10,u+=(y>>2&992)+(y>>1&31))}let d=this.getCorrectedParameterData(u,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(o,a){let c=0;o.forEach((u,d,g)=>{let y=(u>>a-2<<1)+(u&1);c=(c<<3)+y}),c=((c&1)<<11)+(c>>1);for(let u=0;u<4;u++)if(N.bitCount(c^this.EXPECTED_CORNER_BITS[u])<=2)return u;throw new ie}getCorrectedParameterData(o,a){let c,u;a?(c=7,u=2):(c=10,u=4);let d=c-u,g=new Int32Array(c);for(let w=c-1;w>=0;--w)g[w]=o&15,o>>=4;try{new Zi(ot.AZTEC_PARAM).decode(g,d)}catch{throw new ie}let y=0;for(let w=0;w<u;w++)y=(y<<4)+g[w];return y}getBullsEyeCorners(o){let a=o,c=o,u=o,d=o,g=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let b=this.getFirstDifferent(a,g,1,-1),O=this.getFirstDifferent(c,g,1,1),z=this.getFirstDifferent(u,g,-1,1),X=this.getFirstDifferent(d,g,-1,-1);if(this.nbCenterLayers>2){let Z=this.distancePoint(X,b)*this.nbCenterLayers/(this.distancePoint(d,a)*(this.nbCenterLayers+2));if(Z<.75||Z>1.25||!this.isWhiteOrBlackRectangle(b,O,z,X))break}a=b,c=O,u=z,d=X,g=!g}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ie;this.compact=this.nbCenterLayers===5;let y=new Q(a.getX()+.5,a.getY()-.5),w=new Q(c.getX()+.5,c.getY()+.5),E=new Q(u.getX()-.5,u.getY()+.5),T=new Q(d.getX()-.5,d.getY()-.5);return this.expandSquare([y,w,E,T],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let o,a,c,u;try{let y=new we(this.image).detect();o=y[0],a=y[1],c=y[2],u=y[3]}catch{let w=this.image.getWidth()/2,E=this.image.getHeight()/2;o=this.getFirstDifferent(new Et(w+7,E-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new Et(w+7,E+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Et(w-7,E+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Et(w-7,E-7),!1,-1,-1).toResultPoint()}let d=it.round((o.getX()+u.getX()+a.getX()+c.getX())/4),g=it.round((o.getY()+u.getY()+a.getY()+c.getY())/4);try{let y=new we(this.image,15,d,g).detect();o=y[0],a=y[1],c=y[2],u=y[3]}catch{o=this.getFirstDifferent(new Et(d+7,g-7),!1,1,-1).toResultPoint(),a=this.getFirstDifferent(new Et(d+7,g+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Et(d-7,g+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Et(d-7,g-7),!1,-1,-1).toResultPoint()}return d=it.round((o.getX()+u.getX()+a.getX()+c.getX())/4),g=it.round((o.getY()+u.getY()+a.getY()+c.getY())/4),new Et(d,g)}getMatrixCornerPoints(o){return this.expandSquare(o,2*this.nbCenterLayers,this.getDimension())}sampleGrid(o,a,c,u,d){let g=Ge.getInstance(),y=this.getDimension(),w=y/2-this.nbCenterLayers,E=y/2+this.nbCenterLayers;return g.sampleGrid(o,y,y,w,w,E,w,E,E,w,E,a.getX(),a.getY(),c.getX(),c.getY(),u.getX(),u.getY(),d.getX(),d.getY())}sampleLine(o,a,c){let u=0,d=this.distanceResultPoint(o,a),g=d/c,y=o.getX(),w=o.getY(),E=g*(a.getX()-o.getX())/d,T=g*(a.getY()-o.getY())/d;for(let b=0;b<c;b++)this.image.get(it.round(y+b*E),it.round(w+b*T))&&(u|=1<<c-b-1);return u}isWhiteOrBlackRectangle(o,a,c,u){let d=3;o=new Et(o.getX()-d,o.getY()+d),a=new Et(a.getX()-d,a.getY()-d),c=new Et(c.getX()+d,c.getY()-d),u=new Et(u.getX()+d,u.getY()+d);let g=this.getColor(u,o);if(g===0)return!1;let y=this.getColor(o,a);return y!==g||(y=this.getColor(a,c),y!==g)?!1:(y=this.getColor(c,u),y===g)}getColor(o,a){let c=this.distancePoint(o,a),u=(a.getX()-o.getX())/c,d=(a.getY()-o.getY())/c,g=0,y=o.getX(),w=o.getY(),E=this.image.get(o.getX(),o.getY()),T=Math.ceil(c);for(let O=0;O<T;O++)y+=u,w+=d,this.image.get(it.round(y),it.round(w))!==E&&g++;let b=g/c;return b>.1&&b<.9?0:b<=.1===E?1:-1}getFirstDifferent(o,a,c,u){let d=o.getX()+c,g=o.getY()+u;for(;this.isValid(d,g)&&this.image.get(d,g)===a;)d+=c,g+=u;for(d-=c,g-=u;this.isValid(d,g)&&this.image.get(d,g)===a;)d+=c;for(d-=c;this.isValid(d,g)&&this.image.get(d,g)===a;)g+=u;return g-=u,new Et(d,g)}expandSquare(o,a,c){let u=c/(2*a),d=o[0].getX()-o[2].getX(),g=o[0].getY()-o[2].getY(),y=(o[0].getX()+o[2].getX())/2,w=(o[0].getY()+o[2].getY())/2,E=new Q(y+u*d,w+u*g),T=new Q(y-u*d,w-u*g);d=o[1].getX()-o[3].getX(),g=o[1].getY()-o[3].getY(),y=(o[1].getX()+o[3].getX())/2,w=(o[1].getY()+o[3].getY())/2;let b=new Q(y+u*d,w+u*g),O=new Q(y-u*d,w-u*g);return[E,b,T,O]}isValid(o,a){return o>=0&&o<this.image.getWidth()&&a>0&&a<this.image.getHeight()}isValidPoint(o){let a=it.round(o.getX()),c=it.round(o.getY());return this.isValid(a,c)}distancePoint(o,a){return it.distance(o.getX(),o.getY(),a.getX(),a.getY())}distanceResultPoint(o,a){return it.distance(o.getX(),o.getY(),a.getX(),a.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(N.truncDivision(this.nbLayers-4,8)+1)+15}}class gr{decode(o,a=null){let c=null,u=new Ji(o.getBlackMatrix()),d=null,g=null;try{let T=u.detectMirror(!1);d=T.getPoints(),this.reportFoundResultPoints(a,d),g=new Nt().decode(T)}catch(T){c=T}if(g==null)try{let T=u.detectMirror(!0);d=T.getPoints(),this.reportFoundResultPoints(a,d),g=new Nt().decode(T)}catch(T){throw c??T}let y=new Vt(g.getText(),g.getRawBytes(),g.getNumBits(),d,ke.AZTEC,D.currentTimeMillis()),w=g.getByteSegments();w!=null&&y.putMetadata(an.BYTE_SEGMENTS,w);let E=g.getECLevel();return E!=null&&y.putMetadata(an.ERROR_CORRECTION_LEVEL,E),y}reportFoundResultPoints(o,a){if(o!=null){let c=o.get(J.NEED_RESULT_POINT_CALLBACK);c!=null&&a.forEach((u,d,g)=>{c.foundPossibleResultPoint(u)})}}reset(){}}class Lu extends Tt{constructor(o=500){super(new gr,o)}}class bt{decode(o,a){try{return this.doDecode(o,a)}catch{if(a&&a.get(J.TRY_HARDER)===!0&&o.isRotateSupported()){const d=o.rotateCounterClockwise(),g=this.doDecode(d,a),y=g.getResultMetadata();let w=270;y!==null&&y.get(an.ORIENTATION)===!0&&(w=w+y.get(an.ORIENTATION)%360),g.putMetadata(an.ORIENTATION,w);const E=g.getResultPoints();if(E!==null){const T=d.getHeight();for(let b=0;b<E.length;b++)E[b]=new Q(T-E[b].getY()-1,E[b].getX())}return g}else throw new ie}}reset(){}doDecode(o,a){const c=o.getWidth(),u=o.getHeight();let d=new H(c);const g=a&&a.get(J.TRY_HARDER)===!0,y=Math.max(1,u>>(g?8:5));let w;g?w=u:w=15;const E=Math.trunc(u/2);for(let T=0;T<w;T++){const b=Math.trunc((T+1)/2),O=(T&1)===0,z=E+y*(O?b:-b);if(z<0||z>=u)break;try{d=o.getBlackRow(z,d)}catch{continue}for(let X=0;X<2;X++){if(X===1&&(d.reverse(),a&&a.get(J.NEED_RESULT_POINT_CALLBACK)===!0)){const Z=new Map;a.forEach((re,ce)=>Z.set(ce,re)),Z.delete(J.NEED_RESULT_POINT_CALLBACK),a=Z}try{const Z=this.decodeRow(z,d,a);if(X===1){Z.putMetadata(an.ORIENTATION,180);const re=Z.getResultPoints();re!==null&&(re[0]=new Q(c-re[0].getX()-1,re[0].getY()),re[1]=new Q(c-re[1].getX()-1,re[1].getY()))}return Z}catch{}}}throw new ie}static recordPattern(o,a,c){const u=c.length;for(let E=0;E<u;E++)c[E]=0;const d=o.getSize();if(a>=d)throw new ie;let g=!o.get(a),y=0,w=a;for(;w<d;){if(o.get(w)!==g)c[y]++;else{if(++y===u)break;c[y]=1,g=!g}w++}if(!(y===u||y===u-1&&w===d))throw new ie}static recordPatternInReverse(o,a,c){let u=c.length,d=o.get(a);for(;a>0&&u>=0;)o.get(--a)!==d&&(u--,d=!d);if(u>=0)throw new ie;bt.recordPattern(o,a+1,c)}static patternMatchVariance(o,a,c){const u=o.length;let d=0,g=0;for(let E=0;E<u;E++)d+=o[E],g+=a[E];if(d<g)return Number.POSITIVE_INFINITY;const y=d/g;c*=y;let w=0;for(let E=0;E<u;E++){const T=o[E],b=a[E]*y,O=T>b?T-b:b-T;if(O>c)return Number.POSITIVE_INFINITY;w+=O}return w/d}}class Ee extends bt{static findStartPattern(o){const a=o.getSize(),c=o.getNextSet(0);let u=0,d=Int32Array.from([0,0,0,0,0,0]),g=c,y=!1;const w=6;for(let E=c;E<a;E++)if(o.get(E)!==y)d[u]++;else{if(u===w-1){let T=Ee.MAX_AVG_VARIANCE,b=-1;for(let O=Ee.CODE_START_A;O<=Ee.CODE_START_C;O++){const z=bt.patternMatchVariance(d,Ee.CODE_PATTERNS[O],Ee.MAX_INDIVIDUAL_VARIANCE);z<T&&(T=z,b=O)}if(b>=0&&o.isRange(Math.max(0,g-(E-g)/2),g,!1))return Int32Array.from([g,E,b]);g+=d[0]+d[1],d=d.slice(2,d.length-1),d[u-1]=0,d[u]=0,u--}else u++;d[u]=1,y=!y}throw new ie}static decodeCode(o,a,c){bt.recordPattern(o,c,a);let u=Ee.MAX_AVG_VARIANCE,d=-1;for(let g=0;g<Ee.CODE_PATTERNS.length;g++){const y=Ee.CODE_PATTERNS[g],w=this.patternMatchVariance(a,y,Ee.MAX_INDIVIDUAL_VARIANCE);w<u&&(u=w,d=g)}if(d>=0)return d;throw new ie}decodeRow(o,a,c){const u=c&&c.get(J.ASSUME_GS1)===!0,d=Ee.findStartPattern(a),g=d[2];let y=0;const w=new Uint8Array(20);w[y++]=g;let E;switch(g){case Ee.CODE_START_A:E=Ee.CODE_CODE_A;break;case Ee.CODE_START_B:E=Ee.CODE_CODE_B;break;case Ee.CODE_START_C:E=Ee.CODE_CODE_C;break;default:throw new k}let T=!1,b=!1,O="",z=d[0],X=d[1];const Z=Int32Array.from([0,0,0,0,0,0]);let re=0,ce=0,xe=g,_e=0,me=!0,ct=!1,et=!1;for(;!T;){const nc=b;switch(b=!1,re=ce,ce=Ee.decodeCode(a,Z,X),w[y++]=ce,ce!==Ee.CODE_STOP&&(me=!0),ce!==Ee.CODE_STOP&&(_e++,xe+=_e*ce),z=X,X+=Z.reduce((O3,M3)=>O3+M3,0),ce){case Ee.CODE_START_A:case Ee.CODE_START_B:case Ee.CODE_START_C:throw new k}switch(E){case Ee.CODE_CODE_A:if(ce<64)et===ct?O+=String.fromCharCode(" ".charCodeAt(0)+ce):O+=String.fromCharCode(" ".charCodeAt(0)+ce+128),et=!1;else if(ce<96)et===ct?O+=String.fromCharCode(ce-64):O+=String.fromCharCode(ce+64),et=!1;else switch(ce!==Ee.CODE_STOP&&(me=!1),ce){case Ee.CODE_FNC_1:u&&(O.length===0?O+="]C1":O+=String.fromCharCode(29));break;case Ee.CODE_FNC_2:case Ee.CODE_FNC_3:break;case Ee.CODE_FNC_4_A:!ct&&et?(ct=!0,et=!1):ct&&et?(ct=!1,et=!1):et=!0;break;case Ee.CODE_SHIFT:b=!0,E=Ee.CODE_CODE_B;break;case Ee.CODE_CODE_B:E=Ee.CODE_CODE_B;break;case Ee.CODE_CODE_C:E=Ee.CODE_CODE_C;break;case Ee.CODE_STOP:T=!0;break}break;case Ee.CODE_CODE_B:if(ce<96)et===ct?O+=String.fromCharCode(" ".charCodeAt(0)+ce):O+=String.fromCharCode(" ".charCodeAt(0)+ce+128),et=!1;else switch(ce!==Ee.CODE_STOP&&(me=!1),ce){case Ee.CODE_FNC_1:u&&(O.length===0?O+="]C1":O+=String.fromCharCode(29));break;case Ee.CODE_FNC_2:case Ee.CODE_FNC_3:break;case Ee.CODE_FNC_4_B:!ct&&et?(ct=!0,et=!1):ct&&et?(ct=!1,et=!1):et=!0;break;case Ee.CODE_SHIFT:b=!0,E=Ee.CODE_CODE_A;break;case Ee.CODE_CODE_A:E=Ee.CODE_CODE_A;break;case Ee.CODE_CODE_C:E=Ee.CODE_CODE_C;break;case Ee.CODE_STOP:T=!0;break}break;case Ee.CODE_CODE_C:if(ce<100)ce<10&&(O+="0"),O+=ce;else switch(ce!==Ee.CODE_STOP&&(me=!1),ce){case Ee.CODE_FNC_1:u&&(O.length===0?O+="]C1":O+=String.fromCharCode(29));break;case Ee.CODE_CODE_A:E=Ee.CODE_CODE_A;break;case Ee.CODE_CODE_B:E=Ee.CODE_CODE_B;break;case Ee.CODE_STOP:T=!0;break}break}nc&&(E=E===Ee.CODE_CODE_A?Ee.CODE_CODE_B:Ee.CODE_CODE_A)}const Ur=X-z;if(X=a.getNextUnset(X),!a.isRange(X,Math.min(a.getSize(),X+(X-z)/2),!1))throw new ie;if(xe-=_e*re,xe%103!==re)throw new R;const Li=O.length;if(Li===0)throw new ie;Li>0&&me&&(E===Ee.CODE_CODE_C?O=O.substring(0,Li-2):O=O.substring(0,Li-1));const jr=(d[1]+d[0])/2,jt=z+Ur/2,or=w.length,ti=new Uint8Array(or);for(let nc=0;nc<or;nc++)ti[nc]=w[nc];const tc=[new Q(jr,o),new Q(jt,o)];return new Vt(O,ti,0,tc,ke.CODE_128,new Date().getTime())}}Ee.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ee.MAX_AVG_VARIANCE=.25,Ee.MAX_INDIVIDUAL_VARIANCE=.7,Ee.CODE_SHIFT=98,Ee.CODE_CODE_C=99,Ee.CODE_CODE_B=100,Ee.CODE_CODE_A=101,Ee.CODE_FNC_1=102,Ee.CODE_FNC_2=97,Ee.CODE_FNC_3=96,Ee.CODE_FNC_4_A=101,Ee.CODE_FNC_4_B=100,Ee.CODE_START_A=103,Ee.CODE_START_B=104,Ee.CODE_START_C=105,Ee.CODE_STOP=106;class Jt extends bt{constructor(o=!1,a=!1){super(),this.usingCheckDigit=o,this.extendedMode=a,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(o,a,c){let u=this.counters;u.fill(0),this.decodeRowResult="";let d=Jt.findAsteriskPattern(a,u),g=a.getNextSet(d[1]),y=a.getSize(),w,E;do{Jt.recordPattern(a,g,u);let Z=Jt.toNarrowWidePattern(u);if(Z<0)throw new ie;w=Jt.patternToChar(Z),this.decodeRowResult+=w,E=g;for(let re of u)g+=re;g=a.getNextSet(g)}while(w!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let T=0;for(let Z of u)T+=Z;let b=g-E-T;if(g!==y&&b*2<T)throw new ie;if(this.usingCheckDigit){let Z=this.decodeRowResult.length-1,re=0;for(let ce=0;ce<Z;ce++)re+=Jt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ce));if(this.decodeRowResult.charAt(Z)!==Jt.ALPHABET_STRING.charAt(re%43))throw new R;this.decodeRowResult=this.decodeRowResult.substring(0,Z)}if(this.decodeRowResult.length===0)throw new ie;let O;this.extendedMode?O=Jt.decodeExtended(this.decodeRowResult):O=this.decodeRowResult;let z=(d[1]+d[0])/2,X=E+T/2;return new Vt(O,null,0,[new Q(z,o),new Q(X,o)],ke.CODE_39,new Date().getTime())}static findAsteriskPattern(o,a){let c=o.getSize(),u=o.getNextSet(0),d=0,g=u,y=!1,w=a.length;for(let E=u;E<c;E++)if(o.get(E)!==y)a[d]++;else{if(d===w-1){if(this.toNarrowWidePattern(a)===Jt.ASTERISK_ENCODING&&o.isRange(Math.max(0,g-Math.floor((E-g)/2)),g,!1))return[g,E];g+=a[0]+a[1],a.copyWithin(0,2,2+d-1),a[d-1]=0,a[d]=0,d--}else d++;a[d]=1,y=!y}throw new ie}static toNarrowWidePattern(o){let a=o.length,c=0,u;do{let d=2147483647;for(let w of o)w<d&&w>c&&(d=w);c=d,u=0;let g=0,y=0;for(let w=0;w<a;w++){let E=o[w];E>c&&(y|=1<<a-1-w,u++,g+=E)}if(u===3){for(let w=0;w<a&&u>0;w++){let E=o[w];if(E>c&&(u--,E*2>=g))return-1}return y}}while(u>3);return-1}static patternToChar(o){for(let a=0;a<Jt.CHARACTER_ENCODINGS.length;a++)if(Jt.CHARACTER_ENCODINGS[a]===o)return Jt.ALPHABET_STRING.charAt(a);if(o===Jt.ASTERISK_ENCODING)return"*";throw new ie}static decodeExtended(o){let a=o.length,c="";for(let u=0;u<a;u++){let d=o.charAt(u);if(d==="+"||d==="$"||d==="%"||d==="/"){let g=o.charAt(u+1),y="\0";switch(d){case"+":if(g>="A"&&g<="Z")y=String.fromCharCode(g.charCodeAt(0)+32);else throw new k;break;case"$":if(g>="A"&&g<="Z")y=String.fromCharCode(g.charCodeAt(0)-64);else throw new k;break;case"%":if(g>="A"&&g<="E")y=String.fromCharCode(g.charCodeAt(0)-38);else if(g>="F"&&g<="J")y=String.fromCharCode(g.charCodeAt(0)-11);else if(g>="K"&&g<="O")y=String.fromCharCode(g.charCodeAt(0)+16);else if(g>="P"&&g<="T")y=String.fromCharCode(g.charCodeAt(0)+43);else if(g==="U")y="\0";else if(g==="V")y="@";else if(g==="W")y="`";else if(g==="X"||g==="Y"||g==="Z")y="";else throw new k;break;case"/":if(g>="A"&&g<="O")y=String.fromCharCode(g.charCodeAt(0)-32);else if(g==="Z")y=":";else throw new k;break}c+=y,u++}else c+=d}return c}}Jt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Jt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Jt.ASTERISK_ENCODING=148;class pt extends bt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(o,a,c){let u=this.decodeStart(a),d=this.decodeEnd(a),g=new j;pt.decodeMiddle(a,u[1],d[0],g);let y=g.toString(),w=null;c!=null&&(w=c.get(J.ALLOWED_LENGTHS)),w==null&&(w=pt.DEFAULT_ALLOWED_LENGTHS);let E=y.length,T=!1,b=0;for(let X of w){if(E===X){T=!0;break}X>b&&(b=X)}if(!T&&E>b&&(T=!0),!T)throw new k;const O=[new Q(u[1],o),new Q(d[0],o)];return new Vt(y,null,0,O,ke.ITF,new Date().getTime())}static decodeMiddle(o,a,c,u){let d=new Int32Array(10),g=new Int32Array(5),y=new Int32Array(5);for(d.fill(0),g.fill(0),y.fill(0);a<c;){bt.recordPattern(o,a,d);for(let E=0;E<5;E++){let T=2*E;g[E]=d[T],y[E]=d[T+1]}let w=pt.decodeDigit(g);u.append(w.toString()),w=this.decodeDigit(y),u.append(w.toString()),d.forEach(function(E){a+=E})}}decodeStart(o){let a=pt.skipWhiteSpace(o),c=pt.findGuardPattern(o,a,pt.START_PATTERN);return this.narrowLineWidth=(c[1]-c[0])/4,this.validateQuietZone(o,c[0]),c}validateQuietZone(o,a){let c=this.narrowLineWidth*10;c=c<a?c:a;for(let u=a-1;c>0&&u>=0&&!o.get(u);u--)c--;if(c!==0)throw new ie}static skipWhiteSpace(o){const a=o.getSize(),c=o.getNextSet(0);if(c===a)throw new ie;return c}decodeEnd(o){o.reverse();try{let a=pt.skipWhiteSpace(o),c;try{c=pt.findGuardPattern(o,a,pt.END_PATTERN_REVERSED[0])}catch(d){d instanceof ie&&(c=pt.findGuardPattern(o,a,pt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(o,c[0]);let u=c[0];return c[0]=o.getSize()-c[1],c[1]=o.getSize()-u,c}finally{o.reverse()}}static findGuardPattern(o,a,c){let u=c.length,d=new Int32Array(u),g=o.getSize(),y=!1,w=0,E=a;d.fill(0);for(let T=a;T<g;T++)if(o.get(T)!==y)d[w]++;else{if(w===u-1){if(bt.patternMatchVariance(d,c,pt.MAX_INDIVIDUAL_VARIANCE)<pt.MAX_AVG_VARIANCE)return[E,T];E+=d[0]+d[1],D.arraycopy(d,2,d,0,w-1),d[w-1]=0,d[w]=0,w--}else w++;d[w]=1,y=!y}throw new ie}static decodeDigit(o){let a=pt.MAX_AVG_VARIANCE,c=-1,u=pt.PATTERNS.length;for(let d=0;d<u;d++){let g=pt.PATTERNS[d],y=bt.patternMatchVariance(o,g,pt.MAX_INDIVIDUAL_VARIANCE);y<a?(a=y,c=d):y===a&&(c=-1)}if(c>=0)return c%10;throw new ie}}pt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],pt.MAX_AVG_VARIANCE=.38,pt.MAX_INDIVIDUAL_VARIANCE=.5,pt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],pt.START_PATTERN=Int32Array.from([1,1,1,1]),pt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Gt extends bt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(o){let a=!1,c,u=0,d=Int32Array.from([0,0,0]);for(;!a;){d=Int32Array.from([0,0,0]),c=Gt.findGuardPattern(o,u,!1,this.START_END_PATTERN,d);let g=c[0];u=c[1];let y=g-(u-g);y>=0&&(a=o.isRange(y,g,!1))}return c}static checkChecksum(o){return Gt.checkStandardUPCEANChecksum(o)}static checkStandardUPCEANChecksum(o){let a=o.length;if(a===0)return!1;let c=parseInt(o.charAt(a-1),10);return Gt.getStandardUPCEANChecksum(o.substring(0,a-1))===c}static getStandardUPCEANChecksum(o){let a=o.length,c=0;for(let u=a-1;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}c*=3;for(let u=a-2;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}return(1e3-c)%10}static decodeEnd(o,a){return Gt.findGuardPattern(o,a,!1,Gt.START_END_PATTERN,new Int32Array(Gt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(o,a,c,u){return this.findGuardPattern(o,a,c,u,new Int32Array(u.length))}static findGuardPattern(o,a,c,u,d){let g=o.getSize();a=c?o.getNextUnset(a):o.getNextSet(a);let y=0,w=a,E=u.length,T=c;for(let b=a;b<g;b++)if(o.get(b)!==T)d[y]++;else{if(y===E-1){if(bt.patternMatchVariance(d,u,Gt.MAX_INDIVIDUAL_VARIANCE)<Gt.MAX_AVG_VARIANCE)return Int32Array.from([w,b]);w+=d[0]+d[1];let O=d.slice(2,d.length-1);for(let z=0;z<y-1;z++)d[z]=O[z];d[y-1]=0,d[y]=0,y--}else y++;d[y]=1,T=!T}throw new ie}static decodeDigit(o,a,c,u){this.recordPattern(o,c,a);let d=this.MAX_AVG_VARIANCE,g=-1,y=u.length;for(let w=0;w<y;w++){let E=u[w],T=bt.patternMatchVariance(a,E,Gt.MAX_INDIVIDUAL_VARIANCE);T<d&&(d=T,g=w)}if(g>=0)return g;throw new ie}}Gt.MAX_AVG_VARIANCE=.48,Gt.MAX_INDIVIDUAL_VARIANCE=.7,Gt.START_END_PATTERN=Int32Array.from([1,1,1]),Gt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Gt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Gt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class es{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(o,a,c){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(a,c,u),g=u.toString(),y=es.parseExtensionString(g),w=[new Q((c[0]+c[1])/2,o),new Q(d,o)],E=new Vt(g,null,0,w,ke.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&E.putAllMetadata(y),E}decodeMiddle(o,a,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1],y=0;for(let E=0;E<5&&g<d;E++){let T=Gt.decodeDigit(o,u,g,Gt.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let b of u)g+=b;T>=10&&(y|=1<<4-E),E!==4&&(g=o.getNextSet(g),g=o.getNextUnset(g))}if(c.length!==5)throw new ie;let w=this.determineCheckDigit(y);if(es.extensionChecksum(c.toString())!==w)throw new ie;return g}static extensionChecksum(o){let a=o.length,c=0;for(let u=a-2;u>=0;u-=2)c+=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);c*=3;for(let u=a-1;u>=0;u-=2)c+=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);return c*=3,c%10}determineCheckDigit(o){for(let a=0;a<10;a++)if(o===this.CHECK_DIGIT_ENCODINGS[a])return a;throw new ie}static parseExtensionString(o){if(o.length!==5)return null;let a=es.parseExtension5String(o);return a==null?null:new Map([[an.SUGGESTED_PRICE,a]])}static parseExtension5String(o){let a;switch(o.charAt(0)){case"0":a="";break;case"5":a="$";break;case"9":switch(o){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}a="";break;default:a="";break}let c=parseInt(o.substring(1)),u=(c/100).toString(),d=c%100,g=d<10?"0"+d:d.toString();return a+u+"."+g}}class Ma{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(o,a,c){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(a,c,u),g=u.toString(),y=Ma.parseExtensionString(g),w=[new Q((c[0]+c[1])/2,o),new Q(d,o)],E=new Vt(g,null,0,w,ke.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&E.putAllMetadata(y),E}decodeMiddle(o,a,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1],y=0;for(let w=0;w<2&&g<d;w++){let E=Gt.decodeDigit(o,u,g,Gt.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+E%10);for(let T of u)g+=T;E>=10&&(y|=1<<1-w),w!==1&&(g=o.getNextSet(g),g=o.getNextUnset(g))}if(c.length!==2)throw new ie;if(parseInt(c.toString())%4!==y)throw new ie;return g}static parseExtensionString(o){return o.length!==2?null:new Map([[an.ISSUE_NUMBER,parseInt(o)]])}}class Fu{static decodeRow(o,a,c){let u=Gt.findGuardPattern(a,c,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new es().decodeRow(o,a,u)}catch{return new Ma().decodeRow(o,a,u)}}}Fu.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class yt extends Gt{constructor(){super(),this.decodeRowStringBuffer="",yt.L_AND_G_PATTERNS=yt.L_PATTERNS.map(o=>Int32Array.from(o));for(let o=10;o<20;o++){let a=yt.L_PATTERNS[o-10],c=new Int32Array(a.length);for(let u=0;u<a.length;u++)c[u]=a[a.length-u-1];yt.L_AND_G_PATTERNS[o]=c}}decodeRow(o,a,c){let u=yt.findStartGuardPattern(a),d=c==null?null:c.get(J.NEED_RESULT_POINT_CALLBACK);if(d!=null){const me=new Q((u[0]+u[1])/2,o);d.foundPossibleResultPoint(me)}let g=this.decodeMiddle(a,u,this.decodeRowStringBuffer),y=g.rowOffset,w=g.resultString;if(d!=null){const me=new Q(y,o);d.foundPossibleResultPoint(me)}let E=this.decodeEnd(a,y);if(d!=null){const me=new Q((E[0]+E[1])/2,o);d.foundPossibleResultPoint(me)}let T=E[1],b=T+(T-E[0]);if(b>=a.getSize()||!a.isRange(T,b,!1))throw new ie;let O=w.toString();if(O.length<8)throw new k;if(!yt.checkChecksum(O))throw new R;let z=(u[1]+u[0])/2,X=(E[1]+E[0])/2,Z=this.getBarcodeFormat(),re=[new Q(z,o),new Q(X,o)],ce=new Vt(O,null,0,re,Z,new Date().getTime()),xe=0;try{let me=Fu.decodeRow(o,a,E[1]);ce.putMetadata(an.UPC_EAN_EXTENSION,me.getText()),ce.putAllMetadata(me.getResultMetadata()),ce.addResultPoints(me.getResultPoints()),xe=me.getText().length}catch{}let _e=c==null?null:c.get(J.ALLOWED_EAN_EXTENSIONS);if(_e!=null){let me=!1;for(let ct in _e)if(xe.toString()===ct){me=!0;break}if(!me)throw new ie}return ce}decodeEnd(o,a){return yt.findGuardPattern(o,a,!1,yt.START_END_PATTERN,new Int32Array(yt.START_END_PATTERN.length).fill(0))}static checkChecksum(o){return yt.checkStandardUPCEANChecksum(o)}static checkStandardUPCEANChecksum(o){let a=o.length;if(a===0)return!1;let c=parseInt(o.charAt(a-1),10);return yt.getStandardUPCEANChecksum(o.substring(0,a-1))===c}static getStandardUPCEANChecksum(o){let a=o.length,c=0;for(let u=a-1;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}c*=3;for(let u=a-2;u>=0;u-=2){let d=o.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(d<0||d>9)throw new k;c+=d}return(1e3-c)%10}}class Zr extends yt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(o,a,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1],y=0;for(let E=0;E<6&&g<d;E++){let T=yt.decodeDigit(o,u,g,yt.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let b of u)g+=b;T>=10&&(y|=1<<5-E)}c=Zr.determineFirstDigit(c,y),g=yt.findGuardPattern(o,g,!0,yt.MIDDLE_PATTERN,new Int32Array(yt.MIDDLE_PATTERN.length).fill(0))[1];for(let E=0;E<6&&g<d;E++){let T=yt.decodeDigit(o,u,g,yt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T);for(let b of u)g+=b}return{rowOffset:g,resultString:c}}getBarcodeFormat(){return ke.EAN_13}static determineFirstDigit(o,a){for(let c=0;c<10;c++)if(a===this.FIRST_DIGIT_ENCODINGS[c])return o=String.fromCharCode("0".charCodeAt(0)+c)+o,o;throw new ie}}Zr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Wl extends yt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(o,a,c){const u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g=a[1];for(let w=0;w<4&&g<d;w++){let E=yt.decodeDigit(o,u,g,yt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+E);for(let T of u)g+=T}g=yt.findGuardPattern(o,g,!0,yt.MIDDLE_PATTERN,new Int32Array(yt.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<4&&g<d;w++){let E=yt.decodeDigit(o,u,g,yt.L_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+E);for(let T of u)g+=T}return{rowOffset:g,resultString:c}}getBarcodeFormat(){return ke.EAN_8}}class ql extends yt{constructor(){super(...arguments),this.ean13Reader=new Zr}getBarcodeFormat(){return ke.UPC_A}decode(o,a){return this.maybeReturnResult(this.ean13Reader.decode(o))}decodeRow(o,a,c){return this.maybeReturnResult(this.ean13Reader.decodeRow(o,a,c))}decodeMiddle(o,a,c){return this.ean13Reader.decodeMiddle(o,a,c)}maybeReturnResult(o){let a=o.getText();if(a.charAt(0)==="0"){let c=new Vt(a.substring(1),null,null,o.getResultPoints(),ke.UPC_A);return o.getResultMetadata()!=null&&c.putAllMetadata(o.getResultMetadata()),c}else throw new ie}reset(){this.ean13Reader.reset()}}class Bn extends yt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(o,a,c){const u=this.decodeMiddleCounters.map(E=>E);u[0]=0,u[1]=0,u[2]=0,u[3]=0;const d=o.getSize();let g=a[1],y=0;for(let E=0;E<6&&g<d;E++){const T=Bn.decodeDigit(o,u,g,Bn.L_AND_G_PATTERNS);c+=String.fromCharCode("0".charCodeAt(0)+T%10);for(let b of u)g+=b;T>=10&&(y|=1<<5-E)}let w=Bn.determineNumSysAndCheckDigit(c,y);return{rowOffset:g,resultString:w}}decodeEnd(o,a){return Bn.findGuardPatternWithoutCounters(o,a,!0,Bn.MIDDLE_END_PATTERN)}checkChecksum(o){return yt.checkChecksum(Bn.convertUPCEtoUPCA(o))}static determineNumSysAndCheckDigit(o,a){for(let c=0;c<=1;c++)for(let u=0;u<10;u++)if(a===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[c][u]){let d=String.fromCharCode("0".charCodeAt(0)+c),g=String.fromCharCode("0".charCodeAt(0)+u);return d+o+g}throw ie.getNotFoundInstance()}getBarcodeFormat(){return ke.UPC_E}static convertUPCEtoUPCA(o){const a=o.slice(1,7).split("").map(d=>d.charCodeAt(0)),c=new j;c.append(o.charAt(0));let u=a[5];switch(u){case 0:case 1:case 2:c.appendChars(a,0,2),c.append(u),c.append("0000"),c.appendChars(a,2,3);break;case 3:c.appendChars(a,0,3),c.append("00000"),c.appendChars(a,3,2);break;case 4:c.appendChars(a,0,4),c.append("00000"),c.append(a[4]);break;default:c.appendChars(a,0,5),c.append("0000"),c.append(u);break}return o.length>=8&&c.append(o.charAt(7)),c.toString()}}Bn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Bn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Kl extends bt{constructor(o){super();let a=o==null?null:o.get(J.POSSIBLE_FORMATS),c=[];r(a)?(c.push(new Zr),c.push(new ql),c.push(new Wl),c.push(new Bn)):(a.indexOf(ke.EAN_13)>-1&&c.push(new Zr),a.indexOf(ke.UPC_A)>-1&&c.push(new ql),a.indexOf(ke.EAN_8)>-1&&c.push(new Wl),a.indexOf(ke.UPC_E)>-1&&c.push(new Bn)),this.readers=c}decodeRow(o,a,c){for(let u of this.readers)try{const d=u.decodeRow(o,a,c),g=d.getBarcodeFormat()===ke.EAN_13&&d.getText().charAt(0)==="0",y=c==null?null:c.get(J.POSSIBLE_FORMATS),w=y==null||y.includes(ke.UPC_A);if(g&&w){const E=d.getRawBytes(),T=new Vt(d.getText().substring(1),E,E?E.length:null,d.getResultPoints(),ke.UPC_A);return T.putAllMetadata(d.getResultMetadata()),T}return d}catch{}throw new ie}reset(){for(let o of this.readers)o.reset()}}class Tn extends bt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(o,a){for(let c=0;c<a.length;c++)if(bt.patternMatchVariance(o,a[c],Tn.MAX_INDIVIDUAL_VARIANCE)<Tn.MAX_AVG_VARIANCE)return c;throw new ie}static count(o){return it.sum(new Int32Array(o))}static increment(o,a){let c=0,u=a[0];for(let d=1;d<o.length;d++)a[d]>u&&(u=a[d],c=d);o[c]++}static decrement(o,a){let c=0,u=a[0];for(let d=1;d<o.length;d++)a[d]<u&&(u=a[d],c=d);o[c]--}static isFinderPattern(o){let a=o[0]+o[1],c=a+o[2]+o[3],u=a/c;if(u>=Tn.MIN_FINDER_PATTERN_RATIO&&u<=Tn.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;for(let y of o)y>g&&(g=y),y<d&&(d=y);return g<10*d}return!1}}Tn.MAX_AVG_VARIANCE=.2,Tn.MAX_INDIVIDUAL_VARIANCE=.45,Tn.MIN_FINDER_PATTERN_RATIO=9.5/12,Tn.MAX_FINDER_PATTERN_RATIO=12.5/14;class Ms{constructor(o,a){this.value=o,this.checksumPortion=a}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(o){if(!(o instanceof Ms))return!1;const a=o;return this.value===a.value&&this.checksumPortion===a.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class ts{constructor(o,a,c,u,d){this.value=o,this.startEnd=a,this.value=o,this.startEnd=a,this.resultPoints=new Array,this.resultPoints.push(new Q(c,d)),this.resultPoints.push(new Q(u,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(o){if(!(o instanceof ts))return!1;const a=o;return this.value===a.value}hashCode(){return this.value}}class Jr{constructor(){}static getRSSvalue(o,a,c){let u=0;for(let w of o)u+=w;let d=0,g=0,y=o.length;for(let w=0;w<y-1;w++){let E;for(E=1,g|=1<<w;E<o[w];E++,g&=~(1<<w)){let T=Jr.combins(u-E-1,y-w-2);if(c&&g===0&&u-E-(y-w-1)>=y-w-1&&(T-=Jr.combins(u-E-(y-w),y-w-2)),y-w-1>1){let b=0;for(let O=u-E-(y-w-2);O>a;O--)b+=Jr.combins(u-E-O-1,y-w-3);T-=b*(y-1-w)}else u-E>a&&T--;d+=T}u-=E}return d}static combins(o,a){let c,u;o-a>a?(u=a,c=o-a):(u=o-a,c=a);let d=1,g=1;for(let y=o;y>c;y--)d*=y,g<=u&&(d/=g,g++);for(;g<=u;)d/=g,g++;return d}}class ir{static buildBitArray(o){let a=o.length*2-1;o[o.length-1].getRightChar()==null&&(a-=1);let c=12*a,u=new H(c),d=0,y=o[0].getRightChar().getValue();for(let w=11;w>=0;--w)y&1<<w&&u.set(d),d++;for(let w=1;w<o.length;++w){let E=o[w],T=E.getLeftChar().getValue();for(let b=11;b>=0;--b)T&1<<b&&u.set(d),d++;if(E.getRightChar()!=null){let b=E.getRightChar().getValue();for(let O=11;O>=0;--O)b&1<<O&&u.set(d),d++}}return u}}class ns{constructor(o,a){a?this.decodedInformation=null:(this.finished=o,this.decodedInformation=a)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Ls{constructor(o){this.newPosition=o}getNewPosition(){return this.newPosition}}class kn extends Ls{constructor(o,a){super(o),this.value=a}getValue(){return this.value}isFNC1(){return this.value===kn.FNC1}}kn.FNC1="$";class Fs extends Ls{constructor(o,a,c){super(o),c?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=a}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Lr extends Ls{constructor(o,a,c){if(super(o),a<0||a>10||c<0||c>10)throw new k;this.firstDigit=a,this.secondDigit=c}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Lr.FNC1}isSecondDigitFNC1(){return this.secondDigit===Lr.FNC1}isAnyFNC1(){return this.firstDigit===Lr.FNC1||this.secondDigit===Lr.FNC1}}Lr.FNC1=10;class Se{constructor(){}static parseFieldsInGeneralPurpose(o){if(!o)return null;if(o.length<2)throw new ie;let a=o.substring(0,2);for(let d of Se.TWO_DIGIT_DATA_LENGTH)if(d[0]===a)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(2,d[2],o):Se.processFixedAI(2,d[1],o);if(o.length<3)throw new ie;let c=o.substring(0,3);for(let d of Se.THREE_DIGIT_DATA_LENGTH)if(d[0]===c)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(3,d[2],o):Se.processFixedAI(3,d[1],o);for(let d of Se.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===c)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(4,d[2],o):Se.processFixedAI(4,d[1],o);if(o.length<4)throw new ie;let u=o.substring(0,4);for(let d of Se.FOUR_DIGIT_DATA_LENGTH)if(d[0]===u)return d[1]===Se.VARIABLE_LENGTH?Se.processVariableAI(4,d[2],o):Se.processFixedAI(4,d[1],o);throw new ie}static processFixedAI(o,a,c){if(c.length<o)throw new ie;let u=c.substring(0,o);if(c.length<o+a)throw new ie;let d=c.substring(o,o+a),g=c.substring(o+a),y="("+u+")"+d,w=Se.parseFieldsInGeneralPurpose(g);return w==null?y:y+w}static processVariableAI(o,a,c){let u=c.substring(0,o),d;c.length<o+a?d=c.length:d=o+a;let g=c.substring(o,d),y=c.substring(d),w="("+u+")"+g,E=Se.parseFieldsInGeneralPurpose(y);return E==null?w:w+E}}Se.VARIABLE_LENGTH=[],Se.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Se.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Se.VARIABLE_LENGTH,20],["22",Se.VARIABLE_LENGTH,29],["30",Se.VARIABLE_LENGTH,8],["37",Se.VARIABLE_LENGTH,8],["90",Se.VARIABLE_LENGTH,30],["91",Se.VARIABLE_LENGTH,30],["92",Se.VARIABLE_LENGTH,30],["93",Se.VARIABLE_LENGTH,30],["94",Se.VARIABLE_LENGTH,30],["95",Se.VARIABLE_LENGTH,30],["96",Se.VARIABLE_LENGTH,30],["97",Se.VARIABLE_LENGTH,3],["98",Se.VARIABLE_LENGTH,30],["99",Se.VARIABLE_LENGTH,30]],Se.THREE_DIGIT_DATA_LENGTH=[["240",Se.VARIABLE_LENGTH,30],["241",Se.VARIABLE_LENGTH,30],["242",Se.VARIABLE_LENGTH,6],["250",Se.VARIABLE_LENGTH,30],["251",Se.VARIABLE_LENGTH,30],["253",Se.VARIABLE_LENGTH,17],["254",Se.VARIABLE_LENGTH,20],["400",Se.VARIABLE_LENGTH,30],["401",Se.VARIABLE_LENGTH,30],["402",17],["403",Se.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Se.VARIABLE_LENGTH,20],["421",Se.VARIABLE_LENGTH,15],["422",3],["423",Se.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Se.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Se.VARIABLE_LENGTH,15],["391",Se.VARIABLE_LENGTH,18],["392",Se.VARIABLE_LENGTH,15],["393",Se.VARIABLE_LENGTH,18],["703",Se.VARIABLE_LENGTH,30]],Se.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Se.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Se.VARIABLE_LENGTH,20],["8003",Se.VARIABLE_LENGTH,30],["8004",Se.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Se.VARIABLE_LENGTH,30],["8008",Se.VARIABLE_LENGTH,12],["8018",18],["8020",Se.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Se.VARIABLE_LENGTH,70],["8200",Se.VARIABLE_LENGTH,70]];class _o{constructor(o){this.buffer=new j,this.information=o}decodeAllCodes(o,a){let c=a,u=null;do{let d=this.decodeGeneralPurposeField(c,u),g=Se.parseFieldsInGeneralPurpose(d.getNewString());if(g!=null&&o.append(g),d.isRemaining()?u=""+d.getRemainingValue():u=null,c===d.getNewPosition())break;c=d.getNewPosition()}while(!0);return o.toString()}isStillNumeric(o){if(o+7>this.information.getSize())return o+4<=this.information.getSize();for(let a=o;a<o+3;++a)if(this.information.get(a))return!0;return this.information.get(o+3)}decodeNumeric(o){if(o+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(o,4);return d===0?new Lr(this.information.getSize(),Lr.FNC1,Lr.FNC1):new Lr(this.information.getSize(),d-1,Lr.FNC1)}let a=this.extractNumericValueFromBitArray(o,7),c=(a-8)/11,u=(a-8)%11;return new Lr(o+7,c,u)}extractNumericValueFromBitArray(o,a){return _o.extractNumericValueFromBitArray(this.information,o,a)}static extractNumericValueFromBitArray(o,a,c){let u=0;for(let d=0;d<c;++d)o.get(a+d)&&(u|=1<<c-d-1);return u}decodeGeneralPurposeField(o,a){this.buffer.setLengthToZero(),a!=null&&this.buffer.append(a),this.current.setPosition(o);let c=this.parseBlocks();return c!=null&&c.isRemaining()?new Fs(this.current.getPosition(),this.buffer.toString(),c.getRemainingValue()):new Fs(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let o,a;do{let c=this.current.getPosition();if(this.current.isAlpha()?(a=this.parseAlphaBlock(),o=a.isFinished()):this.current.isIsoIec646()?(a=this.parseIsoIec646Block(),o=a.isFinished()):(a=this.parseNumericBlock(),o=a.isFinished()),!(c!==this.current.getPosition())&&!o)break}while(!o);return a.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let o=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFirstDigitFNC1()){let a;return o.isSecondDigitFNC1()?a=new Fs(this.current.getPosition(),this.buffer.toString()):a=new Fs(this.current.getPosition(),this.buffer.toString(),o.getSecondDigit()),new ns(!0,a)}if(this.buffer.append(o.getFirstDigit()),o.isSecondDigitFNC1()){let a=new Fs(this.current.getPosition(),this.buffer.toString());return new ns(!0,a)}this.buffer.append(o.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new ns(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let o=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFNC1()){let a=new Fs(this.current.getPosition(),this.buffer.toString());return new ns(!0,a)}this.buffer.append(o.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new ns(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let o=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(o.getNewPosition()),o.isFNC1()){let a=new Fs(this.current.getPosition(),this.buffer.toString());return new ns(!0,a)}this.buffer.append(o.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new ns(!1)}isStillIsoIec646(o){if(o+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(o,5);if(a>=5&&a<16)return!0;if(o+7>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(o,7);if(c>=64&&c<116)return!0;if(o+8>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(o,8);return u>=232&&u<253}decodeIsoIec646(o){let a=this.extractNumericValueFromBitArray(o,5);if(a===15)return new kn(o+5,kn.FNC1);if(a>=5&&a<15)return new kn(o+5,"0"+(a-5));let c=this.extractNumericValueFromBitArray(o,7);if(c>=64&&c<90)return new kn(o+7,""+(c+1));if(c>=90&&c<116)return new kn(o+7,""+(c+7));let u=this.extractNumericValueFromBitArray(o,8),d;switch(u){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new k}return new kn(o+8,d)}isStillAlpha(o){if(o+5>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(o,5);if(a>=5&&a<16)return!0;if(o+6>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(o,6);return c>=16&&c<63}decodeAlphanumeric(o){let a=this.extractNumericValueFromBitArray(o,5);if(a===15)return new kn(o+5,kn.FNC1);if(a>=5&&a<15)return new kn(o+5,"0"+(a-5));let c=this.extractNumericValueFromBitArray(o,6);if(c>=32&&c<58)return new kn(o+6,""+(c+33));let u;switch(c){case 58:u="*";break;case 59:u=",";break;case 60:u="-";break;case 61:u=".";break;case 62:u="/";break;default:throw new rr("Decoding invalid alphanumeric value: "+c)}return new kn(o+6,u)}isAlphaTo646ToAlphaLatch(o){if(o+1>this.information.getSize())return!1;for(let a=0;a<5&&a+o<this.information.getSize();++a)if(a===2){if(!this.information.get(o+2))return!1}else if(this.information.get(o+a))return!1;return!0}isAlphaOr646ToNumericLatch(o){if(o+3>this.information.getSize())return!1;for(let a=o;a<o+3;++a)if(this.information.get(a))return!1;return!0}isNumericToAlphaNumericLatch(o){if(o+1>this.information.getSize())return!1;for(let a=0;a<4&&a+o<this.information.getSize();++a)if(this.information.get(o+a))return!1;return!0}}class Vu{constructor(o){this.information=o,this.generalDecoder=new _o(o)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Un extends Vu{constructor(o){super(o)}encodeCompressedGtin(o,a){o.append("(01)");let c=o.length();o.append("9"),this.encodeCompressedGtinWithoutAI(o,a,c)}encodeCompressedGtinWithoutAI(o,a,c){for(let u=0;u<4;++u){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(a+10*u,10);d/100===0&&o.append("0"),d/10===0&&o.append("0"),o.append(d)}Un.appendCheckDigit(o,c)}static appendCheckDigit(o,a){let c=0;for(let u=0;u<13;u++){let d=o.charAt(u+a).charCodeAt(0)-"0".charCodeAt(0);c+=u&1?d:3*d}c=10-c%10,c===10&&(c=0),o.append(c)}}Un.GTIN_SIZE=40;class Vs extends Un{constructor(o){super(o)}parseInformation(){let o=new j;o.append("(01)");let a=o.length(),c=this.getGeneralDecoder().extractNumericValueFromBitArray(Vs.HEADER_SIZE,4);return o.append(c),this.encodeCompressedGtinWithoutAI(o,Vs.HEADER_SIZE+4,a),this.getGeneralDecoder().decodeAllCodes(o,Vs.HEADER_SIZE+44)}}Vs.HEADER_SIZE=1+1+2;class Eo extends Vu{constructor(o){super(o)}parseInformation(){let o=new j;return this.getGeneralDecoder().decodeAllCodes(o,Eo.HEADER_SIZE)}}Eo.HEADER_SIZE=2+1+2;class Bs extends Un{constructor(o){super(o)}encodeCompressedWeight(o,a,c){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(a,c);this.addWeightCode(o,u);let d=this.checkWeight(u),g=1e5;for(let y=0;y<5;++y)d/g===0&&o.append("0"),g/=10;o.append(d)}}class jn extends Bs{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()!=jn.HEADER_SIZE+Bs.GTIN_SIZE+jn.WEIGHT_SIZE)throw new ie;let o=new j;return this.encodeCompressedGtin(o,jn.HEADER_SIZE),this.encodeCompressedWeight(o,jn.HEADER_SIZE+Bs.GTIN_SIZE,jn.WEIGHT_SIZE),o.toString()}}jn.HEADER_SIZE=4+1,jn.WEIGHT_SIZE=15;class nf extends jn{constructor(o){super(o)}addWeightCode(o,a){o.append("(3103)")}checkWeight(o){return o}}class rf extends jn{constructor(o){super(o)}addWeightCode(o,a){a<1e4?o.append("(3202)"):o.append("(3203)")}checkWeight(o){return o<1e4?o:o-1e4}}class Fr extends Un{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()<Fr.HEADER_SIZE+Un.GTIN_SIZE)throw new ie;let o=new j;this.encodeCompressedGtin(o,Fr.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(Fr.HEADER_SIZE+Un.GTIN_SIZE,Fr.LAST_DIGIT_SIZE);o.append("(392"),o.append(a),o.append(")");let c=this.getGeneralDecoder().decodeGeneralPurposeField(Fr.HEADER_SIZE+Un.GTIN_SIZE+Fr.LAST_DIGIT_SIZE,null);return o.append(c.getNewString()),o.toString()}}Fr.HEADER_SIZE=5+1+2,Fr.LAST_DIGIT_SIZE=2;class zn extends Un{constructor(o){super(o)}parseInformation(){if(this.getInformation().getSize()<zn.HEADER_SIZE+Un.GTIN_SIZE)throw new ie;let o=new j;this.encodeCompressedGtin(o,zn.HEADER_SIZE);let a=this.getGeneralDecoder().extractNumericValueFromBitArray(zn.HEADER_SIZE+Un.GTIN_SIZE,zn.LAST_DIGIT_SIZE);o.append("(393"),o.append(a),o.append(")");let c=this.getGeneralDecoder().extractNumericValueFromBitArray(zn.HEADER_SIZE+Un.GTIN_SIZE+zn.LAST_DIGIT_SIZE,zn.FIRST_THREE_DIGITS_SIZE);c/100==0&&o.append("0"),c/10==0&&o.append("0"),o.append(c);let u=this.getGeneralDecoder().decodeGeneralPurposeField(zn.HEADER_SIZE+Un.GTIN_SIZE+zn.LAST_DIGIT_SIZE+zn.FIRST_THREE_DIGITS_SIZE,null);return o.append(u.getNewString()),o.toString()}}zn.HEADER_SIZE=5+1+2,zn.LAST_DIGIT_SIZE=2,zn.FIRST_THREE_DIGITS_SIZE=10;class Bt extends Bs{constructor(o,a,c){super(o),this.dateCode=c,this.firstAIdigits=a}parseInformation(){if(this.getInformation().getSize()!=Bt.HEADER_SIZE+Bt.GTIN_SIZE+Bt.WEIGHT_SIZE+Bt.DATE_SIZE)throw new ie;let o=new j;return this.encodeCompressedGtin(o,Bt.HEADER_SIZE),this.encodeCompressedWeight(o,Bt.HEADER_SIZE+Bt.GTIN_SIZE,Bt.WEIGHT_SIZE),this.encodeCompressedDate(o,Bt.HEADER_SIZE+Bt.GTIN_SIZE+Bt.WEIGHT_SIZE),o.toString()}encodeCompressedDate(o,a){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(a,Bt.DATE_SIZE);if(c==38400)return;o.append("("),o.append(this.dateCode),o.append(")");let u=c%32;c/=32;let d=c%12+1;c/=12;let g=c;g/10==0&&o.append("0"),o.append(g),d/10==0&&o.append("0"),o.append(d),u/10==0&&o.append("0"),o.append(u)}addWeightCode(o,a){o.append("("),o.append(this.firstAIdigits),o.append(a/1e5),o.append(")")}checkWeight(o){return o%1e5}}Bt.HEADER_SIZE=7+1,Bt.WEIGHT_SIZE=20,Bt.DATE_SIZE=16;function Bu(S){try{if(S.get(1))return new Vs(S);if(!S.get(2))return new Eo(S);switch(_o.extractNumericValueFromBitArray(S,1,4)){case 4:return new nf(S);case 5:return new rf(S)}switch(_o.extractNumericValueFromBitArray(S,1,5)){case 12:return new Fr(S);case 13:return new zn(S)}switch(_o.extractNumericValueFromBitArray(S,1,7)){case 56:return new Bt(S,"310","11");case 57:return new Bt(S,"320","11");case 58:return new Bt(S,"310","13");case 59:return new Bt(S,"320","13");case 60:return new Bt(S,"310","15");case 61:return new Bt(S,"320","15");case 62:return new Bt(S,"310","17");case 63:return new Bt(S,"320","17")}}catch(o){throw console.log(o),new rr("unknown decoder: "+S)}}class rs{constructor(o,a,c,u){this.leftchar=o,this.rightchar=a,this.finderpattern=c,this.maybeLast=u}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(o,a){return o instanceof rs?rs.equalsOrNull(o.leftchar,a.leftchar)&&rs.equalsOrNull(o.rightchar,a.rightchar)&&rs.equalsOrNull(o.finderpattern,a.finderpattern):!1}static equalsOrNull(o,a){return o===null?a===null:rs.equals(o,a)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class vo{constructor(o,a,c){this.pairs=o,this.rowNumber=a,this.wasReversed=c}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(o){return this.checkEqualitity(this,o)}toString(){return"{ "+this.pairs+" }"}equals(o,a){return o instanceof vo?this.checkEqualitity(o,a)&&o.wasReversed===a.wasReversed:!1}checkEqualitity(o,a){if(!o||!a)return;let c;return o.forEach((u,d)=>{a.forEach(g=>{u.getLeftChar().getValue()===g.getLeftChar().getValue()&&u.getRightChar().getValue()===g.getRightChar().getValue()&&u.getFinderPatter().getValue()===g.getFinderPatter().getValue()&&(c=!0)})}),c}}class de extends Tn{constructor(o){super(...arguments),this.pairs=new Array(de.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=o===!0}decodeRow(o,a,c){this.pairs.length=0,this.startFromEven=!1;try{return de.constructResult(this.decodeRow2pairs(o,a))}catch(u){this.verbose&&console.log(u)}return this.pairs.length=0,this.startFromEven=!0,de.constructResult(this.decodeRow2pairs(o,a))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(o,a){let c=!1;for(;!c;)try{this.pairs.push(this.retrieveNextPair(a,this.pairs,o))}catch(d){if(d instanceof ie){if(!this.pairs.length)throw new ie;c=!0}}if(this.checkChecksum())return this.pairs;let u;if(this.rows.length?u=!0:u=!1,this.storeRow(o,!1),u){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new ie}checkRowsBoolean(o){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,o&&(this.rows=this.rows.reverse());let a=null;try{a=this.checkRows(new Array,0)}catch(c){this.verbose&&console.log(c)}return o&&(this.rows=this.rows.reverse()),a}checkRows(o,a){for(let c=a;c<this.rows.length;c++){let u=this.rows[c];this.pairs.length=0;for(let g of o)this.pairs.push(g.getPairs());if(this.pairs.push(u.getPairs()),!de.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(o);d.push(u);try{return this.checkRows(d,c+1)}catch(g){this.verbose&&console.log(g)}}throw new ie}static isValidSequence(o){for(let a of de.FINDER_PATTERN_SEQUENCES){if(o.length>a.length)continue;let c=!0;for(let u=0;u<o.length;u++)if(o[u].getFinderPattern().getValue()!=a[u]){c=!1;break}if(c)return!0}return!1}storeRow(o,a){let c=0,u=!1,d=!1;for(;c<this.rows.length;){let g=this.rows[c];if(g.getRowNumber()>o){d=g.isEquivalent(this.pairs);break}u=g.isEquivalent(this.pairs),c++}d||u||de.isPartialRow(this.pairs,this.rows)||(this.rows.push(c,new vo(this.pairs,o,a)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(o,a){for(let c of a)if(c.getPairs().length!==o.length){for(let u of c.getPairs())for(let d of o)if(rs.equals(u,d))break}}static isPartialRow(o,a){for(let c of a){let u=!0;for(let d of o){let g=!1;for(let y of c.getPairs())if(d.equals(y)){g=!0;break}if(!g){u=!1;break}}if(u)return!0}return!1}getRows(){return this.rows}static constructResult(o){let a=ir.buildBitArray(o),u=Bu(a).parseInformation(),d=o[0].getFinderPattern().getResultPoints(),g=o[o.length-1].getFinderPattern().getResultPoints(),y=[d[0],d[1],g[0],g[1]];return new Vt(u,null,null,y,ke.RSS_EXPANDED,null)}checkChecksum(){let o=this.pairs.get(0),a=o.getLeftChar(),c=o.getRightChar();if(c==null)return!1;let u=c.getChecksumPortion(),d=2;for(let y=1;y<this.pairs.size();++y){let w=this.pairs.get(y);u+=w.getLeftChar().getChecksumPortion(),d++;let E=w.getRightChar();E!=null&&(u+=E.getChecksumPortion(),d++)}return u%=211,211*(d-4)+u==a.getValue()}static getNextSecondBar(o,a){let c;return o.get(a)?(c=o.getNextUnset(a),c=o.getNextSet(c)):(c=o.getNextSet(a),c=o.getNextUnset(c)),c}retrieveNextPair(o,a,c){let u=a.length%2==0;this.startFromEven&&(u=!u);let d,g=!0,y=-1;do this.findNextPair(o,a,y),d=this.parseFoundFinderPattern(o,c,u),d==null?y=de.getNextSecondBar(o,this.startEnd[0]):g=!1;while(g);let w=this.decodeDataCharacter(o,d,u,!0);if(!this.isEmptyPair(a)&&a[a.length-1].mustBeLast())throw new ie;let E;try{E=this.decodeDataCharacter(o,d,u,!1)}catch(T){E=null,this.verbose&&console.log(T)}return new rs(w,E,d,!0)}isEmptyPair(o){return o.length===0}findNextPair(o,a,c){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=o.getSize(),g;c>=0?g=c:this.isEmptyPair(a)?g=0:g=a[a.length-1].getFinderPattern().getStartEnd()[1];let y=a.length%2!=0;this.startFromEven&&(y=!y);let w=!1;for(;g<d&&(w=!o.get(g),!!w);)g++;let E=0,T=g;for(let b=g;b<d;b++)if(o.get(b)!=w)u[E]++;else{if(E==3){if(y&&de.reverseCounters(u),de.isFinderPattern(u)){this.startEnd[0]=T,this.startEnd[1]=b;return}y&&de.reverseCounters(u),T+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,E--}else E++;u[E]=1,w=!w}throw new ie}static reverseCounters(o){let a=o.length;for(let c=0;c<a/2;++c){let u=o[c];o[c]=o[a-c-1],o[a-c-1]=u}}parseFoundFinderPattern(o,a,c){let u,d,g;if(c){let E=this.startEnd[0]-1;for(;E>=0&&!o.get(E);)E--;E++,u=this.startEnd[0]-E,d=E,g=this.startEnd[1]}else d=this.startEnd[0],g=o.getNextUnset(this.startEnd[1]+1),u=g-this.startEnd[1];let y=this.getDecodeFinderCounters();D.arraycopy(y,0,y,1,y.length-1),y[0]=u;let w;try{w=this.parseFinderValue(y,de.FINDER_PATTERNS)}catch{return null}return new ts(w,[d,g],d,g,a)}decodeDataCharacter(o,a,c,u){let d=this.getDataCharacterCounters();for(let jt=0;jt<d.length;jt++)d[jt]=0;if(u)de.recordPatternInReverse(o,a.getStartEnd()[0],d);else{de.recordPattern(o,a.getStartEnd()[1],d);for(let jt=0,or=d.length-1;jt<or;jt++,or--){let ti=d[jt];d[jt]=d[or],d[or]=ti}}let g=17,y=it.sum(new Int32Array(d))/g,w=(a.getStartEnd()[1]-a.getStartEnd()[0])/15;if(Math.abs(y-w)/w>.3)throw new ie;let E=this.getOddCounts(),T=this.getEvenCounts(),b=this.getOddRoundingErrors(),O=this.getEvenRoundingErrors();for(let jt=0;jt<d.length;jt++){let or=1*d[jt]/y,ti=or+.5;if(ti<1){if(or<.3)throw new ie;ti=1}else if(ti>8){if(or>8.7)throw new ie;ti=8}let tc=jt/2;jt&1?(T[tc]=ti,O[tc]=or-ti):(E[tc]=ti,b[tc]=or-ti)}this.adjustOddEvenCounts(g);let z=4*a.getValue()+(c?0:2)+(u?0:1)-1,X=0,Z=0;for(let jt=E.length-1;jt>=0;jt--){if(de.isNotA1left(a,c,u)){let or=de.WEIGHTS[z][2*jt];Z+=E[jt]*or}X+=E[jt]}let re=0;for(let jt=T.length-1;jt>=0;jt--)if(de.isNotA1left(a,c,u)){let or=de.WEIGHTS[z][2*jt+1];re+=T[jt]*or}let ce=Z+re;if(X&1||X>13||X<4)throw new ie;let xe=(13-X)/2,_e=de.SYMBOL_WIDEST[xe],me=9-_e,ct=Jr.getRSSvalue(E,_e,!0),et=Jr.getRSSvalue(T,me,!1),Ur=de.EVEN_TOTAL_SUBSET[xe],Li=de.GSUM[xe],jr=ct*Ur+et+Li;return new Ms(jr,ce)}static isNotA1left(o,a,c){return!(o.getValue()==0&&a&&c)}adjustOddEvenCounts(o){let a=it.sum(new Int32Array(this.getOddCounts())),c=it.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1;a>13?d=!0:a<4&&(u=!0);let g=!1,y=!1;c>13?y=!0:c<4&&(g=!0);let w=a+c-o,E=(a&1)==1,T=(c&1)==0;if(w==1)if(E){if(T)throw new ie;d=!0}else{if(!T)throw new ie;y=!0}else if(w==-1)if(E){if(T)throw new ie;u=!0}else{if(!T)throw new ie;g=!0}else if(w==0){if(E){if(!T)throw new ie;a<c?(u=!0,y=!0):(d=!0,g=!0)}else if(T)throw new ie}else throw new ie;if(u){if(d)throw new ie;de.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&de.decrement(this.getOddCounts(),this.getOddRoundingErrors()),g){if(y)throw new ie;de.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&de.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}de.SYMBOL_WIDEST=[7,5,4,3,1],de.EVEN_TOTAL_SUBSET=[4,20,52,104,204],de.GSUM=[0,348,1388,2948,3988],de.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],de.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],de.FINDER_PAT_A=0,de.FINDER_PAT_B=1,de.FINDER_PAT_C=2,de.FINDER_PAT_D=3,de.FINDER_PAT_E=4,de.FINDER_PAT_F=5,de.FINDER_PATTERN_SEQUENCES=[[de.FINDER_PAT_A,de.FINDER_PAT_A],[de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B],[de.FINDER_PAT_A,de.FINDER_PAT_C,de.FINDER_PAT_B,de.FINDER_PAT_D],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_C],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_D,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_E,de.FINDER_PAT_B,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_D],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_E],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F],[de.FINDER_PAT_A,de.FINDER_PAT_A,de.FINDER_PAT_B,de.FINDER_PAT_B,de.FINDER_PAT_C,de.FINDER_PAT_D,de.FINDER_PAT_D,de.FINDER_PAT_E,de.FINDER_PAT_E,de.FINDER_PAT_F,de.FINDER_PAT_F]],de.MAX_PAIRS=11;class Uu extends Ms{constructor(o,a,c){super(o,a),this.count=0,this.finderPattern=c}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ot extends Tn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(o,a,c){const u=this.decodePair(a,!1,o,c);Ot.addOrTally(this.possibleLeftPairs,u),a.reverse();let d=this.decodePair(a,!0,o,c);Ot.addOrTally(this.possibleRightPairs,d),a.reverse();for(let g of this.possibleLeftPairs)if(g.getCount()>1){for(let y of this.possibleRightPairs)if(y.getCount()>1&&Ot.checkChecksum(g,y))return Ot.constructResult(g,y)}throw new ie}static addOrTally(o,a){if(a==null)return;let c=!1;for(let u of o)if(u.getValue()===a.getValue()){u.incrementCount(),c=!0;break}c||o.push(a)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(o,a){let c=4537077*o.getValue()+a.getValue(),u=new String(c).toString(),d=new j;for(let E=13-u.length;E>0;E--)d.append("0");d.append(u);let g=0;for(let E=0;E<13;E++){let T=d.charAt(E).charCodeAt(0)-"0".charCodeAt(0);g+=E&1?T:3*T}g=10-g%10,g===10&&(g=0),d.append(g.toString());let y=o.getFinderPattern().getResultPoints(),w=a.getFinderPattern().getResultPoints();return new Vt(d.toString(),null,0,[y[0],y[1],w[0],w[1]],ke.RSS_14,new Date().getTime())}static checkChecksum(o,a){let c=(o.getChecksumPortion()+16*a.getChecksumPortion())%79,u=9*o.getFinderPattern().getValue()+a.getFinderPattern().getValue();return u>72&&u--,u>8&&u--,c===u}decodePair(o,a,c,u){try{let d=this.findFinderPattern(o,a),g=this.parseFoundFinderPattern(o,c,a,d),y=u==null?null:u.get(J.NEED_RESULT_POINT_CALLBACK);if(y!=null){let T=(d[0]+d[1])/2;a&&(T=o.getSize()-1-T),y.foundPossibleResultPoint(new Q(T,c))}let w=this.decodeDataCharacter(o,g,!0),E=this.decodeDataCharacter(o,g,!1);return new Uu(1597*w.getValue()+E.getValue(),w.getChecksumPortion()+4*E.getChecksumPortion(),g)}catch{return null}}decodeDataCharacter(o,a,c){let u=this.getDataCharacterCounters();for(let re=0;re<u.length;re++)u[re]=0;if(c)bt.recordPatternInReverse(o,a.getStartEnd()[0],u);else{bt.recordPattern(o,a.getStartEnd()[1]+1,u);for(let re=0,ce=u.length-1;re<ce;re++,ce--){let xe=u[re];u[re]=u[ce],u[ce]=xe}}let d=c?16:15,g=it.sum(new Int32Array(u))/d,y=this.getOddCounts(),w=this.getEvenCounts(),E=this.getOddRoundingErrors(),T=this.getEvenRoundingErrors();for(let re=0;re<u.length;re++){let ce=u[re]/g,xe=Math.floor(ce+.5);xe<1?xe=1:xe>8&&(xe=8);let _e=Math.floor(re/2);re&1?(w[_e]=xe,T[_e]=ce-xe):(y[_e]=xe,E[_e]=ce-xe)}this.adjustOddEvenCounts(c,d);let b=0,O=0;for(let re=y.length-1;re>=0;re--)O*=9,O+=y[re],b+=y[re];let z=0,X=0;for(let re=w.length-1;re>=0;re--)z*=9,z+=w[re],X+=w[re];let Z=O+3*z;if(c){if(b&1||b>12||b<4)throw new ie;let re=(12-b)/2,ce=Ot.OUTSIDE_ODD_WIDEST[re],xe=9-ce,_e=Jr.getRSSvalue(y,ce,!1),me=Jr.getRSSvalue(w,xe,!0),ct=Ot.OUTSIDE_EVEN_TOTAL_SUBSET[re],et=Ot.OUTSIDE_GSUM[re];return new Ms(_e*ct+me+et,Z)}else{if(X&1||X>10||X<4)throw new ie;let re=(10-X)/2,ce=Ot.INSIDE_ODD_WIDEST[re],xe=9-ce,_e=Jr.getRSSvalue(y,ce,!0),me=Jr.getRSSvalue(w,xe,!1),ct=Ot.INSIDE_ODD_TOTAL_SUBSET[re],et=Ot.INSIDE_GSUM[re];return new Ms(me*ct+_e+et,Z)}}findFinderPattern(o,a){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=o.getSize(),d=!1,g=0;for(;g<u&&(d=!o.get(g),a!==d);)g++;let y=0,w=g;for(let E=g;E<u;E++)if(o.get(E)!==d)c[y]++;else{if(y===3){if(Tn.isFinderPattern(c))return[w,E];w+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,y--}else y++;c[y]=1,d=!d}throw new ie}parseFoundFinderPattern(o,a,c,u){let d=o.get(u[0]),g=u[0]-1;for(;g>=0&&d!==o.get(g);)g--;g++;const y=u[0]-g,w=this.getDecodeFinderCounters(),E=new Int32Array(w.length);D.arraycopy(w,0,E,1,w.length-1),E[0]=y;const T=this.parseFinderValue(E,Ot.FINDER_PATTERNS);let b=g,O=u[1];return c&&(b=o.getSize()-1-b,O=o.getSize()-1-O),new ts(T,[g,u[1]],b,O,a)}adjustOddEvenCounts(o,a){let c=it.sum(new Int32Array(this.getOddCounts())),u=it.sum(new Int32Array(this.getEvenCounts())),d=!1,g=!1,y=!1,w=!1;o?(c>12?g=!0:c<4&&(d=!0),u>12?w=!0:u<4&&(y=!0)):(c>11?g=!0:c<5&&(d=!0),u>10?w=!0:u<4&&(y=!0));let E=c+u-a,T=(c&1)===(o?1:0),b=(u&1)===1;if(E===1)if(T){if(b)throw new ie;g=!0}else{if(!b)throw new ie;w=!0}else if(E===-1)if(T){if(b)throw new ie;d=!0}else{if(!b)throw new ie;y=!0}else if(E===0){if(T){if(!b)throw new ie;c<u?(d=!0,w=!0):(g=!0,y=!0)}else if(b)throw new ie}else throw new ie;if(d){if(g)throw new ie;Tn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&Tn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),y){if(w)throw new ie;Tn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&Tn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ot.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ot.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ot.OUTSIDE_GSUM=[0,161,961,2015,2715],Ot.INSIDE_GSUM=[0,336,1036,1516],Ot.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ot.INSIDE_ODD_WIDEST=[2,4,6,8],Ot.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Vr extends bt{constructor(o,a){super(),this.readers=[],this.verbose=a===!0;const c=o?o.get(J.POSSIBLE_FORMATS):null,u=o&&o.get(J.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;c?((c.includes(ke.EAN_13)||c.includes(ke.UPC_A)||c.includes(ke.EAN_8)||c.includes(ke.UPC_E))&&this.readers.push(new Kl(o)),c.includes(ke.CODE_39)&&this.readers.push(new Jt(u)),c.includes(ke.CODE_128)&&this.readers.push(new Ee),c.includes(ke.ITF)&&this.readers.push(new pt),c.includes(ke.RSS_14)&&this.readers.push(new Ot),c.includes(ke.RSS_EXPANDED)&&this.readers.push(new de(this.verbose))):(this.readers.push(new Kl(o)),this.readers.push(new Jt),this.readers.push(new Kl(o)),this.readers.push(new Ee),this.readers.push(new pt),this.readers.push(new Ot),this.readers.push(new de(this.verbose)))}decodeRow(o,a,c){for(let u=0;u<this.readers.length;u++)try{return this.readers[u].decodeRow(o,a,c)}catch{}throw new ie}reset(){this.readers.forEach(o=>o.reset())}}class ju extends Tt{constructor(o=500,a){super(new Vr(a),o,a)}}class Ct{constructor(o,a,c){this.ecCodewords=o,this.ecBlocks=[a],c&&this.ecBlocks.push(c)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class wt{constructor(o,a){this.count=o,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class st{constructor(o,a,c,u,d,g){this.versionNumber=o,this.symbolSizeRows=a,this.symbolSizeColumns=c,this.dataRegionSizeRows=u,this.dataRegionSizeColumns=d,this.ecBlocks=g;let y=0;const w=g.getECCodewords(),E=g.getECBlocks();for(let T of E)y+=T.getCount()*(T.getDataCodewords()+w);this.totalCodewords=y}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(o,a){if(o&1||a&1)throw new k;for(let c of st.VERSIONS)if(c.symbolSizeRows===o&&c.symbolSizeColumns===a)return c;throw new k}toString(){return""+this.versionNumber}static buildVersions(){return[new st(1,10,10,8,8,new Ct(5,new wt(1,3))),new st(2,12,12,10,10,new Ct(7,new wt(1,5))),new st(3,14,14,12,12,new Ct(10,new wt(1,8))),new st(4,16,16,14,14,new Ct(12,new wt(1,12))),new st(5,18,18,16,16,new Ct(14,new wt(1,18))),new st(6,20,20,18,18,new Ct(18,new wt(1,22))),new st(7,22,22,20,20,new Ct(20,new wt(1,30))),new st(8,24,24,22,22,new Ct(24,new wt(1,36))),new st(9,26,26,24,24,new Ct(28,new wt(1,44))),new st(10,32,32,14,14,new Ct(36,new wt(1,62))),new st(11,36,36,16,16,new Ct(42,new wt(1,86))),new st(12,40,40,18,18,new Ct(48,new wt(1,114))),new st(13,44,44,20,20,new Ct(56,new wt(1,144))),new st(14,48,48,22,22,new Ct(68,new wt(1,174))),new st(15,52,52,24,24,new Ct(42,new wt(2,102))),new st(16,64,64,14,14,new Ct(56,new wt(2,140))),new st(17,72,72,16,16,new Ct(36,new wt(4,92))),new st(18,80,80,18,18,new Ct(48,new wt(4,114))),new st(19,88,88,20,20,new Ct(56,new wt(4,144))),new st(20,96,96,22,22,new Ct(68,new wt(4,174))),new st(21,104,104,24,24,new Ct(56,new wt(6,136))),new st(22,120,120,18,18,new Ct(68,new wt(6,175))),new st(23,132,132,20,20,new Ct(62,new wt(8,163))),new st(24,144,144,22,22,new Ct(62,new wt(8,156),new wt(2,155))),new st(25,8,18,6,16,new Ct(7,new wt(1,5))),new st(26,8,32,6,14,new Ct(11,new wt(1,10))),new st(27,12,26,10,24,new Ct(14,new wt(1,16))),new st(28,12,36,10,16,new Ct(18,new wt(1,22))),new st(29,16,36,14,16,new Ct(24,new wt(1,32))),new st(30,16,48,14,22,new Ct(28,new wt(1,49)))]}}st.VERSIONS=st.buildVersions();class $l{constructor(o){const a=o.getHeight();if(a<8||a>144||a&1)throw new k;this.version=$l.readVersion(o),this.mappingBitMatrix=this.extractDataRegion(o),this.readMappingMatrix=new ze(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(o){const a=o.getHeight(),c=o.getWidth();return st.getVersionForDimensions(a,c)}readCodewords(){const o=new Int8Array(this.version.getTotalCodewords());let a=0,c=4,u=0;const d=this.mappingBitMatrix.getHeight(),g=this.mappingBitMatrix.getWidth();let y=!1,w=!1,E=!1,T=!1;do if(c===d&&u===0&&!y)o[a++]=this.readCorner1(d,g)&255,c-=2,u+=2,y=!0;else if(c===d-2&&u===0&&g&3&&!w)o[a++]=this.readCorner2(d,g)&255,c-=2,u+=2,w=!0;else if(c===d+4&&u===2&&!(g&7)&&!E)o[a++]=this.readCorner3(d,g)&255,c-=2,u+=2,E=!0;else if(c===d-2&&u===0&&(g&7)===4&&!T)o[a++]=this.readCorner4(d,g)&255,c-=2,u+=2,T=!0;else{do c<d&&u>=0&&!this.readMappingMatrix.get(u,c)&&(o[a++]=this.readUtah(c,u,d,g)&255),c-=2,u+=2;while(c>=0&&u<g);c+=1,u+=3;do c>=0&&u<g&&!this.readMappingMatrix.get(u,c)&&(o[a++]=this.readUtah(c,u,d,g)&255),c+=2,u-=2;while(c<d&&u>=0);c+=3,u+=1}while(c<d||u<g);if(a!==this.version.getTotalCodewords())throw new k;return o}readModule(o,a,c,u){return o<0&&(o+=c,a+=4-(c+4&7)),a<0&&(a+=u,o+=4-(u+4&7)),this.readMappingMatrix.set(a,o),this.mappingBitMatrix.get(a,o)}readUtah(o,a,c,u){let d=0;return this.readModule(o-2,a-2,c,u)&&(d|=1),d<<=1,this.readModule(o-2,a-1,c,u)&&(d|=1),d<<=1,this.readModule(o-1,a-2,c,u)&&(d|=1),d<<=1,this.readModule(o-1,a-1,c,u)&&(d|=1),d<<=1,this.readModule(o-1,a,c,u)&&(d|=1),d<<=1,this.readModule(o,a-2,c,u)&&(d|=1),d<<=1,this.readModule(o,a-1,c,u)&&(d|=1),d<<=1,this.readModule(o,a,c,u)&&(d|=1),d}readCorner1(o,a){let c=0;return this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,1,o,a)&&(c|=1),c<<=1,this.readModule(o-1,2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c<<=1,this.readModule(2,a-1,o,a)&&(c|=1),c<<=1,this.readModule(3,a-1,o,a)&&(c|=1),c}readCorner2(o,a){let c=0;return this.readModule(o-3,0,o,a)&&(c|=1),c<<=1,this.readModule(o-2,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(0,a-4,o,a)&&(c|=1),c<<=1,this.readModule(0,a-3,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c}readCorner3(o,a){let c=0;return this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,a-1,o,a)&&(c|=1),c<<=1,this.readModule(0,a-3,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-3,o,a)&&(c|=1),c<<=1,this.readModule(1,a-2,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c}readCorner4(o,a){let c=0;return this.readModule(o-3,0,o,a)&&(c|=1),c<<=1,this.readModule(o-2,0,o,a)&&(c|=1),c<<=1,this.readModule(o-1,0,o,a)&&(c|=1),c<<=1,this.readModule(0,a-2,o,a)&&(c|=1),c<<=1,this.readModule(0,a-1,o,a)&&(c|=1),c<<=1,this.readModule(1,a-1,o,a)&&(c|=1),c<<=1,this.readModule(2,a-1,o,a)&&(c|=1),c<<=1,this.readModule(3,a-1,o,a)&&(c|=1),c}extractDataRegion(o){const a=this.version.getSymbolSizeRows(),c=this.version.getSymbolSizeColumns();if(o.getHeight()!==a)throw new _("Dimension of bitMatrix must match the version size");const u=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),g=a/u|0,y=c/d|0,w=g*u,E=y*d,T=new ze(E,w);for(let b=0;b<g;++b){const O=b*u;for(let z=0;z<y;++z){const X=z*d;for(let Z=0;Z<u;++Z){const re=b*(u+2)+1+Z,ce=O+Z;for(let xe=0;xe<d;++xe){const _e=z*(d+2)+1+xe;if(o.get(_e,re)){const me=X+xe;T.set(me,ce)}}}}}return T}}class La{constructor(o,a){this.numDataCodewords=o,this.codewords=a}static getDataBlocks(o,a){const c=a.getECBlocks();let u=0;const d=c.getECBlocks();for(let Z of d)u+=Z.getCount();const g=new Array(u);let y=0;for(let Z of d)for(let re=0;re<Z.getCount();re++){const ce=Z.getDataCodewords(),xe=c.getECCodewords()+ce;g[y++]=new La(ce,new Uint8Array(xe))}const E=g[0].codewords.length-c.getECCodewords(),T=E-1;let b=0;for(let Z=0;Z<T;Z++)for(let re=0;re<y;re++)g[re].codewords[Z]=o[b++];const O=a.getVersionNumber()===24,z=O?8:y;for(let Z=0;Z<z;Z++)g[Z].codewords[E-1]=o[b++];const X=g[0].codewords.length;for(let Z=E;Z<X;Z++)for(let re=0;re<y;re++){const ce=O?(re+8)%y:re,xe=O&&ce>7?Z-1:Z;g[ce].codewords[xe]=o[b++]}if(b!==o.length)throw new _;return g}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Fa{constructor(o){this.bytes=o,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(o){if(o<1||o>32||o>this.available())throw new _(""+o);let a=0,c=this.bitOffset,u=this.byteOffset;const d=this.bytes;if(c>0){const g=8-c,y=o<g?o:g,w=g-y,E=255>>8-y<<w;a=(d[u]&E)>>w,o-=y,c+=y,c===8&&(c=0,u++)}if(o>0){for(;o>=8;)a=a<<8|d[u]&255,u++,o-=8;if(o>0){const g=8-o,y=255>>g<<g;a=a<<o|(d[u]&y)>>g,c+=o}}return this.bitOffset=c,this.byteOffset=u,a}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var pn;(function(S){S[S.PAD_ENCODE=0]="PAD_ENCODE",S[S.ASCII_ENCODE=1]="ASCII_ENCODE",S[S.C40_ENCODE=2]="C40_ENCODE",S[S.TEXT_ENCODE=3]="TEXT_ENCODE",S[S.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",S[S.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",S[S.BASE256_ENCODE=6]="BASE256_ENCODE"})(pn||(pn={}));class Ri{static decode(o){const a=new Fa(o),c=new j,u=new j,d=new Array;let g=pn.ASCII_ENCODE;do if(g===pn.ASCII_ENCODE)g=this.decodeAsciiSegment(a,c,u);else{switch(g){case pn.C40_ENCODE:this.decodeC40Segment(a,c);break;case pn.TEXT_ENCODE:this.decodeTextSegment(a,c);break;case pn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(a,c);break;case pn.EDIFACT_ENCODE:this.decodeEdifactSegment(a,c);break;case pn.BASE256_ENCODE:this.decodeBase256Segment(a,c,d);break;default:throw new k}g=pn.ASCII_ENCODE}while(g!==pn.PAD_ENCODE&&a.available()>0);return u.length()>0&&c.append(u.toString()),new Si(o,c.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(o,a,c){let u=!1;do{let d=o.readBits(8);if(d===0)throw new k;if(d<=128)return u&&(d+=128),a.append(String.fromCharCode(d-1)),pn.ASCII_ENCODE;if(d===129)return pn.PAD_ENCODE;if(d<=229){const g=d-130;g<10&&a.append("0"),a.append(""+g)}else switch(d){case 230:return pn.C40_ENCODE;case 231:return pn.BASE256_ENCODE;case 232:a.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:u=!0;break;case 236:a.append("[)>05"),c.insert(0,"");break;case 237:a.append("[)>06"),c.insert(0,"");break;case 238:return pn.ANSIX12_ENCODE;case 239:return pn.TEXT_ENCODE;case 240:return pn.EDIFACT_ENCODE;case 241:break;default:if(d!==254||o.available()!==0)throw new k;break}}while(o.available()>0);return pn.ASCII_ENCODE}static decodeC40Segment(o,a){let c=!1;const u=[];let d=0;do{if(o.available()===8)return;const g=o.readBits(8);if(g===254)return;this.parseTwoBytes(g,o.readBits(8),u);for(let y=0;y<3;y++){const w=u[y];switch(d){case 0:if(w<3)d=w+1;else if(w<this.C40_BASIC_SET_CHARS.length){const E=this.C40_BASIC_SET_CHARS[w];c?(a.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):a.append(E)}else throw new k;break;case 1:c?(a.append(String.fromCharCode(w+128)),c=!1):a.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.C40_SHIFT2_SET_CHARS.length){const E=this.C40_SHIFT2_SET_CHARS[w];c?(a.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):a.append(E)}else switch(w){case 27:a.append(String.fromCharCode(29));break;case 30:c=!0;break;default:throw new k}d=0;break;case 3:c?(a.append(String.fromCharCode(w+224)),c=!1):a.append(String.fromCharCode(w+96)),d=0;break;default:throw new k}}}while(o.available()>0)}static decodeTextSegment(o,a){let c=!1,u=[],d=0;do{if(o.available()===8)return;const g=o.readBits(8);if(g===254)return;this.parseTwoBytes(g,o.readBits(8),u);for(let y=0;y<3;y++){const w=u[y];switch(d){case 0:if(w<3)d=w+1;else if(w<this.TEXT_BASIC_SET_CHARS.length){const E=this.TEXT_BASIC_SET_CHARS[w];c?(a.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):a.append(E)}else throw new k;break;case 1:c?(a.append(String.fromCharCode(w+128)),c=!1):a.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.TEXT_SHIFT2_SET_CHARS.length){const E=this.TEXT_SHIFT2_SET_CHARS[w];c?(a.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):a.append(E)}else switch(w){case 27:a.append(String.fromCharCode(29));break;case 30:c=!0;break;default:throw new k}d=0;break;case 3:if(w<this.TEXT_SHIFT3_SET_CHARS.length){const E=this.TEXT_SHIFT3_SET_CHARS[w];c?(a.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):a.append(E),d=0}else throw new k;break;default:throw new k}}}while(o.available()>0)}static decodeAnsiX12Segment(o,a){const c=[];do{if(o.available()===8)return;const u=o.readBits(8);if(u===254)return;this.parseTwoBytes(u,o.readBits(8),c);for(let d=0;d<3;d++){const g=c[d];switch(g){case 0:a.append("\r");break;case 1:a.append("*");break;case 2:a.append(">");break;case 3:a.append(" ");break;default:if(g<14)a.append(String.fromCharCode(g+44));else if(g<40)a.append(String.fromCharCode(g+51));else throw new k;break}}}while(o.available()>0)}static parseTwoBytes(o,a,c){let u=(o<<8)+a-1,d=Math.floor(u/1600);c[0]=d,u-=d*1600,d=Math.floor(u/40),c[1]=d,c[2]=u-d*40}static decodeEdifactSegment(o,a){do{if(o.available()<=16)return;for(let c=0;c<4;c++){let u=o.readBits(6);if(u===31){const d=8-o.getBitOffset();d!==8&&o.readBits(d);return}u&32||(u|=64),a.append(String.fromCharCode(u))}}while(o.available()>0)}static decodeBase256Segment(o,a,c){let u=1+o.getByteOffset();const d=this.unrandomize255State(o.readBits(8),u++);let g;if(d===0?g=o.available()/8|0:d<250?g=d:g=250*(d-249)+this.unrandomize255State(o.readBits(8),u++),g<0)throw new k;const y=new Uint8Array(g);for(let w=0;w<g;w++){if(o.available()<8)throw new k;y[w]=this.unrandomize255State(o.readBits(8),u++)}c.push(y);try{a.append(K.decode(y,q.ISO88591))}catch(w){throw new rr("Platform does not support required encoding: "+w.message)}}static unrandomize255State(o,a){const c=149*a%255+1,u=o-c;return u>=0?u:u+256}}Ri.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ri.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ri.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ri.TEXT_SHIFT2_SET_CHARS=Ri.C40_SHIFT2_SET_CHARS,Ri.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class Cg{constructor(){this.rsDecoder=new Zi(ot.DATA_MATRIX_FIELD_256)}decode(o){const a=new $l(o),c=a.getVersion(),u=a.readCodewords(),d=La.getDataBlocks(u,c);let g=0;for(let E of d)g+=E.getNumDataCodewords();const y=new Uint8Array(g),w=d.length;for(let E=0;E<w;E++){const T=d[E],b=T.getCodewords(),O=T.getNumDataCodewords();this.correctErrors(b,O);for(let z=0;z<O;z++)y[z*w+E]=b[z]}return Ri.decode(y)}correctErrors(o,a){const c=new Int32Array(o);try{this.rsDecoder.decode(c,o.length-a)}catch{throw new R}for(let u=0;u<a;u++)o[u]=c[u]}}class ln{constructor(o){this.image=o,this.rectangleDetector=new we(this.image)}detect(){const o=this.rectangleDetector.detect();let a=this.detectSolid1(o);if(a=this.detectSolid2(a),a[3]=this.correctTopRight(a),!a[3])throw new ie;a=this.shiftToModuleCenter(a);const c=a[0],u=a[1],d=a[2],g=a[3];let y=this.transitionsBetween(c,g)+1,w=this.transitionsBetween(d,g)+1;(y&1)===1&&(y+=1),(w&1)===1&&(w+=1),4*y<7*w&&4*w<7*y&&(y=w=Math.max(y,w));let E=ln.sampleGrid(this.image,c,u,d,g,y,w);return new ue(E,[c,u,d,g])}static shiftPoint(o,a,c){let u=(a.getX()-o.getX())/(c+1),d=(a.getY()-o.getY())/(c+1);return new Q(o.getX()+u,o.getY()+d)}static moveAway(o,a,c){let u=o.getX(),d=o.getY();return u<a?u-=1:u+=1,d<c?d-=1:d+=1,new Q(u,d)}detectSolid1(o){let a=o[0],c=o[1],u=o[3],d=o[2],g=this.transitionsBetween(a,c),y=this.transitionsBetween(c,u),w=this.transitionsBetween(u,d),E=this.transitionsBetween(d,a),T=g,b=[d,a,c,u];return T>y&&(T=y,b[0]=a,b[1]=c,b[2]=u,b[3]=d),T>w&&(T=w,b[0]=c,b[1]=u,b[2]=d,b[3]=a),T>E&&(b[0]=u,b[1]=d,b[2]=a,b[3]=c),b}detectSolid2(o){let a=o[0],c=o[1],u=o[2],d=o[3],g=this.transitionsBetween(a,d),y=ln.shiftPoint(c,u,(g+1)*4),w=ln.shiftPoint(u,c,(g+1)*4),E=this.transitionsBetween(y,a),T=this.transitionsBetween(w,d);return E<T?(o[0]=a,o[1]=c,o[2]=u,o[3]=d):(o[0]=c,o[1]=u,o[2]=d,o[3]=a),o}correctTopRight(o){let a=o[0],c=o[1],u=o[2],d=o[3],g=this.transitionsBetween(a,d),y=this.transitionsBetween(c,d),w=ln.shiftPoint(a,c,(y+1)*4),E=ln.shiftPoint(u,c,(g+1)*4);g=this.transitionsBetween(w,d),y=this.transitionsBetween(E,d);let T=new Q(d.getX()+(u.getX()-c.getX())/(g+1),d.getY()+(u.getY()-c.getY())/(g+1)),b=new Q(d.getX()+(a.getX()-c.getX())/(y+1),d.getY()+(a.getY()-c.getY())/(y+1));if(!this.isValid(T))return this.isValid(b)?b:null;if(!this.isValid(b))return T;let O=this.transitionsBetween(w,T)+this.transitionsBetween(E,T),z=this.transitionsBetween(w,b)+this.transitionsBetween(E,b);return O>z?T:b}shiftToModuleCenter(o){let a=o[0],c=o[1],u=o[2],d=o[3],g=this.transitionsBetween(a,d)+1,y=this.transitionsBetween(u,d)+1,w=ln.shiftPoint(a,c,y*4),E=ln.shiftPoint(u,c,g*4);g=this.transitionsBetween(w,d)+1,y=this.transitionsBetween(E,d)+1,(g&1)===1&&(g+=1),(y&1)===1&&(y+=1);let T=(a.getX()+c.getX()+u.getX()+d.getX())/4,b=(a.getY()+c.getY()+u.getY()+d.getY())/4;a=ln.moveAway(a,T,b),c=ln.moveAway(c,T,b),u=ln.moveAway(u,T,b),d=ln.moveAway(d,T,b);let O,z;return w=ln.shiftPoint(a,c,y*4),w=ln.shiftPoint(w,d,g*4),O=ln.shiftPoint(c,a,y*4),O=ln.shiftPoint(O,u,g*4),E=ln.shiftPoint(u,d,y*4),E=ln.shiftPoint(E,c,g*4),z=ln.shiftPoint(d,u,y*4),z=ln.shiftPoint(z,a,g*4),[w,O,E,z]}isValid(o){return o.getX()>=0&&o.getX()<this.image.getWidth()&&o.getY()>0&&o.getY()<this.image.getHeight()}static sampleGrid(o,a,c,u,d,g,y){return Ge.getInstance().sampleGrid(o,g,y,.5,.5,g-.5,.5,g-.5,y-.5,.5,y-.5,a.getX(),a.getY(),d.getX(),d.getY(),u.getX(),u.getY(),c.getX(),c.getY())}transitionsBetween(o,a){let c=Math.trunc(o.getX()),u=Math.trunc(o.getY()),d=Math.trunc(a.getX()),g=Math.trunc(a.getY()),y=Math.abs(g-u)>Math.abs(d-c);if(y){let Z=c;c=u,u=Z,Z=d,d=g,g=Z}let w=Math.abs(d-c),E=Math.abs(g-u),T=-w/2,b=u<g?1:-1,O=c<d?1:-1,z=0,X=this.image.get(y?u:c,y?c:u);for(let Z=c,re=u;Z!==d;Z+=O){let ce=this.image.get(y?re:Z,y?Z:re);if(ce!==X&&(z++,X=ce),T+=E,T>0){if(re===g)break;re+=b,T-=w}}return z}}class Ni{constructor(){this.decoder=new Cg}decode(o,a=null){let c,u;if(a!=null&&a.has(J.PURE_BARCODE)){const E=Ni.extractPureBits(o.getBlackMatrix());c=this.decoder.decode(E),u=Ni.NO_POINTS}else{const E=new ln(o.getBlackMatrix()).detect();c=this.decoder.decode(E.getBits()),u=E.getPoints()}const d=c.getRawBytes(),g=new Vt(c.getText(),d,8*d.length,u,ke.DATA_MATRIX,D.currentTimeMillis()),y=c.getByteSegments();y!=null&&g.putMetadata(an.BYTE_SEGMENTS,y);const w=c.getECLevel();return w!=null&&g.putMetadata(an.ERROR_CORRECTION_LEVEL,w),g}reset(){}static extractPureBits(o){const a=o.getTopLeftOnBit(),c=o.getBottomRightOnBit();if(a==null||c==null)throw new ie;const u=this.moduleSize(a,o);let d=a[1];const g=c[1];let y=a[0];const E=(c[0]-y+1)/u,T=(g-d+1)/u;if(E<=0||T<=0)throw new ie;const b=u/2;d+=b,y+=b;const O=new ze(E,T);for(let z=0;z<T;z++){const X=d+z*u;for(let Z=0;Z<E;Z++)o.get(y+Z*u,X)&&O.set(Z,z)}return O}static moduleSize(o,a){const c=a.getWidth();let u=o[0];const d=o[1];for(;u<c&&a.get(u,d);)u++;if(u===c)throw new ie;const g=u-o[0];if(g===0)throw new ie;return g}}Ni.NO_POINTS=[];class sf extends Tt{constructor(o=500){super(new Ni,o)}}var Io;(function(S){S[S.L=0]="L",S[S.M=1]="M",S[S.Q=2]="Q",S[S.H=3]="H"})(Io||(Io={}));class xt{constructor(o,a,c){this.value=o,this.stringValue=a,this.bits=c,xt.FOR_BITS.set(c,this),xt.FOR_VALUE.set(o,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(o){switch(o){case"L":return xt.L;case"M":return xt.M;case"Q":return xt.Q;case"H":return xt.H;default:throw new x(o+"not available")}}toString(){return this.stringValue}equals(o){if(!(o instanceof xt))return!1;const a=o;return this.value===a.value}static forBits(o){if(o<0||o>=xt.FOR_BITS.size)throw new _;return xt.FOR_BITS.get(o)}}xt.FOR_BITS=new Map,xt.FOR_VALUE=new Map,xt.L=new xt(Io.L,"L",1),xt.M=new xt(Io.M,"M",0),xt.Q=new xt(Io.Q,"Q",3),xt.H=new xt(Io.H,"H",2);class Ht{constructor(o){this.errorCorrectionLevel=xt.forBits(o>>3&3),this.dataMask=o&7}static numBitsDiffering(o,a){return N.bitCount(o^a)}static decodeFormatInformation(o,a){const c=Ht.doDecodeFormatInformation(o,a);return c!==null?c:Ht.doDecodeFormatInformation(o^Ht.FORMAT_INFO_MASK_QR,a^Ht.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(o,a){let c=Number.MAX_SAFE_INTEGER,u=0;for(const d of Ht.FORMAT_INFO_DECODE_LOOKUP){const g=d[0];if(g===o||g===a)return new Ht(d[1]);let y=Ht.numBitsDiffering(o,g);y<c&&(u=d[1],c=y),o!==a&&(y=Ht.numBitsDiffering(a,g),y<c&&(u=d[1],c=y))}return c<=3?new Ht(u):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(o){if(!(o instanceof Ht))return!1;const a=o;return this.errorCorrectionLevel===a.errorCorrectionLevel&&this.dataMask===a.dataMask}}Ht.FORMAT_INFO_MASK_QR=21522,Ht.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ne{constructor(o,...a){this.ecCodewordsPerBlock=o,this.ecBlocks=a}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let o=0;const a=this.ecBlocks;for(const c of a)o+=c.getCount();return o}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class U{constructor(o,a){this.count=o,this.dataCodewords=a}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Fe{constructor(o,a,...c){this.versionNumber=o,this.alignmentPatternCenters=a,this.ecBlocks=c;let u=0;const d=c[0].getECCodewordsPerBlock(),g=c[0].getECBlocks();for(const y of g)u+=y.getCount()*(y.getDataCodewords()+d);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(o){return this.ecBlocks[o.getValue()]}static getProvisionalVersionForDimension(o){if(o%4!==1)throw new k;try{return this.getVersionForNumber((o-17)/4)}catch{throw new k}}static getVersionForNumber(o){if(o<1||o>40)throw new _;return Fe.VERSIONS[o-1]}static decodeVersionInformation(o){let a=Number.MAX_SAFE_INTEGER,c=0;for(let u=0;u<Fe.VERSION_DECODE_INFO.length;u++){const d=Fe.VERSION_DECODE_INFO[u];if(d===o)return Fe.getVersionForNumber(u+7);const g=Ht.numBitsDiffering(o,d);g<a&&(c=u+7,a=g)}return a<=3?Fe.getVersionForNumber(c):null}buildFunctionPattern(){const o=this.getDimensionForVersion(),a=new ze(o);a.setRegion(0,0,9,9),a.setRegion(o-8,0,8,9),a.setRegion(0,o-8,9,8);const c=this.alignmentPatternCenters.length;for(let u=0;u<c;u++){const d=this.alignmentPatternCenters[u]-2;for(let g=0;g<c;g++)u===0&&(g===0||g===c-1)||u===c-1&&g===0||a.setRegion(this.alignmentPatternCenters[g]-2,d,5,5)}return a.setRegion(6,9,1,o-17),a.setRegion(9,6,o-17,1),this.versionNumber>6&&(a.setRegion(o-11,0,3,6),a.setRegion(0,o-11,6,3)),a}toString(){return""+this.versionNumber}}Fe.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Fe.VERSIONS=[new Fe(1,new Int32Array(0),new ne(7,new U(1,19)),new ne(10,new U(1,16)),new ne(13,new U(1,13)),new ne(17,new U(1,9))),new Fe(2,Int32Array.from([6,18]),new ne(10,new U(1,34)),new ne(16,new U(1,28)),new ne(22,new U(1,22)),new ne(28,new U(1,16))),new Fe(3,Int32Array.from([6,22]),new ne(15,new U(1,55)),new ne(26,new U(1,44)),new ne(18,new U(2,17)),new ne(22,new U(2,13))),new Fe(4,Int32Array.from([6,26]),new ne(20,new U(1,80)),new ne(18,new U(2,32)),new ne(26,new U(2,24)),new ne(16,new U(4,9))),new Fe(5,Int32Array.from([6,30]),new ne(26,new U(1,108)),new ne(24,new U(2,43)),new ne(18,new U(2,15),new U(2,16)),new ne(22,new U(2,11),new U(2,12))),new Fe(6,Int32Array.from([6,34]),new ne(18,new U(2,68)),new ne(16,new U(4,27)),new ne(24,new U(4,19)),new ne(28,new U(4,15))),new Fe(7,Int32Array.from([6,22,38]),new ne(20,new U(2,78)),new ne(18,new U(4,31)),new ne(18,new U(2,14),new U(4,15)),new ne(26,new U(4,13),new U(1,14))),new Fe(8,Int32Array.from([6,24,42]),new ne(24,new U(2,97)),new ne(22,new U(2,38),new U(2,39)),new ne(22,new U(4,18),new U(2,19)),new ne(26,new U(4,14),new U(2,15))),new Fe(9,Int32Array.from([6,26,46]),new ne(30,new U(2,116)),new ne(22,new U(3,36),new U(2,37)),new ne(20,new U(4,16),new U(4,17)),new ne(24,new U(4,12),new U(4,13))),new Fe(10,Int32Array.from([6,28,50]),new ne(18,new U(2,68),new U(2,69)),new ne(26,new U(4,43),new U(1,44)),new ne(24,new U(6,19),new U(2,20)),new ne(28,new U(6,15),new U(2,16))),new Fe(11,Int32Array.from([6,30,54]),new ne(20,new U(4,81)),new ne(30,new U(1,50),new U(4,51)),new ne(28,new U(4,22),new U(4,23)),new ne(24,new U(3,12),new U(8,13))),new Fe(12,Int32Array.from([6,32,58]),new ne(24,new U(2,92),new U(2,93)),new ne(22,new U(6,36),new U(2,37)),new ne(26,new U(4,20),new U(6,21)),new ne(28,new U(7,14),new U(4,15))),new Fe(13,Int32Array.from([6,34,62]),new ne(26,new U(4,107)),new ne(22,new U(8,37),new U(1,38)),new ne(24,new U(8,20),new U(4,21)),new ne(22,new U(12,11),new U(4,12))),new Fe(14,Int32Array.from([6,26,46,66]),new ne(30,new U(3,115),new U(1,116)),new ne(24,new U(4,40),new U(5,41)),new ne(20,new U(11,16),new U(5,17)),new ne(24,new U(11,12),new U(5,13))),new Fe(15,Int32Array.from([6,26,48,70]),new ne(22,new U(5,87),new U(1,88)),new ne(24,new U(5,41),new U(5,42)),new ne(30,new U(5,24),new U(7,25)),new ne(24,new U(11,12),new U(7,13))),new Fe(16,Int32Array.from([6,26,50,74]),new ne(24,new U(5,98),new U(1,99)),new ne(28,new U(7,45),new U(3,46)),new ne(24,new U(15,19),new U(2,20)),new ne(30,new U(3,15),new U(13,16))),new Fe(17,Int32Array.from([6,30,54,78]),new ne(28,new U(1,107),new U(5,108)),new ne(28,new U(10,46),new U(1,47)),new ne(28,new U(1,22),new U(15,23)),new ne(28,new U(2,14),new U(17,15))),new Fe(18,Int32Array.from([6,30,56,82]),new ne(30,new U(5,120),new U(1,121)),new ne(26,new U(9,43),new U(4,44)),new ne(28,new U(17,22),new U(1,23)),new ne(28,new U(2,14),new U(19,15))),new Fe(19,Int32Array.from([6,30,58,86]),new ne(28,new U(3,113),new U(4,114)),new ne(26,new U(3,44),new U(11,45)),new ne(26,new U(17,21),new U(4,22)),new ne(26,new U(9,13),new U(16,14))),new Fe(20,Int32Array.from([6,34,62,90]),new ne(28,new U(3,107),new U(5,108)),new ne(26,new U(3,41),new U(13,42)),new ne(30,new U(15,24),new U(5,25)),new ne(28,new U(15,15),new U(10,16))),new Fe(21,Int32Array.from([6,28,50,72,94]),new ne(28,new U(4,116),new U(4,117)),new ne(26,new U(17,42)),new ne(28,new U(17,22),new U(6,23)),new ne(30,new U(19,16),new U(6,17))),new Fe(22,Int32Array.from([6,26,50,74,98]),new ne(28,new U(2,111),new U(7,112)),new ne(28,new U(17,46)),new ne(30,new U(7,24),new U(16,25)),new ne(24,new U(34,13))),new Fe(23,Int32Array.from([6,30,54,78,102]),new ne(30,new U(4,121),new U(5,122)),new ne(28,new U(4,47),new U(14,48)),new ne(30,new U(11,24),new U(14,25)),new ne(30,new U(16,15),new U(14,16))),new Fe(24,Int32Array.from([6,28,54,80,106]),new ne(30,new U(6,117),new U(4,118)),new ne(28,new U(6,45),new U(14,46)),new ne(30,new U(11,24),new U(16,25)),new ne(30,new U(30,16),new U(2,17))),new Fe(25,Int32Array.from([6,32,58,84,110]),new ne(26,new U(8,106),new U(4,107)),new ne(28,new U(8,47),new U(13,48)),new ne(30,new U(7,24),new U(22,25)),new ne(30,new U(22,15),new U(13,16))),new Fe(26,Int32Array.from([6,30,58,86,114]),new ne(28,new U(10,114),new U(2,115)),new ne(28,new U(19,46),new U(4,47)),new ne(28,new U(28,22),new U(6,23)),new ne(30,new U(33,16),new U(4,17))),new Fe(27,Int32Array.from([6,34,62,90,118]),new ne(30,new U(8,122),new U(4,123)),new ne(28,new U(22,45),new U(3,46)),new ne(30,new U(8,23),new U(26,24)),new ne(30,new U(12,15),new U(28,16))),new Fe(28,Int32Array.from([6,26,50,74,98,122]),new ne(30,new U(3,117),new U(10,118)),new ne(28,new U(3,45),new U(23,46)),new ne(30,new U(4,24),new U(31,25)),new ne(30,new U(11,15),new U(31,16))),new Fe(29,Int32Array.from([6,30,54,78,102,126]),new ne(30,new U(7,116),new U(7,117)),new ne(28,new U(21,45),new U(7,46)),new ne(30,new U(1,23),new U(37,24)),new ne(30,new U(19,15),new U(26,16))),new Fe(30,Int32Array.from([6,26,52,78,104,130]),new ne(30,new U(5,115),new U(10,116)),new ne(28,new U(19,47),new U(10,48)),new ne(30,new U(15,24),new U(25,25)),new ne(30,new U(23,15),new U(25,16))),new Fe(31,Int32Array.from([6,30,56,82,108,134]),new ne(30,new U(13,115),new U(3,116)),new ne(28,new U(2,46),new U(29,47)),new ne(30,new U(42,24),new U(1,25)),new ne(30,new U(23,15),new U(28,16))),new Fe(32,Int32Array.from([6,34,60,86,112,138]),new ne(30,new U(17,115)),new ne(28,new U(10,46),new U(23,47)),new ne(30,new U(10,24),new U(35,25)),new ne(30,new U(19,15),new U(35,16))),new Fe(33,Int32Array.from([6,30,58,86,114,142]),new ne(30,new U(17,115),new U(1,116)),new ne(28,new U(14,46),new U(21,47)),new ne(30,new U(29,24),new U(19,25)),new ne(30,new U(11,15),new U(46,16))),new Fe(34,Int32Array.from([6,34,62,90,118,146]),new ne(30,new U(13,115),new U(6,116)),new ne(28,new U(14,46),new U(23,47)),new ne(30,new U(44,24),new U(7,25)),new ne(30,new U(59,16),new U(1,17))),new Fe(35,Int32Array.from([6,30,54,78,102,126,150]),new ne(30,new U(12,121),new U(7,122)),new ne(28,new U(12,47),new U(26,48)),new ne(30,new U(39,24),new U(14,25)),new ne(30,new U(22,15),new U(41,16))),new Fe(36,Int32Array.from([6,24,50,76,102,128,154]),new ne(30,new U(6,121),new U(14,122)),new ne(28,new U(6,47),new U(34,48)),new ne(30,new U(46,24),new U(10,25)),new ne(30,new U(2,15),new U(64,16))),new Fe(37,Int32Array.from([6,28,54,80,106,132,158]),new ne(30,new U(17,122),new U(4,123)),new ne(28,new U(29,46),new U(14,47)),new ne(30,new U(49,24),new U(10,25)),new ne(30,new U(24,15),new U(46,16))),new Fe(38,Int32Array.from([6,32,58,84,110,136,162]),new ne(30,new U(4,122),new U(18,123)),new ne(28,new U(13,46),new U(32,47)),new ne(30,new U(48,24),new U(14,25)),new ne(30,new U(42,15),new U(32,16))),new Fe(39,Int32Array.from([6,26,54,82,110,138,166]),new ne(30,new U(20,117),new U(4,118)),new ne(28,new U(40,47),new U(7,48)),new ne(30,new U(43,24),new U(22,25)),new ne(30,new U(10,15),new U(67,16))),new Fe(40,Int32Array.from([6,30,58,86,114,142,170]),new ne(30,new U(19,118),new U(6,119)),new ne(28,new U(18,47),new U(31,48)),new ne(30,new U(34,24),new U(34,25)),new ne(30,new U(20,15),new U(61,16)))];var Ye;(function(S){S[S.DATA_MASK_000=0]="DATA_MASK_000",S[S.DATA_MASK_001=1]="DATA_MASK_001",S[S.DATA_MASK_010=2]="DATA_MASK_010",S[S.DATA_MASK_011=3]="DATA_MASK_011",S[S.DATA_MASK_100=4]="DATA_MASK_100",S[S.DATA_MASK_101=5]="DATA_MASK_101",S[S.DATA_MASK_110=6]="DATA_MASK_110",S[S.DATA_MASK_111=7]="DATA_MASK_111"})(Ye||(Ye={}));class sr{constructor(o,a){this.value=o,this.isMasked=a}unmaskBitMatrix(o,a){for(let c=0;c<a;c++)for(let u=0;u<a;u++)this.isMasked(c,u)&&o.flip(u,c)}}sr.values=new Map([[Ye.DATA_MASK_000,new sr(Ye.DATA_MASK_000,(S,o)=>(S+o&1)===0)],[Ye.DATA_MASK_001,new sr(Ye.DATA_MASK_001,(S,o)=>(S&1)===0)],[Ye.DATA_MASK_010,new sr(Ye.DATA_MASK_010,(S,o)=>o%3===0)],[Ye.DATA_MASK_011,new sr(Ye.DATA_MASK_011,(S,o)=>(S+o)%3===0)],[Ye.DATA_MASK_100,new sr(Ye.DATA_MASK_100,(S,o)=>(Math.floor(S/2)+Math.floor(o/3)&1)===0)],[Ye.DATA_MASK_101,new sr(Ye.DATA_MASK_101,(S,o)=>S*o%6===0)],[Ye.DATA_MASK_110,new sr(Ye.DATA_MASK_110,(S,o)=>S*o%6<3)],[Ye.DATA_MASK_111,new sr(Ye.DATA_MASK_111,(S,o)=>(S+o+S*o%3&1)===0)]]);class Va{constructor(o){const a=o.getHeight();if(a<21||(a&3)!==1)throw new k;this.bitMatrix=o}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let o=0;for(let d=0;d<6;d++)o=this.copyBit(d,8,o);o=this.copyBit(7,8,o),o=this.copyBit(8,8,o),o=this.copyBit(8,7,o);for(let d=5;d>=0;d--)o=this.copyBit(8,d,o);const a=this.bitMatrix.getHeight();let c=0;const u=a-7;for(let d=a-1;d>=u;d--)c=this.copyBit(8,d,c);for(let d=a-8;d<a;d++)c=this.copyBit(d,8,c);if(this.parsedFormatInfo=Ht.decodeFormatInformation(o,c),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new k}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const o=this.bitMatrix.getHeight(),a=Math.floor((o-17)/4);if(a<=6)return Fe.getVersionForNumber(a);let c=0;const u=o-11;for(let g=5;g>=0;g--)for(let y=o-9;y>=u;y--)c=this.copyBit(y,g,c);let d=Fe.decodeVersionInformation(c);if(d!==null&&d.getDimensionForVersion()===o)return this.parsedVersion=d,d;c=0;for(let g=5;g>=0;g--)for(let y=o-9;y>=u;y--)c=this.copyBit(g,y,c);if(d=Fe.decodeVersionInformation(c),d!==null&&d.getDimensionForVersion()===o)return this.parsedVersion=d,d;throw new k}copyBit(o,a,c){return(this.isMirror?this.bitMatrix.get(a,o):this.bitMatrix.get(o,a))?c<<1|1:c<<1}readCodewords(){const o=this.readFormatInformation(),a=this.readVersion(),c=sr.values.get(o.getDataMask()),u=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,u);const d=a.buildFunctionPattern();let g=!0;const y=new Uint8Array(a.getTotalCodewords());let w=0,E=0,T=0;for(let b=u-1;b>0;b-=2){b===6&&b--;for(let O=0;O<u;O++){const z=g?u-1-O:O;for(let X=0;X<2;X++)d.get(b-X,z)||(T++,E<<=1,this.bitMatrix.get(b-X,z)&&(E|=1),T===8&&(y[w++]=E,T=0,E=0))}g=!g}if(w!==a.getTotalCodewords())throw new k;return y}remask(){if(this.parsedFormatInfo===null)return;const o=sr.values[this.parsedFormatInfo.getDataMask()],a=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,a)}setMirror(o){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=o}mirror(){const o=this.bitMatrix;for(let a=0,c=o.getWidth();a<c;a++)for(let u=a+1,d=o.getHeight();u<d;u++)o.get(a,u)!==o.get(u,a)&&(o.flip(u,a),o.flip(a,u))}}class Us{constructor(o,a){this.numDataCodewords=o,this.codewords=a}static getDataBlocks(o,a,c){if(o.length!==a.getTotalCodewords())throw new _;const u=a.getECBlocksForLevel(c);let d=0;const g=u.getECBlocks();for(const X of g)d+=X.getCount();const y=new Array(d);let w=0;for(const X of g)for(let Z=0;Z<X.getCount();Z++){const re=X.getDataCodewords(),ce=u.getECCodewordsPerBlock()+re;y[w++]=new Us(re,new Uint8Array(ce))}const E=y[0].codewords.length;let T=y.length-1;for(;T>=0&&y[T].codewords.length!==E;)T--;T++;const b=E-u.getECCodewordsPerBlock();let O=0;for(let X=0;X<b;X++)for(let Z=0;Z<w;Z++)y[Z].codewords[X]=o[O++];for(let X=T;X<w;X++)y[X].codewords[b]=o[O++];const z=y[0].codewords.length;for(let X=b;X<z;X++)for(let Z=0;Z<w;Z++){const re=Z<T?X:X+1;y[Z].codewords[re]=o[O++]}return y}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Br;(function(S){S[S.TERMINATOR=0]="TERMINATOR",S[S.NUMERIC=1]="NUMERIC",S[S.ALPHANUMERIC=2]="ALPHANUMERIC",S[S.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",S[S.BYTE=4]="BYTE",S[S.ECI=5]="ECI",S[S.KANJI=6]="KANJI",S[S.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",S[S.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",S[S.HANZI=9]="HANZI"})(Br||(Br={}));class Be{constructor(o,a,c,u){this.value=o,this.stringValue=a,this.characterCountBitsForVersions=c,this.bits=u,Be.FOR_BITS.set(u,this),Be.FOR_VALUE.set(o,this)}static forBits(o){const a=Be.FOR_BITS.get(o);if(a===void 0)throw new _;return a}getCharacterCountBits(o){const a=o.getVersionNumber();let c;return a<=9?c=0:a<=26?c=1:c=2,this.characterCountBitsForVersions[c]}getValue(){return this.value}getBits(){return this.bits}equals(o){if(!(o instanceof Be))return!1;const a=o;return this.value===a.value}toString(){return this.stringValue}}Be.FOR_BITS=new Map,Be.FOR_VALUE=new Map,Be.TERMINATOR=new Be(Br.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Be.NUMERIC=new Be(Br.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Be.ALPHANUMERIC=new Be(Br.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Be.STRUCTURED_APPEND=new Be(Br.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Be.BYTE=new Be(Br.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Be.ECI=new Be(Br.ECI,"ECI",Int32Array.from([0,0,0]),7),Be.KANJI=new Be(Br.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Be.FNC1_FIRST_POSITION=new Be(Br.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Be.FNC1_SECOND_POSITION=new Be(Br.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Be.HANZI=new Be(Br.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class $t{static decode(o,a,c,u){const d=new Fa(o);let g=new j;const y=new Array;let w=-1,E=-1;try{let T=null,b=!1,O;do{if(d.available()<4)O=Be.TERMINATOR;else{const z=d.readBits(4);O=Be.forBits(z)}switch(O){case Be.TERMINATOR:break;case Be.FNC1_FIRST_POSITION:case Be.FNC1_SECOND_POSITION:b=!0;break;case Be.STRUCTURED_APPEND:if(d.available()<16)throw new k;w=d.readBits(8),E=d.readBits(8);break;case Be.ECI:const z=$t.parseECIValue(d);if(T=L.getCharacterSetECIByValue(z),T===null)throw new k;break;case Be.HANZI:const X=d.readBits(4),Z=d.readBits(O.getCharacterCountBits(a));X===$t.GB2312_SUBSET&&$t.decodeHanziSegment(d,g,Z);break;default:const re=d.readBits(O.getCharacterCountBits(a));switch(O){case Be.NUMERIC:$t.decodeNumericSegment(d,g,re);break;case Be.ALPHANUMERIC:$t.decodeAlphanumericSegment(d,g,re,b);break;case Be.BYTE:$t.decodeByteSegment(d,g,re,T,y,u);break;case Be.KANJI:$t.decodeKanjiSegment(d,g,re);break;default:throw new k}break}}while(O!==Be.TERMINATOR)}catch{throw new k}return new Si(o,g.toString(),y.length===0?null:y,c===null?null:c.toString(),w,E)}static decodeHanziSegment(o,a,c){if(c*13>o.available())throw new k;const u=new Uint8Array(2*c);let d=0;for(;c>0;){const g=o.readBits(13);let y=g/96<<8&4294967295|g%96;y<959?y+=41377:y+=42657,u[d]=y>>8&255,u[d+1]=y&255,d+=2,c--}try{a.append(K.decode(u,q.GB2312))}catch(g){throw new k(g)}}static decodeKanjiSegment(o,a,c){if(c*13>o.available())throw new k;const u=new Uint8Array(2*c);let d=0;for(;c>0;){const g=o.readBits(13);let y=g/192<<8&4294967295|g%192;y<7936?y+=33088:y+=49472,u[d]=y>>8,u[d+1]=y,d+=2,c--}try{a.append(K.decode(u,q.SHIFT_JIS))}catch(g){throw new k(g)}}static decodeByteSegment(o,a,c,u,d,g){if(8*c>o.available())throw new k;const y=new Uint8Array(c);for(let E=0;E<c;E++)y[E]=o.readBits(8);let w;u===null?w=q.guessEncoding(y,g):w=u.getName();try{a.append(K.decode(y,w))}catch(E){throw new k(E)}d.push(y)}static toAlphaNumericChar(o){if(o>=$t.ALPHANUMERIC_CHARS.length)throw new k;return $t.ALPHANUMERIC_CHARS[o]}static decodeAlphanumericSegment(o,a,c,u){const d=a.length();for(;c>1;){if(o.available()<11)throw new k;const g=o.readBits(11);a.append($t.toAlphaNumericChar(Math.floor(g/45))),a.append($t.toAlphaNumericChar(g%45)),c-=2}if(c===1){if(o.available()<6)throw new k;a.append($t.toAlphaNumericChar(o.readBits(6)))}if(u)for(let g=d;g<a.length();g++)a.charAt(g)==="%"&&(g<a.length()-1&&a.charAt(g+1)==="%"?a.deleteCharAt(g+1):a.setCharAt(g,String.fromCharCode(29)))}static decodeNumericSegment(o,a,c){for(;c>=3;){if(o.available()<10)throw new k;const u=o.readBits(10);if(u>=1e3)throw new k;a.append($t.toAlphaNumericChar(Math.floor(u/100))),a.append($t.toAlphaNumericChar(Math.floor(u/10)%10)),a.append($t.toAlphaNumericChar(u%10)),c-=3}if(c===2){if(o.available()<7)throw new k;const u=o.readBits(7);if(u>=100)throw new k;a.append($t.toAlphaNumericChar(Math.floor(u/10))),a.append($t.toAlphaNumericChar(u%10))}else if(c===1){if(o.available()<4)throw new k;const u=o.readBits(4);if(u>=10)throw new k;a.append($t.toAlphaNumericChar(u))}}static parseECIValue(o){const a=o.readBits(8);if(!(a&128))return a&127;if((a&192)===128){const c=o.readBits(8);return(a&63)<<8&4294967295|c}if((a&224)===192){const c=o.readBits(16);return(a&31)<<16&4294967295|c}throw new k}}$t.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",$t.GB2312_SUBSET=1;class of{constructor(o){this.mirrored=o}isMirrored(){return this.mirrored}applyMirroredCorrection(o){if(!this.mirrored||o===null||o.length<3)return;const a=o[0];o[0]=o[2],o[2]=a}}class Sg{constructor(){this.rsDecoder=new Zi(ot.QR_CODE_FIELD_256)}decodeBooleanArray(o,a){return this.decodeBitMatrix(ze.parseFromBooleanArray(o),a)}decodeBitMatrix(o,a){const c=new Va(o);let u=null;try{return this.decodeBitMatrixParser(c,a)}catch(d){u=d}try{c.remask(),c.setMirror(!0),c.readVersion(),c.readFormatInformation(),c.mirror();const d=this.decodeBitMatrixParser(c,a);return d.setOther(new of(!0)),d}catch(d){throw u!==null?u:d}}decodeBitMatrixParser(o,a){const c=o.readVersion(),u=o.readFormatInformation().getErrorCorrectionLevel(),d=o.readCodewords(),g=Us.getDataBlocks(d,c,u);let y=0;for(const T of g)y+=T.getNumDataCodewords();const w=new Uint8Array(y);let E=0;for(const T of g){const b=T.getCodewords(),O=T.getNumDataCodewords();this.correctErrors(b,O);for(let z=0;z<O;z++)w[E++]=b[z]}return $t.decode(w,c,u,a)}correctErrors(o,a){const c=new Int32Array(o);try{this.rsDecoder.decode(c,o.length-a)}catch{throw new R}for(let u=0;u<a;u++)o[u]=c[u]}}class zu extends Q{constructor(o,a,c){super(o,a),this.estimatedModuleSize=c}aboutEquals(o,a,c){if(Math.abs(a-this.getY())<=o&&Math.abs(c-this.getX())<=o){const u=Math.abs(o-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(o,a,c){const u=(this.getX()+a)/2,d=(this.getY()+o)/2,g=(this.estimatedModuleSize+c)/2;return new zu(u,d,g)}}class is{constructor(o,a,c,u,d,g,y){this.image=o,this.startX=a,this.startY=c,this.width=u,this.height=d,this.moduleSize=g,this.resultPointCallback=y,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const o=this.startX,a=this.height,c=this.width,u=o+c,d=this.startY+a/2,g=new Int32Array(3),y=this.image;for(let w=0;w<a;w++){const E=d+(w&1?-Math.floor((w+1)/2):Math.floor((w+1)/2));g[0]=0,g[1]=0,g[2]=0;let T=o;for(;T<u&&!y.get(T,E);)T++;let b=0;for(;T<u;){if(y.get(T,E))if(b===1)g[1]++;else if(b===2){if(this.foundPatternCross(g)){const O=this.handlePossibleCenter(g,E,T);if(O!==null)return O}g[0]=g[2],g[1]=1,g[2]=0,b=1}else g[++b]++;else b===1&&b++,g[b]++;T++}if(this.foundPatternCross(g)){const O=this.handlePossibleCenter(g,E,u);if(O!==null)return O}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ie}static centerFromEnd(o,a){return a-o[2]-o[1]/2}foundPatternCross(o){const a=this.moduleSize,c=a/2;for(let u=0;u<3;u++)if(Math.abs(a-o[u])>=c)return!1;return!0}crossCheckVertical(o,a,c,u){const d=this.image,g=d.getHeight(),y=this.crossCheckStateCount;y[0]=0,y[1]=0,y[2]=0;let w=o;for(;w>=0&&d.get(a,w)&&y[1]<=c;)y[1]++,w--;if(w<0||y[1]>c)return NaN;for(;w>=0&&!d.get(a,w)&&y[0]<=c;)y[0]++,w--;if(y[0]>c)return NaN;for(w=o+1;w<g&&d.get(a,w)&&y[1]<=c;)y[1]++,w++;if(w===g||y[1]>c)return NaN;for(;w<g&&!d.get(a,w)&&y[2]<=c;)y[2]++,w++;if(y[2]>c)return NaN;const E=y[0]+y[1]+y[2];return 5*Math.abs(E-u)>=2*u?NaN:this.foundPatternCross(y)?is.centerFromEnd(y,w):NaN}handlePossibleCenter(o,a,c){const u=o[0]+o[1]+o[2],d=is.centerFromEnd(o,c),g=this.crossCheckVertical(a,d,2*o[1],u);if(!isNaN(g)){const y=(o[0]+o[1]+o[2])/3;for(const E of this.possibleCenters)if(E.aboutEquals(y,g,d))return E.combineEstimate(g,d,y);const w=new zu(d,g,y);this.possibleCenters.push(w),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(w)}return null}}class mi extends Q{constructor(o,a,c,u){super(o,a),this.estimatedModuleSize=c,this.count=u,u===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(o,a,c){if(Math.abs(a-this.getY())<=o&&Math.abs(c-this.getX())<=o){const u=Math.abs(o-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(o,a,c){const u=this.count+1,d=(this.count*this.getX()+a)/u,g=(this.count*this.getY()+o)/u,y=(this.count*this.estimatedModuleSize+c)/u;return new mi(d,g,y,u)}}class af{constructor(o){this.bottomLeft=o[0],this.topLeft=o[1],this.topRight=o[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Cn{constructor(o,a){this.image=o,this.resultPointCallback=a,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=a}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(o){const a=o!=null&&o.get(J.TRY_HARDER)!==void 0,c=o!=null&&o.get(J.PURE_BARCODE)!==void 0,u=this.image,d=u.getHeight(),g=u.getWidth();let y=Math.floor(3*d/(4*Cn.MAX_MODULES));(y<Cn.MIN_SKIP||a)&&(y=Cn.MIN_SKIP);let w=!1;const E=new Int32Array(5);for(let b=y-1;b<d&&!w;b+=y){E[0]=0,E[1]=0,E[2]=0,E[3]=0,E[4]=0;let O=0;for(let z=0;z<g;z++)if(u.get(z,b))(O&1)===1&&O++,E[O]++;else if(O&1)E[O]++;else if(O===4)if(Cn.foundPatternCross(E)){if(this.handlePossibleCenter(E,b,z,c)===!0)if(y=2,this.hasSkipped===!0)w=this.haveMultiplyConfirmedCenters();else{const Z=this.findRowSkip();Z>E[2]&&(b+=Z-E[2]-y,z=g-1)}else{E[0]=E[2],E[1]=E[3],E[2]=E[4],E[3]=1,E[4]=0,O=3;continue}O=0,E[0]=0,E[1]=0,E[2]=0,E[3]=0,E[4]=0}else E[0]=E[2],E[1]=E[3],E[2]=E[4],E[3]=1,E[4]=0,O=3;else E[++O]++;Cn.foundPatternCross(E)&&this.handlePossibleCenter(E,b,g,c)===!0&&(y=E[0],this.hasSkipped&&(w=this.haveMultiplyConfirmedCenters()))}const T=this.selectBestPatterns();return Q.orderBestPatterns(T),new af(T)}static centerFromEnd(o,a){return a-o[4]-o[3]-o[2]/2}static foundPatternCross(o){let a=0;for(let d=0;d<5;d++){const g=o[d];if(g===0)return!1;a+=g}if(a<7)return!1;const c=a/7,u=c/2;return Math.abs(c-o[0])<u&&Math.abs(c-o[1])<u&&Math.abs(3*c-o[2])<3*u&&Math.abs(c-o[3])<u&&Math.abs(c-o[4])<u}getCrossCheckStateCount(){const o=this.crossCheckStateCount;return o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o}crossCheckDiagonal(o,a,c,u){const d=this.getCrossCheckStateCount();let g=0;const y=this.image;for(;o>=g&&a>=g&&y.get(a-g,o-g);)d[2]++,g++;if(o<g||a<g)return!1;for(;o>=g&&a>=g&&!y.get(a-g,o-g)&&d[1]<=c;)d[1]++,g++;if(o<g||a<g||d[1]>c)return!1;for(;o>=g&&a>=g&&y.get(a-g,o-g)&&d[0]<=c;)d[0]++,g++;if(d[0]>c)return!1;const w=y.getHeight(),E=y.getWidth();for(g=1;o+g<w&&a+g<E&&y.get(a+g,o+g);)d[2]++,g++;if(o+g>=w||a+g>=E)return!1;for(;o+g<w&&a+g<E&&!y.get(a+g,o+g)&&d[3]<c;)d[3]++,g++;if(o+g>=w||a+g>=E||d[3]>=c)return!1;for(;o+g<w&&a+g<E&&y.get(a+g,o+g)&&d[4]<c;)d[4]++,g++;if(d[4]>=c)return!1;const T=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(T-u)<2*u&&Cn.foundPatternCross(d)}crossCheckVertical(o,a,c,u){const d=this.image,g=d.getHeight(),y=this.getCrossCheckStateCount();let w=o;for(;w>=0&&d.get(a,w);)y[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(a,w)&&y[1]<=c;)y[1]++,w--;if(w<0||y[1]>c)return NaN;for(;w>=0&&d.get(a,w)&&y[0]<=c;)y[0]++,w--;if(y[0]>c)return NaN;for(w=o+1;w<g&&d.get(a,w);)y[2]++,w++;if(w===g)return NaN;for(;w<g&&!d.get(a,w)&&y[3]<c;)y[3]++,w++;if(w===g||y[3]>=c)return NaN;for(;w<g&&d.get(a,w)&&y[4]<c;)y[4]++,w++;if(y[4]>=c)return NaN;const E=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(E-u)>=2*u?NaN:Cn.foundPatternCross(y)?Cn.centerFromEnd(y,w):NaN}crossCheckHorizontal(o,a,c,u){const d=this.image,g=d.getWidth(),y=this.getCrossCheckStateCount();let w=o;for(;w>=0&&d.get(w,a);)y[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(w,a)&&y[1]<=c;)y[1]++,w--;if(w<0||y[1]>c)return NaN;for(;w>=0&&d.get(w,a)&&y[0]<=c;)y[0]++,w--;if(y[0]>c)return NaN;for(w=o+1;w<g&&d.get(w,a);)y[2]++,w++;if(w===g)return NaN;for(;w<g&&!d.get(w,a)&&y[3]<c;)y[3]++,w++;if(w===g||y[3]>=c)return NaN;for(;w<g&&d.get(w,a)&&y[4]<c;)y[4]++,w++;if(y[4]>=c)return NaN;const E=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(E-u)>=u?NaN:Cn.foundPatternCross(y)?Cn.centerFromEnd(y,w):NaN}handlePossibleCenter(o,a,c,u){const d=o[0]+o[1]+o[2]+o[3]+o[4];let g=Cn.centerFromEnd(o,c),y=this.crossCheckVertical(a,Math.floor(g),o[2],d);if(!isNaN(y)&&(g=this.crossCheckHorizontal(Math.floor(g),Math.floor(y),o[2],d),!isNaN(g)&&(!u||this.crossCheckDiagonal(Math.floor(y),Math.floor(g),o[2],d)))){const w=d/7;let E=!1;const T=this.possibleCenters;for(let b=0,O=T.length;b<O;b++){const z=T[b];if(z.aboutEquals(w,y,g)){T[b]=z.combineEstimate(y,g,w),E=!0;break}}if(!E){const b=new mi(g,y,w);T.push(b),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(b)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let a=null;for(const c of this.possibleCenters)if(c.getCount()>=Cn.CENTER_QUORUM)if(a==null)a=c;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-c.getX())-Math.abs(a.getY()-c.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let o=0,a=0;const c=this.possibleCenters.length;for(const g of this.possibleCenters)g.getCount()>=Cn.CENTER_QUORUM&&(o++,a+=g.getEstimatedModuleSize());if(o<3)return!1;const u=a/c;let d=0;for(const g of this.possibleCenters)d+=Math.abs(g.getEstimatedModuleSize()-u);return d<=.05*a}selectBestPatterns(){const o=this.possibleCenters.length;if(o<3)throw new ie;const a=this.possibleCenters;let c;if(o>3){let u=0,d=0;for(const w of this.possibleCenters){const E=w.getEstimatedModuleSize();u+=E,d+=E*E}c=u/o;let g=Math.sqrt(d/o-c*c);a.sort((w,E)=>{const T=Math.abs(E.getEstimatedModuleSize()-c),b=Math.abs(w.getEstimatedModuleSize()-c);return T<b?-1:T>b?1:0});const y=Math.max(.2*c,g);for(let w=0;w<a.length&&a.length>3;w++){const E=a[w];Math.abs(E.getEstimatedModuleSize()-c)>y&&(a.splice(w,1),w--)}}if(a.length>3){let u=0;for(const d of a)u+=d.getEstimatedModuleSize();c=u/a.length,a.sort((d,g)=>{if(g.getCount()===d.getCount()){const y=Math.abs(g.getEstimatedModuleSize()-c),w=Math.abs(d.getEstimatedModuleSize()-c);return y<w?1:y>w?-1:0}else return g.getCount()-d.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]}}Cn.CENTER_QUORUM=2,Cn.MIN_SKIP=3,Cn.MAX_MODULES=57;class Ao{constructor(o){this.image=o}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(o){this.resultPointCallback=o==null?null:o.get(J.NEED_RESULT_POINT_CALLBACK);const c=new Cn(this.image,this.resultPointCallback).find(o);return this.processFinderPatternInfo(c)}processFinderPatternInfo(o){const a=o.getTopLeft(),c=o.getTopRight(),u=o.getBottomLeft(),d=this.calculateModuleSize(a,c,u);if(d<1)throw new ie("No pattern found in proccess finder.");const g=Ao.computeDimension(a,c,u,d),y=Fe.getProvisionalVersionForDimension(g),w=y.getDimensionForVersion()-7;let E=null;if(y.getAlignmentPatternCenters().length>0){const z=c.getX()-a.getX()+u.getX(),X=c.getY()-a.getY()+u.getY(),Z=1-3/w,re=Math.floor(a.getX()+Z*(z-a.getX())),ce=Math.floor(a.getY()+Z*(X-a.getY()));for(let xe=4;xe<=16;xe<<=1)try{E=this.findAlignmentInRegion(d,re,ce,xe);break}catch(_e){if(!(_e instanceof ie))throw _e}}const T=Ao.createTransform(a,c,u,E,g),b=Ao.sampleGrid(this.image,T,g);let O;return E===null?O=[u,a,c]:O=[u,a,c,E],new ue(b,O)}static createTransform(o,a,c,u,d){const g=d-3.5;let y,w,E,T;return u!==null?(y=u.getX(),w=u.getY(),E=g-3,T=E):(y=a.getX()-o.getX()+c.getX(),w=a.getY()-o.getY()+c.getY(),E=g,T=g),be.quadrilateralToQuadrilateral(3.5,3.5,g,3.5,E,T,3.5,g,o.getX(),o.getY(),a.getX(),a.getY(),y,w,c.getX(),c.getY())}static sampleGrid(o,a,c){return Ge.getInstance().sampleGridWithTransform(o,c,c,a)}static computeDimension(o,a,c,u){const d=it.round(Q.distance(o,a)/u),g=it.round(Q.distance(o,c)/u);let y=Math.floor((d+g)/2)+7;switch(y&3){case 0:y++;break;case 2:y--;break;case 3:throw new ie("Dimensions could be not found.")}return y}calculateModuleSize(o,a,c){return(this.calculateModuleSizeOneWay(o,a)+this.calculateModuleSizeOneWay(o,c))/2}calculateModuleSizeOneWay(o,a){const c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(o.getX()),Math.floor(o.getY()),Math.floor(a.getX()),Math.floor(a.getY())),u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(o.getX()),Math.floor(o.getY()));return isNaN(c)?u/7:isNaN(u)?c/7:(c+u)/14}sizeOfBlackWhiteBlackRunBothWays(o,a,c,u){let d=this.sizeOfBlackWhiteBlackRun(o,a,c,u),g=1,y=o-(c-o);y<0?(g=o/(o-y),y=0):y>=this.image.getWidth()&&(g=(this.image.getWidth()-1-o)/(y-o),y=this.image.getWidth()-1);let w=Math.floor(a-(u-a)*g);return g=1,w<0?(g=a/(a-w),w=0):w>=this.image.getHeight()&&(g=(this.image.getHeight()-1-a)/(w-a),w=this.image.getHeight()-1),y=Math.floor(o+(y-o)*g),d+=this.sizeOfBlackWhiteBlackRun(o,a,y,w),d-1}sizeOfBlackWhiteBlackRun(o,a,c,u){const d=Math.abs(u-a)>Math.abs(c-o);if(d){let z=o;o=a,a=z,z=c,c=u,u=z}const g=Math.abs(c-o),y=Math.abs(u-a);let w=-g/2;const E=o<c?1:-1,T=a<u?1:-1;let b=0;const O=c+E;for(let z=o,X=a;z!==O;z+=E){const Z=d?X:z,re=d?z:X;if(b===1===this.image.get(Z,re)){if(b===2)return it.distance(z,X,o,a);b++}if(w+=y,w>0){if(X===u)break;X+=T,w-=g}}return b===2?it.distance(c+E,u,o,a):NaN}findAlignmentInRegion(o,a,c,u){const d=Math.floor(u*o),g=Math.max(0,a-d),y=Math.min(this.image.getWidth()-1,a+d);if(y-g<o*3)throw new ie("Alignment top exceeds estimated module size.");const w=Math.max(0,c-d),E=Math.min(this.image.getHeight()-1,c+d);if(E-w<o*3)throw new ie("Alignment bottom exceeds estimated module size.");return new is(this.image,g,w,y-g,E-w,o,this.resultPointCallback).find()}}class Cr{constructor(){this.decoder=new Sg}getDecoder(){return this.decoder}decode(o,a){let c,u;if(a!=null&&a.get(J.PURE_BARCODE)!==void 0){const w=Cr.extractPureBits(o.getBlackMatrix());c=this.decoder.decodeBitMatrix(w,a),u=Cr.NO_POINTS}else{const w=new Ao(o.getBlackMatrix()).detect(a);c=this.decoder.decodeBitMatrix(w.getBits(),a),u=w.getPoints()}c.getOther()instanceof of&&c.getOther().applyMirroredCorrection(u);const d=new Vt(c.getText(),c.getRawBytes(),void 0,u,ke.QR_CODE,void 0),g=c.getByteSegments();g!==null&&d.putMetadata(an.BYTE_SEGMENTS,g);const y=c.getECLevel();return y!==null&&d.putMetadata(an.ERROR_CORRECTION_LEVEL,y),c.hasStructuredAppend()&&(d.putMetadata(an.STRUCTURED_APPEND_SEQUENCE,c.getStructuredAppendSequenceNumber()),d.putMetadata(an.STRUCTURED_APPEND_PARITY,c.getStructuredAppendParity())),d}reset(){}static extractPureBits(o){const a=o.getTopLeftOnBit(),c=o.getBottomRightOnBit();if(a===null||c===null)throw new ie;const u=this.moduleSize(a,o);let d=a[1],g=c[1],y=a[0],w=c[0];if(y>=w||d>=g)throw new ie;if(g-d!==w-y&&(w=y+(g-d),w>=o.getWidth()))throw new ie;const E=Math.round((w-y+1)/u),T=Math.round((g-d+1)/u);if(E<=0||T<=0)throw new ie;if(T!==E)throw new ie;const b=Math.floor(u/2);d+=b,y+=b;const O=y+Math.floor((E-1)*u)-w;if(O>0){if(O>b)throw new ie;y-=O}const z=d+Math.floor((T-1)*u)-g;if(z>0){if(z>b)throw new ie;d-=z}const X=new ze(E,T);for(let Z=0;Z<T;Z++){const re=d+Math.floor(Z*u);for(let ce=0;ce<E;ce++)o.get(y+Math.floor(ce*u),re)&&X.set(ce,Z)}return X}static moduleSize(o,a){const c=a.getHeight(),u=a.getWidth();let d=o[0],g=o[1],y=!0,w=0;for(;d<u&&g<c;){if(y!==a.get(d,g)){if(++w===5)break;y=!y}d++,g++}if(d===u||g===c)throw new ie;return(d-o[0])/7}}Cr.NO_POINTS=new Array;class He{PDF417Common(){}static getBitCountSum(o){return it.sum(o)}static toIntArray(o){if(o==null||!o.length)return He.EMPTY_INT_ARRAY;const a=new Int32Array(o.length);let c=0;for(const u of o)a[c++]=u;return a}static getCodeword(o){const a=P.binarySearch(He.SYMBOL_TABLE,o&262143);return a<0?-1:(He.CODEWORD_TABLE[a]-1)%He.NUMBER_OF_CODEWORDS}}He.NUMBER_OF_CODEWORDS=929,He.MAX_CODEWORDS_IN_BARCODE=He.NUMBER_OF_CODEWORDS-1,He.MIN_ROWS_IN_BARCODE=3,He.MAX_ROWS_IN_BARCODE=90,He.MODULES_IN_CODEWORD=17,He.MODULES_IN_STOP_PATTERN=18,He.BARS_IN_MODULE=8,He.EMPTY_INT_ARRAY=new Int32Array([]),He.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),He.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class bg{constructor(o,a){this.bits=o,this.points=a}getBits(){return this.bits}getPoints(){return this.points}}class Ze{static detectMultiple(o,a,c){let u=o.getBlackMatrix(),d=Ze.detect(c,u);return d.length||(u=u.clone(),u.rotate180(),d=Ze.detect(c,u)),new bg(u,d)}static detect(o,a){const c=new Array;let u=0,d=0,g=!1;for(;u<a.getHeight();){const y=Ze.findVertices(a,u,d);if(y[0]==null&&y[3]==null){if(!g)break;g=!1,d=0;for(const w of c)w[1]!=null&&(u=Math.trunc(Math.max(u,w[1].getY()))),w[3]!=null&&(u=Math.max(u,Math.trunc(w[3].getY())));u+=Ze.ROW_STEP;continue}if(g=!0,c.push(y),!o)break;y[2]!=null?(d=Math.trunc(y[2].getX()),u=Math.trunc(y[2].getY())):(d=Math.trunc(y[4].getX()),u=Math.trunc(y[4].getY()))}return c}static findVertices(o,a,c){const u=o.getHeight(),d=o.getWidth(),g=new Array(8);return Ze.copyToResult(g,Ze.findRowsWithPattern(o,u,d,a,c,Ze.START_PATTERN),Ze.INDEXES_START_PATTERN),g[4]!=null&&(c=Math.trunc(g[4].getX()),a=Math.trunc(g[4].getY())),Ze.copyToResult(g,Ze.findRowsWithPattern(o,u,d,a,c,Ze.STOP_PATTERN),Ze.INDEXES_STOP_PATTERN),g}static copyToResult(o,a,c){for(let u=0;u<c.length;u++)o[c[u]]=a[u]}static findRowsWithPattern(o,a,c,u,d,g){const y=new Array(4);let w=!1;const E=new Int32Array(g.length);for(;u<a;u+=Ze.ROW_STEP){let b=Ze.findGuardPattern(o,d,u,c,!1,g,E);if(b!=null){for(;u>0;){const O=Ze.findGuardPattern(o,d,--u,c,!1,g,E);if(O!=null)b=O;else{u++;break}}y[0]=new Q(b[0],u),y[1]=new Q(b[1],u),w=!0;break}}let T=u+1;if(w){let b=0,O=Int32Array.from([Math.trunc(y[0].getX()),Math.trunc(y[1].getX())]);for(;T<a;T++){const z=Ze.findGuardPattern(o,O[0],T,c,!1,g,E);if(z!=null&&Math.abs(O[0]-z[0])<Ze.MAX_PATTERN_DRIFT&&Math.abs(O[1]-z[1])<Ze.MAX_PATTERN_DRIFT)O=z,b=0;else{if(b>Ze.SKIPPED_ROW_COUNT_MAX)break;b++}}T-=b+1,y[2]=new Q(O[0],T),y[3]=new Q(O[1],T)}return T-u<Ze.BARCODE_MIN_HEIGHT&&P.fill(y,null),y}static findGuardPattern(o,a,c,u,d,g,y){P.fillWithin(y,0,y.length,0);let w=a,E=0;for(;o.get(w,c)&&w>0&&E++<Ze.MAX_PIXEL_DRIFT;)w--;let T=w,b=0,O=g.length;for(let z=d;T<u;T++)if(o.get(T,c)!==z)y[b]++;else{if(b===O-1){if(Ze.patternMatchVariance(y,g,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE)return new Int32Array([w,T]);w+=y[0]+y[1],D.arraycopy(y,2,y,0,b-1),y[b-1]=0,y[b]=0,b--}else b++;y[b]=1,z=!z}return b===O-1&&Ze.patternMatchVariance(y,g,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE?new Int32Array([w,T-1]):null}static patternMatchVariance(o,a,c){let u=o.length,d=0,g=0;for(let E=0;E<u;E++)d+=o[E],g+=a[E];if(d<g)return 1/0;let y=d/g;c*=y;let w=0;for(let E=0;E<u;E++){let T=o[E],b=a[E]*y,O=T>b?T-b:b-T;if(O>c)return 1/0;w+=O}return w/d}}Ze.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ze.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ze.MAX_AVG_VARIANCE=.42,Ze.MAX_INDIVIDUAL_VARIANCE=.8,Ze.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ze.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ze.MAX_PIXEL_DRIFT=3,Ze.MAX_PATTERN_DRIFT=5,Ze.SKIPPED_ROW_COUNT_MAX=25,Ze.ROW_STEP=5,Ze.BARCODE_MIN_HEIGHT=10;class Wt{constructor(o,a){if(a.length===0)throw new _;this.field=o;let c=a.length;if(c>1&&a[0]===0){let u=1;for(;u<c&&a[u]===0;)u++;u===c?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(c-u),D.arraycopy(a,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=a}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(o){return this.coefficients[this.coefficients.length-1-o]}evaluateAt(o){if(o===0)return this.getCoefficient(0);if(o===1){let u=0;for(let d of this.coefficients)u=this.field.add(u,d);return u}let a=this.coefficients[0],c=this.coefficients.length;for(let u=1;u<c;u++)a=this.field.add(this.field.multiply(o,a),this.coefficients[u]);return a}add(o){if(!this.field.equals(o.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero())return o;if(o.isZero())return this;let a=this.coefficients,c=o.coefficients;if(a.length>c.length){let g=a;a=c,c=g}let u=new Int32Array(c.length),d=c.length-a.length;D.arraycopy(c,0,u,0,d);for(let g=d;g<c.length;g++)u[g]=this.field.add(a[g-d],c[g]);return new Wt(this.field,u)}subtract(o){if(!this.field.equals(o.field))throw new _("ModulusPolys do not have same ModulusGF field");return o.isZero()?this:this.add(o.negative())}multiply(o){return o instanceof Wt?this.multiplyOther(o):this.multiplyScalar(o)}multiplyOther(o){if(!this.field.equals(o.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero()||o.isZero())return new Wt(this.field,new Int32Array([0]));let a=this.coefficients,c=a.length,u=o.coefficients,d=u.length,g=new Int32Array(c+d-1);for(let y=0;y<c;y++){let w=a[y];for(let E=0;E<d;E++)g[y+E]=this.field.add(g[y+E],this.field.multiply(w,u[E]))}return new Wt(this.field,g)}negative(){let o=this.coefficients.length,a=new Int32Array(o);for(let c=0;c<o;c++)a[c]=this.field.subtract(0,this.coefficients[c]);return new Wt(this.field,a)}multiplyScalar(o){if(o===0)return new Wt(this.field,new Int32Array([0]));if(o===1)return this;let a=this.coefficients.length,c=new Int32Array(a);for(let u=0;u<a;u++)c[u]=this.field.multiply(this.coefficients[u],o);return new Wt(this.field,c)}multiplyByMonomial(o,a){if(o<0)throw new _;if(a===0)return new Wt(this.field,new Int32Array([0]));let c=this.coefficients.length,u=new Int32Array(c+o);for(let d=0;d<c;d++)u[d]=this.field.multiply(this.coefficients[d],a);return new Wt(this.field,u)}toString(){let o=new j;for(let a=this.getDegree();a>=0;a--){let c=this.getCoefficient(a);c!==0&&(c<0?(o.append(" - "),c=-c):o.length()>0&&o.append(" + "),(a===0||c!==1)&&o.append(c),a!==0&&(a===1?o.append("x"):(o.append("x^"),o.append(a))))}return o.toString()}}class Rg{add(o,a){return(o+a)%this.modulus}subtract(o,a){return(this.modulus+o-a)%this.modulus}exp(o){return this.expTable[o]}log(o){if(o===0)throw new _;return this.logTable[o]}inverse(o){if(o===0)throw new bi;return this.expTable[this.modulus-this.logTable[o]-1]}multiply(o,a){return o===0||a===0?0:this.expTable[(this.logTable[o]+this.logTable[a])%(this.modulus-1)]}getSize(){return this.modulus}equals(o){return o===this}}class Gu extends Rg{constructor(o,a){super(),this.modulus=o,this.expTable=new Int32Array(o),this.logTable=new Int32Array(o);let c=1;for(let u=0;u<o;u++)this.expTable[u]=c,c=c*a%o;for(let u=0;u<o-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new Wt(this,new Int32Array([0])),this.one=new Wt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(o,a){if(o<0)throw new _;if(a===0)return this.zero;let c=new Int32Array(o+1);return c[0]=a,new Wt(this,c)}}Gu.PDF417_GF=new Gu(He.NUMBER_OF_CODEWORDS,3);class Ba{constructor(){this.field=Gu.PDF417_GF}decode(o,a,c){let u=new Wt(this.field,o),d=new Int32Array(a),g=!1;for(let X=a;X>0;X--){let Z=u.evaluateAt(this.field.exp(X));d[a-X]=Z,Z!==0&&(g=!0)}if(!g)return 0;let y=this.field.getOne();if(c!=null)for(const X of c){let Z=this.field.exp(o.length-1-X),re=new Wt(this.field,new Int32Array([this.field.subtract(0,Z),1]));y=y.multiply(re)}let w=new Wt(this.field,d),E=this.runEuclideanAlgorithm(this.field.buildMonomial(a,1),w,a),T=E[0],b=E[1],O=this.findErrorLocations(T),z=this.findErrorMagnitudes(b,T,O);for(let X=0;X<O.length;X++){let Z=o.length-1-this.field.log(O[X]);if(Z<0)throw R.getChecksumInstance();o[Z]=this.field.subtract(o[Z],z[X])}return O.length}runEuclideanAlgorithm(o,a,c){if(o.getDegree()<a.getDegree()){let O=o;o=a,a=O}let u=o,d=a,g=this.field.getZero(),y=this.field.getOne();for(;d.getDegree()>=Math.round(c/2);){let O=u,z=g;if(u=d,g=y,u.isZero())throw R.getChecksumInstance();d=O;let X=this.field.getZero(),Z=u.getCoefficient(u.getDegree()),re=this.field.inverse(Z);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){let ce=d.getDegree()-u.getDegree(),xe=this.field.multiply(d.getCoefficient(d.getDegree()),re);X=X.add(this.field.buildMonomial(ce,xe)),d=d.subtract(u.multiplyByMonomial(ce,xe))}y=X.multiply(g).subtract(z).negative()}let w=y.getCoefficient(0);if(w===0)throw R.getChecksumInstance();let E=this.field.inverse(w),T=y.multiply(E),b=d.multiply(E);return[T,b]}findErrorLocations(o){let a=o.getDegree(),c=new Int32Array(a),u=0;for(let d=1;d<this.field.getSize()&&u<a;d++)o.evaluateAt(d)===0&&(c[u]=this.field.inverse(d),u++);if(u!==a)throw R.getChecksumInstance();return c}findErrorMagnitudes(o,a,c){let u=a.getDegree(),d=new Int32Array(u);for(let E=1;E<=u;E++)d[u-E]=this.field.multiply(E,a.getCoefficient(E));let g=new Wt(this.field,d),y=c.length,w=new Int32Array(y);for(let E=0;E<y;E++){let T=this.field.inverse(c[E]),b=this.field.subtract(0,o.evaluateAt(T)),O=this.field.inverse(g.evaluateAt(T));w[E]=this.field.multiply(b,O)}return w}}class pi{constructor(o,a,c,u,d){o instanceof pi?this.constructor_2(o):this.constructor_1(o,a,c,u,d)}constructor_1(o,a,c,u,d){const g=a==null||c==null,y=u==null||d==null;if(g&&y)throw new ie;g?(a=new Q(0,u.getY()),c=new Q(0,d.getY())):y&&(u=new Q(o.getWidth()-1,a.getY()),d=new Q(o.getWidth()-1,c.getY())),this.image=o,this.topLeft=a,this.bottomLeft=c,this.topRight=u,this.bottomRight=d,this.minX=Math.trunc(Math.min(a.getX(),c.getX())),this.maxX=Math.trunc(Math.max(u.getX(),d.getX())),this.minY=Math.trunc(Math.min(a.getY(),u.getY())),this.maxY=Math.trunc(Math.max(c.getY(),d.getY()))}constructor_2(o){this.image=o.image,this.topLeft=o.getTopLeft(),this.bottomLeft=o.getBottomLeft(),this.topRight=o.getTopRight(),this.bottomRight=o.getBottomRight(),this.minX=o.getMinX(),this.maxX=o.getMaxX(),this.minY=o.getMinY(),this.maxY=o.getMaxY()}static merge(o,a){return o==null?a:a==null?o:new pi(o.image,o.topLeft,o.bottomLeft,a.topRight,a.bottomRight)}addMissingRows(o,a,c){let u=this.topLeft,d=this.bottomLeft,g=this.topRight,y=this.bottomRight;if(o>0){let w=c?this.topLeft:this.topRight,E=Math.trunc(w.getY()-o);E<0&&(E=0);let T=new Q(w.getX(),E);c?u=T:g=T}if(a>0){let w=c?this.bottomLeft:this.bottomRight,E=Math.trunc(w.getY()+a);E>=this.image.getHeight()&&(E=this.image.getHeight()-1);let T=new Q(w.getX(),E);c?d=T:y=T}return new pi(this.image,u,d,g,y)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class lf{constructor(o,a,c,u){this.columnCount=o,this.errorCorrectionLevel=u,this.rowCountUpperPart=a,this.rowCountLowerPart=c,this.rowCount=a+c}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Pi{constructor(){this.buffer=""}static form(o,a){let c=-1;function u(g,y,w,E,T,b){if(g==="%%")return"%";if(a[++c]===void 0)return;g=E?parseInt(E.substr(1)):void 0;let O=T?parseInt(T.substr(1)):void 0,z;switch(b){case"s":z=a[c];break;case"c":z=a[c][0];break;case"f":z=parseFloat(a[c]).toFixed(g);break;case"p":z=parseFloat(a[c]).toPrecision(g);break;case"e":z=parseFloat(a[c]).toExponential(g);break;case"x":z=parseInt(a[c]).toString(O||16);break;case"d":z=parseFloat(parseInt(a[c],O||10).toPrecision(g)).toFixed(0);break}z=typeof z=="object"?JSON.stringify(z):(+z).toString(O);let X=parseInt(w),Z=w&&w[0]+""=="0"?"0":" ";for(;z.length<X;)z=y!==void 0?z+Z:Z+z;return z}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return o.replace(d,u)}format(o,...a){this.buffer+=Pi.form(o,a)}toString(){return this.buffer}}class Di{constructor(o){this.boundingBox=new pi(o),this.codewords=new Array(o.getMaxY()-o.getMinY()+1)}getCodewordNearby(o){let a=this.getCodeword(o);if(a!=null)return a;for(let c=1;c<Di.MAX_NEARBY_DISTANCE;c++){let u=this.imageRowToCodewordIndex(o)-c;if(u>=0&&(a=this.codewords[u],a!=null)||(u=this.imageRowToCodewordIndex(o)+c,u<this.codewords.length&&(a=this.codewords[u],a!=null)))return a}return null}imageRowToCodewordIndex(o){return o-this.boundingBox.getMinY()}setCodeword(o,a){this.codewords[this.imageRowToCodewordIndex(o)]=a}getCodeword(o){return this.codewords[this.imageRowToCodewordIndex(o)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const o=new Pi;let a=0;for(const c of this.codewords){if(c==null){o.format("%3d:    |   %n",a++);continue}o.format("%3d: %3d|%3d%n",a++,c.getRowNumber(),c.getValue())}return o.toString()}}Di.MAX_NEARBY_DISTANCE=5;class To{constructor(){this.values=new Map}setValue(o){o=Math.trunc(o);let a=this.values.get(o);a==null&&(a=0),a++,this.values.set(o,a)}getValue(){let o=-1,a=new Array;for(const[c,u]of this.values.entries()){const d={getKey:()=>c,getValue:()=>u};d.getValue()>o?(o=d.getValue(),a=[],a.push(d.getKey())):d.getValue()===o&&a.push(d.getKey())}return He.toIntArray(a)}getConfidence(o){return this.values.get(o)}}class Ql extends Di{constructor(o,a){super(o),this._isLeft=a}setRowNumbers(){for(let o of this.getCodewords())o!=null&&o.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(o){let a=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(a,o);let c=this.getBoundingBox(),u=this._isLeft?c.getTopLeft():c.getTopRight(),d=this._isLeft?c.getBottomLeft():c.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=-1,E=1,T=0;for(let b=g;b<y;b++){if(a[b]==null)continue;let O=a[b],z=O.getRowNumber()-w;if(z===0)T++;else if(z===1)E=Math.max(E,T),T=1,w=O.getRowNumber();else if(z<0||O.getRowNumber()>=o.getRowCount()||z>b)a[b]=null;else{let X;E>2?X=(E-2)*z:X=z;let Z=X>=b;for(let re=1;re<=X&&!Z;re++)Z=a[b-re]!=null;Z?a[b]=null:(w=O.getRowNumber(),T=1)}}}getRowHeights(){let o=this.getBarcodeMetadata();if(o==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(o);let a=new Int32Array(o.getRowCount());for(let c of this.getCodewords())if(c!=null){let u=c.getRowNumber();if(u>=a.length)continue;a[u]++}return a}adjustIncompleteIndicatorColumnRowNumbers(o){let a=this.getBoundingBox(),c=this._isLeft?a.getTopLeft():a.getTopRight(),u=this._isLeft?a.getBottomLeft():a.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),g=this.imageRowToCodewordIndex(Math.trunc(u.getY())),y=this.getCodewords(),w=-1;for(let E=d;E<g;E++){if(y[E]==null)continue;let T=y[E];T.setRowNumberAsRowIndicatorColumn();let b=T.getRowNumber()-w;b===0||(b===1?w=T.getRowNumber():T.getRowNumber()>=o.getRowCount()?y[E]=null:w=T.getRowNumber())}}getBarcodeMetadata(){let o=this.getCodewords(),a=new To,c=new To,u=new To,d=new To;for(let y of o){if(y==null)continue;y.setRowNumberAsRowIndicatorColumn();let w=y.getValue()%30,E=y.getRowNumber();switch(this._isLeft||(E+=2),E%3){case 0:c.setValue(w*3+1);break;case 1:d.setValue(w/3),u.setValue(w%3);break;case 2:a.setValue(w+1);break}}if(a.getValue().length===0||c.getValue().length===0||u.getValue().length===0||d.getValue().length===0||a.getValue()[0]<1||c.getValue()[0]+u.getValue()[0]<He.MIN_ROWS_IN_BARCODE||c.getValue()[0]+u.getValue()[0]>He.MAX_ROWS_IN_BARCODE)return null;let g=new lf(a.getValue()[0],c.getValue()[0],u.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(o,g),g}removeIncorrectCodewords(o,a){for(let c=0;c<o.length;c++){let u=o[c];if(o[c]==null)continue;let d=u.getValue()%30,g=u.getRowNumber();if(g>a.getRowCount()){o[c]=null;continue}switch(this._isLeft||(g+=2),g%3){case 0:d*3+1!==a.getRowCountUpperPart()&&(o[c]=null);break;case 1:(Math.trunc(d/3)!==a.getErrorCorrectionLevel()||d%3!==a.getRowCountLowerPart())&&(o[c]=null);break;case 2:d+1!==a.getColumnCount()&&(o[c]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Mt{constructor(o,a){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=o,this.barcodeColumnCount=o.getColumnCount(),this.boundingBox=a,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let o=He.MAX_CODEWORDS_IN_BARCODE,a;do a=o,o=this.adjustRowNumbersAndGetCount();while(o>0&&o<a);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(o){o!=null&&o.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let o=this.adjustRowNumbersByRow();if(o===0)return 0;for(let a=1;a<this.barcodeColumnCount+1;a++){let c=this.detectionResultColumns[a].getCodewords();for(let u=0;u<c.length;u++)c[u]!=null&&(c[u].hasValidRowNumber()||this.adjustRowNumbers(a,u,c))}return o}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let o=this.detectionResultColumns[0].getCodewords(),a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<o.length;c++)if(o[c]!=null&&a[c]!=null&&o[c].getRowNumber()===a[c].getRowNumber())for(let u=1;u<=this.barcodeColumnCount;u++){let d=this.detectionResultColumns[u].getCodewords()[c];d!=null&&(d.setRowNumber(o[c].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[u].getCodewords()[c]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let o=0,a=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<a.length;c++){if(a[c]==null)continue;let u=a[c].getRowNumber(),d=0;for(let g=this.barcodeColumnCount+1;g>0&&d<this.ADJUST_ROW_NUMBER_SKIP;g--){let y=this.detectionResultColumns[g].getCodewords()[c];y!=null&&(d=Mt.adjustRowNumberIfValid(u,d,y),y.hasValidRowNumber()||o++)}}return o}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let o=0,a=this.detectionResultColumns[0].getCodewords();for(let c=0;c<a.length;c++){if(a[c]==null)continue;let u=a[c].getRowNumber(),d=0;for(let g=1;g<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;g++){let y=this.detectionResultColumns[g].getCodewords()[c];y!=null&&(d=Mt.adjustRowNumberIfValid(u,d,y),y.hasValidRowNumber()||o++)}}return o}static adjustRowNumberIfValid(o,a,c){return c==null||c.hasValidRowNumber()||(c.isValidRowNumber(o)?(c.setRowNumber(o),a=0):++a),a}adjustRowNumbers(o,a,c){if(!this.detectionResultColumns[o-1])return;let u=c[a],d=this.detectionResultColumns[o-1].getCodewords(),g=d;this.detectionResultColumns[o+1]!=null&&(g=this.detectionResultColumns[o+1].getCodewords());let y=new Array(14);y[2]=d[a],y[3]=g[a],a>0&&(y[0]=c[a-1],y[4]=d[a-1],y[5]=g[a-1]),a>1&&(y[8]=c[a-2],y[10]=d[a-2],y[11]=g[a-2]),a<c.length-1&&(y[1]=c[a+1],y[6]=d[a+1],y[7]=g[a+1]),a<c.length-2&&(y[9]=c[a+2],y[12]=d[a+2],y[13]=g[a+2]);for(let w of y)if(Mt.adjustRowNumber(u,w))return}static adjustRowNumber(o,a){return a==null?!1:a.hasValidRowNumber()&&a.getBucket()===o.getBucket()?(o.setRowNumber(a.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(o){this.boundingBox=o}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(o,a){this.detectionResultColumns[o]=a}getDetectionResultColumn(o){return this.detectionResultColumns[o]}toString(){let o=this.detectionResultColumns[0];o==null&&(o=this.detectionResultColumns[this.barcodeColumnCount+1]);let a=new Pi;for(let c=0;c<o.getCodewords().length;c++){a.format("CW %3d:",c);for(let u=0;u<this.barcodeColumnCount+2;u++){if(this.detectionResultColumns[u]==null){a.format("    |   ");continue}let d=this.detectionResultColumns[u].getCodewords()[c];if(d==null){a.format("    |   ");continue}a.format(" %3d|%3d",d.getRowNumber(),d.getValue())}a.format("%n")}return a.toString()}}class Ua{constructor(o,a,c,u){this.rowNumber=Ua.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(o),this.endX=Math.trunc(a),this.bucket=Math.trunc(c),this.value=Math.trunc(u)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(o){return o!==Ua.BARCODE_ROW_UNKNOWN&&this.bucket===o%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(o){this.rowNumber=o}toString(){return this.rowNumber+"|"+this.value}}Ua.BARCODE_ROW_UNKNOWN=-1;class mr{static initialize(){for(let o=0;o<He.SYMBOL_TABLE.length;o++){let a=He.SYMBOL_TABLE[o],c=a&1;for(let u=0;u<He.BARS_IN_MODULE;u++){let d=0;for(;(a&1)===c;)d+=1,a>>=1;c=a&1,mr.RATIOS_TABLE[o]||(mr.RATIOS_TABLE[o]=new Array(He.BARS_IN_MODULE)),mr.RATIOS_TABLE[o][He.BARS_IN_MODULE-u-1]=Math.fround(d/He.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(o){let a=mr.getDecodedCodewordValue(mr.sampleBitCounts(o));return a!==-1?a:mr.getClosestDecodedValue(o)}static sampleBitCounts(o){let a=it.sum(o),c=new Int32Array(He.BARS_IN_MODULE),u=0,d=0;for(let g=0;g<He.MODULES_IN_CODEWORD;g++){let y=a/(2*He.MODULES_IN_CODEWORD)+g*a/He.MODULES_IN_CODEWORD;d+o[u]<=y&&(d+=o[u],u++),c[u]++}return c}static getDecodedCodewordValue(o){let a=mr.getBitValue(o);return He.getCodeword(a)===-1?-1:a}static getBitValue(o){let a=0;for(let c=0;c<o.length;c++)for(let u=0;u<o[c];u++)a=a<<1|(c%2===0?1:0);return Math.trunc(a)}static getClosestDecodedValue(o){let a=it.sum(o),c=new Array(He.BARS_IN_MODULE);if(a>1)for(let g=0;g<c.length;g++)c[g]=Math.fround(o[g]/a);let u=$.MAX_VALUE,d=-1;this.bSymbolTableReady||mr.initialize();for(let g=0;g<mr.RATIOS_TABLE.length;g++){let y=0,w=mr.RATIOS_TABLE[g];for(let E=0;E<He.BARS_IN_MODULE;E++){let T=Math.fround(w[E]-c[E]);if(y+=Math.fround(T*T),y>=u)break}y<u&&(u=y,d=He.SYMBOL_TABLE[g])}return d}}mr.bSymbolTableReady=!1,mr.RATIOS_TABLE=new Array(He.SYMBOL_TABLE.length).map(S=>new Array(He.BARS_IN_MODULE));class Hu{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(o){this.segmentIndex=o}getFileId(){return this.fileId}setFileId(o){this.fileId=o}getOptionalData(){return this.optionalData}setOptionalData(o){this.optionalData=o}isLastSegment(){return this.lastSegment}setLastSegment(o){this.lastSegment=o}getSegmentCount(){return this.segmentCount}setSegmentCount(o){this.segmentCount=o}getSender(){return this.sender||null}setSender(o){this.sender=o}getAddressee(){return this.addressee||null}setAddressee(o){this.addressee=o}getFileName(){return this.fileName}setFileName(o){this.fileName=o}getFileSize(){return this.fileSize}setFileSize(o){this.fileSize=o}getChecksum(){return this.checksum}setChecksum(o){this.checksum=o}getTimestamp(){return this.timestamp}setTimestamp(o){this.timestamp=o}}class Wu{static parseLong(o,a=void 0){return parseInt(o,a)}}class qu extends m{}qu.kind="NullPointerException";class Xl{writeBytes(o){this.writeBytesOffset(o,0,o.length)}writeBytesOffset(o,a,c){if(o==null)throw new qu;if(a<0||a>o.length||c<0||a+c>o.length||a+c<0)throw new G;if(c===0)return;for(let u=0;u<c;u++)this.write(o[a+u])}flush(){}close(){}}class cf extends m{}class ki extends Xl{constructor(o=32){if(super(),this.count=0,o<0)throw new _("Negative initial size: "+o);this.buf=new Uint8Array(o)}ensureCapacity(o){o-this.buf.length>0&&this.grow(o)}grow(o){let c=this.buf.length<<1;if(c-o<0&&(c=o),c<0){if(o<0)throw new cf;c=N.MAX_VALUE}this.buf=P.copyOfUint8Array(this.buf,c)}write(o){this.ensureCapacity(this.count+1),this.buf[this.count]=o,this.count+=1}writeBytesOffset(o,a,c){if(a<0||a>o.length||c<0||a+c-o.length>0)throw new G;this.ensureCapacity(this.count+c),D.arraycopy(o,a,this.buf,this.count,c),this.count+=c}writeTo(o){o.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return P.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(o){return o?typeof o=="string"?this.toString_string(o):this.toString_number(o):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(o){return new String(this.buf).toString()}toString_number(o){return new String(this.buf).toString()}close(){}}var St;(function(S){S[S.ALPHA=0]="ALPHA",S[S.LOWER=1]="LOWER",S[S.MIXED=2]="MIXED",S[S.PUNCT=3]="PUNCT",S[S.ALPHA_SHIFT=4]="ALPHA_SHIFT",S[S.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(St||(St={}));function uf(){if(typeof window<"u")return window.BigInt||null;if(typeof Xu<"u")return Xu.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let ss;function Oi(S){if(typeof ss>"u"&&(ss=uf()),ss===null)throw new Error("BigInt is not supported!");return ss(S)}function Ku(){let S=[];S[0]=Oi(1);let o=Oi(900);S[1]=o;for(let a=2;a<16;a++)S[a]=S[a-1]*o;return S}class se{static decode(o,a){let c=new j(""),u=L.ISO8859_1;c.enableDecoding(u);let d=1,g=o[d++],y=new Hu;for(;d<o[0];){switch(g){case se.TEXT_COMPACTION_MODE_LATCH:d=se.textCompaction(o,d,c);break;case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:d=se.byteCompaction(g,o,u,d,c);break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(o[d++]);break;case se.NUMERIC_COMPACTION_MODE_LATCH:d=se.numericCompaction(o,d,c);break;case se.ECI_CHARSET:L.getCharacterSetECIByValue(o[d++]);break;case se.ECI_GENERAL_PURPOSE:d+=2;break;case se.ECI_USER_DEFINED:d++;break;case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=se.decodeMacroBlock(o,d,y);break;case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:throw new k;default:d--,d=se.textCompaction(o,d,c);break}if(d<o.length)g=o[d++];else throw k.getFormatInstance()}if(c.length()===0)throw k.getFormatInstance();let w=new Si(null,c.toString(),null,a);return w.setOther(y),w}static decodeMacroBlock(o,a,c){if(a+se.NUMBER_OF_SEQUENCE_CODEWORDS>o[0])throw k.getFormatInstance();let u=new Int32Array(se.NUMBER_OF_SEQUENCE_CODEWORDS);for(let y=0;y<se.NUMBER_OF_SEQUENCE_CODEWORDS;y++,a++)u[y]=o[a];c.setSegmentIndex(N.parseInt(se.decodeBase900toBase10(u,se.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new j;a=se.textCompaction(o,a,d),c.setFileId(d.toString());let g=-1;for(o[a]===se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(g=a+1);a<o[0];)switch(o[a]){case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(a++,o[a]){case se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let y=new j;a=se.textCompaction(o,a+1,y),c.setFileName(y.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let w=new j;a=se.textCompaction(o,a+1,w),c.setSender(w.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let E=new j;a=se.textCompaction(o,a+1,E),c.setAddressee(E.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let T=new j;a=se.numericCompaction(o,a+1,T),c.setSegmentCount(N.parseInt(T.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let b=new j;a=se.numericCompaction(o,a+1,b),c.setTimestamp(Wu.parseLong(b.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let O=new j;a=se.numericCompaction(o,a+1,O),c.setChecksum(N.parseInt(O.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let z=new j;a=se.numericCompaction(o,a+1,z),c.setFileSize(Wu.parseLong(z.toString()));break;default:throw k.getFormatInstance()}break;case se.MACRO_PDF417_TERMINATOR:a++,c.setLastSegment(!0);break;default:throw k.getFormatInstance()}if(g!==-1){let y=a-g;c.isLastSegment()&&y--,c.setOptionalData(P.copyOfRange(o,g,g+y))}return a}static textCompaction(o,a,c){let u=new Int32Array((o[0]-a)*2),d=new Int32Array((o[0]-a)*2),g=0,y=!1;for(;a<o[0]&&!y;){let w=o[a++];if(w<se.TEXT_COMPACTION_MODE_LATCH)u[g]=w/30,u[g+1]=w%30,g+=2;else switch(w){case se.TEXT_COMPACTION_MODE_LATCH:u[g++]=se.TEXT_COMPACTION_MODE_LATCH;break;case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:a--,y=!0;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u[g]=se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,w=o[a++],d[g]=w,g++;break}}return se.decodeTextCompaction(u,d,g,c),a}static decodeTextCompaction(o,a,c,u){let d=St.ALPHA,g=St.ALPHA,y=0;for(;y<c;){let w=o[y],E="";switch(d){case St.ALPHA:if(w<26)E=String.fromCharCode(65+w);else switch(w){case 26:E=" ";break;case se.LL:d=St.LOWER;break;case se.ML:d=St.MIXED;break;case se.PS:g=d,d=St.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case se.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.LOWER:if(w<26)E=String.fromCharCode(97+w);else switch(w){case 26:E=" ";break;case se.AS:g=d,d=St.ALPHA_SHIFT;break;case se.ML:d=St.MIXED;break;case se.PS:g=d,d=St.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case se.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.MIXED:if(w<se.PL)E=se.MIXED_CHARS[w];else switch(w){case se.PL:d=St.PUNCT;break;case 26:E=" ";break;case se.LL:d=St.LOWER;break;case se.AL:d=St.ALPHA;break;case se.PS:g=d,d=St.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case se.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.PUNCT:if(w<se.PAL)E=se.PUNCT_CHARS[w];else switch(w){case se.PAL:d=St.ALPHA;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case se.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.ALPHA_SHIFT:if(d=g,w<26)E=String.fromCharCode(65+w);else switch(w){case 26:E=" ";break;case se.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break;case St.PUNCT_SHIFT:if(d=g,w<se.PAL)E=se.PUNCT_CHARS[w];else switch(w){case se.PAL:d=St.ALPHA;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[y]);break;case se.TEXT_COMPACTION_MODE_LATCH:d=St.ALPHA;break}break}E!==""&&u.append(E),y++}}static byteCompaction(o,a,c,u,d){let g=new ki,y=0,w=0,E=!1;switch(o){case se.BYTE_COMPACTION_MODE_LATCH:let T=new Int32Array(6),b=a[u++];for(;u<a[0]&&!E;)switch(T[y++]=b,w=900*w+b,b=a[u++],b){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:u--,E=!0;break;default:if(y%5===0&&y>0){for(let O=0;O<6;++O)g.write(Number(Oi(w)>>Oi(8*(5-O))));w=0,y=0}break}u===a[0]&&b<se.TEXT_COMPACTION_MODE_LATCH&&(T[y++]=b);for(let O=0;O<y;O++)g.write(T[O]);break;case se.BYTE_COMPACTION_MODE_LATCH_6:for(;u<a[0]&&!E;){let O=a[u++];if(O<se.TEXT_COMPACTION_MODE_LATCH)y++,w=900*w+O;else switch(O){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:u--,E=!0;break}if(y%5===0&&y>0){for(let z=0;z<6;++z)g.write(Number(Oi(w)>>Oi(8*(5-z))));w=0,y=0}}break}return d.append(K.decode(g.toByteArray(),c)),u}static numericCompaction(o,a,c){let u=0,d=!1,g=new Int32Array(se.MAX_NUMERIC_CODEWORDS);for(;a<o[0]&&!d;){let y=o[a++];if(a===o[0]&&(d=!0),y<se.TEXT_COMPACTION_MODE_LATCH)g[u]=y,u++;else switch(y){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:a--,d=!0;break}(u%se.MAX_NUMERIC_CODEWORDS===0||y===se.NUMERIC_COMPACTION_MODE_LATCH||d)&&u>0&&(c.append(se.decodeBase900toBase10(g,u)),u=0)}return a}static decodeBase900toBase10(o,a){let c=Oi(0);for(let d=0;d<a;d++)c+=se.EXP900[a-d-1]*Oi(o[d]);let u=c.toString();if(u.charAt(0)!=="1")throw new k;return u.substring(1)}}se.TEXT_COMPACTION_MODE_LATCH=900,se.BYTE_COMPACTION_MODE_LATCH=901,se.NUMERIC_COMPACTION_MODE_LATCH=902,se.BYTE_COMPACTION_MODE_LATCH_6=924,se.ECI_USER_DEFINED=925,se.ECI_GENERAL_PURPOSE=926,se.ECI_CHARSET=927,se.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,se.MACRO_PDF417_TERMINATOR=922,se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,se.MAX_NUMERIC_CODEWORDS=15,se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,se.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,se.PL=25,se.LL=27,se.AS=27,se.ML=28,se.AL=28,se.PS=29,se.PAL=29,se.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,se.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",se.EXP900=uf()?Ku():[],se.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Je{constructor(){}static decode(o,a,c,u,d,g,y){let w=new pi(o,a,c,u,d),E=null,T=null,b;for(let X=!0;;X=!1){if(a!=null&&(E=Je.getRowIndicatorColumn(o,w,a,!0,g,y)),u!=null&&(T=Je.getRowIndicatorColumn(o,w,u,!1,g,y)),b=Je.merge(E,T),b==null)throw ie.getNotFoundInstance();let Z=b.getBoundingBox();if(X&&Z!=null&&(Z.getMinY()<w.getMinY()||Z.getMaxY()>w.getMaxY()))w=Z;else break}b.setBoundingBox(w);let O=b.getBarcodeColumnCount()+1;b.setDetectionResultColumn(0,E),b.setDetectionResultColumn(O,T);let z=E!=null;for(let X=1;X<=O;X++){let Z=z?X:O-X;if(b.getDetectionResultColumn(Z)!==void 0)continue;let re;Z===0||Z===O?re=new Ql(w,Z===0):re=new Di(w),b.setDetectionResultColumn(Z,re);let ce=-1,xe=ce;for(let _e=w.getMinY();_e<=w.getMaxY();_e++){if(ce=Je.getStartColumn(b,Z,_e,z),ce<0||ce>w.getMaxX()){if(xe===-1)continue;ce=xe}let me=Je.detectCodeword(o,w.getMinX(),w.getMaxX(),z,ce,_e,g,y);me!=null&&(re.setCodeword(_e,me),xe=ce,g=Math.min(g,me.getWidth()),y=Math.max(y,me.getWidth()))}}return Je.createDecoderResult(b)}static merge(o,a){if(o==null&&a==null)return null;let c=Je.getBarcodeMetadata(o,a);if(c==null)return null;let u=pi.merge(Je.adjustBoundingBox(o),Je.adjustBoundingBox(a));return new Mt(c,u)}static adjustBoundingBox(o){if(o==null)return null;let a=o.getRowHeights();if(a==null)return null;let c=Je.getMax(a),u=0;for(let y of a)if(u+=c-y,y>0)break;let d=o.getCodewords();for(let y=0;u>0&&d[y]==null;y++)u--;let g=0;for(let y=a.length-1;y>=0&&(g+=c-a[y],!(a[y]>0));y--);for(let y=d.length-1;g>0&&d[y]==null;y--)g--;return o.getBoundingBox().addMissingRows(u,g,o.isLeft())}static getMax(o){let a=-1;for(let c of o)a=Math.max(a,c);return a}static getBarcodeMetadata(o,a){let c;if(o==null||(c=o.getBarcodeMetadata())==null)return a==null?null:a.getBarcodeMetadata();let u;return a==null||(u=a.getBarcodeMetadata())==null?c:c.getColumnCount()!==u.getColumnCount()&&c.getErrorCorrectionLevel()!==u.getErrorCorrectionLevel()&&c.getRowCount()!==u.getRowCount()?null:c}static getRowIndicatorColumn(o,a,c,u,d,g){let y=new Ql(a,u);for(let w=0;w<2;w++){let E=w===0?1:-1,T=Math.trunc(Math.trunc(c.getX()));for(let b=Math.trunc(Math.trunc(c.getY()));b<=a.getMaxY()&&b>=a.getMinY();b+=E){let O=Je.detectCodeword(o,0,o.getWidth(),u,T,b,d,g);O!=null&&(y.setCodeword(b,O),u?T=O.getStartX():T=O.getEndX())}}return y}static adjustCodewordCount(o,a){let c=a[0][1],u=c.getValue(),d=o.getBarcodeColumnCount()*o.getBarcodeRowCount()-Je.getNumberOfECCodeWords(o.getBarcodeECLevel());if(u.length===0){if(d<1||d>He.MAX_CODEWORDS_IN_BARCODE)throw ie.getNotFoundInstance();c.setValue(d)}else u[0]!==d&&c.setValue(d)}static createDecoderResult(o){let a=Je.createBarcodeMatrix(o);Je.adjustCodewordCount(o,a);let c=new Array,u=new Int32Array(o.getBarcodeRowCount()*o.getBarcodeColumnCount()),d=[],g=new Array;for(let w=0;w<o.getBarcodeRowCount();w++)for(let E=0;E<o.getBarcodeColumnCount();E++){let T=a[w][E+1].getValue(),b=w*o.getBarcodeColumnCount()+E;T.length===0?c.push(b):T.length===1?u[b]=T[0]:(g.push(b),d.push(T))}let y=new Array(d.length);for(let w=0;w<y.length;w++)y[w]=d[w];return Je.createDecoderResultFromAmbiguousValues(o.getBarcodeECLevel(),u,He.toIntArray(c),He.toIntArray(g),y)}static createDecoderResultFromAmbiguousValues(o,a,c,u,d){let g=new Int32Array(u.length),y=100;for(;y-- >0;){for(let w=0;w<g.length;w++)a[u[w]]=d[w][g[w]];try{return Je.decodeCodewords(a,o,c)}catch(w){if(!(w instanceof R))throw w}if(g.length===0)throw R.getChecksumInstance();for(let w=0;w<g.length;w++)if(g[w]<d[w].length-1){g[w]++;break}else if(g[w]=0,w===g.length-1)throw R.getChecksumInstance()}throw R.getChecksumInstance()}static createBarcodeMatrix(o){let a=Array.from({length:o.getBarcodeRowCount()},()=>new Array(o.getBarcodeColumnCount()+2));for(let u=0;u<a.length;u++)for(let d=0;d<a[u].length;d++)a[u][d]=new To;let c=0;for(let u of o.getDetectionResultColumns()){if(u!=null){for(let d of u.getCodewords())if(d!=null){let g=d.getRowNumber();if(g>=0){if(g>=a.length)continue;a[g][c].setValue(d.getValue())}}}c++}return a}static isValidBarcodeColumn(o,a){return a>=0&&a<=o.getBarcodeColumnCount()+1}static getStartColumn(o,a,c,u){let d=u?1:-1,g=null;if(Je.isValidBarcodeColumn(o,a-d)&&(g=o.getDetectionResultColumn(a-d).getCodeword(c)),g!=null)return u?g.getEndX():g.getStartX();if(g=o.getDetectionResultColumn(a).getCodewordNearby(c),g!=null)return u?g.getStartX():g.getEndX();if(Je.isValidBarcodeColumn(o,a-d)&&(g=o.getDetectionResultColumn(a-d).getCodewordNearby(c)),g!=null)return u?g.getEndX():g.getStartX();let y=0;for(;Je.isValidBarcodeColumn(o,a-d);){a-=d;for(let w of o.getDetectionResultColumn(a).getCodewords())if(w!=null)return(u?w.getEndX():w.getStartX())+d*y*(w.getEndX()-w.getStartX());y++}return u?o.getBoundingBox().getMinX():o.getBoundingBox().getMaxX()}static detectCodeword(o,a,c,u,d,g,y,w){d=Je.adjustCodewordStartColumn(o,a,c,u,d,g);let E=Je.getModuleBitCount(o,a,c,u,d,g);if(E==null)return null;let T,b=it.sum(E);if(u)T=d+b;else{for(let X=0;X<E.length/2;X++){let Z=E[X];E[X]=E[E.length-1-X],E[E.length-1-X]=Z}T=d,d=T-b}if(!Je.checkCodewordSkew(b,y,w))return null;let O=mr.getDecodedValue(E),z=He.getCodeword(O);return z===-1?null:new Ua(d,T,Je.getCodewordBucketNumber(O),z)}static getModuleBitCount(o,a,c,u,d,g){let y=d,w=new Int32Array(8),E=0,T=u?1:-1,b=u;for(;(u?y<c:y>=a)&&E<w.length;)o.get(y,g)===b?(w[E]++,y+=T):(E++,b=!b);return E===w.length||y===(u?c:a)&&E===w.length-1?w:null}static getNumberOfECCodeWords(o){return 2<<o}static adjustCodewordStartColumn(o,a,c,u,d,g){let y=d,w=u?-1:1;for(let E=0;E<2;E++){for(;(u?y>=a:y<c)&&u===o.get(y,g);){if(Math.abs(d-y)>Je.CODEWORD_SKEW_SIZE)return d;y+=w}w=-w,u=!u}return y}static checkCodewordSkew(o,a,c){return a-Je.CODEWORD_SKEW_SIZE<=o&&o<=c+Je.CODEWORD_SKEW_SIZE}static decodeCodewords(o,a,c){if(o.length===0)throw k.getFormatInstance();let u=1<<a+1,d=Je.correctErrors(o,c,u);Je.verifyCodewordCount(o,u);let g=se.decode(o,""+a);return g.setErrorsCorrected(d),g.setErasures(c.length),g}static correctErrors(o,a,c){if(a!=null&&a.length>c/2+Je.MAX_ERRORS||c<0||c>Je.MAX_EC_CODEWORDS)throw R.getChecksumInstance();return Je.errorCorrection.decode(o,c,a)}static verifyCodewordCount(o,a){if(o.length<4)throw k.getFormatInstance();let c=o[0];if(c>o.length)throw k.getFormatInstance();if(c===0)if(a<o.length)o[0]=o.length-a;else throw k.getFormatInstance()}static getBitCountForCodeword(o){let a=new Int32Array(8),c=0,u=a.length-1;for(;!((o&1)!==c&&(c=o&1,u--,u<0));)a[u]++,o>>=1;return a}static getCodewordBucketNumber(o){return o instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(o):this.getCodewordBucketNumber_number(o)}static getCodewordBucketNumber_number(o){return Je.getCodewordBucketNumber(Je.getBitCountForCodeword(o))}static getCodewordBucketNumber_Int32Array(o){return(o[0]-o[2]+o[4]-o[6]+9)%9}static toString(o){let a=new Pi;for(let c=0;c<o.length;c++){a.format("Row %2d: ",c);for(let u=0;u<o[c].length;u++){let d=o[c][u];d.getValue().length===0?a.format("        ",null):a.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}a.format("%n")}return a.toString()}}Je.CODEWORD_SKEW_SIZE=2,Je.MAX_ERRORS=3,Je.MAX_EC_CODEWORDS=512,Je.errorCorrection=new Ba;class yn{decode(o,a=null){let c=yn.decode(o,a,!1);if(c==null||c.length===0||c[0]==null)throw ie.getNotFoundInstance();return c[0]}decodeMultiple(o,a=null){try{return yn.decode(o,a,!0)}catch(c){throw c instanceof k||c instanceof R?ie.getNotFoundInstance():c}}static decode(o,a,c){const u=new Array,d=Ze.detectMultiple(o,a,c);for(const g of d.getPoints()){const y=Je.decode(d.getBits(),g[4],g[5],g[6],g[7],yn.getMinCodewordWidth(g),yn.getMaxCodewordWidth(g)),w=new Vt(y.getText(),y.getRawBytes(),void 0,g,ke.PDF_417);w.putMetadata(an.ERROR_CORRECTION_LEVEL,y.getECLevel());const E=y.getOther();E!=null&&w.putMetadata(an.PDF417_EXTRA_METADATA,E),u.push(w)}return u.map(g=>g)}static getMaxWidth(o,a){return o==null||a==null?0:Math.trunc(Math.abs(o.getX()-a.getX()))}static getMinWidth(o,a){return o==null||a==null?N.MAX_VALUE:Math.trunc(Math.abs(o.getX()-a.getX()))}static getMaxCodewordWidth(o){return Math.floor(Math.max(Math.max(yn.getMaxWidth(o[0],o[4]),yn.getMaxWidth(o[6],o[2])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN),Math.max(yn.getMaxWidth(o[1],o[5]),yn.getMaxWidth(o[7],o[3])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(o){return Math.floor(Math.min(Math.min(yn.getMinWidth(o[0],o[4]),yn.getMinWidth(o[6],o[2])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN),Math.min(yn.getMinWidth(o[1],o[5]),yn.getMinWidth(o[7],o[3])*He.MODULES_IN_CODEWORD/He.MODULES_IN_STOP_PATTERN)))}reset(){}}class Yl extends m{}Yl.kind="ReaderException";class $u{constructor(o,a){this.verbose=o===!0,a&&this.setHints(a)}decode(o,a){return a&&this.setHints(a),this.decodeInternal(o)}decodeWithState(o){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(o)}setHints(o){this.hints=o;const a=!r(o)&&o.get(J.TRY_HARDER)===!0,c=r(o)?null:o.get(J.POSSIBLE_FORMATS),u=new Array;if(!r(c)){const d=c.some(g=>g===ke.UPC_A||g===ke.UPC_E||g===ke.EAN_13||g===ke.EAN_8||g===ke.CODABAR||g===ke.CODE_39||g===ke.CODE_93||g===ke.CODE_128||g===ke.ITF||g===ke.RSS_14||g===ke.RSS_EXPANDED);d&&!a&&u.push(new Vr(o,this.verbose)),c.includes(ke.QR_CODE)&&u.push(new Cr),c.includes(ke.DATA_MATRIX)&&u.push(new Ni),c.includes(ke.AZTEC)&&u.push(new gr),c.includes(ke.PDF_417)&&u.push(new yn),d&&a&&u.push(new Vr(o,this.verbose))}u.length===0&&(a||u.push(new Vr(o,this.verbose)),u.push(new Cr),u.push(new Ni),u.push(new gr),u.push(new yn),a&&u.push(new Vr(o,this.verbose))),this.readers=u}reset(){if(this.readers!==null)for(const o of this.readers)o.reset()}decodeInternal(o){if(this.readers===null)throw new Yl("No readers where selected, nothing can be read.");for(const a of this.readers)try{return a.decode(o,this.hints)}catch(c){if(c instanceof Yl)continue}throw new ie("No MultiFormat Readers were able to detect the code.")}}class ja extends Tt{constructor(o=null,a=500){const c=new $u;c.setHints(o),super(c,a)}decodeBitmap(o){return this.reader.decodeWithState(o)}}class hf extends Tt{constructor(o=500){super(new yn,o)}}class df extends Tt{constructor(o=500){super(new Cr,o)}}var za;(function(S){S[S.ERROR_CORRECTION=0]="ERROR_CORRECTION",S[S.CHARACTER_SET=1]="CHARACTER_SET",S[S.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",S[S.MIN_SIZE=3]="MIN_SIZE",S[S.MAX_SIZE=4]="MAX_SIZE",S[S.MARGIN=5]="MARGIN",S[S.PDF417_COMPACT=6]="PDF417_COMPACT",S[S.PDF417_COMPACTION=7]="PDF417_COMPACTION",S[S.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",S[S.AZTEC_LAYERS=9]="AZTEC_LAYERS",S[S.QR_VERSION=10]="QR_VERSION"})(za||(za={}));var cn=za;class Zl{constructor(o){this.field=o,this.cachedGenerators=[],this.cachedGenerators.push(new An(o,Int32Array.from([1])))}buildGenerator(o){const a=this.cachedGenerators;if(o>=a.length){let c=a[a.length-1];const u=this.field;for(let d=a.length;d<=o;d++){const g=c.multiply(new An(u,Int32Array.from([1,u.exp(d-1+u.getGeneratorBase())])));a.push(g),c=g}}return a[o]}encode(o,a){if(a===0)throw new _("No error correction bytes");const c=o.length-a;if(c<=0)throw new _("No data bytes provided");const u=this.buildGenerator(a),d=new Int32Array(c);D.arraycopy(o,0,d,0,c);let g=new An(this.field,d);g=g.multiplyByMonomial(a,1);const w=g.divide(u)[1].getCoefficients(),E=a-w.length;for(let T=0;T<E;T++)o[c+T]=0;D.arraycopy(w,0,o,c+E,w.length)}}class Ut{constructor(){}static applyMaskPenaltyRule1(o){return Ut.applyMaskPenaltyRule1Internal(o,!0)+Ut.applyMaskPenaltyRule1Internal(o,!1)}static applyMaskPenaltyRule2(o){let a=0;const c=o.getArray(),u=o.getWidth(),d=o.getHeight();for(let g=0;g<d-1;g++){const y=c[g];for(let w=0;w<u-1;w++){const E=y[w];E===y[w+1]&&E===c[g+1][w]&&E===c[g+1][w+1]&&a++}}return Ut.N2*a}static applyMaskPenaltyRule3(o){let a=0;const c=o.getArray(),u=o.getWidth(),d=o.getHeight();for(let g=0;g<d;g++)for(let y=0;y<u;y++){const w=c[g];y+6<u&&w[y]===1&&w[y+1]===0&&w[y+2]===1&&w[y+3]===1&&w[y+4]===1&&w[y+5]===0&&w[y+6]===1&&(Ut.isWhiteHorizontal(w,y-4,y)||Ut.isWhiteHorizontal(w,y+7,y+11))&&a++,g+6<d&&c[g][y]===1&&c[g+1][y]===0&&c[g+2][y]===1&&c[g+3][y]===1&&c[g+4][y]===1&&c[g+5][y]===0&&c[g+6][y]===1&&(Ut.isWhiteVertical(c,y,g-4,g)||Ut.isWhiteVertical(c,y,g+7,g+11))&&a++}return a*Ut.N3}static isWhiteHorizontal(o,a,c){a=Math.max(a,0),c=Math.min(c,o.length);for(let u=a;u<c;u++)if(o[u]===1)return!1;return!0}static isWhiteVertical(o,a,c,u){c=Math.max(c,0),u=Math.min(u,o.length);for(let d=c;d<u;d++)if(o[d][a]===1)return!1;return!0}static applyMaskPenaltyRule4(o){let a=0;const c=o.getArray(),u=o.getWidth(),d=o.getHeight();for(let w=0;w<d;w++){const E=c[w];for(let T=0;T<u;T++)E[T]===1&&a++}const g=o.getHeight()*o.getWidth();return Math.floor(Math.abs(a*2-g)*10/g)*Ut.N4}static getDataMaskBit(o,a,c){let u,d;switch(o){case 0:u=c+a&1;break;case 1:u=c&1;break;case 2:u=a%3;break;case 3:u=(c+a)%3;break;case 4:u=Math.floor(c/2)+Math.floor(a/3)&1;break;case 5:d=c*a,u=(d&1)+d%3;break;case 6:d=c*a,u=(d&1)+d%3&1;break;case 7:d=c*a,u=d%3+(c+a&1)&1;break;default:throw new _("Invalid mask pattern: "+o)}return u===0}static applyMaskPenaltyRule1Internal(o,a){let c=0;const u=a?o.getHeight():o.getWidth(),d=a?o.getWidth():o.getHeight(),g=o.getArray();for(let y=0;y<u;y++){let w=0,E=-1;for(let T=0;T<d;T++){const b=a?g[y][T]:g[T][y];b===E?w++:(w>=5&&(c+=Ut.N1+(w-5)),w=1,E=b)}w>=5&&(c+=Ut.N1+(w-5))}return c}}Ut.N1=3,Ut.N2=3,Ut.N3=40,Ut.N4=10;class Ga{constructor(o,a){this.width=o,this.height=a;const c=new Array(a);for(let u=0;u!==a;u++)c[u]=new Uint8Array(o);this.bytes=c}getHeight(){return this.height}getWidth(){return this.width}get(o,a){return this.bytes[a][o]}getArray(){return this.bytes}setNumber(o,a,c){this.bytes[a][o]=c}setBoolean(o,a,c){this.bytes[a][o]=c?1:0}clear(o){for(const a of this.bytes)P.fill(a,o)}equals(o){if(!(o instanceof Ga))return!1;const a=o;if(this.width!==a.width||this.height!==a.height)return!1;for(let c=0,u=this.height;c<u;++c){const d=this.bytes[c],g=a.bytes[c];for(let y=0,w=this.width;y<w;++y)if(d[y]!==g[y])return!1}return!0}toString(){const o=new j;for(let a=0,c=this.height;a<c;++a){const u=this.bytes[a];for(let d=0,g=this.width;d<g;++d)switch(u[d]){case 0:o.append(" 0");break;case 1:o.append(" 1");break;default:o.append("  ");break}o.append(`
`)}return o.toString()}}class os{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const o=new j;return o.append(`<<
`),o.append(" mode: "),o.append(this.mode?this.mode.toString():"null"),o.append(`
 ecLevel: `),o.append(this.ecLevel?this.ecLevel.toString():"null"),o.append(`
 version: `),o.append(this.version?this.version.toString():"null"),o.append(`
 maskPattern: `),o.append(this.maskPattern.toString()),this.matrix?(o.append(`
 matrix:
`),o.append(this.matrix.toString())):o.append(`
 matrix: null
`),o.append(`>>
`),o.toString()}setMode(o){this.mode=o}setECLevel(o){this.ecLevel=o}setVersion(o){this.version=o}setMaskPattern(o){this.maskPattern=o}setMatrix(o){this.matrix=o}static isValidMaskPattern(o){return o>=0&&o<os.NUM_MASK_PATTERNS}}os.NUM_MASK_PATTERNS=8;class ft extends m{}ft.kind="WriterException";class je{constructor(){}static clearMatrix(o){o.clear(255)}static buildMatrix(o,a,c,u,d){je.clearMatrix(d),je.embedBasicPatterns(c,d),je.embedTypeInfo(a,u,d),je.maybeEmbedVersionInfo(c,d),je.embedDataBits(o,u,d)}static embedBasicPatterns(o,a){je.embedPositionDetectionPatternsAndSeparators(a),je.embedDarkDotAtLeftBottomCorner(a),je.maybeEmbedPositionAdjustmentPatterns(o,a),je.embedTimingPatterns(a)}static embedTypeInfo(o,a,c){const u=new H;je.makeTypeInfoBits(o,a,u);for(let d=0,g=u.getSize();d<g;++d){const y=u.get(u.getSize()-1-d),w=je.TYPE_INFO_COORDINATES[d],E=w[0],T=w[1];if(c.setBoolean(E,T,y),d<8){const b=c.getWidth()-d-1,O=8;c.setBoolean(b,O,y)}else{const O=c.getHeight()-7+(d-8);c.setBoolean(8,O,y)}}}static maybeEmbedVersionInfo(o,a){if(o.getVersionNumber()<7)return;const c=new H;je.makeVersionInfoBits(o,c);let u=6*3-1;for(let d=0;d<6;++d)for(let g=0;g<3;++g){const y=c.get(u);u--,a.setBoolean(d,a.getHeight()-11+g,y),a.setBoolean(a.getHeight()-11+g,d,y)}}static embedDataBits(o,a,c){let u=0,d=-1,g=c.getWidth()-1,y=c.getHeight()-1;for(;g>0;){for(g===6&&(g-=1);y>=0&&y<c.getHeight();){for(let w=0;w<2;++w){const E=g-w;if(!je.isEmpty(c.get(E,y)))continue;let T;u<o.getSize()?(T=o.get(u),++u):T=!1,a!==255&&Ut.getDataMaskBit(a,E,y)&&(T=!T),c.setBoolean(E,y,T)}y+=d}d=-d,y+=d,g-=2}if(u!==o.getSize())throw new ft("Not all bits consumed: "+u+"/"+o.getSize())}static findMSBSet(o){return 32-N.numberOfLeadingZeros(o)}static calculateBCHCode(o,a){if(a===0)throw new _("0 polynomial");const c=je.findMSBSet(a);for(o<<=c-1;je.findMSBSet(o)>=c;)o^=a<<je.findMSBSet(o)-c;return o}static makeTypeInfoBits(o,a,c){if(!os.isValidMaskPattern(a))throw new ft("Invalid mask pattern");const u=o.getBits()<<3|a;c.appendBits(u,5);const d=je.calculateBCHCode(u,je.TYPE_INFO_POLY);c.appendBits(d,10);const g=new H;if(g.appendBits(je.TYPE_INFO_MASK_PATTERN,15),c.xor(g),c.getSize()!==15)throw new ft("should not happen but we got: "+c.getSize())}static makeVersionInfoBits(o,a){a.appendBits(o.getVersionNumber(),6);const c=je.calculateBCHCode(o.getVersionNumber(),je.VERSION_INFO_POLY);if(a.appendBits(c,12),a.getSize()!==18)throw new ft("should not happen but we got: "+a.getSize())}static isEmpty(o){return o===255}static embedTimingPatterns(o){for(let a=8;a<o.getWidth()-8;++a){const c=(a+1)%2;je.isEmpty(o.get(a,6))&&o.setNumber(a,6,c),je.isEmpty(o.get(6,a))&&o.setNumber(6,a,c)}}static embedDarkDotAtLeftBottomCorner(o){if(o.get(8,o.getHeight()-8)===0)throw new ft;o.setNumber(8,o.getHeight()-8,1)}static embedHorizontalSeparationPattern(o,a,c){for(let u=0;u<8;++u){if(!je.isEmpty(c.get(o+u,a)))throw new ft;c.setNumber(o+u,a,0)}}static embedVerticalSeparationPattern(o,a,c){for(let u=0;u<7;++u){if(!je.isEmpty(c.get(o,a+u)))throw new ft;c.setNumber(o,a+u,0)}}static embedPositionAdjustmentPattern(o,a,c){for(let u=0;u<5;++u){const d=je.POSITION_ADJUSTMENT_PATTERN[u];for(let g=0;g<5;++g)c.setNumber(o+g,a+u,d[g])}}static embedPositionDetectionPattern(o,a,c){for(let u=0;u<7;++u){const d=je.POSITION_DETECTION_PATTERN[u];for(let g=0;g<7;++g)c.setNumber(o+g,a+u,d[g])}}static embedPositionDetectionPatternsAndSeparators(o){const a=je.POSITION_DETECTION_PATTERN[0].length;je.embedPositionDetectionPattern(0,0,o),je.embedPositionDetectionPattern(o.getWidth()-a,0,o),je.embedPositionDetectionPattern(0,o.getWidth()-a,o);const c=8;je.embedHorizontalSeparationPattern(0,c-1,o),je.embedHorizontalSeparationPattern(o.getWidth()-c,c-1,o),je.embedHorizontalSeparationPattern(0,o.getWidth()-c,o);const u=7;je.embedVerticalSeparationPattern(u,0,o),je.embedVerticalSeparationPattern(o.getHeight()-u-1,0,o),je.embedVerticalSeparationPattern(u,o.getHeight()-u,o)}static maybeEmbedPositionAdjustmentPatterns(o,a){if(o.getVersionNumber()<2)return;const c=o.getVersionNumber()-1,u=je.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[c];for(let d=0,g=u.length;d!==g;d++){const y=u[d];if(y>=0)for(let w=0;w!==g;w++){const E=u[w];E>=0&&je.isEmpty(a.get(E,y))&&je.embedPositionAdjustmentPattern(E-2,y-2,a)}}}}je.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),je.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),je.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),je.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),je.VERSION_INFO_POLY=7973,je.TYPE_INFO_POLY=1335,je.TYPE_INFO_MASK_PATTERN=21522;class ff{constructor(o,a){this.dataBytes=o,this.errorCorrectionBytes=a}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Lt{constructor(){}static calculateMaskPenalty(o){return Ut.applyMaskPenaltyRule1(o)+Ut.applyMaskPenaltyRule2(o)+Ut.applyMaskPenaltyRule3(o)+Ut.applyMaskPenaltyRule4(o)}static encode(o,a,c=null){let u=Lt.DEFAULT_BYTE_MODE_ENCODING;const d=c!==null&&c.get(cn.CHARACTER_SET)!==void 0;d&&(u=c.get(cn.CHARACTER_SET).toString());const g=this.chooseMode(o,u),y=new H;if(g===Be.BYTE&&(d||Lt.DEFAULT_BYTE_MODE_ENCODING!==u)){const _e=L.getCharacterSetECIByName(u);_e!==void 0&&this.appendECI(_e,y)}this.appendModeInfo(g,y);const w=new H;this.appendBytes(o,g,w,u);let E;if(c!==null&&c.get(cn.QR_VERSION)!==void 0){const _e=Number.parseInt(c.get(cn.QR_VERSION).toString(),10);E=Fe.getVersionForNumber(_e);const me=this.calculateBitsNeeded(g,y,w,E);if(!this.willFit(me,E,a))throw new ft("Data too big for requested version")}else E=this.recommendVersion(a,g,y,w);const T=new H;T.appendBitArray(y);const b=g===Be.BYTE?w.getSizeInBytes():o.length;this.appendLengthInfo(b,E,g,T),T.appendBitArray(w);const O=E.getECBlocksForLevel(a),z=E.getTotalCodewords()-O.getTotalECCodewords();this.terminateBits(z,T);const X=this.interleaveWithECBytes(T,E.getTotalCodewords(),z,O.getNumBlocks()),Z=new os;Z.setECLevel(a),Z.setMode(g),Z.setVersion(E);const re=E.getDimensionForVersion(),ce=new Ga(re,re),xe=this.chooseMaskPattern(X,a,E,ce);return Z.setMaskPattern(xe),je.buildMatrix(X,a,E,xe,ce),Z.setMatrix(ce),Z}static recommendVersion(o,a,c,u){const d=this.calculateBitsNeeded(a,c,u,Fe.getVersionForNumber(1)),g=this.chooseVersion(d,o),y=this.calculateBitsNeeded(a,c,u,g);return this.chooseVersion(y,o)}static calculateBitsNeeded(o,a,c,u){return a.getSize()+o.getCharacterCountBits(u)+c.getSize()}static getAlphanumericCode(o){return o<Lt.ALPHANUMERIC_TABLE.length?Lt.ALPHANUMERIC_TABLE[o]:-1}static chooseMode(o,a=null){if(L.SJIS.getName()===a&&this.isOnlyDoubleByteKanji(o))return Be.KANJI;let c=!1,u=!1;for(let d=0,g=o.length;d<g;++d){const y=o.charAt(d);if(Lt.isDigit(y))c=!0;else if(this.getAlphanumericCode(y.charCodeAt(0))!==-1)u=!0;else return Be.BYTE}return u?Be.ALPHANUMERIC:c?Be.NUMERIC:Be.BYTE}static isOnlyDoubleByteKanji(o){let a;try{a=K.encode(o,L.SJIS)}catch{return!1}const c=a.length;if(c%2!==0)return!1;for(let u=0;u<c;u+=2){const d=a[u]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(o,a,c,u){let d=Number.MAX_SAFE_INTEGER,g=-1;for(let y=0;y<os.NUM_MASK_PATTERNS;y++){je.buildMatrix(o,a,c,y,u);let w=this.calculateMaskPenalty(u);w<d&&(d=w,g=y)}return g}static chooseVersion(o,a){for(let c=1;c<=40;c++){const u=Fe.getVersionForNumber(c);if(Lt.willFit(o,u,a))return u}throw new ft("Data too big")}static willFit(o,a,c){const u=a.getTotalCodewords(),g=a.getECBlocksForLevel(c).getTotalECCodewords(),y=u-g,w=(o+7)/8;return y>=w}static terminateBits(o,a){const c=o*8;if(a.getSize()>c)throw new ft("data bits cannot fit in the QR Code"+a.getSize()+" > "+c);for(let g=0;g<4&&a.getSize()<c;++g)a.appendBit(!1);const u=a.getSize()&7;if(u>0)for(let g=u;g<8;g++)a.appendBit(!1);const d=o-a.getSizeInBytes();for(let g=0;g<d;++g)a.appendBits(g&1?17:236,8);if(a.getSize()!==c)throw new ft("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(o,a,c,u,d,g){if(u>=c)throw new ft("Block ID too large");const y=o%c,w=c-y,E=Math.floor(o/c),T=E+1,b=Math.floor(a/c),O=b+1,z=E-b,X=T-O;if(z!==X)throw new ft("EC bytes mismatch");if(c!==w+y)throw new ft("RS blocks mismatch");if(o!==(b+z)*w+(O+X)*y)throw new ft("Total bytes mismatch");u<w?(d[0]=b,g[0]=z):(d[0]=O,g[0]=X)}static interleaveWithECBytes(o,a,c,u){if(o.getSizeInBytes()!==c)throw new ft("Number of bits and data bytes does not match");let d=0,g=0,y=0;const w=new Array;for(let T=0;T<u;++T){const b=new Int32Array(1),O=new Int32Array(1);Lt.getNumDataBytesAndNumECBytesForBlockID(a,c,u,T,b,O);const z=b[0],X=new Uint8Array(z);o.toBytes(8*d,X,0,z);const Z=Lt.generateECBytes(X,O[0]);w.push(new ff(X,Z)),g=Math.max(g,z),y=Math.max(y,Z.length),d+=b[0]}if(c!==d)throw new ft("Data bytes does not match offset");const E=new H;for(let T=0;T<g;++T)for(const b of w){const O=b.getDataBytes();T<O.length&&E.appendBits(O[T],8)}for(let T=0;T<y;++T)for(const b of w){const O=b.getErrorCorrectionBytes();T<O.length&&E.appendBits(O[T],8)}if(a!==E.getSizeInBytes())throw new ft("Interleaving error: "+a+" and "+E.getSizeInBytes()+" differ.");return E}static generateECBytes(o,a){const c=o.length,u=new Int32Array(c+a);for(let g=0;g<c;g++)u[g]=o[g]&255;new Zl(ot.QR_CODE_FIELD_256).encode(u,a);const d=new Uint8Array(a);for(let g=0;g<a;g++)d[g]=u[c+g];return d}static appendModeInfo(o,a){a.appendBits(o.getBits(),4)}static appendLengthInfo(o,a,c,u){const d=c.getCharacterCountBits(a);if(o>=1<<d)throw new ft(o+" is bigger than "+((1<<d)-1));u.appendBits(o,d)}static appendBytes(o,a,c,u){switch(a){case Be.NUMERIC:Lt.appendNumericBytes(o,c);break;case Be.ALPHANUMERIC:Lt.appendAlphanumericBytes(o,c);break;case Be.BYTE:Lt.append8BitBytes(o,c,u);break;case Be.KANJI:Lt.appendKanjiBytes(o,c);break;default:throw new ft("Invalid mode: "+a)}}static getDigit(o){return o.charCodeAt(0)-48}static isDigit(o){const a=Lt.getDigit(o);return a>=0&&a<=9}static appendNumericBytes(o,a){const c=o.length;let u=0;for(;u<c;){const d=Lt.getDigit(o.charAt(u));if(u+2<c){const g=Lt.getDigit(o.charAt(u+1)),y=Lt.getDigit(o.charAt(u+2));a.appendBits(d*100+g*10+y,10),u+=3}else if(u+1<c){const g=Lt.getDigit(o.charAt(u+1));a.appendBits(d*10+g,7),u+=2}else a.appendBits(d,4),u++}}static appendAlphanumericBytes(o,a){const c=o.length;let u=0;for(;u<c;){const d=Lt.getAlphanumericCode(o.charCodeAt(u));if(d===-1)throw new ft;if(u+1<c){const g=Lt.getAlphanumericCode(o.charCodeAt(u+1));if(g===-1)throw new ft;a.appendBits(d*45+g,11),u+=2}else a.appendBits(d,6),u++}}static append8BitBytes(o,a,c){let u;try{u=K.encode(o,c)}catch(d){throw new ft(d)}for(let d=0,g=u.length;d!==g;d++){const y=u[d];a.appendBits(y,8)}}static appendKanjiBytes(o,a){let c;try{c=K.encode(o,L.SJIS)}catch(d){throw new ft(d)}const u=c.length;for(let d=0;d<u;d+=2){const g=c[d]&255,y=c[d+1]&255,w=g<<8&4294967295|y;let E=-1;if(w>=33088&&w<=40956?E=w-33088:w>=57408&&w<=60351&&(E=w-49472),E===-1)throw new ft("Invalid byte sequence");const T=(E>>8)*192+(E&255);a.appendBits(T,13)}}static appendECI(o,a){a.appendBits(Be.ECI.getBits(),4),a.appendBits(o.getValue(),8)}}Lt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Lt.DEFAULT_BYTE_MODE_ENCODING=L.UTF8.getName();class as{write(o,a,c,u=null){if(o.length===0)throw new _("Found empty contents");if(a<0||c<0)throw new _("Requested dimensions are too small: "+a+"x"+c);let d=xt.L,g=as.QUIET_ZONE_SIZE;u!==null&&(u.get(cn.ERROR_CORRECTION)!==void 0&&(d=xt.fromString(u.get(cn.ERROR_CORRECTION).toString())),u.get(cn.MARGIN)!==void 0&&(g=Number.parseInt(u.get(cn.MARGIN).toString(),10)));const y=Lt.encode(o,d,u);return this.renderResult(y,a,c,g)}writeToDom(o,a,c,u,d=null){typeof o=="string"&&(o=document.querySelector(o));const g=this.write(a,c,u,d);o&&o.appendChild(g)}renderResult(o,a,c,u){const d=o.getMatrix();if(d===null)throw new rr;const g=d.getWidth(),y=d.getHeight(),w=g+u*2,E=y+u*2,T=Math.max(a,w),b=Math.max(c,E),O=Math.min(Math.floor(T/w),Math.floor(b/E)),z=Math.floor((T-g*O)/2),X=Math.floor((b-y*O)/2),Z=this.createSVGElement(T,b);for(let re=0,ce=X;re<y;re++,ce+=O)for(let xe=0,_e=z;xe<g;xe++,_e+=O)if(d.get(xe,re)===1){const me=this.createSvgRectElement(_e,ce,O,O);Z.appendChild(me)}return Z}createSVGElement(o,a){const c=document.createElementNS(as.SVG_NS,"svg");return c.setAttributeNS(null,"height",o.toString()),c.setAttributeNS(null,"width",a.toString()),c}createSvgRectElement(o,a,c,u){const d=document.createElementNS(as.SVG_NS,"rect");return d.setAttributeNS(null,"x",o.toString()),d.setAttributeNS(null,"y",a.toString()),d.setAttributeNS(null,"height",c.toString()),d.setAttributeNS(null,"width",u.toString()),d.setAttributeNS(null,"fill","#000000"),d}}as.QUIET_ZONE_SIZE=4,as.SVG_NS="http://www.w3.org/2000/svg";class Mi{encode(o,a,c,u,d){if(o.length===0)throw new _("Found empty contents");if(a!==ke.QR_CODE)throw new _("Can only encode QR_CODE, but got "+a);if(c<0||u<0)throw new _(`Requested dimensions are too small: ${c}x${u}`);let g=xt.L,y=Mi.QUIET_ZONE_SIZE;d!==null&&(d.get(cn.ERROR_CORRECTION)!==void 0&&(g=xt.fromString(d.get(cn.ERROR_CORRECTION).toString())),d.get(cn.MARGIN)!==void 0&&(y=Number.parseInt(d.get(cn.MARGIN).toString(),10)));const w=Lt.encode(o,g,d);return Mi.renderResult(w,c,u,y)}static renderResult(o,a,c,u){const d=o.getMatrix();if(d===null)throw new rr;const g=d.getWidth(),y=d.getHeight(),w=g+u*2,E=y+u*2,T=Math.max(a,w),b=Math.max(c,E),O=Math.min(Math.floor(T/w),Math.floor(b/E)),z=Math.floor((T-g*O)/2),X=Math.floor((b-y*O)/2),Z=new ze(T,b);for(let re=0,ce=X;re<y;re++,ce+=O)for(let xe=0,_e=z;xe<g;xe++,_e+=O)d.get(xe,re)===1&&Z.setRegion(_e,ce,O,O);return Z}}Mi.QUIET_ZONE_SIZE=4;class Sr{encode(o,a,c,u,d){let g;switch(a){case ke.QR_CODE:g=new Mi;break;default:throw new _("No encoder available for format "+a)}return g.encode(o,a,c,u,d)}}class ei extends Ie{constructor(o,a,c,u,d,g,y,w){if(super(g,y),this.yuvData=o,this.dataWidth=a,this.dataHeight=c,this.left=u,this.top=d,u+g>a||d+y>c)throw new _("Crop rectangle does not fit within image data.");w&&this.reverseHorizontal(g,y)}getRow(o,a){if(o<0||o>=this.getHeight())throw new _("Requested row is outside the image: "+o);const c=this.getWidth();(a==null||a.length<c)&&(a=new Uint8ClampedArray(c));const u=(o+this.top)*this.dataWidth+this.left;return D.arraycopy(this.yuvData,u,a,0,c),a}getMatrix(){const o=this.getWidth(),a=this.getHeight();if(o===this.dataWidth&&a===this.dataHeight)return this.yuvData;const c=o*a,u=new Uint8ClampedArray(c);let d=this.top*this.dataWidth+this.left;if(o===this.dataWidth)return D.arraycopy(this.yuvData,d,u,0,c),u;for(let g=0;g<a;g++){const y=g*o;D.arraycopy(this.yuvData,d,u,y,o),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(o,a,c,u){return new ei(this.yuvData,this.dataWidth,this.dataHeight,this.left+o,this.top+a,c,u,!1)}renderThumbnail(){const o=this.getWidth()/ei.THUMBNAIL_SCALE_FACTOR,a=this.getHeight()/ei.THUMBNAIL_SCALE_FACTOR,c=new Int32Array(o*a),u=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let g=0;g<a;g++){const y=g*o;for(let w=0;w<o;w++){const E=u[d+w*ei.THUMBNAIL_SCALE_FACTOR]&255;c[y+w]=4278190080|E*65793}d+=this.dataWidth*ei.THUMBNAIL_SCALE_FACTOR}return c}getThumbnailWidth(){return this.getWidth()/ei.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/ei.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(o,a){const c=this.yuvData;for(let u=0,d=this.top*this.dataWidth+this.left;u<a;u++,d+=this.dataWidth){const g=d+o/2;for(let y=d,w=d+o-1;y<g;y++,w--){const E=c[y];c[y]=c[w],c[w]=E}}}invert(){return new Me(this)}}ei.THUMBNAIL_SCALE_FACTOR=2;class Jl extends Ie{constructor(o,a,c,u,d,g,y){if(super(a,c),this.dataWidth=u,this.dataHeight=d,this.left=g,this.top=y,o.BYTES_PER_ELEMENT===4){const w=a*c,E=new Uint8ClampedArray(w);for(let T=0;T<w;T++){const b=o[T],O=b>>16&255,z=b>>7&510,X=b&255;E[T]=(O+z+X)/4&255}this.luminances=E}else this.luminances=o;if(u===void 0&&(this.dataWidth=a),d===void 0&&(this.dataHeight=c),g===void 0&&(this.left=0),y===void 0&&(this.top=0),this.left+a>this.dataWidth||this.top+c>this.dataHeight)throw new _("Crop rectangle does not fit within image data.")}getRow(o,a){if(o<0||o>=this.getHeight())throw new _("Requested row is outside the image: "+o);const c=this.getWidth();(a==null||a.length<c)&&(a=new Uint8ClampedArray(c));const u=(o+this.top)*this.dataWidth+this.left;return D.arraycopy(this.luminances,u,a,0,c),a}getMatrix(){const o=this.getWidth(),a=this.getHeight();if(o===this.dataWidth&&a===this.dataHeight)return this.luminances;const c=o*a,u=new Uint8ClampedArray(c);let d=this.top*this.dataWidth+this.left;if(o===this.dataWidth)return D.arraycopy(this.luminances,d,u,0,c),u;for(let g=0;g<a;g++){const y=g*o;D.arraycopy(this.luminances,d,u,y,o),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(o,a,c,u){return new Jl(this.luminances,c,u,this.dataWidth,this.dataHeight,this.left+o,this.top+a)}invert(){return new Me(this)}}class js extends L{static forName(o){return this.getCharacterSetECIByName(o)}}class p{}p.ISO_8859_1=L.ISO8859_1;class v{isCompact(){return this.compact}setCompact(o){this.compact=o}getSize(){return this.size}setSize(o){this.size=o}getLayers(){return this.layers}setLayers(o){this.layers=o}getCodeWords(){return this.codeWords}setCodeWords(o){this.codeWords=o}getMatrix(){return this.matrix}setMatrix(o){this.matrix=o}}class C{static singletonList(o){return[o]}static min(o,a){return o.sort(a)[0]}}class V{constructor(o){this.previous=o}getPrevious(){return this.previous}}class ee extends V{constructor(o,a,c){super(o),this.value=a,this.bitCount=c}appendTo(o,a){o.appendBits(this.value,this.bitCount)}add(o,a){return new ee(this,o,a)}addBinaryShift(o,a){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new ee(this,o,a)}toString(){let o=this.value&(1<<this.bitCount)-1;return o|=1<<this.bitCount,"<"+N.toBinaryString(o|1<<this.bitCount).substring(1)+">"}}class le extends ee{constructor(o,a,c){super(o,0,0),this.binaryShiftStart=a,this.binaryShiftByteCount=c}appendTo(o,a){for(let c=0;c<this.binaryShiftByteCount;c++)(c===0||c===31&&this.binaryShiftByteCount<=62)&&(o.appendBits(31,5),this.binaryShiftByteCount>62?o.appendBits(this.binaryShiftByteCount-31,16):c===0?o.appendBits(Math.min(this.binaryShiftByteCount,31),5):o.appendBits(this.binaryShiftByteCount-31,5)),o.appendBits(a[this.binaryShiftStart+c],8)}addBinaryShift(o,a){return new le(this,o,a)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ve(S,o,a){return new le(S,o,a)}function vt(S,o,a){return new ee(S,o,a)}const Gn=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],nt=0,Sn=1,Pt=2,zs=3,wn=4,ec=new ee(null,0,0),Ha=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,917504+14336+928+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,655360+928+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,655360+992+28,655360+992+30,655360+992+29,0])];function D3(S){for(let o of S)P.fill(o,-1);return S[nt][wn]=0,S[Sn][wn]=0,S[Sn][nt]=28,S[zs][wn]=0,S[Pt][wn]=0,S[Pt][nt]=15,S}const jx=D3(P.createInt32Array(6,6));class ls{constructor(o,a,c,u){this.token=o,this.mode=a,this.binaryShiftByteCount=c,this.bitCount=u}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(o,a){let c=this.bitCount,u=this.token;if(o!==this.mode){let g=Ha[this.mode][o];u=vt(u,g&65535,g>>16),c+=g>>16}let d=o===Pt?4:5;return u=vt(u,a,d),new ls(u,o,0,c+d)}shiftAndAppend(o,a){let c=this.token,u=this.mode===Pt?4:5;return c=vt(c,jx[this.mode][o],u),c=vt(c,a,5),new ls(c,this.mode,0,this.bitCount+u+5)}addBinaryShiftChar(o){let a=this.token,c=this.mode,u=this.bitCount;if(this.mode===wn||this.mode===Pt){let y=Ha[c][nt];a=vt(a,y&65535,y>>16),u+=y>>16,c=nt}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,g=new ls(a,c,this.binaryShiftByteCount+1,u+d);return g.binaryShiftByteCount===2047+31&&(g=g.endBinaryShift(o+1)),g}endBinaryShift(o){if(this.binaryShiftByteCount===0)return this;let a=this.token;return a=ve(a,o-this.binaryShiftByteCount,this.binaryShiftByteCount),new ls(a,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(o){let a=this.bitCount+(Ha[this.mode][o.mode]>>16);return this.binaryShiftByteCount<o.binaryShiftByteCount?a+=ls.calculateBinaryShiftCost(o)-ls.calculateBinaryShiftCost(this):this.binaryShiftByteCount>o.binaryShiftByteCount&&o.binaryShiftByteCount>0&&(a+=10),a<=o.bitCount}toBitArray(o){let a=[];for(let u=this.endBinaryShift(o.length).token;u!==null;u=u.getPrevious())a.unshift(u);let c=new H;for(const u of a)u.appendTo(c,o);return c}toString(){return q.format("%s bits=%d bytes=%d",Gn[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(o){return o.binaryShiftByteCount>62?21:o.binaryShiftByteCount>31?20:o.binaryShiftByteCount>0?10:0}}ls.INITIAL_STATE=new ls(ec,nt,0,0);function k3(S){const o=q.getCharCode(" "),a=q.getCharCode("."),c=q.getCharCode(",");S[nt][o]=1;const u=q.getCharCode("Z"),d=q.getCharCode("A");for(let O=d;O<=u;O++)S[nt][O]=O-d+2;S[Sn][o]=1;const g=q.getCharCode("z"),y=q.getCharCode("a");for(let O=y;O<=g;O++)S[Sn][O]=O-y+2;S[Pt][o]=1;const w=q.getCharCode("9"),E=q.getCharCode("0");for(let O=E;O<=w;O++)S[Pt][O]=O-E+2;S[Pt][c]=12,S[Pt][a]=13;const T=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let O=0;O<T.length;O++)S[zs][q.getCharCode(T[O])]=O;const b=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let O=0;O<b.length;O++)q.getCharCode(b[O])>0&&(S[wn][q.getCharCode(b[O])]=O);return S}const Ng=k3(P.createInt32Array(5,256));class Qu{constructor(o){this.text=o}encode(){const o=q.getCharCode(" "),a=q.getCharCode(`
`);let c=C.singletonList(ls.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let g,y=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case q.getCharCode("\r"):g=y===a?2:0;break;case q.getCharCode("."):g=y===o?3:0;break;case q.getCharCode(","):g=y===o?4:0;break;case q.getCharCode(":"):g=y===o?5:0;break;default:g=0}g>0?(c=Qu.updateStateListForPair(c,d,g),d++):c=this.updateStateListForChar(c,d)}return C.min(c,(d,g)=>d.getBitCount()-g.getBitCount()).toBitArray(this.text)}updateStateListForChar(o,a){const c=[];for(let u of o)this.updateStateForChar(u,a,c);return Qu.simplifyStates(c)}updateStateForChar(o,a,c){let u=this.text[a]&255,d=Ng[o.getMode()][u]>0,g=null;for(let y=0;y<=wn;y++){let w=Ng[y][u];if(w>0){if(g==null&&(g=o.endBinaryShift(a)),!d||y===o.getMode()||y===Pt){const E=g.latchAndAppend(y,w);c.push(E)}if(!d&&jx[o.getMode()][y]>=0){const E=g.shiftAndAppend(y,w);c.push(E)}}}if(o.getBinaryShiftByteCount()>0||Ng[o.getMode()][u]===0){let y=o.addBinaryShiftChar(a);c.push(y)}}static updateStateListForPair(o,a,c){const u=[];for(let d of o)this.updateStateForPair(d,a,c,u);return this.simplifyStates(u)}static updateStateForPair(o,a,c,u){let d=o.endBinaryShift(a);if(u.push(d.latchAndAppend(wn,c)),o.getMode()!==wn&&u.push(d.shiftAndAppend(wn,c)),c===3||c===4){let g=d.latchAndAppend(Pt,16-c).latchAndAppend(Pt,1);u.push(g)}if(o.getBinaryShiftByteCount()>0){let g=o.addBinaryShiftChar(a).addBinaryShiftChar(a+1);u.push(g)}}static simplifyStates(o){let a=[];for(const c of o){let u=!0;for(const d of a){if(d.isBetterThanOrEqualTo(c)){u=!1;break}c.isBetterThanOrEqualTo(d)&&(a=a.filter(g=>g!==d))}u&&a.push(c)}return a}}class It{constructor(){}static encodeBytes(o){return It.encode(o,It.DEFAULT_EC_PERCENT,It.DEFAULT_AZTEC_LAYERS)}static encode(o,a,c){let u=new Qu(o).encode(),d=N.truncDivision(u.getSize()*a,100)+11,g=u.getSize()+d,y,w,E,T,b;if(c!==It.DEFAULT_AZTEC_LAYERS){if(y=c<0,w=Math.abs(c),w>(y?It.MAX_NB_BITS_COMPACT:It.MAX_NB_BITS))throw new _(q.format("Illegal value %s for layers",c));E=It.totalBitsInLayer(w,y),T=It.WORD_SIZE[w];let me=E-E%T;if(b=It.stuffBits(u,T),b.getSize()+d>me)throw new _("Data to large for user specified layer");if(y&&b.getSize()>T*64)throw new _("Data to large for user specified layer")}else{T=0,b=null;for(let me=0;;me++){if(me>It.MAX_NB_BITS)throw new _("Data too large for an Aztec code");if(y=me<=3,w=y?me+1:me,E=It.totalBitsInLayer(w,y),g>E)continue;(b==null||T!==It.WORD_SIZE[w])&&(T=It.WORD_SIZE[w],b=It.stuffBits(u,T));let ct=E-E%T;if(!(y&&b.getSize()>T*64)&&b.getSize()+d<=ct)break}}let O=It.generateCheckWords(b,E,T),z=b.getSize()/T,X=It.generateModeMessage(y,w,z),Z=(y?11:14)+w*4,re=new Int32Array(Z),ce;if(y){ce=Z;for(let me=0;me<re.length;me++)re[me]=me}else{ce=Z+1+2*N.truncDivision(N.truncDivision(Z,2)-1,15);let me=N.truncDivision(Z,2),ct=N.truncDivision(ce,2);for(let et=0;et<me;et++){let Ur=et+N.truncDivision(et,15);re[me-et-1]=ct-Ur-1,re[me+et]=ct+Ur+1}}let xe=new ze(ce);for(let me=0,ct=0;me<w;me++){let et=(w-me)*4+(y?9:12);for(let Ur=0;Ur<et;Ur++){let Li=Ur*2;for(let jr=0;jr<2;jr++)O.get(ct+Li+jr)&&xe.set(re[me*2+jr],re[me*2+Ur]),O.get(ct+et*2+Li+jr)&&xe.set(re[me*2+Ur],re[Z-1-me*2-jr]),O.get(ct+et*4+Li+jr)&&xe.set(re[Z-1-me*2-jr],re[Z-1-me*2-Ur]),O.get(ct+et*6+Li+jr)&&xe.set(re[Z-1-me*2-Ur],re[me*2+jr])}ct+=et*8}if(It.drawModeMessage(xe,y,ce,X),y)It.drawBullsEye(xe,N.truncDivision(ce,2),5);else{It.drawBullsEye(xe,N.truncDivision(ce,2),7);for(let me=0,ct=0;me<N.truncDivision(Z,2)-1;me+=15,ct+=16)for(let et=N.truncDivision(ce,2)&1;et<ce;et+=2)xe.set(N.truncDivision(ce,2)-ct,et),xe.set(N.truncDivision(ce,2)+ct,et),xe.set(et,N.truncDivision(ce,2)-ct),xe.set(et,N.truncDivision(ce,2)+ct)}let _e=new v;return _e.setCompact(y),_e.setSize(ce),_e.setLayers(w),_e.setCodeWords(z),_e.setMatrix(xe),_e}static drawBullsEye(o,a,c){for(let u=0;u<c;u+=2)for(let d=a-u;d<=a+u;d++)o.set(d,a-u),o.set(d,a+u),o.set(a-u,d),o.set(a+u,d);o.set(a-c,a-c),o.set(a-c+1,a-c),o.set(a-c,a-c+1),o.set(a+c,a-c),o.set(a+c,a-c+1),o.set(a+c,a+c-1)}static generateModeMessage(o,a,c){let u=new H;return o?(u.appendBits(a-1,2),u.appendBits(c-1,6),u=It.generateCheckWords(u,28,4)):(u.appendBits(a-1,5),u.appendBits(c-1,11),u=It.generateCheckWords(u,40,4)),u}static drawModeMessage(o,a,c,u){let d=N.truncDivision(c,2);if(a)for(let g=0;g<7;g++){let y=d-3+g;u.get(g)&&o.set(y,d-5),u.get(g+7)&&o.set(d+5,y),u.get(20-g)&&o.set(y,d+5),u.get(27-g)&&o.set(d-5,y)}else for(let g=0;g<10;g++){let y=d-5+g+N.truncDivision(g,5);u.get(g)&&o.set(y,d-7),u.get(g+10)&&o.set(d+7,y),u.get(29-g)&&o.set(y,d+7),u.get(39-g)&&o.set(d-7,y)}}static generateCheckWords(o,a,c){let u=o.getSize()/c,d=new Zl(It.getGF(c)),g=N.truncDivision(a,c),y=It.bitsToWords(o,c,g);d.encode(y,g-u);let w=a%c,E=new H;E.appendBits(0,w);for(const T of Array.from(y))E.appendBits(T,c);return E}static bitsToWords(o,a,c){let u=new Int32Array(c),d,g;for(d=0,g=o.getSize()/a;d<g;d++){let y=0;for(let w=0;w<a;w++)y|=o.get(d*a+w)?1<<a-w-1:0;u[d]=y}return u}static getGF(o){switch(o){case 4:return ot.AZTEC_PARAM;case 6:return ot.AZTEC_DATA_6;case 8:return ot.AZTEC_DATA_8;case 10:return ot.AZTEC_DATA_10;case 12:return ot.AZTEC_DATA_12;default:throw new _("Unsupported word size "+o)}}static stuffBits(o,a){let c=new H,u=o.getSize(),d=(1<<a)-2;for(let g=0;g<u;g+=a){let y=0;for(let w=0;w<a;w++)(g+w>=u||o.get(g+w))&&(y|=1<<a-1-w);(y&d)===d?(c.appendBits(y&d,a),g--):y&d?c.appendBits(y,a):(c.appendBits(y|1,a),g--)}return c}static totalBitsInLayer(o,a){return((a?88:112)+16*o)*o}}It.DEFAULT_EC_PERCENT=33,It.DEFAULT_AZTEC_LAYERS=0,It.MAX_NB_BITS=32,It.MAX_NB_BITS_COMPACT=4,It.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class gf{encode(o,a,c,u){return this.encodeWithHints(o,a,c,u,null)}encodeWithHints(o,a,c,u,d){let g=p.ISO_8859_1,y=It.DEFAULT_EC_PERCENT,w=It.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(cn.CHARACTER_SET)&&(g=js.forName(d.get(cn.CHARACTER_SET).toString())),d.has(cn.ERROR_CORRECTION)&&(y=N.parseInt(d.get(cn.ERROR_CORRECTION).toString())),d.has(cn.AZTEC_LAYERS)&&(w=N.parseInt(d.get(cn.AZTEC_LAYERS).toString()))),gf.encodeLayers(o,a,c,u,g,y,w)}static encodeLayers(o,a,c,u,d,g,y){if(a!==ke.AZTEC)throw new _("Can only encode AZTEC, but got "+a);let w=It.encode(q.getBytes(o,d),g,y);return gf.renderResult(w,c,u)}static renderResult(o,a,c){let u=o.getMatrix();if(u==null)throw new rr;let d=u.getWidth(),g=u.getHeight(),y=Math.max(a,d),w=Math.max(c,g),E=Math.min(y/d,w/g),T=(y-d*E)/2,b=(w-g*E)/2,O=new ze(y,w);for(let z=0,X=b;z<g;z++,X+=E)for(let Z=0,re=T;Z<d;Z++,re+=E)u.get(Z,z)&&O.setRegion(re,X,E,E);return O}}n.AbstractExpandedDecoder=Vu,n.ArgumentException=x,n.ArithmeticException=bi,n.AztecCode=v,n.AztecCodeReader=gr,n.AztecCodeWriter=gf,n.AztecDecoder=Nt,n.AztecDetector=Ji,n.AztecDetectorResult=Ce,n.AztecEncoder=It,n.AztecHighLevelEncoder=Qu,n.AztecPoint=Et,n.BarcodeFormat=ke,n.Binarizer=B,n.BinaryBitmap=I,n.BitArray=H,n.BitMatrix=ze,n.BitSource=Fa,n.BrowserAztecCodeReader=Lu,n.BrowserBarcodeReader=ju,n.BrowserCodeReader=Tt,n.BrowserDatamatrixCodeReader=sf,n.BrowserMultiFormatReader=ja,n.BrowserPDF417Reader=hf,n.BrowserQRCodeReader=df,n.BrowserQRCodeSvgWriter=as,n.CharacterSetECI=L,n.ChecksumException=R,n.Code128Reader=Ee,n.Code39Reader=Jt,n.DataMatrixDecodedBitStreamParser=Ri,n.DataMatrixReader=Ni,n.DecodeHintType=J,n.DecoderResult=Si,n.DefaultGridSampler=We,n.DetectorResult=ue,n.EAN13Reader=Zr,n.EncodeHintType=cn,n.Exception=m,n.FormatException=k,n.GenericGF=ot,n.GenericGFPoly=An,n.GlobalHistogramBinarizer=rt,n.GridSampler=pe,n.GridSamplerInstance=Ge,n.HTMLCanvasElementLuminanceSource=Ue,n.HybridBinarizer=Oe,n.ITFReader=pt,n.IllegalArgumentException=_,n.IllegalStateException=rr,n.InvertedLuminanceSource=Me,n.LuminanceSource=Ie,n.MathUtils=it,n.MultiFormatOneDReader=Vr,n.MultiFormatReader=$u,n.MultiFormatWriter=Sr,n.NotFoundException=ie,n.OneDReader=bt,n.PDF417DecodedBitStreamParser=se,n.PDF417DecoderErrorCorrection=Ba,n.PDF417Reader=yn,n.PDF417ResultMetadata=Hu,n.PerspectiveTransform=be,n.PlanarYUVLuminanceSource=ei,n.QRCodeByteMatrix=Ga,n.QRCodeDataMask=sr,n.QRCodeDecodedBitStreamParser=$t,n.QRCodeDecoderErrorCorrectionLevel=xt,n.QRCodeDecoderFormatInformation=Ht,n.QRCodeEncoder=Lt,n.QRCodeEncoderQRCode=os,n.QRCodeMaskUtil=Ut,n.QRCodeMatrixUtil=je,n.QRCodeMode=Be,n.QRCodeReader=Cr,n.QRCodeVersion=Fe,n.QRCodeWriter=Mi,n.RGBLuminanceSource=Jl,n.RSS14Reader=Ot,n.RSSExpandedReader=de,n.ReaderException=Yl,n.ReedSolomonDecoder=Zi,n.ReedSolomonEncoder=Zl,n.ReedSolomonException=Yr,n.Result=Vt,n.ResultMetadataType=an,n.ResultPoint=Q,n.StringUtils=q,n.UnsupportedOperationException=W,n.VideoInputDevice=Rt,n.WhiteRectangleDetector=we,n.WriterException=ft,n.ZXingArrays=P,n.ZXingCharset=js,n.ZXingInteger=N,n.ZXingStandardCharsets=p,n.ZXingStringBuilder=j,n.ZXingStringEncoding=K,n.ZXingSystem=D,n.createAbstractExpandedDecoder=Bu,Object.defineProperty(n,"__esModule",{value:!0})})})(gy,gy.exports);var Xt=gy.exports;const LF=$v(Xt),FF=Kv({__proto__:null,default:LF},[Xt]);var Rv=function(){function t(e,n,r){if(this.formatMap=new Map([[Ne.QR_CODE,Xt.BarcodeFormat.QR_CODE],[Ne.AZTEC,Xt.BarcodeFormat.AZTEC],[Ne.CODABAR,Xt.BarcodeFormat.CODABAR],[Ne.CODE_39,Xt.BarcodeFormat.CODE_39],[Ne.CODE_93,Xt.BarcodeFormat.CODE_93],[Ne.CODE_128,Xt.BarcodeFormat.CODE_128],[Ne.DATA_MATRIX,Xt.BarcodeFormat.DATA_MATRIX],[Ne.MAXICODE,Xt.BarcodeFormat.MAXICODE],[Ne.ITF,Xt.BarcodeFormat.ITF],[Ne.EAN_13,Xt.BarcodeFormat.EAN_13],[Ne.EAN_8,Xt.BarcodeFormat.EAN_8],[Ne.PDF_417,Xt.BarcodeFormat.PDF_417],[Ne.RSS_14,Xt.BarcodeFormat.RSS_14],[Ne.RSS_EXPANDED,Xt.BarcodeFormat.RSS_EXPANDED],[Ne.UPC_A,Xt.BarcodeFormat.UPC_A],[Ne.UPC_E,Xt.BarcodeFormat.UPC_E],[Ne.UPC_EAN_EXTENSION,Xt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!FF)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=r;var i=this.createZXingFormats(e),s=new Map;s.set(Xt.DecodeHintType.POSSIBLE_FORMATS,i),s.set(Xt.DecodeHintType.TRY_HARDER,!1),this.hints=s}return t.prototype.decodeAsync=function(e){var n=this;return new Promise(function(r,i){try{r(n.decode(e))}catch(s){i(s)}})},t.prototype.decode=function(e){var n=new Xt.MultiFormatReader(this.verbose,this.hints),r=new Xt.HTMLCanvasElementLuminanceSource(e),i=new Xt.BinaryBitmap(new Xt.HybridBinarizer(r)),s=n.decode(i);return{text:s.text,format:R3.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,i){e.set(n,r)}),e},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createZXingFormats=function(e){for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r];this.formatMap.has(s)?n.push(this.formatMap.get(s)):this.logger.logError("".concat(s," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),VF=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(_){l(_)}}function f(x){try{m(r.throw(x))}catch(_){l(_)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},BF=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Nv=function(){function t(e,n,r){if(this.formatMap=new Map([[Ne.QR_CODE,"qr_code"],[Ne.AZTEC,"aztec"],[Ne.CODABAR,"codabar"],[Ne.CODE_39,"code_39"],[Ne.CODE_93,"code_93"],[Ne.CODE_128,"code_128"],[Ne.DATA_MATRIX,"data_matrix"],[Ne.ITF,"itf"],[Ne.EAN_13,"ean_13"],[Ne.EAN_8,"ean_8"],[Ne.PDF_417,"pdf417"],[Ne.UPC_A,"upc_a"],[Ne.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=r;var i=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},t.prototype.decodeAsync=function(e){return VF(this,void 0,void 0,function(){var n,r;return BF(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(e)];case 1:if(n=i.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return r=this.selectLargestBarcode(n),[2,{text:r.rawValue,format:R3.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(e){for(var n=null,r=0,i=0,s=e;i<s.length;i++){var l=s[i],h=l.boundingBox.width*l.boundingBox.height;h>r&&(r=h,n=l)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(e){for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r];this.formatMap.has(s)?n.push(this.formatMap.get(s)):this.logger.warn("".concat(s," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,i){e.set(n,r)}),e},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),Pv=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(_){l(_)}}function f(x){try{m(r.throw(x))}catch(_){l(_)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},Dv=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},UF=function(){function t(e,n,r,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=r,n&&Nv.isSupported()?(this.primaryDecoder=new Nv(e,r,i),this.secondaryDecoder=new Rv(e,r,i)):this.primaryDecoder=new Rv(e,r,i)}return t.prototype.decodeAsync=function(e){return Pv(this,void 0,void 0,function(){var n;return Dv(this,function(r){switch(r.label){case 0:n=performance.now(),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,r.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(e){return Pv(this,void 0,void 0,function(){var n,r;return Dv(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,i.sent()];case 3:if(r=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw r;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(e){if(this.verbose){var n=performance.now()-e;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,n=0,r=this.executionResults;n<r.length;n++){var i=r[n];e+=i}var s=e/this.executionResults.length;console.log("".concat(s," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),Ux=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),v1=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(_){l(_)}}function f(x){try{m(r.throw(x))}catch(_){l(_)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},I1=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},P3=function(){function t(e,n){this.name=e,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(e){var n={};n[this.name]=e;var r={advanced:[n]};return this.track.applyConstraints(r)},t.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var n=e[this.name];return n}return null},t}(),jF=function(t){Ux(e,t);function e(n,r){return t.call(this,n,r)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(n){var r={};r[this.name]=n;var i={advanced:[r]};return this.track.applyConstraints(i)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),r=n[this.name];return{min:r.min,max:r.max,step:r.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(P3),zF=function(t){Ux(e,t);function e(n){return t.call(this,"zoom",n)||this}return e}(jF),GF=function(t){Ux(e,t);function e(n){return t.call(this,"torch",n)||this}return e}(P3),HF=function(){function t(e){this.track=e}return t.prototype.zoomFeature=function(){return new zF(this.track)},t.prototype.torchFeature=function(){return new GF(this.track)},t}(),WF=function(){function t(e,n,r){this.isClosed=!1,this.parentElement=e,this.mediaStream=n,this.callbacks=r,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return t.prototype.createVideoElement=function(e){var n=document.createElement("video");return n.style.width="".concat(e,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var r=e.surface.clientWidth,i=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(r,i),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(e,n,r,i){return v1(this,void 0,void 0,function(){var s,l;return I1(this,function(h){switch(h.label){case 0:return s=new t(e,n,i),r.aspectRatio?(l={aspectRatio:r.aspectRatio},[4,s.getFirstTrackOrFail().applyConstraints(l)]):[3,2];case 1:h.sent(),h.label=2;case 2:return s.setupSurface(),[2,s]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(e){this.failIfClosed();var n=this,r=function(){setTimeout(e,200),n.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(e){return v1(this,void 0,void 0,function(){return I1(this,function(n){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(n,r){var i=e.mediaStream.getVideoTracks(),s=i.length,l=0;e.mediaStream.getVideoTracks().forEach(function(h){e.mediaStream.removeTrack(h),h.stop(),++l,l>=s&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),n())})})},t.prototype.getCapabilities=function(){return new HF(this.getFirstTrackOrFail())},t}(),qF=function(){function t(e){this.mediaStream=e}return t.prototype.render=function(e,n,r){return v1(this,void 0,void 0,function(){return I1(this,function(i){return[2,WF.create(e,this.mediaStream,n,r)]})})},t.create=function(e){return v1(this,void 0,void 0,function(){var n,r;return I1(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return r=i.sent(),[2,new t(r)]}})})},t}(),kv=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(_){l(_)}}function f(x){try{m(r.throw(x))}catch(_){l(_)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},Ov=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},KF=function(){function t(){}return t.failIfNotSupported=function(){return kv(this,void 0,void 0,function(){return Ov(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(e){return kv(this,void 0,void 0,function(){return Ov(this,function(n){return[2,qF.create(e)]})})},t}(),$F=globalThis&&globalThis.__awaiter||function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(l){l(s)})}return new(n||(n=Promise))(function(s,l){function h(x){try{m(r.next(x))}catch(_){l(_)}}function f(x){try{m(r.throw(x))}catch(_){l(_)}}function m(x){x.done?s(x.value):i(x.value).then(h,f)}m((r=r.apply(t,e||[])).next())})},QF=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(x){return f([m,x])}}function f(m){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(n=0)),n;)try{if(r=1,i&&(s=m[0]&2?i.return:m[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,m[1])).done)return s;switch(i=0,s&&(m=[m[0]&2,s.value]),m[0]){case 0:case 1:s=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,i=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!s||m[1]>s[0]&&m[1]<s[3])){n.label=m[1];break}if(m[0]===6&&n.label<s[1]){n.label=s[1],s=m;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(m);break}s[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(x){m=[6,x],i=0}finally{r=s=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},XF=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var e=Sc.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(e=Sc.insecureContextCameraQueryError()),Promise.reject(e)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},t.getCamerasFromMediaDevices=function(){return $F(this,void 0,void 0,function(){var e,n,r,i,s,l,h;return QF(this,function(f){switch(f.label){case 0:return e=function(m){for(var x=m.getVideoTracks(),_=0,I=x;_<I.length;_++){var R=I[_];R.enabled=!1,R.stop(),m.removeTrack(R)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=f.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=f.sent(),i=[],s=0,l=r;s<l.length;s++)h=l[s],h.kind==="videoinput"&&i.push({id:h.deviceId,label:h.label});return e(n),[2,i]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,n){var r=function(s){for(var l=[],h=0,f=s;h<f.length;h++){var m=f[h];m.kind==="video"&&l.push({id:m.id,label:m.label})}e(l)},i=MediaStreamTrack;i.getSources(r)})},t}(),_n;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(_n||(_n={}));var YF=function(){function t(){this.state=_n.NOT_STARTED,this.onGoingTransactionNewState=_n.UNKNOWN}return t.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},t.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===_n.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=_n.UNKNOWN,this.directTransition(e)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===_n.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=_n.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==_n.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(e){switch(this.state){case _n.UNKNOWN:throw"Transition from unknown is not allowed";case _n.NOT_STARTED:this.failIfNewStateIs(e,[_n.PAUSED]);break;case _n.SCANNING:break;case _n.PAUSED:break}},t.prototype.failIfNewStateIs=function(e,n){for(var r=0,i=n;r<i.length;r++){var s=i[r];if(e===s)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},t}(),ZF=function(){function t(e){this.stateManager=e}return t.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},t.prototype.directTransition=function(e){this.stateManager.directTransition(e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===_n.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==_n.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===_n.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===_n.PAUSED},t}(),JF=function(){function t(){}return t.create=function(){return new ZF(new YF)},t}(),eV=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ii=function(t){eV(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(kF),tV=function(){function t(e,n){this.logger=n,this.fps=ii.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=ii.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?N3.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!qs(this.qrbox)},t.create=function(e,n){return new t(e,n)},t}(),nV=function(){function t(e,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var r;typeof n=="boolean"?this.verbose=n===!0:n&&(r=n,this.verbose=r.verbose===!0,r.experimentalFeatures),this.logger=new MF(this.verbose),this.qrcode=new UF(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(r),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=JF.create()}return t.prototype.start=function(e,n,r,i){var s=this;if(!e)throw"cameraIdOrConfig is required";if(!r||typeof r!="function")throw"qrCodeSuccessCallback is required and should be a function.";var l;i?l=i:l=this.verbose?this.logger.log:function(){};var h=tV.create(n,this.logger);this.clearElement();var f=!1;h.videoConstraints&&(h.isMediaStreamConstraintsValid()?f=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var m=f,x=document.getElementById(this.elementId);x.clientWidth?x.clientWidth:ii.DEFAULT_WIDTH,x.style.position="relative",this.shouldScan=!0,this.element=x;var _=this,I=this.stateManagerProxy.startTransition(_n.SCANNING);return new Promise(function(R,B){var D=m?h.videoConstraints:_.createVideoConstraints(e);if(!D){I.cancel(),B("videoConstraints should be defined");return}var G={};(!m||h.aspectRatio)&&(G.aspectRatio=h.aspectRatio);var F={onRenderSurfaceReady:function(P,N){_.setupUi(P,N,h),_.isScanning=!0,_.foreverScan(h,r,l)}};KF.failIfNotSupported().then(function(P){P.create(D).then(function(N){return N.render(s.element,G,F).then(function(H){_.renderedCamera=H,I.execute(),R(null)}).catch(function(H){I.cancel(),B(H)})}).catch(function(N){I.cancel(),B(Sc.errorGettingUserMedia(N))})}).catch(function(P){I.cancel(),B(Sc.cameraStreamingNotSupported())})})},t.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(_n.PAUSED),this.showPausedState(),(qs(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,n=function(){e.stateManagerProxy.directTransition(_n.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(_n.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var r=function(){if(e.element){var s=document.getElementById(ii.SHADED_REGION_ELEMENT_ID);s&&e.element.removeChild(s)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),r(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),n.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(e,n){return this.scanFileV2(e,n).then(function(r){return r.decodedText})},t.prototype.scanFileV2=function(e,n){var r=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(qs(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,s){r.possiblyCloseLastScanImageFile(),r.clearElement(),r.lastScanImageFile=URL.createObjectURL(e);var l=new Image;l.onload=function(){var h=l.width,f=l.height,m=document.getElementById(r.elementId),x=m.clientWidth?m.clientWidth:ii.DEFAULT_WIDTH,_=Math.max(m.clientHeight?m.clientHeight:f,ii.FILE_SCAN_MIN_HEIGHT),I=r.computeCanvasDrawConfig(h,f,x,_);if(n){var R=r.createCanvasElement(x,_,"qr-canvas-visible");R.style.display="inline-block",m.appendChild(R);var B=R.getContext("2d");if(!B)throw"Unable to get 2d context from canvas";B.canvas.width=x,B.canvas.height=_,B.drawImage(l,0,0,h,f,I.x,I.y,I.width,I.height)}var D=ii.FILE_SCAN_HIDDEN_CANVAS_PADDING,G=Math.max(l.width,I.width),F=Math.max(l.height,I.height),P=G+2*D,N=F+2*D,H=r.createCanvasElement(P,N);m.appendChild(H);var Y=H.getContext("2d");if(!Y)throw"Unable to get 2d context from canvas";Y.canvas.width=P,Y.canvas.height=N,Y.drawImage(l,0,0,h,f,D,D,G,F);try{r.qrcode.decodeRobustlyAsync(H).then(function(J){i(bv.createFromQrcodeResult(J))}).catch(s)}catch(J){s("QR code parse error, error = ".concat(J))}},l.onerror=s,l.onabort=s,l.onstalled=s,l.onsuspend=s,l.src=URL.createObjectURL(e)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return XF.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(e){if(e){if(!N3.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(e){var n=[Ne.QR_CODE,Ne.AZTEC,Ne.CODABAR,Ne.CODE_39,Ne.CODE_93,Ne.CODE_128,Ne.DATA_MATRIX,Ne.MAXICODE,Ne.ITF,Ne.EAN_13,Ne.EAN_8,Ne.PDF_417,Ne.RSS_14,Ne.RSS_EXPANDED,Ne.UPC_A,Ne.UPC_E,Ne.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return n;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var r=[],i=0,s=e.formatsToSupport;i<s.length;i++){var l=s[i];DF(l)?r.push(l):this.logger.warn("Invalid format: ".concat(l," passed in config, ignoring."))}if(r.length===0)throw"None of formatsToSupport match supported values.";return r},t.prototype.getUseBarCodeDetectorIfSupported=function(e){if(qs(e))return!0;if(!qs(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(qs(e.experimentalFeatures))return!0;var n=e.experimentalFeatures;return qs(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(e,n,r){var i=this,s=r.qrbox;this.validateQrboxConfig(s);var l=this.toQrdimensions(e,n,s),h=function(m){if(m<ii.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(ii.MIN_QR_BOX_SIZE,"px.")},f=function(m){return m>e&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),m=e),m};h(l.width),h(l.height),l.width=f(l.width)},t.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(e,n,r){if(typeof r=="number")return{width:r,height:r};if(typeof r=="function")try{return r(e,n)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return r},t.prototype.setupUi=function(e,n,r){r.isShadedBoxEnabled()&&this.validateQrboxSize(e,n,r);var i=qs(r.qrbox)?{width:e,height:n}:r.qrbox;this.validateQrboxConfig(i);var s=this.toQrdimensions(e,n,i);s.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var l=r.isShadedBoxEnabled()&&s.height<=n,h={x:0,y:0,width:e,height:n},f=l?this.getShadedRegionBounds(e,n,s):h,m=this.createCanvasElement(f.width,f.height),x={willReadFrequently:!0},_=m.getContext("2d",x);_.canvas.width=f.width,_.canvas.height=f.height,this.element.append(m),l&&this.possiblyInsertShadingElement(this.element,e,n,s),this.createScannerPausedUiElement(this.element),this.qrRegion=f,this.context=_,this.canvasElement=m},t.prototype.createScannerPausedUiElement=function(e){var n=document.createElement("div");n.innerText=Sc.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",e.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(e,n){var r=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return e(i.text,bv.createFromQrcodeResult(i)),r.possiblyUpdateShaders(!0),!0}).catch(function(i){r.possiblyUpdateShaders(!1);var s=Sc.codeParseError(i);return n(s,OF.createFrom(s)),!1})},t.prototype.foreverScan=function(e,n,r){var i=this;if(this.shouldScan&&this.renderedCamera){var s=this.renderedCamera.getSurface(),l=s.videoWidth/s.clientWidth,h=s.videoHeight/s.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var f=this.qrRegion.width*l,m=this.qrRegion.height*h,x=this.qrRegion.x*l,_=this.qrRegion.y*h;this.context.drawImage(s,x,_,f,m,0,0,this.qrRegion.width,this.qrRegion.height);var I=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(e,n,r)},i.getTimeoutFps(e.fps))};this.scanContext(n,r).then(function(R){!R&&e.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(n,r).finally(function(){I()})):I()}).catch(function(R){i.logger.logError("Error happend while scanning context",R),I()})}},t.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var n="facingMode",r="deviceId",i={user:!0,environment:!0},s="exact",l=function(B){if(B in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(B,"'")},h=Object.keys(e);if(h.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(h.length," keys");var f=Object.keys(e)[0];if(f!==n&&f!==r)throw"Only '".concat(n,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(f===n){var m=e.facingMode;if(typeof m=="string"){if(l(m))return{facingMode:m}}else if(typeof m=="object")if(s in m){if(l(m["".concat(s)]))return{facingMode:{exact:m["".concat(s)]}}}else throw"'facingMode' should be string or object with"+" ".concat(s," as key.");else{var x=typeof m;throw"Invalid type of 'facingMode' = ".concat(x)}}else{var _=e.deviceId;if(typeof _=="string")return{deviceId:_};if(typeof _=="object"){if(s in _)return{deviceId:{exact:_["".concat(s)]}};throw"'deviceId' should be string or object with"+" ".concat(s," as key.")}else{var I=typeof _;throw"Invalid type of 'deviceId' = ".concat(I)}}}var R=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(R)},t.prototype.computeCanvasDrawConfig=function(e,n,r,i){if(e<=r&&n<=i){var s=(r-e)/2,l=(i-n)/2;return{x:s,y:l,width:e,height:n}}else{var h=e,f=n;return e>r&&(n=r/e*n,e=r),n>i&&(e=i/n*e,n=i),this.logger.log("Image downsampled from "+"".concat(h,"X").concat(f)+" to ".concat(e,"X").concat(n,".")),this.computeCanvasDrawConfig(e,n,r,i)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},t.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=e?ii.BORDER_SHADER_MATCH_COLOR:ii.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(e,n,r){var i=e,s=n,l=document.createElement("canvas");return l.style.width="".concat(i,"px"),l.style.height="".concat(s,"px"),l.style.display="none",l.id=qs(r)?"qr-canvas":r,l},t.prototype.getShadedRegionBounds=function(e,n,r){if(r.width>e||r.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-r.width)/2,y:(n-r.height)/2,width:r.width,height:r.height}},t.prototype.possiblyInsertShadingElement=function(e,n,r,i){if(!(n-i.width<1||r-i.height<1)){var s=document.createElement("div");s.style.position="absolute";var l=(n-i.width)/2,h=(r-i.height)/2;if(s.style.borderLeft="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderRight="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderTop="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),s.style.borderBottom="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),s.style.boxSizing="border-box",s.style.top="0px",s.style.bottom="0px",s.style.left="0px",s.style.right="0px",s.id="".concat(ii.SHADED_REGION_ELEMENT_ID),n-i.width<11||r-i.height<11)this.hasBorderShaders=!1;else{var f=5,m=40;this.insertShaderBorders(s,m,f,-f,null,0,!0),this.insertShaderBorders(s,m,f,-f,null,0,!1),this.insertShaderBorders(s,m,f,null,-f,0,!0),this.insertShaderBorders(s,m,f,null,-f,0,!1),this.insertShaderBorders(s,f,m+f,-f,null,-f,!0),this.insertShaderBorders(s,f,m+f,null,-f,-f,!0),this.insertShaderBorders(s,f,m+f,-f,null,-f,!1),this.insertShaderBorders(s,f,m+f,null,-f,-f,!1),this.hasBorderShaders=!0}e.append(s)}},t.prototype.insertShaderBorders=function(e,n,r,i,s,l,h){var f=document.createElement("div");f.style.position="absolute",f.style.backgroundColor=ii.BORDER_SHADER_DEFAULT_COLOR,f.style.width="".concat(n,"px"),f.style.height="".concat(r,"px"),i!==null&&(f.style.top="".concat(i,"px")),s!==null&&(f.style.bottom="".concat(s,"px")),h?f.style.left="".concat(l,"px"):f.style.right="".concat(l,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(f),e.appendChild(f)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(e){return 1e3/e},t}();globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var Mv;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Mv||(Mv={}));const rV=()=>{const t=fi(),e=oe.useRef(null),n=oe.useRef(!1),[r,i]=oe.useState(!1),[s,l]=oe.useState(null),[h,f]=oe.useState(""),[m,x]=oe.useState(null);oe.useEffect(()=>()=>{e.current&&r&&e.current.stop().catch(console.error)},[r]);const _=async()=>{try{if(e.current)try{await e.current.stop(),e.current.clear()}catch{console.log("No scanner to stop")}n.current=!1,i(!0),await new Promise(G=>setTimeout(G,100));const D=new nV("qr-reader");e.current=D,await D.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},G=>{R(G)},G=>{}),l(!0),Qe.success("Scanner ready! Point camera at QR code")}catch(D){console.error("Error starting scanner:",D),i(!1),l(!1),D.name==="NotAllowedError"?Qe.error("Camera permission denied. Please enable camera access."):D.name==="NotFoundError"?Qe.error("No camera found on this device."):Qe.error("Failed to start scanner. Try manual entry.")}},I=async()=>{if(e.current&&r)try{await e.current.stop(),i(!1),Qe.success("Scanner stopped")}catch(D){console.error("Error stopping scanner:",D)}},R=D=>{if(n.current){console.log("Already processing, ignoring duplicate scan");return}n.current=!0,console.log("Processing QR code:",D),e.current&&e.current.pause(!0),x(D);const G=D.match(/\/artifacts\/([a-zA-Z0-9-_]+)/);if(G&&G[1]){const F=G[1];I(),Qe.success("QR Code scanned successfully!",{duration:2e3,icon:""}),setTimeout(()=>{t(`/artifacts/${F}`)},500)}else I(),Qe.error("Invalid QR code. Expected artifact URL."),setTimeout(()=>{n.current=!1,_()},2e3)},B=D=>{if(D.preventDefault(),!h.trim()){Qe.error("Please enter an artifact ID");return}Qe.success("Opening artifact..."),t(`/artifacts/${h.trim()}`)};return A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("div",{className:"mb-8",children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"QR Code Scanner"}),A.jsx("p",{className:"mt-2 text-gray-600",children:"Scan QR codes to quickly access artifact information"})]}),A.jsx("div",{className:"card mb-6",children:A.jsxs("div",{className:"card-content",children:[s===!1&&A.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4 flex items-start gap-3",children:[A.jsx(o3,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-red-800 font-medium",children:"Camera Access Required"}),A.jsx("p",{className:"text-red-700 text-sm mt-1",children:"Please enable camera permissions in your browser settings to use the scanner."})]})]}),!r&&A.jsxs("div",{className:"text-center py-12",children:[A.jsx(_v,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),A.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Ready to Scan"}),A.jsx("p",{className:"text-gray-600 mb-6",children:"Click the button below to activate your camera"}),A.jsxs("button",{onClick:_,className:"btn btn-primary btn-lg flex items-center gap-2 mx-auto",children:[A.jsx(_v,{className:"w-5 h-5"}),"Start Scanner"]})]}),r&&A.jsx("div",{className:"relative bg-black rounded-lg overflow-hidden",style:{minHeight:"400px"},children:A.jsx("div",{id:"qr-reader",style:{width:"100%"}})}),r&&A.jsxs("div",{className:"mt-4 text-center",children:[A.jsxs("button",{onClick:I,className:"btn btn-danger btn-sm flex items-center gap-2 mx-auto",children:[A.jsx(k7,{className:"w-4 h-4"}),"Stop Scanner"]}),A.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Point your camera at a QR code"})]}),m&&A.jsxs("div",{className:"mt-4 bg-green-50 border border-green-200 rounded-lg p-3 flex items-start gap-2",children:[A.jsx(A7,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),A.jsxs("div",{className:"flex-1 min-w-0",children:[A.jsx("p",{className:"text-green-800 font-medium text-sm",children:"Last Scanned:"}),A.jsx("p",{className:"text-green-700 text-xs truncate",children:m})]})]})]})}),A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content",children:[A.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[A.jsx(ly,{className:"w-5 h-5"}),"Manual Entry"]}),A.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Already know the artifact ID? Enter it directly below."}),A.jsxs("form",{onSubmit:B,className:"space-y-4",children:[A.jsxs("div",{children:[A.jsx("label",{htmlFor:"artifactId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Artifact ID"}),A.jsx("input",{type:"text",id:"artifactId",value:h,onChange:D=>f(D.target.value),className:"input",placeholder:"e.g., xHDc4cQXBh13pTnzJSCN"})]}),A.jsxs("button",{type:"submit",className:"btn btn-outline w-full flex items-center justify-center gap-2",children:[A.jsx(ly,{className:"w-4 h-4"}),"Go to Artifact"]})]})]})}),A.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[A.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:" Scanning Tips:"}),A.jsxs("ul",{className:"text-blue-800 text-sm space-y-1 list-disc list-inside",children:[A.jsx("li",{children:"Hold your phone steady"}),A.jsx("li",{children:"Ensure good lighting"}),A.jsx("li",{children:"Center the QR code in the frame"}),A.jsx("li",{children:"Keep camera 4-6 inches from QR code"}),A.jsx("li",{children:"Use manual entry if scanning doesn't work"})]})]})]})})},iV=()=>{var n,r,i,s;const{user:t}=ks(),e=fi();return t?A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("button",{onClick:()=>e("/dashboard"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[A.jsx(Hl,{className:"w-4 h-4"}),"Back to Dashboard"]}),A.jsxs("div",{className:"mb-8",children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Profile"}),A.jsx("p",{className:"mt-2 text-gray-600",children:"View and manage your account information"})]}),A.jsxs("div",{className:"grid gap-6",children:[A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content",children:[A.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[A.jsx("div",{className:"w-20 h-20 rounded-full bg-primary-600 text-white flex items-center justify-center text-3xl font-bold",children:((r=(n=t.displayName)==null?void 0:n[0])==null?void 0:r.toUpperCase())||((s=(i=t.email)==null?void 0:i[0])==null?void 0:s.toUpperCase())||"U"}),A.jsxs("div",{children:[A.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.displayName||t.username||"User"}),t.role&&A.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-800 mt-2",children:t.role})]})]}),A.jsxs("div",{className:"space-y-4",children:[A.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[A.jsx(l3,{className:"w-5 h-5 text-gray-400"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),A.jsx("p",{className:"text-gray-900",children:t.email})]})]}),t.username&&A.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[A.jsx(w1,{className:"w-5 h-5 text-gray-400"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Username"}),A.jsx("p",{className:"text-gray-900",children:t.username})]})]}),t.role&&A.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[A.jsx(c3,{className:"w-5 h-5 text-gray-400"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Role"}),A.jsx("p",{className:"text-gray-900 capitalize",children:t.role})]})]}),t.createdAt&&A.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[A.jsx(a3,{className:"w-5 h-5 text-gray-400"}),A.jsxs("div",{children:[A.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Member Since"}),A.jsx("p",{className:"text-gray-900",children:new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]})}),A.jsx("div",{className:"card",children:A.jsxs("div",{className:"card-content",children:[A.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Actions"}),A.jsxs("div",{className:"space-y-3",children:[A.jsx("button",{onClick:()=>e("/profile/edit"),className:"btn btn-outline w-full justify-start",children:"Edit Profile Information"}),A.jsx("button",{onClick:()=>e("/profile/change-password"),className:"btn btn-outline w-full justify-start",children:"Change Password"}),A.jsx("button",{onClick:()=>e("/profile/delete"),className:"btn btn-danger w-full justify-start",children:"Delete Account"})]})]})})]})]})}):null},sV=()=>{const{user:t}=ks(),e=fi(),[n,r]=oe.useState(!1),{register:i,handleSubmit:s,formState:{errors:l}}=Jd({defaultValues:{displayName:(t==null?void 0:t.displayName)||"",username:(t==null?void 0:t.username)||"",email:(t==null?void 0:t.email)||""}}),h=async f=>{if(!t||!vn.currentUser){Qe.error("User not authenticated");return}r(!0);try{if(await mC(vn.currentUser,{displayName:f.displayName}),f.email!==t.email)try{await nk(vn.currentUser,f.email)}catch(x){if(x.code==="auth/requires-recent-login"){Qe.error("Please log out and log back in before changing your email",{duration:5e3}),r(!1);return}throw x}const m=xs(Ei,"users",t.id);await _g(m,{displayName:f.displayName,username:f.username,email:f.email}),Qe.success("Profile updated successfully!",{duration:3e3,icon:""}),window.location.href="/profile"}catch(m){console.error("Error updating profile:",m),Qe.error(m.message||"Failed to update profile")}finally{r(!1)}};return t?A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("button",{onClick:()=>e("/profile"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[A.jsx(Hl,{className:"w-4 h-4"}),"Back to Profile"]}),A.jsxs("div",{className:"mb-8",children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Profile"}),A.jsx("p",{className:"mt-2 text-gray-600",children:"Update your personal information"})]}),A.jsx("div",{className:"card",children:A.jsxs("form",{onSubmit:s(h),className:"card-content space-y-6",children:[A.jsxs("div",{children:[A.jsxs("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 mb-1",children:[A.jsx(w1,{className:"w-4 h-4 inline mr-1"}),"Display Name"]}),A.jsx("input",{...i("displayName",{required:"Display name is required",minLength:{value:2,message:"Display name must be at least 2 characters"},maxLength:{value:50,message:"Display name must be less than 50 characters"}}),type:"text",id:"displayName",className:"input",placeholder:"Enter your display name"}),l.displayName&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:l.displayName.message})]}),A.jsxs("div",{children:[A.jsxs("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:[A.jsx(w1,{className:"w-4 h-4 inline mr-1"}),"Username"]}),A.jsx("input",{...i("username",{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"},maxLength:{value:30,message:"Username must be less than 30 characters"},pattern:{value:/^[a-zA-Z0-9_-]+$/,message:"Username can only contain letters, numbers, hyphens, and underscores"}}),type:"text",id:"username",className:"input",placeholder:"Enter your username"}),l.username&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:l.username.message})]}),A.jsxs("div",{children:[A.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:[A.jsx(l3,{className:"w-4 h-4 inline mr-1"}),"Email Address"]}),A.jsx("input",{...i("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}}),type:"email",id:"email",className:"input",placeholder:"Enter your email"}),l.email&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:l.email.message}),A.jsx("p",{className:"text-sm text-gray-500 mt-1",children:" Changing your email may require you to log in again"})]}),A.jsxs("div",{children:[A.jsxs("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:[A.jsx(c3,{className:"w-4 h-4 inline mr-1"}),"Role"]}),A.jsx("input",{type:"text",id:"role",value:t.role,className:"input bg-gray-100 cursor-not-allowed",disabled:!0,readOnly:!0}),A.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Role cannot be changed. Contact an administrator if you need a different role."})]}),A.jsxs("div",{className:"flex gap-3 pt-4",children:[A.jsx("button",{type:"button",onClick:()=>e("/profile"),className:"btn btn-outline flex-1",disabled:n,children:"Cancel"}),A.jsx("button",{type:"submit",disabled:n,className:"btn btn-primary flex-1",children:n?"Saving...":"Save Changes"})]})]})})]})}):null},oV=()=>{const t=fi(),[e,n]=oe.useState(!1),{register:r,handleSubmit:i,formState:{errors:s},watch:l,reset:h}=Jd(),f=l("newPassword"),m=async x=>{if(!vn.currentUser||!vn.currentUser.email){Qe.error("User not authenticated");return}n(!0);try{const _=Bl.credential(vn.currentUser.email,x.currentPassword);await Z6(vn.currentUser,_),await rk(vn.currentUser,x.newPassword),Qe.success("Password changed successfully!",{duration:3e3,icon:""}),h(),t("/profile")}catch(_){console.error("Error changing password:",_),_.code==="auth/wrong-password"?Qe.error("Current password is incorrect"):_.code==="auth/weak-password"?Qe.error("New password is too weak. Use at least 6 characters"):Qe.error(_.message||"Failed to change password")}finally{n(!1)}};return A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("button",{onClick:()=>t("/profile"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[A.jsx(Hl,{className:"w-4 h-4"}),"Back to Profile"]}),A.jsxs("div",{className:"mb-8",children:[A.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Change Password"}),A.jsx("p",{className:"mt-2 text-gray-600",children:"Update your account password"})]}),A.jsx("div",{className:"card",children:A.jsxs("form",{onSubmit:i(m),className:"card-content space-y-6",children:[A.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[A.jsx(o3,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),A.jsxs("div",{className:"text-sm text-blue-800",children:[A.jsx("p",{className:"font-medium mb-1",children:"Password Requirements:"}),A.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[A.jsx("li",{children:"At least 6 characters long"}),A.jsx("li",{children:"Use a mix of letters, numbers, and symbols"}),A.jsx("li",{children:"Avoid common passwords"})]})]})]}),A.jsxs("div",{children:[A.jsxs("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:[A.jsx(vm,{className:"w-4 h-4 inline mr-1"}),"Current Password"]}),A.jsx("input",{...r("currentPassword",{required:"Current password is required"}),type:"password",id:"currentPassword",className:"input",placeholder:"Enter your current password"}),s.currentPassword&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.currentPassword.message})]}),A.jsxs("div",{children:[A.jsxs("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:[A.jsx(vm,{className:"w-4 h-4 inline mr-1"}),"New Password"]}),A.jsx("input",{...r("newPassword",{required:"New password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",id:"newPassword",className:"input",placeholder:"Enter your new password"}),s.newPassword&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.newPassword.message})]}),A.jsxs("div",{children:[A.jsxs("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:[A.jsx(vm,{className:"w-4 h-4 inline mr-1"}),"Confirm New Password"]}),A.jsx("input",{...r("confirmPassword",{required:"Please confirm your new password",validate:x=>x===f||"Passwords do not match"}),type:"password",id:"confirmPassword",className:"input",placeholder:"Confirm your new password"}),s.confirmPassword&&A.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.confirmPassword.message})]}),A.jsxs("div",{className:"flex gap-3 pt-4",children:[A.jsx("button",{type:"button",onClick:()=>t("/profile"),className:"btn btn-outline flex-1",disabled:e,children:"Cancel"}),A.jsx("button",{type:"submit",disabled:e,className:"btn btn-primary flex-1",children:e?"Changing Password...":"Change Password"})]})]})})]})})},aV="modulepreload",lV=function(t){return"/"+t},Lv={},Fv=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=lV(s),s in Lv)return;Lv[s]=!0;const l=s.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(!!r)for(let x=i.length-1;x>=0;x--){const _=i[x];if(_.href===s&&(!l||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${h}`))return;const m=document.createElement("link");if(m.rel=l?"stylesheet":aV,l||(m.as="script",m.crossOrigin=""),m.href=s,document.head.appendChild(m),l)return new Promise((x,_)=>{m.addEventListener("load",x),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},cV=()=>{const{user:t}=ks(),e=fi(),[n,r]=oe.useState(""),[i,s]=oe.useState(!1),l=async()=>{if(n!=="DELETE"){Qe.error("Please type DELETE to confirm");return}if(!vn.currentUser||!t){Qe.error("No user logged in");return}s(!0);try{const h=vn.currentUser.uid,{doc:f,updateDoc:m,serverTimestamp:x}=await Fv(()=>import("./index.esm-7c0470f5.js"),[]),{db:_}=await Fv(()=>Promise.resolve().then(()=>WL),void 0);await m(f(_,"users",h),{isActive:!1,deletedAt:x(),deletedBy:h}),await ak(vn.currentUser),Qe.success("Account deleted successfully"),e("/login")}catch(h){console.error("Error deleting account:",h),h.code==="auth/requires-recent-login"?Qe.error("Please log out and log back in before deleting your account",{duration:5e3}):Qe.error("Failed to delete account. Please try again.")}finally{s(!1)}};return t?A.jsx("div",{className:"min-h-screen bg-gray-50",children:A.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[A.jsxs("button",{onClick:()=>e("/profile"),className:"btn btn-ghost mb-6 flex items-center gap-2",children:[A.jsx(Hl,{className:"w-4 h-4"}),"Back to Profile"]}),A.jsx("div",{className:"card border-2 border-red-200",children:A.jsxs("div",{className:"card-content",children:[A.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[A.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:A.jsx(I7,{className:"w-6 h-6 text-red-600"})}),A.jsxs("div",{children:[A.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Delete Account"}),A.jsx("p",{className:"text-sm text-red-600",children:"This action cannot be undone"})]})]}),A.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[A.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:" Warning"}),A.jsxs("ul",{className:"text-sm text-red-800 space-y-1 list-disc list-inside",children:[A.jsx("li",{children:"Your account will be permanently deleted"}),A.jsx("li",{children:"All your artifacts will remain in the system"}),A.jsx("li",{children:"You will lose access to all your data"}),A.jsx("li",{children:"This action cannot be reversed"})]})]}),A.jsxs("div",{className:"space-y-4",children:[A.jsxs("div",{children:[A.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Type ",A.jsx("span",{className:"font-bold text-red-600",children:"DELETE"})," to confirm"]}),A.jsx("input",{type:"text",value:n,onChange:h=>r(h.target.value),className:"input",placeholder:"Type DELETE here",disabled:i})]}),A.jsxs("div",{className:"flex gap-3",children:[A.jsx("button",{onClick:()=>e("/profile"),className:"btn btn-outline flex-1",disabled:i,children:"Cancel"}),A.jsx("button",{onClick:l,disabled:n!=="DELETE"||i,className:"btn btn-danger flex-1",children:i?"Deleting...":"Delete My Account"})]})]})]})})]})}):null};class uV extends oe.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){this.setState({error:e,errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:A.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:A.jsx("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:A.jsxs("div",{className:"flex items-center",children:[A.jsx("div",{className:"flex-shrink-0",children:A.jsx("svg",{className:"h-8 w-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),A.jsxs("div",{className:"ml-3",children:[A.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Something went wrong"}),A.jsx("div",{className:"mt-2 text-sm text-gray-500",children:A.jsx("p",{children:"We're sorry, but something unexpected happened. Please try refreshing the page."})}),!1,A.jsx("div",{className:"mt-4",children:A.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary btn-sm",children:"Refresh Page"})})]})]})})}):this.props.children}}const hV=()=>{const{user:t}=ks(),e=fi(),[n,r]=oe.useState(!1),i=oe.useRef(null);oe.useEffect(()=>{const m=x=>{i.current&&!i.current.contains(x.target)&&r(!1)};return n&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[n]);const s=async()=>{try{await yC(vn),Qe.success("Logged out successfully"),e("/login")}catch(m){console.error("Error logging out:",m),Qe.error("Failed to log out")}},l=()=>{r(!1),e("/profile")},h=()=>{r(!1),e("/profile/delete")};if(!t)return null;const f=()=>{var m,x;return t.displayName?t.displayName.split(" ").map(_=>_[0]).join("").toUpperCase().slice(0,2):((x=(m=t.email)==null?void 0:m[0])==null?void 0:x.toUpperCase())||"U"};return A.jsxs("div",{className:"relative",ref:i,children:[A.jsxs("button",{onClick:()=>r(!n),className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"User menu",children:[A.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-600 text-white flex items-center justify-center font-semibold text-sm",children:f()}),A.jsxs("div",{className:"hidden md:block text-left",children:[A.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.displayName||t.username||"User"}),A.jsx("p",{className:"text-xs text-gray-500",children:t.email})]}),A.jsx(T7,{className:`w-4 h-4 text-gray-500 transition-transform ${n?"rotate-180":""}`})]}),n&&A.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[A.jsxs("div",{className:"px-4 py-3 border-b border-gray-200",children:[A.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.displayName||t.username||"User"}),A.jsx("p",{className:"text-xs text-gray-500 truncate",children:t.email}),t.role&&A.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary-100 text-primary-800 mt-1",children:t.role})]}),A.jsxs("div",{className:"py-1",children:[A.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[A.jsx(w1,{className:"w-4 h-4"}),A.jsx("span",{children:"View Profile"})]}),A.jsxs("button",{onClick:l,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[A.jsx(P7,{className:"w-4 h-4"}),A.jsx("span",{children:"Account Settings"})]})]}),A.jsxs("div",{className:"border-t border-gray-200 py-1",children:[A.jsxs("button",{onClick:h,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[A.jsx(u3,{className:"w-4 h-4"}),A.jsx("span",{children:"Delete Account"})]}),A.jsxs("button",{onClick:s,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[A.jsx(S7,{className:"w-4 h-4"}),A.jsx("span",{children:"Log Out"})]})]})]})]})},dV=()=>{const{user:t}=ks();return A.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:A.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:A.jsxs("div",{className:"flex justify-between items-center h-16",children:[A.jsxs(Of,{to:"/dashboard",className:"flex items-center gap-2 hover:opacity-80 transition-opacity",children:[A.jsx(Ox,{className:"w-8 h-8 text-primary-600"}),A.jsxs("div",{children:[A.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Artifacts Scanner"}),A.jsx("p",{className:"text-xs text-gray-500",children:"Archaeological Management"})]})]}),t&&A.jsxs("nav",{className:"hidden md:flex items-center gap-6",children:[A.jsx(Of,{to:"/dashboard",className:"text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors",children:"Dashboard"}),A.jsx(Of,{to:"/artifacts",className:"text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors",children:"Artifacts"}),A.jsx(Of,{to:"/scanner",className:"text-sm font-medium text-gray-700 hover:text-primary-600 transition-colors",children:"Scanner"})]}),t&&A.jsx(hV,{})]})})})};function fV(){const{user:t,loading:e}=ks();return e?A.jsx(ef,{}):A.jsx(uV,{children:A.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&A.jsx(dV,{}),A.jsxs(bP,{children:[A.jsx(ri,{path:"/login",element:t?A.jsx(ni,{to:"/dashboard",replace:!0}):A.jsx(x7,{})}),A.jsx(ri,{path:"/dashboard",element:t?A.jsx(_7,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/artifacts",element:t?A.jsx(CF,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/artifacts/new",element:t?A.jsx(bF,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/artifacts/:id/edit",element:t?A.jsx(RF,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/artifacts/:id",element:t?A.jsx(PF,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/scanner",element:t?A.jsx(rV,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/profile",element:t?A.jsx(iV,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/profile/edit",element:t?A.jsx(sV,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/profile/change-password",element:t?A.jsx(oV,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/profile/delete",element:t?A.jsx(cV,{}):A.jsx(ni,{to:"/login",replace:!0})}),A.jsx(ri,{path:"/",element:A.jsx(ni,{to:t?"/dashboard":"/login",replace:!0})})]})]})})}const gV=new L4({defaultOptions:{queries:{staleTime:5*60*1e3,retry:1}}});bm.createRoot(document.getElementById("root")).render(A.jsx(_r.StrictMode,{children:A.jsx(V4,{client:gV,children:A.jsxs(MP,{children:[A.jsx(fV,{}),A.jsx(C8,{position:"top-right"})]})})}));export{Db as $,Kb as A,Dl as B,Ss as C,Dn as D,SB as E,Ul as F,px as G,CB as H,IV as I,Ci as J,S9 as K,R9 as L,G9 as M,YV as N,ZV as O,tL as P,dr as Q,jV as R,bV as S,dn as T,yB as U,hg as V,J9 as W,pB as X,XV as Y,DV as Z,LC as _,pd as a,CV as a0,b9 as a1,U9 as a2,TB as a3,iB as a4,mB as a5,MV as a6,AB as a7,xs as a8,BV as a9,VV as aA,sB as aB,oB as aC,UV as aD,zV as aE,hB as aF,dB as aG,Y9 as aH,F9 as aI,kb as aJ,SV as aK,gB as aL,xd as aM,xm as aN,EB as aO,xV as aP,JV as aQ,qV as aR,WV as aS,QV as aT,LV as aU,_g as aV,xB as aW,kV as aX,V9 as aY,_B as aZ,NV as aa,PV as ab,OV as ac,IB as ad,$V as ae,KV as af,gn as ag,Xd as ah,H9 as ai,aB as aj,Cx as ak,eB as al,tB as am,z9 as an,nB as ao,rB as ap,N9 as aq,vB as ar,wB as as,RV as at,GV as au,HV as av,FV as aw,lB as ax,uB as ay,cB as az,P9 as b,gu as c,jl as d,zt as e,ge as f,Mu as g,$d as h,w0 as i,wg as j,Qd as k,pg as l,Tx as m,mu as n,yg as o,il as p,eL as q,In as r,Al as s,Te as t,EV as u,_O as v,rn as w,bB as x,at as y,_V as z};
//# sourceMappingURL=index-83f475f8.js.map
